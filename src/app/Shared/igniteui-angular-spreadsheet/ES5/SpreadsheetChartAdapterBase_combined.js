/*
THIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT ("AGREEMENT") LOCATED HERE:
https://www.infragistics.com/legal/license/igultimate-la
https://www.infragistics.com/legal/license/igultimate-eula
GOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.
*/
import * as tslib_1 from "tslib";
import { Base, Type, markType, INotifyPropertyChanged_$type, PropertyChangedEventArgs, Nullable$1, IEnumerator$1_$type, IEnumerable$1_$type, IEnumerator_$type, IDisposable_$type, enumGetBox, typeCast, Number_$type, String_$type, fromEnum, getInstanceType, EnumUtil, runOn, delegateRemove, delegateCombine, fromEn, typeGetValue, Boolean_$type, Point_$type, PointUtil, getEnumerator, EventArgs, getBoxIfEnum, NotSupportedException, Stream, typeCastObjTo$t, Array_$type, Date_$type, IEquatable$1_$type, toEnum, Delegate_$type } from "../../igniteui-angular-core/ES5/type";
import { WorksheetChart, OrderedSortCondition, FillSortCondition, FontColorSortCondition, IconSortCondition, CustomListSortCondition, SortCondition, RelativeIndex, WorksheetTableColumn, CellFill, WorkbookColorInfo, FormatConditionIconSet_$type, WorksheetRegionAddress, WorksheetTable, Worksheet, WorksheetRegion, CellConditionalFormat, CellFillPattern, Workbook, WorksheetCellFormatData, CellFillRectangularGradient, CellFillLinearGradient, CellAddress, ExcelUtils, WorksheetCell, DataValidationErrorStyle_$type, CustomFilter, RelativeDateRangeFilter, DatePeriodFilter, AverageFilter, TopOrBottomFilter, YearToDateFilter, CustomFilterCondition, FormatConditionIcon_$type, ExcelComparisonOperator_$type, RelativeDateRangeDuration_$type, RelativeDateRangeOffset_$type, DatePeriodFilterType_$type, WorksheetShape, WorksheetShapeGroupBase, WorksheetShapeGroup, WorksheetHyperlink, WorksheetItemPosition, MathUtilities, ShapeFillNoFill, ShapeFillSolid, ShapeFillImage, ShapeOutlineNoOutline, ShapeOutlineSolid, WorksheetImage, WorksheetShapeWithText, UnknownShape, FormattedString, WorkbookStyle, WorkbookFormatCollection, WorksheetCellFormatProxy, NamedReference, NamedReferenceBase, FormulaParser, CharUnicodeInfo, ListDataValidationRule, ExcelCalcValue, CellCalcReference, Formula, WorksheetCellAddress, CalcUtilities, WorksheetPaneSelection, NamedCalcReference, ChangeInfo, StructuredTableReference, RowColumnBase, TableCalcReferenceBase, FontUnderlineStyle_$type, FontSuperscriptSubscriptStyle_$type, HorizontalCellAlignment_$type, VerticalCellAlignment_$type, CellReferenceMode_$type, IWorkbookOwner_$type, CellBorderLineStyle_$type, DiagonalBorders_$type, IWorksheetCellFormat_$type, TextMetricsProviderBase, CellFillGradientStop, ChartGradientFill, ChartEmptyFill, ChartSolidFill, Colors, ValueFormatter, GetCellTextParameters, ErrorValue, IconFilter, WeakWorkbookOwner, WorksheetReferenceCollection, ConditionBase, FillPatternStyle_$type, HorizontalTextAlignment_$type, ExcelChangeAction_$type, IFilterable_$type, IWorkbookFont_$type, WorksheetProtectedRange, WorksheetCellBlock, WorkbookFontData, WorksheetMergedCellsRegion, ArrayFormula, StringElement, FormulaContext, RefToken, AreaToken, UnaryOperatorToken, BinaryOperatorToken, WorkbookFontProxy, FormattedStringElement, IRegionBlockingValue_$type, IFunctionToken_$type, FontColorFilter, FillFilter, FixedValuesFilter, IndexRange, CellSizeMeasurementContext, ArrayInteriorFormula, DataTableInteriorFormula, WorkbookBuiltInStyle, PaneLocation_$type, RegionLookupTable$1, WorksheetCellComment, NamedReferenceUnconnected, SortedIntRangeList, WorkbookLoadOptions, WorkbookSaveOptions, ColorsInternal, DateRangeFilter, WorkbookThemeColorType_$type } from "../../igniteui-angular-excel/ES5/excel.core";
import { SortDirectionWithCustomListOptions_$type } from "./SortDirectionWithCustomListOptions";
import { Dictionary$2 } from "../../igniteui-angular-core/ES5/Dictionary$2";
import { SpreadsheetSortDialogConditionType_$type } from "./SpreadsheetSortDialogConditionType";
import { ComboBoxListItem } from "./ComboBoxListItem";
import { ObservableCollectionExtended$1 } from "./ObservableCollectionExtended$1";
import { List$1 } from "../../igniteui-angular-core/ES5/List$1";
import { KeyValuePair$2 } from "../../igniteui-angular-core/ES5/KeyValuePair$2";
import { Tuple$2 } from "../../igniteui-angular-core/ES5/Tuple$2";
import { StringBuilder } from "../../igniteui-angular-core/ES5/StringBuilder";
import { Tuple } from "../../igniteui-angular-core/ES5/Tuple";
import { stringFormat, stringCompare1, stringSplit, stringFormat1, isLetterOrDigit, indexOfAny, startsWith1, isDigit, trimEnd, stringEquals1 } from "../../igniteui-angular-core/ES5/stringExtended";
import { SortContext_$type } from "./SortContext";
import { ObservableCollection$1 } from "../../igniteui-angular-core/ES5/ObservableCollection$1";
import { SortTargetResult } from "./SortTargetResult";
import { ArgumentNullException } from "../../igniteui-angular-core/ES5/ArgumentNullException";
import { ActiveRowIndexChangedEventArgs } from "./ActiveRowIndexChangedEventArgs";
import { ArgumentException } from "../../igniteui-angular-core/ES5/ArgumentException";
import { Color } from "../../igniteui-angular-core/ES5/Color";
import { ArgumentOutOfRangeException } from "../../igniteui-angular-core/ES5/ArgumentOutOfRangeException";
import { HashSet$1 } from "../../igniteui-angular-core/ES5/HashSet$1";
import { CellContentType_$type } from "./CellContentType";
import { nullableEquals, nullableNotEquals, nullableIsNull, unwrapNullable, wrapNullable, nullableLessThan, nullableGreaterThan, nullableLessThanOrEqual, nullableGreaterThanOrEqual } from "../../igniteui-angular-core/ES5/nullable";
import { stringEmpty, stringReplace, stringIsNullOrEmpty, stringStartsWith, stringIsNullOrWhiteSpace, stringContains, stringToString$1 } from "../../igniteui-angular-core/ES5/string";
import { DomWrapper_$type } from "../../igniteui-angular-core/ES5/dom";
import { Rect } from "../../igniteui-angular-core/ES5/Rect";
import { VisualElement } from "./VisualElement";
import { BaseDOMEventProxy } from "../../igniteui-angular-core/ES5/BaseDOMEventProxy";
import { DropDown } from "./DropDown";
import { DropDownItem } from "./DropDownItem";
import { DropDownPosition } from "./DropDownPosition";
import { RelativePositionInfo } from "./RelativePositionInfo";
import { SpreadsheetCell } from "./SpreadsheetCell";
import { SpreadsheetCellRange } from "./SpreadsheetCellRange";
import { CoreUtilities } from "./CoreUtilities";
import { ISpreadsheetEditorValue_$type } from "./ISpreadsheetEditorValue";
import { SpreadsheetEditModeEnteringEventArgs } from "./SpreadsheetEditModeEnteringEventArgs";
import { SpreadsheetEditModeEnteredEventArgs } from "./SpreadsheetEditModeEnteredEventArgs";
import { SpreadsheetAction_$type } from "./SpreadsheetAction";
import { SpreadsheetEditModeExitingEventArgs } from "./SpreadsheetEditModeExitingEventArgs";
import { SpreadsheetEditModeExitedEventArgs } from "./SpreadsheetEditModeExitedEventArgs";
import { SpreadsheetTransactionOperation_$type } from "./SpreadsheetTransactionOperation";
import { SpreadsheetEditModeValidationErrorEventArgs } from "./SpreadsheetEditModeValidationErrorEventArgs";
import { EditModeDataValidationException } from "./EditModeDataValidationException";
import { isNaN_, truncate, intDivide, isInfinity, tryParseNumber } from "../../igniteui-angular-core/ES5/number";
import { Thickness } from "../../igniteui-angular-core/ES5/Thickness";
import { WorkbookFontSnapshot } from "./WorkbookFontSnapshot";
import { TextBoxVisualElement } from "./TextBoxVisualElement";
import { SpreadsheetEditorValue } from "./SpreadsheetEditorValue";
import { ClipboardHelper } from "./ClipboardHelper";
import { DataFormats } from "../../igniteui-angular-core/ES5/DataFormats";
import { SpreadsheetContextMenuSubItem_$type } from "./SpreadsheetContextMenuSubItem";
import { SpreadsheetSpecialFilterMenuItems_$type } from "./SpreadsheetSpecialFilterMenuItems";
import { LongValue } from "./LongValue";
import { Enumerable } from "../../igniteui-angular-core/ES5/Enumerable";
import { SpreadsheetUserPromptTrigger_$type } from "./SpreadsheetUserPromptTrigger";
import { ReadOnlyCollection$1 } from "../../igniteui-angular-core/ES5/ReadOnlyCollection$1";
import { ElementLayer$1 } from "./ElementLayer$1";
import { PropertyChangeNotifierExtended } from "./PropertyChangeNotifierExtended";
import { SpreadsheetImageBackground } from "./SpreadsheetImageBackground";
import { PropertyChangeNotifier } from "./PropertyChangeNotifier";
import { SpreadsheetCellRenderInfoArray } from "./SpreadsheetCellRenderInfoArray";
import { MDList$1 } from "./MDList$1";
import { SpreadsheetDropDownButton } from "./SpreadsheetDropDownButton";
import { SpreadsheetGridLinePen } from "./SpreadsheetGridLinePen";
import { MDBitArray } from "./MDBitArray";
import { WeakReference } from "../../igniteui-angular-core/ES5/WeakReference";
import { PropertyChangeListener$1 } from "./PropertyChangeListener$1";
import { IPropertyChangeListener_$type } from "./IPropertyChangeListener";
import { PropertyChangeListenerList } from "./PropertyChangeListenerList";
import { IntRange } from "./IntRange";
import { PredefinedSpreadsheetLayers } from "./PredefinedSpreadsheetLayers";
import { Size } from "../../igniteui-angular-core/ES5/Size";
import { CT_Path2DArcTo, CT_Path2DClose, CT_Path2DCubicBezierTo, CT_AdjPoint2D, CT_Path2DLineTo, CT_Path2DMoveTo, CT_Path2DQuadBezierTo, IPath2DCommandVisitor$2_$type, CT_Path2D, CT_CustomGeometry2D, CT_GeomGuideList, CT_GeomRect, CT_TextBodyProperties, CT_Path2DList, ST_AdjAngle, ST_AdjCoordinate, CT_GeomGuide, CT_PresetGeometry2D, ICT_ShapePropertiesOwner_$type, IPath2DCommand_$type, ST_PathFillMode_$type } from "../../igniteui-angular-excel/ES5/documents.openxml";
import { ShapeGuideVariables } from "./ShapeGuideVariables";
import { ImageData, ImageFormat, ST_PositiveCoordinate, ST_Angle, ST_ShapeType_$type } from "../../igniteui-angular-excel/ES5/documents.core";
import { XmlConvert } from "../../igniteui-angular-core/ES5/XmlConvert";
import { Convert } from "../../igniteui-angular-core/ES5/Convert";
import { ShapeGuide } from "./ShapeGuide";
import { ContextMenu } from "./ContextMenu";
import { Brush } from "../../igniteui-angular-core/ES5/Brush";
import { SpreadsheetResourceId_$type } from "./SpreadsheetResourceId";
import { LRUCache$2 } from "../../igniteui-angular-core/ES5/LRUCache$2";
import { DefaultSpreadsheetColors } from "./DefaultSpreadsheetColors";
import { VisualElementConstraint } from "./VisualElementConstraint";
import { VisualElementThickness } from "./VisualElementThickness";
import { VisualElementDomBuilder } from "./VisualElementDomBuilder";
import { SpreadsheetMetricsCache } from "./SpreadsheetMetricsCache";
import { SpreadsheetMeasureHelper_MeasureStack } from "./SpreadsheetMeasureHelper_MeasureStack";
import { WorkbookDataObjectPastingEventArgs } from "./WorkbookDataObjectPastingEventArgs";
import { SpreadsheetDialogResult } from "./SpreadsheetDialogResult";
import { EditModeWorkbookFontInfo } from "./EditModeWorkbookFontInfo";
import { rectFromLiteral, rectToLiteral } from "../../igniteui-angular-core/ES5/IgRect";
import { pointFromLiteral } from "../../igniteui-angular-core/ES5/IgPoint";
import { SpreadsheetDialogServicesManager } from "./SpreadsheetDialogServicesManager";
import { ResolvedWorkbookFont } from "./ResolvedWorkbookFont";
import { IGFormattedTextDocument } from "./IGFormattedTextDocument";
import { VisualElementInputProxy } from "./VisualElementInputProxy";
import { SpreadsheetAreaLayoutManager_SheetLayerInfo$1 } from "./SpreadsheetAreaLayoutManager_SheetLayerInfo$1";
import { PixelConverter } from "./PixelConverter";
import { IElementLayerContainer_$type } from "./IElementLayerContainer";
import { IPlatformScrollBarAdapter_$type } from "./IPlatformScrollBarAdapter";
import { ScrollBarVisibilityCoordinator } from "./ScrollBarVisibilityCoordinator";
import { ScrollBarInfoMediator } from "./ScrollBarInfoMediator";
import { TimedOperation } from "./TimedOperation";
import { SpreadsheetHitTestResult } from "./SpreadsheetHitTestResult";
import { ScrollInfo } from "./ScrollInfo";
import { ExtendedScrollBarInfoMediator } from "./ExtendedScrollBarInfoMediator";
import { EqualityComparer$1 } from "../../igniteui-angular-core/ES5/EqualityComparer$1";
import { boxArray$1, arrayGetLength, arrayCopyTo } from "../../igniteui-angular-core/ES5/array";
import { arrayIndexOf1 } from "../../igniteui-angular-core/ES5/arrayExtended";
import { ButtonVisualElement } from "./ButtonVisualElement";
import { RendererLayerVisualElement$2 } from "./RendererLayerVisualElement$2";
import { ISpreadsheetGraphics_$type } from "./ISpreadsheetGraphics";
import { RendererLayerVisualElementView$1 } from "./RendererLayerVisualElementView$1";
import { RendererElementLayer$2 } from "./RendererElementLayer$2";
import { ScrollBarVisualElement } from "./ScrollBarVisualElement";
import { JsScrollBar } from "./JsScrollBar";
import { JsScrollBarAdapter } from "./JsScrollBarAdapter";
import { RepeatButtonVisualElement } from "./RepeatButtonVisualElement";
import { RootVisualElement } from "./RootVisualElement";
import { SpreadsheetCursorHelper } from "./SpreadsheetCursorHelper";
import { ISpreadsheetInteractionManagerOwner_$type } from "./ISpreadsheetInteractionManagerOwner";
import { LayerVisualElement } from "./LayerVisualElement";
import { SpreadsheetToolTipContext } from "./SpreadsheetToolTipContext";
import { sizeToLiteral, sizeFromLiteral } from "../../igniteui-angular-core/ES5/IgSize";
import { IRendererElementLayerView$2_$type } from "./IRendererElementLayerView$2";
import { PageStartScrollCache } from "./PageStartScrollCache";
import { ISpreadsheetResourceProvider_$type } from "./ISpreadsheetResourceProvider";
import { SpreadsheetHeaderContentLayerBase_HeaderInfo$1 } from "./SpreadsheetHeaderContentLayerBase_HeaderInfo$1";
import { HeaderVisual } from "./HeaderVisual";
import { HeaderVisualInfo } from "./HeaderVisualInfo";
import { SpreadsheetDrawingOperation } from "./SpreadsheetDrawingOperation";
import { NotImplementedException } from "../../igniteui-angular-core/ES5/NotImplementedException";
import { LineVisualElement } from "./LineVisualElement";
import { SpreadsheetIconElement } from "./SpreadsheetIconElement";
import { SpreadsheetInvalidDataElement } from "./SpreadsheetInvalidDataElement";
import { ElementLayerViewSingle } from "./ElementLayerViewSingle";
import { ILayerRenderer_$type } from "./ILayerRenderer";
import { Spreadsheet_SimpleNamedReference } from "./Spreadsheet_SimpleNamedReference";
import { ReadOnlyNotifyCollection$1 } from "./ReadOnlyNotifyCollection$1";
import { InvalidOperationException } from "../../igniteui-angular-core/ES5/InvalidOperationException";
import { UndoManager } from "./UndoManager";
import { WeakPropertyChangedHandler$1 } from "./WeakPropertyChangedHandler$1";
import { SpreadsheetMouseOperation } from "./SpreadsheetMouseOperation";
import { IgDialogWrapper } from "./IgDialogWrapper";
import { DeferredOperation } from "./DeferredOperation";
import { SpreadsheetCommandBuilder } from "./SpreadsheetCommandBuilder";
import { SpreadsheetCommandExecutingEventArgs } from "./SpreadsheetCommandExecutingEventArgs";
import { SpreadsheetCommandExecutedEventArgs } from "./SpreadsheetCommandExecutedEventArgs";
import { Localization } from "../../igniteui-angular-core/ES5/Localization";
import { Environment } from "../../igniteui-angular-core/ES5/Environment";
import { Spreadsheet_CustomEditValue } from "./Spreadsheet_CustomEditValue";
import { FormatCellsDialogTab_$type } from "./FormatCellsDialogTab";
import { FormatCellsDialogOptions } from "./FormatCellsDialogOptions";
import { FormatCellsDialogData } from "./FormatCellsDialogData";
import { WorkbookSerializationLoadException } from "./WorkbookSerializationLoadException";
import { WorkbookDataObjectCopyingEventArgs } from "./WorkbookDataObjectCopyingEventArgs";
import { WorkbookDataObjectSettingDataEventArgs } from "./WorkbookDataObjectSettingDataEventArgs";
import { WorkbookSerializationErrorEventArgs } from "./WorkbookSerializationErrorEventArgs";
import { IWorksheetUndoUnit_$type } from "./IWorksheetUndoUnit";
import { UndoTransaction } from "./UndoTransaction";
import { LockedEditRangeInfoForOperation } from "./LockedEditRangeInfoForOperation";
import { SpreadsheetEditRangePasswordNeededEventArgs } from "./SpreadsheetEditRangePasswordNeededEventArgs";
import { LockedEditRangeInfoForWorksheet } from "./LockedEditRangeInfoForWorksheet";
import { TableExpansionInfo } from "./TableExpansionInfo";
import { WorkbookSerializationLoadOptions } from "./WorkbookSerializationLoadOptions";
import { SpreadsheetActiveCellChangedEventArgs } from "./SpreadsheetActiveCellChangedEventArgs";
import { SpreadsheetActiveTableChangedEventArgs } from "./SpreadsheetActiveTableChangedEventArgs";
import { SpreadsheetActiveWorksheetChangedEventArgs } from "./SpreadsheetActiveWorksheetChangedEventArgs";
import { SpreadsheetHyperlinkExecutingEventArgs } from "./SpreadsheetHyperlinkExecutingEventArgs";
import { IOPath } from "../../igniteui-angular-core/ES5/IOPath";
import { Uri } from "../../igniteui-angular-core/ES5/Uri";
import { SpreadsheetCellDropDownItemSelectingEventArgs } from "./SpreadsheetCellDropDownItemSelectingEventArgs";
import { SpreadsheetWorkbookDirtiedEventArgs } from "./SpreadsheetWorkbookDirtiedEventArgs";
import { InvalidMultipleRangeSelection } from "./InvalidMultipleRangeSelection";
import { EditableComboBox } from "./EditableComboBox";
import { ExcelCellFormatCategory_$type } from "./ExcelCellFormatCategory";
import { WorksheetUndoTransaction } from "./WorksheetUndoTransaction";
import { ReadOnlyResolvedWorksheetCellFormatData } from "./ReadOnlyResolvedWorksheetCellFormatData";
import { LazyReadOnlyNotifyCollection$1 } from "./LazyReadOnlyNotifyCollection$1";
import { StringComparer } from "../../igniteui-angular-core/ES5/StringComparer";
import { ISpreadsheetEditInfo_$type } from "./ISpreadsheetEditInfo";
import { MemoryStream } from "../../igniteui-angular-core/ES5/MemoryStream";
import { SpreadsheetRenderCache_MeasureTextMetricsProvider } from "./SpreadsheetRenderCache_MeasureTextMetricsProvider";
import { Spreadsheet_NullSpreadsheetText } from "./Spreadsheet_NullSpreadsheetText";
import { CustomDOMEventProxy } from "./CustomDOMEventProxy";
import { Stack$1 } from "../../igniteui-angular-core/ES5/Stack$1";
import { SpreadsheetVisualElementDomBuilder_CanvasCache } from "./SpreadsheetVisualElementDomBuilder_CanvasCache";
import { ComboBoxVisualElement } from "./ComboBoxVisualElement";
import { ToggleButtonVisualElement } from "./ToggleButtonVisualElement";
import { JSDataObject } from "./JSDataObject";
import { JsSpreadsheetText } from "./JsSpreadsheetText";
import { ResolvedWorksheetCellFormatDataFont } from "./ResolvedWorksheetCellFormatDataFont";
import { FormattedStringFontResolved } from "./FormattedStringFontResolved";
import { BrushUtilCore } from "../../igniteui-angular-core/ES5/BrushUtilCore";
import { IGFormattedTextParagraph } from "./IGFormattedTextParagraph";
import { IGFormattedTextRun } from "./IGFormattedTextRun";
import { IGFormattedTextFont } from "./IGFormattedTextFont";
import { IGFormattedTextSettings } from "./IGFormattedTextSettings";
import { Encoding } from "../../igniteui-angular-core/ES5/Encoding";
import { Regex } from "../../igniteui-angular-core/ES5/Regex";
import { CultureInfo, NumberFormatInfo, DateTimeFormat } from "../../igniteui-angular-core/ES5/culture";
import { UriParser } from "../../igniteui-angular-core/ES5/UriParser";
import { AdapterIntRangeSet$1 } from "./AdapterIntRangeSet$1";
import { intSToU, numberToString2, tryParseInt32_1, tryParseNumber1, tryParseInt32_2, numberToString } from "../../igniteui-angular-core/ES5/numberExtended";
import { dateFromValues, dateGetTimeOfDay, dateToday, dateAddHours, dateMinValue, dateGetDate, dateMaxValue, dateNow } from "../../igniteui-angular-core/ES5/date";
import { dateToStringFormat, dateTryParse } from "../../igniteui-angular-core/ES5/dateExtended";
import { timeSpanTotalDays, timeSpanTotalHours, timeSpanFromHours } from "../../igniteui-angular-core/ES5/timespan";
import { SpreadsheetEditHelper_TextChangeWithOptions } from "./SpreadsheetEditHelper_TextChangeWithOptions";
import { XmlTextReader } from "../../igniteui-angular-core/ES5/XmlTextReader";
import { StringReader } from "../../igniteui-angular-core/ES5/StringReader";
import { GZipStream } from "../../igniteui-angular-excel/ES5/excel.openxml";
import { CellBorderValue } from "./CellBorderValue";
import { RowCellFormatEnumerator } from "./RowCellFormatEnumerator";
import { ColumnCellFormatEnumerator } from "./ColumnCellFormatEnumerator";
import { PlatformTimer } from "./PlatformTimer";
import { SpreadsheetPaneManager_InternalFlags_$type } from "./SpreadsheetPaneManager_InternalFlags";
import { Queue$1 } from "../../igniteui-angular-core/ES5/Queue$1";
import { DisposableAction } from "./DisposableAction";
import { SpreadsheetChartDataInfo } from "./SpreadsheetChartDataInfo";
import { SpreadsheetPaneManager_SetBorderHelper } from "./SpreadsheetPaneManager_SetBorderHelper";
import { ExtendedRangeScrollInfo } from "./ExtendedRangeScrollInfo";
import { SpreadsheetResolvedRenderFormat } from "./SpreadsheetResolvedRenderFormat";
import { WorksheetCellFormatDataEqualityComparer } from "./WorksheetCellFormatDataEqualityComparer";
import { WorkbookSerializationProviderBase } from "./WorkbookSerializationProviderBase";
import { ExcelWorkbookSerializationProvider_CellRangeTargetInfo } from "./ExcelWorkbookSerializationProvider_CellRangeTargetInfo";
import { WorkbookDataObjectLoadContext } from "./WorkbookDataObjectLoadContext";
import { ExcelWorkbookSerializationProvider_TargetColumnIndexHelper } from "./ExcelWorkbookSerializationProvider_TargetColumnIndexHelper";
import { CellRegionMapMany } from "./CellRegionMapMany";
import { CellRegionMapSingle } from "./CellRegionMapSingle";
import { WorkbookDataObjectSaveContext } from "./WorkbookDataObjectSaveContext";
import { StreamReader } from "../../igniteui-angular-core/ES5/StreamReader";
import { PlainTextWorkbookSerializationProvider_ParseEditValue } from "./PlainTextWorkbookSerializationProvider_ParseEditValue";
import { PlainTextReader } from "./PlainTextReader";
import { PlainTextWriter } from "./PlainTextWriter";
import { StreamWriter } from "../../igniteui-angular-core/ES5/StreamWriter";
import { IGExcelSerializationProvider_SyncPackageFactory } from "./IGExcelSerializationProvider_SyncPackageFactory";
import { Guid } from "../../igniteui-angular-core/ES5/Guid";
import { IGExcelSerializationProvider_SelectionWorkbookSaveFilter } from "./IGExcelSerializationProvider_SelectionWorkbookSaveFilter";
import { StringWriter } from "../../igniteui-angular-core/ES5/StringWriter";
import { SpreadsheetTabManager_InternalFlags_$type } from "./SpreadsheetTabManager_InternalFlags";
import { WorkbookUndoUnitBase } from "./WorkbookUndoUnitBase";
import { SpreadsheetVisualData } from "./SpreadsheetVisualData";
import { SpreadsheetHeaderAreaVisualData } from "./SpreadsheetHeaderAreaVisualData";
import { SpreadsheetCellAreaVisualData } from "./SpreadsheetCellAreaVisualData";
import { RectData } from "../../igniteui-angular-core/ES5/RectData";
import { SpreadsheetRowColumnVisualData } from "./SpreadsheetRowColumnVisualData";
import { AdjustableVisualElement } from "./AdjustableVisualElement";
import { SpreadsheetDialogUtilities } from "./SpreadsheetDialogUtilities";
import { FormatCellsDialogBorderInfo } from "./FormatCellsDialogBorderInfo";
import { StyleAttributeMember } from "./StyleAttributeMember";
import { CheckboxElementInfo } from "./CheckboxElementInfo";
import { SpreadsheetDialogFormatCategory } from "./SpreadsheetDialogFormatCategory";
import { BorderLineButtonElementProxy } from "./BorderLineButtonElementProxy";
import { SingleCellSpreadsheetPreviewHelper } from "./SingleCellSpreadsheetPreviewHelper";
import { FormatCellsDialogManager_ElementVisibility_$type } from "./FormatCellsDialogManager_ElementVisibility";
import { SpreadsheetDialogFormat } from "./SpreadsheetDialogFormat";
import { ColorSortingCriteriaControl_ColorSortingCriteriaElementPart_$type } from "./ColorSortingCriteriaControl_ColorSortingCriteriaElementPart";
import { SortCriteriaRow_RowElementPart_$type } from "./SortCriteriaRow_RowElementPart";
import { tryParseBool } from "../../igniteui-angular-core/ES5/bool";
import { ThemeColorPickerControlViewModel } from "./ThemeColorPickerControlViewModel";
import { DialogFontStyle_$type } from "./DialogFontStyle";
import { ISpreadsheetDialogFormatsService_$type } from "./ISpreadsheetDialogFormatsService";
import { SpreadsheetDialogFormatCategoryEx } from "./SpreadsheetDialogFormatCategoryEx";
import { FormatCellsDialogViewModel_FormatCellsDialogState } from "./FormatCellsDialogViewModel_FormatCellsDialogState";
/**
 * Defines a base class for spreadsheet chart adapters that creates and initializes a container element which contains the elements required to display the chart in a spreadsheet based on a [[WorksheetChart]] instance.
 */
var SpreadsheetChartAdapterBase = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetChartAdapterBase, _super);
    function SpreadsheetChartAdapterBase() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetChartAdapterBase.$t = markType(SpreadsheetChartAdapterBase, 'SpreadsheetChartAdapterBase');
    return SpreadsheetChartAdapterBase;
}(Base));
export { SpreadsheetChartAdapterBase };
/**
 * @hidden
 */
var SortConditionWrapper = /** @class */ (function (_super) {
    tslib_1.__extends(SortConditionWrapper, _super);
    function SortConditionWrapper(a, b, c) {
        var _this = _super.call(this) || this;
        _this._f = 0;
        _this._s = 0;
        _this._x = 0;
        _this._z = null;
        _this._d = 0;
        _this._k = null;
        _this._ab = null;
        _this._ac = null;
        _this._a = null;
        _this._ae = null;
        _this._b = null;
        _this._c = null;
        _this.propertyChanged = null;
        _this._k = a;
        _this._aj(b, c);
        return _this;
    }
    SortConditionWrapper.prototype._ak = function (a) {
        switch (a) {
            case "SortConditionType":
                switch (this._h) {
                    case 0:
                    case 1:
                    case 2:
                    case 3:
                        switch (this._e) {
                            case 2:
                                this._e = 0;
                                break;
                            case 3:
                                this._e = 1;
                                break;
                        }
                        break;
                    case 4: break;
                }
                this._k._cd(this);
                this._am();
                break;
            case "Column":
                this._k._cd(this);
                this._am();
                break;
        }
        var b = this.propertyChanged;
        if (null != b) {
            b(this, new PropertyChangedEventArgs(a));
        }
    };
    SortConditionWrapper.prototype.toString = function () {
        return stringFormat("{0} - {1}", this._w, enumGetBox(SpreadsheetSortDialogConditionType_$type, this._h));
    };
    SortConditionWrapper.prototype._aj = function (a, b) {
        var _this = this;
        var e_1, _0;
        if (null == a) {
            this._y = 0;
            return;
        }
        var c = null;
        var d = 0;
        var e = getInstanceType(a);
        if (e == SortConditionWrapper._ai) {
            var f = a;
            c = f.value;
            d = f.key.index;
        }
        else if (e == SortConditionWrapper._ah) {
            var g = a;
            c = g.value;
            var h = g.key;
            d = h.index;
        }
        else {
        }
        var i = false;
        if (null != c) {
            var j = ((function () { var k = SortConditionWrapper._p.tryGetValue(getInstanceType(c), _this._f); _this._f = k.p1; return k.ret; })());
            if (!j) {
                return;
            }
            switch (this._f) {
                case 1:
                    {
                        var k = typeCast(FillSortCondition.$, c);
                        if (null != k) {
                            this._z = k.fill;
                        }
                        else {
                        }
                    }
                    break;
                case 2:
                    {
                        var l = typeCast(FontColorSortCondition.$, c);
                        if (null != l) {
                            this._z = l.fontColorInfo;
                        }
                        else {
                        }
                    }
                    break;
                case 3:
                    {
                        var m = typeCast(IconSortCondition.$, c);
                        if (null != m) {
                            var n = Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), m.iconSet, m._iconIndex$i);
                            this._z = n;
                        }
                        else {
                        }
                    }
                    break;
                case 4:
                    {
                        var o = typeCast(CustomListSortCondition.$, c);
                        if (null != o) {
                            var p = new StringBuilder(0);
                            var q = new StringBuilder(0);
                            var r = new List$1(String_$type, 0);
                            try {
                                for (var _1 = tslib_1.__values(fromEnum(o.list)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                                    var s = _2.value;
                                    if (p.c > 0) {
                                        p.l(", ");
                                    }
                                    p.l(s);
                                    if (q.c > 0) {
                                        q.x(0, ", ");
                                    }
                                    q.x(0, s);
                                    r.add(s);
                                }
                            }
                            catch (e_1_1) { e_1 = { error: e_1_1 }; }
                            finally {
                                try {
                                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                                }
                                finally { if (e_1) throw e_1.error; }
                            }
                            this._ab = p.toString();
                            this._ac = q.toString();
                            this._a = r.toArray();
                            this._f = 0;
                            i = true;
                        }
                        else {
                        }
                    }
                    break;
                case 0: break;
                default: break;
            }
            var t1 = c.sortDirection;
            L0: while (true) {
                switch (t1) {
                    case 0:
                        this._d = i ? 2 : 0;
                        break;
                    case 1:
                        this._d = i ? 3 : 1;
                        break;
                    default:
                        t1 = 0;
                        continue L0;
                }
                break;
            }
        }
        d += b;
        this._y = d;
    };
    SortConditionWrapper.prototype._ad = function (a) {
        return a ? this._ab : this._ac;
    };
    SortConditionWrapper.prototype._v = function () {
        return this._k._au();
    };
    SortConditionWrapper.prototype._al = function (a, b) {
        if (b === void 0) { b = false; }
        var c = a;
        var d = c + this._v();
        var e = this._s != d;
        var f = this._x != c;
        if (false == b && false == f && false == e) {
            return;
        }
        this._s = d;
        this._x = c;
        this._ak("Column");
        if (b || e) {
            this._ak("AbsoluteColumnIndex");
        }
        if (b || f) {
            this._ak("RelativeColumnIndex");
        }
    };
    SortConditionWrapper.prototype._am = function () {
        this._k._b9(this);
        this._ak("ColorSortingCriteriaListItems");
    };
    SortConditionWrapper.prototype._an = function () {
        switch (this._w) {
            case 0:
                this._af = this._k._bg;
                break;
            default:
                this._af = this._k._bq;
                break;
        }
    };
    SortConditionWrapper.prototype._j = function () {
        var a = new SortConditionWrapper(this._k, null, 0);
        a._d = this._d;
        a._f = this._f;
        a._x = this._x;
        a._s = this._s;
        a._z = this._z;
        a._ab = this._ab;
        a._ac = this._ac;
        a._a = this._a;
        a._ae = this._ae;
        this._k._cd(a);
        return a;
    };
    SortConditionWrapper.prototype._u = function () {
        var a = this._aa;
        var b = a == null;
        for (var c = 0; c < this._q.count; c++) {
            var d = this._q.item(c);
            var e = d.dataValue;
            var f = e == null;
            if (b) {
                if (f) {
                    return c;
                }
                else {
                    continue;
                }
            }
            if (Base.equalsStatic(e, a)) {
                return c;
            }
        }
        return -1;
    };
    SortConditionWrapper.prototype._n = function (a, b) {
        var c = this._l;
        switch (this._h) {
            case 0:
                a = new OrderedSortCondition(c);
                b = null;
                return {
                    ret: true,
                    p0: a,
                    p1: b
                };
            case 1:
                var d = this._aa;
                if (null == d) {
                    var e = this._i._fs("SpreadsheetSortDialogConditionTypes_FillSortCondition_DisplayText");
                    b = new SortDialogViewModel_ApplySortErrorInfo(1, this, "Cell Color", this._i._fs("SortDialog_SortConditionError_FieldCannotBeNull", e));
                    a = null;
                    return {
                        ret: false,
                        p0: a,
                        p1: b
                    };
                }
                a = new FillSortCondition(d, c);
                b = null;
                return {
                    ret: true,
                    p0: a,
                    p1: b
                };
            case 2:
                var f = this._aa;
                if (WorkbookColorInfo.l_op_Equality(null, f)) {
                    var g = this._i._fs("SpreadsheetSortDialogConditionTypes_FontColorSortCondition_DisplayText");
                    b = new SortDialogViewModel_ApplySortErrorInfo(1, this, "Font Color", this._i._fs("SortDialog_SortConditionError_FieldCannotBeNull", g));
                    a = null;
                    return {
                        ret: false,
                        p0: a,
                        p1: b
                    };
                }
                a = new FontColorSortCondition(f, c);
                b = null;
                return {
                    ret: true,
                    p0: a,
                    p1: b
                };
            case 3:
                var h = this._aa;
                if (null == h) {
                    var i = this._i._fs("SpreadsheetSortDialogConditionTypes_IconSortCondition_DisplayText");
                    b = new SortDialogViewModel_ApplySortErrorInfo(1, this, "Conditional Formatting Icon", this._i._fs("SortDialog_SortConditionError_FieldCannotBeNull", i));
                    a = null;
                    return {
                        ret: false,
                        p0: a,
                        p1: b
                    };
                }
                a = new IconSortCondition(h.c, h.d, c);
                b = null;
                return {
                    ret: true,
                    p0: a,
                    p1: b
                };
            case 4:
                a = new (CustomListSortCondition.bind.apply(CustomListSortCondition, tslib_1.__spread([void 0, c], this._a)))();
                b = null;
                return {
                    ret: true,
                    p0: a,
                    p1: b
                };
            default:
                a = null;
                b = null;
                return {
                    ret: false,
                    p0: a,
                    p1: b
                };
        }
    };
    Object.defineProperty(SortConditionWrapper.prototype, "_af", {
        get: function () {
            return this._ae;
        },
        set: function (a) {
            if (stringCompare1(this._ae, a, 0) == 0) {
                return;
            }
            this._ae = a;
            this._ak("SortByLabelText");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_l", {
        get: function () {
            switch (this._d) {
                case 0:
                case 2: return 0;
                case 1:
                case 3: return 1;
                default: return 0;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_i", {
        get: function () {
            return this._k._e;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper, "_p", {
        get: function () {
            if (null == SortConditionWrapper._o) {
                var a = EnumUtil.getValues(SpreadsheetSortDialogConditionType_$type).length;
                SortConditionWrapper._o = new Dictionary$2(Type.$, SpreadsheetSortDialogConditionType_$type, 1, a);
                SortConditionWrapper._o.addItem(OrderedSortCondition.$, 0);
                SortConditionWrapper._o.addItem(FillSortCondition.$, 1);
                SortConditionWrapper._o.addItem(FontColorSortCondition.$, 2);
                SortConditionWrapper._o.addItem(IconSortCondition.$, 3);
                SortConditionWrapper._o.addItem(CustomListSortCondition.$, 4);
            }
            return SortConditionWrapper._o;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_t", {
        get: function () {
            return this._s;
        },
        set: function (a) {
            var b = a;
            var c = b - this._v();
            var d = this._s != b;
            var e = this._x != c;
            if (false == e && false == d) {
                return;
            }
            this._s = b;
            this._x = c;
            this._ak("Column");
            if (d) {
                this._ak("AbsoluteColumnIndex");
            }
            if (e) {
                this._ak("RelativeColumnIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_q", {
        get: function () {
            if (null == this._b) {
                this._b = new ObservableCollectionExtended$1(ComboBoxListItem.$, 0);
                this._am();
            }
            return this._b;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_aa", {
        get: function () {
            return this._z;
        },
        set: function (a) {
            this._z = a;
            this._ak("ColorValue");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_w", {
        get: function () {
            return this._k._ar.indexOf(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_m", {
        get: function () {
            return this._k._ae(this);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_y", {
        get: function () {
            return this._x;
        },
        set: function (a) {
            this._al(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_e", {
        get: function () {
            return this._d;
        },
        set: function (a) {
            if (a == this._d) {
                return;
            }
            this._d = a;
            this._ak("SortDirection");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_g", {
        get: function () {
            return this._f;
        },
        set: function (a) {
            if (a == 4) {
                a = 0;
            }
            this._f = a;
            this._ak("SortConditionType");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_h", {
        get: function () {
            switch (this._f) {
                case 0:
                    switch (this._e) {
                        case 0:
                        case 1: break;
                        case 2:
                        case 3: return 4;
                    }
                    break;
            }
            return this._f;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortConditionWrapper.prototype, "_r", {
        get: function () {
            if (null == this._c) {
                this._c = new ObservableCollectionExtended$1(ComboBoxListItem.$, 0);
                this._k._cd(this);
            }
            return this._c;
        },
        enumerable: true,
        configurable: true
    });
    SortConditionWrapper.$t = markType(SortConditionWrapper, 'SortConditionWrapper', Base.$, [INotifyPropertyChanged_$type]);
    SortConditionWrapper._o = null;
    SortConditionWrapper._ai = KeyValuePair$2.$.specialize(RelativeIndex.$, SortCondition.$);
    SortConditionWrapper._ah = KeyValuePair$2.$.specialize(WorksheetTableColumn.$, SortCondition.$);
    return SortConditionWrapper;
}(Base));
export { SortConditionWrapper };
/**
 * @hidden
 */
var SortDialogViewModel = /** @class */ (function (_super) {
    tslib_1.__extends(SortDialogViewModel, _super);
    function SortDialogViewModel(a, b, c) {
        var _this = _super.call(this) || this;
        _this._d = null;
        _this._n = new WorksheetRegionAddress();
        _this._ad = false;
        _this._c = 0;
        _this._q = null;
        _this._i = null;
        _this._aq = null;
        _this._aw = Nullable$1.toNullable(Number_$type, null);
        _this._ai = true;
        _this._ag = false;
        _this._j = new WorksheetRegionAddress();
        _this._l = new WorksheetRegionAddress();
        _this._al = true;
        _this._aa = false;
        _this._o = 0;
        _this._s = false;
        _this._a2 = null;
        _this._a = null;
        _this._am = null;
        _this._ao = null;
        _this._r = null;
        _this._activeRowIndexChanged = null;
        _this.propertyChanged = null;
        if (b == null) {
            throw new ArgumentNullException(0, "sortTarget");
        }
        _this._d = a;
        _this._c = b.a;
        _this._r = c;
        switch (_this._c) {
            case 0:
            case 1:
            case 2:
                _this._n = b.d;
                _this._ad = b.f;
                _this._q = null;
                _this._i = b.b;
                break;
            case 3:
                _this._q = b.e;
                _this._n = b.d;
                _this._i = _this._q.worksheet;
                break;
        }
        _this._bt();
        return _this;
    }
    SortDialogViewModel._v = function (a, b) {
        var c = a == null;
        var d = b == null;
        if (c && d) {
            return true;
        }
        if (c != d) {
            return false;
        }
        return Base.equalsStatic(a, b);
    };
    SortDialogViewModel.prototype._h = function (a) {
        var b = typeCast(ArgumentException.$, a);
        if (null != b) {
            var c = this._e._fs("SortDialog_SortConditionError_DuplicateItemSorted");
            return new SortDialogViewModel_ApplySortErrorInfo(0, c);
        }
        return new SortDialogViewModel_ApplySortErrorInfo(0, a.message);
    };
    SortDialogViewModel.prototype._br = function (a) {
        var e_2, _0;
        if (null != this._aq) {
            var b = this._aq;
            b.collectionChanged = delegateRemove(b.collectionChanged, runOn(this, this._b4));
        }
        this._aq = new ObservableCollection$1(SortConditionWrapper.$, 0);
        var c = this._aq;
        c.collectionChanged = delegateCombine(c.collectionChanged, runOn(this, this._b4));
        if (null != a) {
            try {
                for (var _1 = tslib_1.__values(fromEn(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    var e = this._at();
                    var f = new SortConditionWrapper(this, d, e);
                    if (this._af(f)) {
                        this._aq.add(f);
                    }
                }
            }
            catch (e_2_1) { e_2 = { error: e_2_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_2) throw e_2.error; }
            }
        }
        if (this._aq.count == 0) {
            this._f();
        }
        this._ax = Nullable$1.toNullable(Number_$type, 0);
    };
    SortDialogViewModel.prototype._bs = function () {
        var a;
        if (null == this._ao) {
            this._ao = new ObservableCollection$1(ComboBoxListItem.$, 0);
        }
        var b = EnumUtil.getValues(SpreadsheetSortDialogConditionType_$type);
        var c = "SpreadsheetSortDialogConditionTypes_{0}_DisplayText";
        for (var e = 0; e < b.length; e++) {
            var d = b[e];
            if (d == 4) {
                continue;
            }
            var f = stringFormat(c, EnumUtil.getName(SpreadsheetSortDialogConditionType_$type, d));
            var g = this._d._fs(f);
            a = new ComboBoxListItem(enumGetBox(SpreadsheetSortDialogConditionType_$type, d), g);
            this._ao.add(a);
        }
    };
    SortDialogViewModel.prototype._at = function () {
        switch (this._c) {
            case 0: break;
            case 1:
                var a = this._au();
                var b = this._av(this._i.sortSettings.region._h);
                var c = b - a;
                return c;
            case 3: break;
        }
        return 0;
    };
    SortDialogViewModel.prototype._bt = function () {
        switch (this._c) {
            case 1:
                {
                    var a = this._i.sortSettings;
                    this._o = a.sortType;
                    this._s = true;
                    this._ag = this._o == 0 ? this._ad : false;
                    this._aa = a.caseSensitive;
                    this._br(a._sortConditions$i);
                }
                break;
            case 0:
                {
                    this._o = 0;
                    this._s = true;
                    this._ag = this._o == 0 ? this._ad : false;
                    this._aa = false;
                    this._br(null);
                }
                break;
            case 2:
                {
                    var b = this._i.filterSettings.sortSettings;
                    this._o = 0;
                    this._s = false;
                    this._ag = true;
                    this._aa = b.caseSensitive;
                    this._br(b._sortConditions$i);
                }
                break;
            case 3:
                {
                    var c = this._q.sortSettings;
                    this._o = 0;
                    this._s = false;
                    this._n = this._q._bs._h;
                    this._ag = true;
                    this._aa = c.caseSensitive;
                    this._br(c._sortConditions$i);
                }
                break;
            default: return;
        }
        this._ca();
        this._cc();
    };
    SortDialogViewModel.prototype._bw = function (a, b) {
        this._b1(a, b);
    };
    SortDialogViewModel.prototype._g = function () {
        var a = this._ax;
        if (a.hasValue) {
            return this._ar._inner[a.value];
        }
        return null;
    };
    SortDialogViewModel.prototype._a6 = function (a) {
        if (a.isAutomatic) {
            return SpreadsheetUtilities.di(this._d, "SortDialog_Text_Automatic");
        }
        var b = a._getResolvedColor1(this._d.workbook);
        return this._a7(b);
    };
    SortDialogViewModel.prototype._a7 = function (a) {
        return SpreadsheetUtilities.di(this._d, "SortDialog_Color_RGB", a.o, a.n, a.m);
    };
    SortDialogViewModel.prototype._au = function () {
        var a = this._k._n ? this._k : this._m;
        return this._av(a);
    };
    SortDialogViewModel.prototype._av = function (a) {
        switch (this._o) {
            case 1: return a._ac;
            case 0: return a._w;
            default: return a._w;
        }
    };
    SortDialogViewModel.prototype._a8 = function (a) {
        var _0;
        var b = [];
        for (var _1 = 1; _1 < arguments.length; _1++) {
            b[_1 - 1] = arguments[_1];
        }
        var c = (_0 = this._d)._fs.apply(_0, tslib_1.__spread([a], b));
        c = SpreadsheetUtilities.c2(c);
        return c;
    };
    SortDialogViewModel.prototype._ay = function (a, b, c) {
        switch (c) {
            case 0:
            case 4: throw new ArgumentOutOfRangeException(0);
            case 1:
                {
                    var d = this._i._rows$i._aj(a);
                    var e = this._i._getCellConditionalFormat1(a, b);
                    if (e != null && e.cellFormat != null && e.cellFormat.fill != null) {
                        return e.cellFormat.fill;
                    }
                    else {
                        var f = this._i._b4(d, b);
                        var g = f._ar;
                        if (null == g) {
                            return CellFill.noColor;
                        }
                        var h = typeCast(CellFillPattern.$, g);
                        if (null != h && 0 == h.patternStyle) {
                            return CellFill.noColor;
                        }
                        return g;
                    }
                }
            case 2:
                {
                    var i = this._i._rows$i._aj(a);
                    var j = this._i._getCellConditionalFormat1(a, b);
                    if (j != null && j.cellFormat != null && j.cellFormat.font != null && WorkbookColorInfo.l_op_Inequality(j.cellFormat.font.colorInfo, null)) {
                        return j.cellFormat.font.colorInfo;
                    }
                    else {
                        var k = this._i._b4(i, b);
                        var l = k._bh;
                        var m = this._i.workbook;
                        var n = WorkbookColorInfo.automatic._getResolvedColor1(m);
                        var o = l._getResolvedColor1(m);
                        if (Color.b(n, o) || Color.c(Nullable$1.toNullable(Color.$, null), Nullable$1.toNullable(Color.$, o))) {
                            return WorkbookColorInfo.automatic;
                        }
                        else {
                            return l;
                        }
                    }
                }
            case 3:
                {
                    var p = this._i._getCellConditionalFormat1(a, b);
                    if (p != null) {
                        var q = p.iconInfo;
                        if (null != q) {
                            var r = Nullable$1.toNullable(Number_$type, q.iconIndex);
                            var s = q.iconSet;
                            if (r.hasValue && r.value < 0) {
                                return SpreadsheetUtilities.d1;
                            }
                            var t = Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), s, r);
                            return t;
                        }
                    }
                    return SpreadsheetUtilities.d1;
                }
            default: return null;
        }
    };
    SortDialogViewModel.prototype._az = function (a) {
        switch (a) {
            case 0:
            case 4: throw new ArgumentOutOfRangeException(0);
            case 1:
                {
                    return CellFill.noColor;
                }
            case 2:
                {
                    return WorkbookColorInfo.automatic;
                }
            case 3:
                {
                    return SpreadsheetUtilities.d1;
                }
            default: return null;
        }
    };
    SortDialogViewModel.prototype._a9 = function (a) {
        if (null == a) {
            return stringEmpty();
        }
        var b = this._d.workbook;
        var c = null;
        var d = typeCast(CellFill.$, a);
        if (null != d) {
            if (d == CellFill.noColor) {
                return SpreadsheetUtilities.di(this._d, "SortDialog_CellFill_NoColor");
            }
            if (typeCast(CellFillRectangularGradient.$, d) !== null || typeCast(CellFillLinearGradient.$, d) !== null) {
                return SpreadsheetUtilities.di(this._d, "SortDialog_CellFill_Gradient");
            }
            var e = typeCast(CellFillPattern.$, d);
            if (null != e) {
                c = e.backgroundColorInfo;
            }
        }
        if (WorkbookColorInfo.l_op_Equality(null, c)) {
            c = typeCast(WorkbookColorInfo.$, a);
        }
        if (WorkbookColorInfo.l_op_Inequality(null, c)) {
            return this._a6(c);
        }
        var f = typeCast(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), a);
        if (null != f) {
            var g = f.d;
            if (g.hasValue) {
                return " ";
            }
            else {
                return this._d._fs("SortDialog_ConditionalFormatIcon_NoCellIcon");
            }
        }
        return stringEmpty();
    };
    SortDialogViewModel.prototype._ae = function (a) {
        var b = this._ax;
        if (false == b.hasValue) {
            return false;
        }
        var c = a._w;
        if (c < 0 || c >= this._ar.count) {
            return false;
        }
        return c == b.value;
    };
    SortDialogViewModel.prototype._af = function (a) {
        switch (this._c) {
            case 0: break;
            case 1:
                var b = a._t;
                switch (this._p) {
                    case 1:
                        if (b < this._n._ac || b > this._n._ae) {
                            return false;
                        }
                        break;
                    case 0:
                        if (b < this._n._w || b > this._n._x) {
                            return false;
                        }
                        break;
                }
                break;
            case 3: break;
        }
        return true;
    };
    Object.defineProperty(SortDialogViewModel.prototype, "_ac", {
        get: function () {
            return this._ax.hasValue;
        },
        enumerable: true,
        configurable: true
    });
    SortDialogViewModel.prototype._bx = function (a, b) {
        this._ar.insert(a, b);
    };
    SortDialogViewModel.prototype._by = function (a) {
        var b = a ? this._z : this._y;
        var c = a ? -1 : 1;
        if (b) {
            var d = this._ax.value;
            var e = d + c;
            var f = this._g();
            this._ar.remove(f);
            this._ar.insert(e, f);
            this._ax = Nullable$1.toNullable(Number_$type, e);
        }
        else {
            var g = a ? "CanMoveUp" : "CanMoveDown";
        }
    };
    SortDialogViewModel.prototype._b3 = function (a, b) {
        var c = this._ax;
        this._ax = a;
        if (b && nullableEquals(c, a)) {
            this._bw(c, this._ax);
        }
    };
    SortDialogViewModel.prototype._b5 = function (a, b, c, d) {
        var e;
        if (d < c.count) {
            e = c.item(d);
            e.dataValue = a;
            e.displayText = b;
        }
        else {
            e = new ComboBoxListItem(a, b);
            c.add(e);
        }
    };
    SortDialogViewModel.prototype._b6 = function () {
        var e_3, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._ar)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var a = _2.value;
                a._am();
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_3) throw e_3.error; }
        }
    };
    SortDialogViewModel.prototype._b7 = function () {
        var e_4, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._ar)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var a = _2.value;
                this._cd(a);
            }
        }
        catch (e_4_1) { e_4 = { error: e_4_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_4) throw e_4.error; }
        }
    };
    SortDialogViewModel.prototype._b9 = function (a) {
        var e_5, _0;
        var b = a._h;
        switch (b) {
            case 4:
            case 0: return;
        }
        var c = a._t;
        var d;
        var e = a._q;
        e.clear();
        var f = new HashSet$1(Base.$, 0);
        switch (this._o) {
            case 1:
                {
                    var g = c;
                    var h = this._k._w;
                    var i = this._k._x;
                    for (var j = h; j <= i; j++) {
                        var k = this._ay(g, j, b);
                        if (false == f.contains(k)) {
                            f.add_1(k);
                            var l = this._a9(k);
                            d = new ComboBoxListItem(k, l);
                            e.add(d);
                        }
                    }
                }
                break;
            case 0:
                {
                    if (this._k._n) {
                        var m = c;
                        var n = this._k._ac;
                        var o = this._k._ae;
                        var p = (o - n) + 1;
                        for (var q = n; q <= o; q++) {
                            var r = this._ay(q, m, b);
                            if (false == f.contains(r)) {
                                f.add_1(r);
                                var s = this._a9(r);
                                d = new ComboBoxListItem(r, s);
                                if (typeCast(WorkbookColorInfo.$, d.dataValue) !== null && d.dataValue.isAutomatic) {
                                    e.insert(0, d);
                                }
                                else {
                                    e.add(d);
                                }
                            }
                        }
                    }
                    else {
                        var t = this._az(b);
                        f.add_1(t);
                        var u = this._a9(t);
                        d = new ComboBoxListItem(t, u);
                        e.add(d);
                    }
                }
                break;
            default: break;
        }
        var v = false;
        try {
            for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var w = _2.value;
                if (SortDialogViewModel._v(a._aa, w.dataValue)) {
                    v = true;
                    break;
                }
            }
        }
        catch (e_5_1) { e_5 = { error: e_5_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_5) throw e_5.error; }
        }
        if (false == v) {
            a._aa = null;
        }
    };
    SortDialogViewModel.prototype._b8 = function () {
        var a;
        if (null == this._am) {
            this._am = new ObservableCollection$1(ComboBoxListItem.$, 0);
        }
        var b;
        switch (this._p) {
            case 1:
                b = "SortDialog_SortDirectionLeftOrRight_{0}";
                break;
            case 0:
                b = "SortDialog_SortDirectionTopOrBottom_{0}";
                break;
            default:
                b = "SortDialog_SortDirectionTopOrBottom_{0}";
                break;
        }
        var c = 0;
        var d = enumGetBox(SortDirectionWithCustomListOptions_$type, c);
        var e = stringFormat(b, d.toString());
        var f = this._d._fs(e);
        if (this._am.count >= 1) {
            a = this._am._inner[0];
            a.displayText = f;
        }
        else {
            a = new ComboBoxListItem(d, f);
            this._am.add(a);
        }
        c = 1;
        d = enumGetBox(SortDirectionWithCustomListOptions_$type, c);
        e = stringFormat(b, d.toString());
        f = this._d._fs(e);
        if (this._am.count >= 2) {
            a = this._am._inner[1];
            a.displayText = f;
        }
        else {
            a = new ComboBoxListItem(d, f);
            this._am.add(a);
        }
    };
    SortDialogViewModel.prototype._ca = function () {
        var a;
        switch (this._p) {
            case 1:
                a = "SortDialog_Row_ColumnHeader";
                break;
            case 0:
                a = "SortDialog_Column_ColumnHeader";
                break;
            default:
                a = "SortDialog_Column_ColumnHeader";
                break;
        }
        this._a3 = this._a8(a);
    };
    SortDialogViewModel.prototype._cb = function (a) {
        var e_6, _0;
        var b;
        if (null == this._a) {
            this._a = new ObservableCollectionExtended$1(ComboBoxListItem.$, 0);
        }
        else {
            if (false == a) {
                this._a.clear();
                try {
                    for (var _1 = tslib_1.__values(fromEnum(this._ar)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var c = _2.value;
                        c._al(0, true);
                    }
                }
                catch (e_6_1) { e_6 = { error: e_6_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_6) throw e_6.error; }
                }
            }
        }
        switch (this._o) {
            case 1:
                {
                    var d = this._k;
                    var e = d._w;
                    var f = d._ac;
                    var g = d._ae;
                    var h = (g - f) + 1;
                    for (var i = f; i <= g; i++) {
                        var j = CellAddress.x(i, false, this._i.workbook.currentFormat, 1, false, this._i.workbook.cellReferenceMode);
                        j = stringReplace(j, "$", stringEmpty());
                        var k = this._d._fs("SortDialog_RowName", j);
                        b = new ComboBoxListItem(i, k);
                        this._a.add(b);
                    }
                }
                break;
            case 0:
                {
                    var l = this._ak ? this._m : this._k;
                    var m = l._ac;
                    var n = l._w;
                    var o = l._x;
                    var p = (o - n) + 1;
                    var q = this._i._rows$i._aj(m);
                    for (var r = n; r <= o; r++) {
                        var s = void 0;
                        if (this._ak && null != q) {
                            s = SpreadsheetUtilities.dg(q, r);
                        }
                        else {
                            var t = CellAddress.w(r, false, 16384, -1, false, this._i.workbook.cellReferenceMode);
                            t = stringReplace(t, "$", stringEmpty());
                            s = this._d._fs("SortDialog_ColumnName", t);
                        }
                        var u = r - n;
                        if (u < this._a.count) {
                            b = this._a._inner[u];
                            b.dataValue = r;
                            b.displayText = s;
                        }
                        else {
                            b = new ComboBoxListItem(r, s);
                            this._a.add(b);
                        }
                    }
                }
                break;
            default: break;
        }
    };
    SortDialogViewModel.prototype._cc = function () {
        switch (this._c) {
            case 1:
            case 0:
                {
                    var t1 = this._p;
                    L0: while (true) {
                        switch (t1) {
                            case 1:
                                this._aj = false;
                                break;
                            case 0:
                                this._aj = true;
                                break;
                            default:
                                t1 = 0;
                                continue L0;
                        }
                        break;
                    }
                }
                break;
            case 2:
            case 3:
                this._aj = false;
                break;
            default: return;
        }
    };
    SortDialogViewModel.prototype._cd = function (a) {
        var b;
        var c;
        var d;
        var e = a._r;
        var f = this._p == 0;
        var g = SpreadsheetUtilities.l(this._i, this._j, a._y, f);
        var h;
        var t1 = g;
        L0: while (true) {
            switch (t1) {
                case 1:
                case 3:
                case 2:
                    h = stringFormat("SortDialog_SortDirection_{0}_{1}", EnumUtil.getName(CellContentType_$type, g), "{0}");
                    break;
                case 0:
                default:
                    t1 = 1;
                    continue L0;
            }
            break;
        }
        b = 0;
        c = enumGetBox(SortDirectionWithCustomListOptions_$type, b);
        var i = stringFormat(h, c.toString());
        d = this._d._fs(i);
        this._b5(c, d, e, 0);
        b = 1;
        c = enumGetBox(SortDirectionWithCustomListOptions_$type, b);
        i = stringFormat(h, c.toString());
        d = this._d._fs(i);
        this._b5(c, d, e, 1);
        if (4 == a._h) {
            c = enumGetBox(SortDirectionWithCustomListOptions_$type, 2);
            d = a._ad(true);
            this._b5(c, d, e, 2);
            c = enumGetBox(SortDirectionWithCustomListOptions_$type, 3);
            d = a._ad(false);
            this._b5(c, d, e, 3);
        }
        else {
            while (e.count > 2) {
                e.removeAt(2);
            }
        }
    };
    SortDialogViewModel.prototype._ce = function () {
        if (false == this._al) {
            return;
        }
        var a = this._n;
        switch (this._c) {
            case 1:
            case 0:
                {
                    var b = a._ac;
                    if (this._ad) {
                        if (a._ac != 0) {
                            b--;
                        }
                        else {
                        }
                    }
                    this._l = new WorksheetRegionAddress(1, b, b, a._w, a._x);
                    switch (this._p) {
                        case 0:
                            var c = void 0;
                            if (this._ad) {
                                c = this._ag ? a._ac : b;
                            }
                            else {
                                c = this._ag ? a._ac + 1 : a._ac;
                            }
                            this._j = new WorksheetRegionAddress(1, c, a._ae, a._w, a._x);
                            break;
                        case 1:
                            this._j = new WorksheetRegionAddress(1, b, a._ae, a._w, a._x);
                            break;
                    }
                }
                break;
            case 2:
                {
                    var d = this._i.filterSettings;
                    var e = d.sortAndFilterAreaRegion;
                    this._j = e != null ? e._h : WorksheetRegionAddress._b;
                    var f = d.region._h;
                    this._l = new WorksheetRegionAddress(1, f._ac, f._ac, f._w, f._x);
                }
                break;
            case 3:
                {
                    this._j = this._q.dataAreaRegion._h;
                    this._l = this._q.headerRowRegion._h;
                }
                break;
            default: break;
        }
        if (this._r != null) {
            this._r(this._j);
        }
        this._al = false;
    };
    SortDialogViewModel.prototype._f = function () {
        var a = new SortConditionWrapper(this, null, 0);
        this._ar.add(a);
        this._ax = Nullable$1.toNullable(Number_$type, this._ar.count - 1);
        return a;
    };
    SortDialogViewModel.prototype._u = function (a) {
        var e_7, _0, e_8, _1, e_9, _2;
        var b = this._ar;
        var c;
        switch (this._c) {
            case 2:
                {
                    var d = this._i.filterSettings.sortSettings;
                    d.caseSensitive = this._ab;
                    var e = new List$1(KeyValuePair$2.$.specialize(RelativeIndex.$, SortCondition.$), 0);
                    var _loop_1 = function (f) {
                        var g = new RelativeIndex(f._y);
                        if (false == ((function () { var h = f._n(c, a); c = h.p0; a = h.p1; return h.ret; })())) {
                            return { value: {
                                    ret: false,
                                    p0: a
                                } };
                        }
                        e.add(new KeyValuePair$2(RelativeIndex.$, SortCondition.$, 1, g, c));
                    };
                    try {
                        for (var _3 = tslib_1.__values(fromEnum(b)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                            var f = _4.value;
                            var state_1 = _loop_1(f);
                            if (typeof state_1 === "object")
                                return state_1.value;
                        }
                    }
                    catch (e_7_1) { e_7 = { error: e_7_1 }; }
                    finally {
                        try {
                            if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                        }
                        finally { if (e_7) throw e_7.error; }
                    }
                    if (e.count > 0) {
                        try {
                            d._sortConditions$i.clear();
                            d._sortConditions$i.addRange(e);
                        }
                        catch (h) {
                            a = this._h(h);
                            return {
                                ret: false,
                                p0: a
                            };
                        }
                    }
                    a = null;
                    return {
                        ret: true,
                        p0: a
                    };
                }
            case 0:
            case 1:
                {
                    var i = this._i.sortSettings;
                    i.caseSensitive = this._ab;
                    i.sortType = this._p;
                    i._setRegion(this._k.toString());
                    var j = new List$1(KeyValuePair$2.$.specialize(RelativeIndex.$, SortCondition.$), 0);
                    var _loop_2 = function (k) {
                        var l = new RelativeIndex(k._y);
                        if (false == ((function () { var m = k._n(c, a); c = m.p0; a = m.p1; return m.ret; })())) {
                            return { value: {
                                    ret: false,
                                    p0: a
                                } };
                        }
                        j.add(new KeyValuePair$2(RelativeIndex.$, SortCondition.$, 1, l, c));
                    };
                    try {
                        for (var _5 = tslib_1.__values(fromEnum(b)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var k = _6.value;
                            var state_2 = _loop_2(k);
                            if (typeof state_2 === "object")
                                return state_2.value;
                        }
                    }
                    catch (e_8_1) { e_8 = { error: e_8_1 }; }
                    finally {
                        try {
                            if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                        }
                        finally { if (e_8) throw e_8.error; }
                    }
                    if (j.count > 0) {
                        try {
                            if (i._sortConditions$i != null) {
                                i._sortConditions$i.clear();
                            }
                            i._sortConditions$i.addRange(j);
                        }
                        catch (m) {
                            a = this._h(m);
                            return {
                                ret: false,
                                p0: a
                            };
                        }
                    }
                    a = null;
                    return {
                        ret: true,
                        p0: a
                    };
                }
            case 3:
                {
                    var n = this._q.sortSettings;
                    n.caseSensitive = this._ab;
                    var o = new List$1(KeyValuePair$2.$.specialize(WorksheetTableColumn.$, SortCondition.$), 0);
                    var _loop_3 = function (p) {
                        var q = this_1._q._columns$i._item(p._y);
                        if (false == ((function () { var r = p._n(c, a); c = r.p0; a = r.p1; return r.ret; })())) {
                            return { value: {
                                    ret: false,
                                    p0: a
                                } };
                        }
                        o.add(new KeyValuePair$2(WorksheetTableColumn.$, SortCondition.$, 1, q, c));
                    };
                    var this_1 = this;
                    try {
                        for (var _7 = tslib_1.__values(fromEnum(b)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                            var p = _8.value;
                            var state_3 = _loop_3(p);
                            if (typeof state_3 === "object")
                                return state_3.value;
                        }
                    }
                    catch (e_9_1) { e_9 = { error: e_9_1 }; }
                    finally {
                        try {
                            if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                        }
                        finally { if (e_9) throw e_9.error; }
                    }
                    if (o.count > 0) {
                        try {
                            n._sortConditions$i.clear();
                            n._sortConditions$i.addRange(o);
                        }
                        catch (r) {
                            a = this._h(r);
                            return {
                                ret: false,
                                p0: a
                            };
                        }
                    }
                    a = null;
                    return {
                        ret: true,
                        p0: a
                    };
                }
            default:
                a = null;
                return {
                    ret: false,
                    p0: a
                };
        }
    };
    SortDialogViewModel.prototype._bu = function () {
        var a = this._g();
        if (null != a) {
            var b = this._ar._inner[this._aw.value];
            if (null != b) {
                var c = b._j();
                var d = this._ax.value + 1;
                this._bx(d, c);
                this._b3(Nullable$1.toNullable(Number_$type, d), true);
            }
        }
        else {
        }
    };
    SortDialogViewModel.prototype._bv = function () {
        if (this._ac) {
            var a = this._ar;
            var b = this._ax.value;
            var c = Nullable$1.toNullable(Number_$type, b);
            a.removeAt(b);
            if (this._aq.count == 0) {
                c = Nullable$1.toNullable(Number_$type, null);
            }
            else if (nullableEquals(this._aq.count, c)) {
                c.postDecrement();
            }
            this._b3(c, true);
        }
        else {
        }
    };
    SortDialogViewModel.prototype._bz = function () {
        this._by(false);
    };
    SortDialogViewModel.prototype._b0 = function () {
        this._by(true);
    };
    Object.defineProperty(SortDialogViewModel.prototype, "_ak", {
        get: function () {
            switch (this._c) {
                case 1:
                case 0:
                    {
                        var t1 = this._p;
                        L0: while (true) {
                            switch (t1) {
                                case 1: return false;
                                case 0: return this._ah;
                                default:
                                    t1 = 0;
                                    continue L0;
                            }
                            break;
                        }
                    }
                case 2:
                case 3: return this._ah;
                default: return this._ah;
            }
        },
        enumerable: true,
        configurable: true
    });
    SortDialogViewModel.prototype._b1 = function (a, b) {
        if (null != this._activeRowIndexChanged) {
            var c = new ActiveRowIndexChangedEventArgs(a, b);
            this._activeRowIndexChanged(this, c);
        }
        this._b2("ActiveRowIndex");
    };
    SortDialogViewModel.prototype._b2 = function (a) {
        switch (a) {
            case "SortOrientation":
                this._al = true;
                this._cb(false);
                this._ca();
                this._b8();
                this._cc();
                this._b7();
                this._b6();
                break;
            case "MyDataHasHeaders":
                this._cb(true);
                break;
        }
        var b = this.propertyChanged;
        if (null != b) {
            b(this, new PropertyChangedEventArgs(a));
        }
    };
    Object.defineProperty(SortDialogViewModel.prototype, "_k", {
        get: function () {
            this._ce();
            return this._j;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_m", {
        get: function () {
            this._ce();
            return this._l;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_e", {
        get: function () {
            return this._d;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ax", {
        get: function () {
            return this._aw;
        },
        set: function (a) {
            var b = this._aw;
            var c = a;
            if (nullableEquals(b, c)) {
                return;
            }
            this._aw = a;
            this._bw(b, c);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_a0", {
        get: function () {
            return this._a8("SortDialog_AddLevel");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_t", {
        get: function () {
            return this._s;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_a1", {
        get: function () {
            return this._a8("SortDialog_Cancel");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_w", {
        get: function () {
            return this._ac;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_x", {
        get: function () {
            return this._ac;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_y", {
        get: function () {
            if (false == this._ac) {
                return false;
            }
            return this._ax.value < (this._ar.count - 1);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_z", {
        get: function () {
            if (false == this._ac) {
                return false;
            }
            return this._ax.value > 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ab", {
        get: function () {
            return this._aa;
        },
        set: function (a) {
            if (a == this._aa) {
                return;
            }
            this._aa = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_a3", {
        get: function () {
            return this._a2;
        },
        set: function (a) {
            if (stringCompare1(this._a2, a, 0) == 0) {
                return;
            }
            this._a2 = a;
            this._b2("ColumnColumnHeaderText");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_an", {
        get: function () {
            if (null == this._am) {
                this._b8();
            }
            return this._am;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_a4", {
        get: function () {
            return this._a8("SortDialog_CopyLevel");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_a5", {
        get: function () {
            return this._a8("SortDialog_DeleteLevel");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_b", {
        get: function () {
            if (null == this._a) {
                this._cb(false);
            }
            return this._a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ba", {
        get: function () {
            return this._a8("SortDialog_MoveDown");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bb", {
        get: function () {
            return this._a8("SortDialog_MoveUp");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ah", {
        get: function () {
            return this._ag;
        },
        set: function (a) {
            this._ag = a;
            this._al = true;
            this._b2("MyDataHasHeaders");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_aj", {
        get: function () {
            return this._ai;
        },
        set: function (a) {
            if (a == this._ai) {
                return;
            }
            this._ai = a;
            this._b2("MyDataHasHeadersEnabled");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bc", {
        get: function () {
            return this._a8("SortDialog_MyDataHasHeaders");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bd", {
        get: function () {
            return this._a8("SortDialog_OK");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_be", {
        get: function () {
            return this._a8("SortDialog_Options");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bf", {
        get: function () {
            return this._a8("SortDialog_Order_ColumnHeader");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bg", {
        get: function () {
            return this._a8("SortDialog_SortBy_Label");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ap", {
        get: function () {
            if (null == this._ao) {
                this._bs();
            }
            return this._ao;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_ar", {
        get: function () {
            return this._aq;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bh", {
        get: function () {
            return this._a8("SortDialog_Title");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bi", {
        get: function () {
            return this._a8("SortDialog_SortOn_ColumnHeader");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bk", {
        get: function () {
            return this._a8("SortOptionsDialog_CaseSensitive");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bj", {
        get: function () {
            return this._a8("SortOptionsDialog_Cancel");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bn", {
        get: function () {
            return this._a8("SortOptionsDialog_SortLeftToRight");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bo", {
        get: function () {
            return this._a8("SortOptionsDialog_SortTopToBottom");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bp", {
        get: function () {
            return this._a8("SortOptionsDialog_Title");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bl", {
        get: function () {
            return this._a8("SortOptionsDialog_OK");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bm", {
        get: function () {
            return this._a8("SortOptionsDialog_Orientation");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_p", {
        get: function () {
            return this._o;
        },
        set: function (a) {
            if (a == this._o) {
                return;
            }
            this._o = a;
            this._b2("SortOrientation");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogViewModel.prototype, "_bq", {
        get: function () {
            return this._a8("SortDialog_ThenBy_Label");
        },
        enumerable: true,
        configurable: true
    });
    SortDialogViewModel.prototype._b4 = function (a, b) {
        var e_10, _0;
        switch (b.action) {
            case 1:
                if (b.oldStartingIndex == 0 && this._aq.count > 0) {
                    this._aq._inner[0]._an();
                }
                break;
            case 0:
                try {
                    for (var _1 = tslib_1.__values(fromEn(b.newItems)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var c = _2.value;
                        var d = c;
                        d._an();
                    }
                }
                catch (e_10_1) { e_10 = { error: e_10_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_10) throw e_10.error; }
                }
                if (b.newStartingIndex == 0 && this._aq.count > 1) {
                    this._aq._inner[1]._an();
                }
                break;
        }
    };
    SortDialogViewModel.$t = markType(SortDialogViewModel, 'SortDialogViewModel', Base.$, [INotifyPropertyChanged_$type]);
    return SortDialogViewModel;
}(Base));
export { SortDialogViewModel };
/**
 * @hidden
 */
var SortDialogViewModel_ApplySortErrorInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SortDialogViewModel_ApplySortErrorInfo, _super);
    function SortDialogViewModel_ApplySortErrorInfo(a) {
        var _rest = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            _rest[_0 - 1] = arguments[_0];
        }
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.d = null;
        _this.c = null;
        a = (a == void 0) ? 0 : a;
        switch (a) {
            case 0:
                {
                    var c = _rest[0];
                    _this.c = c;
                }
                break;
            case 1:
                {
                    var c = _rest[0];
                    var d = _rest[1];
                    var e = _rest[2];
                    _this.a = c;
                    _this.d = d;
                    _this.c = e;
                }
                break;
        }
        return _this;
    }
    Object.defineProperty(SortDialogViewModel_ApplySortErrorInfo.prototype, "b", {
        get: function () {
            return null != this.a ? this.a._w : -1;
        },
        enumerable: true,
        configurable: true
    });
    SortDialogViewModel_ApplySortErrorInfo.$t = markType(SortDialogViewModel_ApplySortErrorInfo, 'SortDialogViewModel_ApplySortErrorInfo');
    return SortDialogViewModel_ApplySortErrorInfo;
}(Base));
export { SortDialogViewModel_ApplySortErrorInfo };
/**
 * @hidden
 */
var CellDropDown = /** @class */ (function (_super) {
    tslib_1.__extends(CellDropDown, _super);
    function CellDropDown(a) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.a = null;
        _this.e = null;
        _this.b = a;
        return _this;
    }
    Object.defineProperty(CellDropDown.prototype, "c", {
        get: function () {
            return this.a != null && this.a.f;
        },
        enumerable: true,
        configurable: true
    });
    CellDropDown.prototype.f = function () {
        if (this.a != null) {
            var a = this.a;
            var b = this.e;
            this.a = null;
            this.e = null;
            a.ao();
            a.aq();
            b.remove();
            b.destroy();
        }
    };
    CellDropDown.prototype.d = function (a, b, c, d, e) {
        var _this = this;
        this.f();
        if (this.b._fa == null) {
            return false;
        }
        var f = this.b._n(a);
        if (f == null || c.count == 0) {
            return false;
        }
        var g = this.b._fa;
        var h = new List$1(DropDownItem.$, 0);
        for (var i = 0; i < c.count; i++) {
            var j = c._inner[i];
            var k = new DropDownItem();
            k.p = j;
            k.m = i;
            h.add(k);
        }
        var l = new DropDownPosition();
        l.a = 2 | 4;
        l.b = 1 | 4;
        l.c = RelativePositionInfo.d;
        l.d = RelativePositionInfo.d;
        l.e = RelativePositionInfo.e;
        l.f = RelativePositionInfo.d;
        var m = this.b._bh.a7.rootWrapper;
        b = b.copy();
        var n = f;
        while (n != this.b._bh) {
            b.x += n.ax;
            b.y += n.a2;
            n = n._parent;
        }
        this.e = g.createElement("div");
        this.e.setRawStyleProperty("position", "relative");
        this.e.setRawStyleProperty("width", "0px");
        this.e.setRawStyleProperty("height", "0px");
        if (m.getChildCount() == 0) {
            m.append(this.e);
        }
        else {
            m.getChildAt(0).before(this.e);
        }
        this.a = new DropDown(g, this.e, h, null, null, function (o, p) {
            o.addClass("comboboxitem");
            o.setText(p.p);
        });
        var o = this.a;
        o.itemClicked = delegateCombine(o.itemClicked, function (o, p) { return e(typeGetValue(p.m)); });
        var p = this.a;
        p.closed = delegateCombine(p.closed, function (p, q) {
            if (_this.b._v.hasKeyboardFocusWithin) {
                _this.b._v.focus();
            }
        });
        this.a.y = function (q, r, s, t) {
            t.preventDefault();
            t.stopPropagation();
            _this.a.l(r, s);
            return true;
        };
        this.a.ac.setRawStyleProperty("min-width", b.width + "px");
        this.a.ac.addClass("comboboxdropdown");
        this.a.ac.listen("blur", function (q) { return _this.f(); });
        this.a.ai = d;
        this.a.a0(b, l);
        this.a.ac.focus();
        return true;
    };
    CellDropDown.$t = markType(CellDropDown, 'CellDropDown');
    return CellDropDown;
}(Base));
export { CellDropDown };
/**
 * @hidden
 */
var SpreadsheetCellEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellEditManager, _super);
    function SpreadsheetCellEditManager(a) {
        var _this = _super.call(this) || this;
        _this.f = null;
        _this.a = null;
        _this.h = new SpreadsheetCell();
        _this.m = new SpreadsheetCellRange();
        _this.n = new SpreadsheetCellRange();
        _this.w = null;
        _this.u = null;
        _this.s = null;
        _this.j = null;
        _this.aj = 0;
        CoreUtilities.y(a);
        _this.f = a;
        return _this;
    }
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "i", {
        get: function () {
            return this.h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "x", {
        get: function () {
            return this.w;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "l", {
        get: function () {
            return this.j;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "o", {
        get: function () {
            return this.m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "p", {
        get: function () {
            return this.n;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "c", {
        get: function () {
            return this.a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "t", {
        get: function () {
            return this.s;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "v", {
        get: function () {
            return this.u;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellEditManager.prototype, "g", {
        get: function () {
            return this.f;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellEditManager.prototype.am = function () {
        var a = stringEmpty();
        var b = this.g._a8;
        if (b != null) {
            var c = null;
            var d = this.g._am._c;
            c = b._fk(d);
            if (c != null) {
                var e = b._bc;
                var f = e._rows$i.item(d.row);
                var g = e._b4(f, d.column);
                a = ((function (h) { return h != null ? h : stringEmpty(); })(SpreadsheetUtilities.df(c, e, g)));
            }
        }
        return a;
    };
    SpreadsheetCellEditManager.prototype.an = function (a) {
        if (this.f.isInEditMode) {
            this.f.cellEditMode = a ? 1 : 2;
        }
    };
    SpreadsheetCellEditManager.prototype.ax = function (a, b) {
        this.f.activeSelectionCellRangeFormat._u(b);
    };
    SpreadsheetCellEditManager.prototype.ay = function () {
        if (this.a != null && !this.f._dh) {
            this.a._m(false);
            this.f._dr = true;
            this.f._ge();
        }
    };
    SpreadsheetCellEditManager.prototype.y = function (a, b, c, d, e) {
        if (c === void 0) { c = null; }
        if (d === void 0) { d = false; }
        if (e === void 0) { e = false; }
        try {
            this.f._g9(true);
            return this.z(a, b, c, d, e);
        }
        finally {
            this.f._g9(false);
        }
    };
    SpreadsheetCellEditManager.prototype.z = function (a, b, c, d, e) {
        if (c === void 0) { c = null; }
        if (d === void 0) { d = false; }
        if (e === void 0) { e = false; }
        if (!this.ae(1, true)) {
            return false;
        }
        this.f._v.verifyLayout();
        if (this.f.isInEditMode) {
            return false;
        }
        if (this.f._bd != null && !this.f._cx(false)) {
            return false;
        }
        if (!this.ah) {
            return false;
        }
        var f = this.f._a8;
        if (f == null) {
            return false;
        }
        var g = f.getCellRange(a);
        var h = f._e1(g);
        if (SpreadsheetCell._l_op_Equality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            return false;
        }
        var i = f._ar(h.value);
        if (i == null) {
            return false;
        }
        if (!this.aa(i)) {
            return false;
        }
        this.f.selectionMode = 0;
        this.f.isInEndMode = false;
        f._b2(i, h.value, true);
        this.ap();
        if (this.g.isInEditMode) {
            return false;
        }
        if (f._bc.isProtected && f._bc.protection.selectionMode == 2) {
            return false;
        }
        var j = g._c;
        var k = new SpreadsheetEditModeEnteringEventArgs(j);
        this.f._h0(k);
        if (k.cancel) {
            return false;
        }
        if (this.f._a8._br(a) == false) {
            return false;
        }
        if (this.g.isInEditMode) {
            return false;
        }
        if (false == d && !this.f._v.focus()) {
            return false;
        }
        if (this.a == null) {
            this.a = this.b();
        }
        this.h = j;
        this.m = f.getCellRange(a);
        this.n = this.m;
        this.w = (f._a8(a) || CellFill._createSolidFill1(ExcelUtils.gw(255, 255, 255)))._c(f._bc.workbook);
        this.u = f;
        this.s = i;
        this.j = this.k(f, j);
        this.f.isInEditMode = true;
        if (this.j.a.r == false && this.j.b._a4 == 6 && this.n.lastColumn < this.j.a.x) {
            this.n = new SpreadsheetCellRange(this.n.firstRow, this.n.firstColumn, this.n.lastRow, this.j.a.x);
        }
        this.aj = NaN;
        i._al = true;
        this.an(b);
        this.ax(a, this.a);
        this.as(c, b, d, e);
        this.f._ge();
        this.f._hz(new SpreadsheetEditModeEnteredEventArgs(j));
        return true;
    };
    SpreadsheetCellEditManager.prototype.k = function (a, b) {
        return a._s(b);
    };
    SpreadsheetCellEditManager.prototype.ae = function (a, b, c, d) {
        if (c === void 0) { c = false; }
        if (d === void 0) { d = true; }
        try {
            this.f._g9(true);
            return this.af(a, b, c, d);
        }
        finally {
            this.f._g9(false);
        }
    };
    SpreadsheetCellEditManager.prototype.af = function (a, b, c, d) {
        if (c === void 0) { c = false; }
        if (d === void 0) { d = true; }
        if (!this.g.isInEditMode) {
            if (this.f._bd != null) {
                return this.f._cx(a == 0, b);
            }
            return true;
        }
        var e = this.h;
        var f = this.d();
        var g = f != null ? f.unformattedText : null;
        var h = a != 0;
        var i = new SpreadsheetEditModeExitingEventArgs(e, h, !b, g);
        this.f._h2(i);
        if (i.canCancel && i.cancel) {
            return false;
        }
        if (i.acceptChanges != h) {
            if (!i.acceptChanges) {
                a = 0;
            }
            else {
                a = 1;
            }
        }
        var j = this.q(a, b, d);
        if (!b && (j & 1) == 1) {
            if ((j & 2) == 2 && this.f.cellEditMode == 1) {
                this.f._cz(151, null, null);
            }
            return false;
        }
        this.f.isInEditMode = false;
        this.ax(e, null);
        this.f.cellEditMode = 0;
        this.f._ds = true;
        this.f._ge();
        this.f._h1(new SpreadsheetEditModeExitedEventArgs(e));
        if (c && (j & 4) == 4) {
            return false;
        }
        return true;
    };
    SpreadsheetCellEditManager.prototype.d = function () {
        if (!this.f.isInEditMode) {
            return null;
        }
        return this.e();
    };
    SpreadsheetCellEditManager.prototype.al = function () {
        if (this.f.isInEditMode == false) {
            return NaN;
        }
        if (isNaN_(this.aj)) {
            this.aj = this.ak();
        }
        return this.aj;
    };
    SpreadsheetCellEditManager.prototype.ar = function () {
        this.aj = NaN;
        this.f._ge();
    };
    SpreadsheetCellEditManager.prototype.au = function () {
        if (!this.g.isInEditMode) {
            if (false == this.y(this.g.activeCell, false, null, true)) {
                this.g._v.focus();
            }
        }
        else {
            this.an(false);
        }
    };
    SpreadsheetCellEditManager.prototype.aw = function () {
        if (this.a != null) {
            this.a._o();
        }
    };
    SpreadsheetCellEditManager.prototype.ai = function () {
        if (this.f.isInEditMode && this.u != null && this.u._bc._d6) {
            var a = this.u._bc._dataValidationRules$i._e(SpreadsheetUtilities.az(this.h.row, this.h.column));
            if (a != null && a._k != 0) {
                return true;
            }
        }
        return false;
    };
    SpreadsheetCellEditManager.prototype.q = function (a, b, c) {
        var _this = this;
        if (!this.f.isInEditMode) {
            return 0;
        }
        var d = 0;
        if (a != 0) {
            var e_11 = this.f;
            var f_1 = this.u._bc;
            var g_1 = this.h;
            var h = function (i, j, k, l) {
                var m = _this.ai();
                var n = 1;
                var o = function () {
                    n = j();
                    if (n == 2) {
                        var p = f_1._bi(g_1.row, g_1.column);
                        if (p != null) {
                            d |= 2;
                            var q = new SpreadsheetEditModeValidationErrorEventArgs(g_1, p, b);
                            q.action = p.showErrorMessageForInvalidValue ? 0 : 3;
                            e_11._h3(q);
                            switch (q.action) {
                                case 3: break;
                                case 2:
                                    n = 0;
                                    break;
                                case 1:
                                    n = 1;
                                    break;
                                case 0:
                                    n = _this.r(n, p);
                                    break;
                            }
                            if (n == 0) {
                                d |= 4;
                            }
                            if (n != 2) {
                                throw new EditModeDataValidationException();
                            }
                        }
                    }
                };
                e_11._gi(i, o, l, void 0, k, void 0, m);
                return n;
            };
            var i = new SpreadsheetEditHelper(this.u, this.s, this.h, this.f.isFixedDecimalEnabled, this.f.fixedDecimalPlaceCount, runOn(this.f, this.f._dz), h);
            var j = this.d();
            if (j != null) {
                var k = i.e(a, j, b == false, j.unformattedText, this.j.c);
                if (k == 1 && !b) {
                    return d |= 1;
                }
                if (k == 2 && f_1._fd.count > 0 && f_1._bi(g_1.row, g_1.column) == null) {
                    if (f_1._ei(g_1.row, g_1.column)) {
                        if (this.u != null) {
                            this.u._g0();
                        }
                    }
                }
            }
        }
        var l = this.s;
        this.w = null;
        this.j = null;
        this.s = null;
        this.u = null;
        l._al = false;
        this.at();
        if (c) {
            this.f._v.focus();
        }
        return d;
    };
    SpreadsheetCellEditManager.prototype.r = function (a, b) {
        var c = stringIsNullOrEmpty(b.errorMessageTitle) ? stringEmpty() : b.errorMessageTitle;
        var d = !stringIsNullOrEmpty(b.errorMessageDescription);
        var e = stringFormat(d ? "CustomValidation{0}Message" : "DefaultValidation{0}Message", EnumUtil.getName(DataValidationErrorStyle_$type, b.errorStyle));
        var f = d ? this.f._fs(e, b.errorMessageDescription) : this.f._fs(e);
        switch (b.errorStyle) {
            case 2:
                if (2 == this.f._v.showMessageBox(f, c, 1, 64, 1)) {
                    a = 0;
                }
                break;
            case 1:
                var g = this.f._v.showMessageBox(f, c, 3, 48, 7);
                if (g == 2) {
                    a = 0;
                }
                else if (g == 7) {
                    a = 1;
                }
                break;
            default:
            case 0:
                if (2 == this.f._v.showMessageBox(f, c, 1, 16, 1)) {
                    a = 0;
                }
                else {
                    a = 1;
                }
                break;
        }
        return a;
    };
    SpreadsheetCellEditManager.$t = markType(SpreadsheetCellEditManager, 'SpreadsheetCellEditManager');
    return SpreadsheetCellEditManager;
}(Base));
export { SpreadsheetCellEditManager };
/**
 * @hidden
 */
var JsCellEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(JsCellEditManager, _super);
    function JsCellEditManager(a) {
        return _super.call(this, a) || this;
    }
    JsCellEditManager.prototype.get_ac = function () {
        return true;
    };
    Object.defineProperty(JsCellEditManager.prototype, "ac", {
        get: function () {
            return this.get_ac();
        },
        enumerable: true,
        configurable: true
    });
    JsCellEditManager.prototype.get_ad = function () {
        return true;
    };
    Object.defineProperty(JsCellEditManager.prototype, "ad", {
        get: function () {
            return this.get_ad();
        },
        enumerable: true,
        configurable: true
    });
    JsCellEditManager.prototype.get_ah = function () {
        return !this.g.isDisabled;
    };
    Object.defineProperty(JsCellEditManager.prototype, "ah", {
        get: function () {
            return this.get_ah();
        },
        enumerable: true,
        configurable: true
    });
    JsCellEditManager.prototype.a0 = function (a, b) {
        a.cg = b.a.e;
        a.ck = b.a.f;
        a.dg = new Thickness(1, b.a.y, b.a.ac, b.a.z, b.a.v);
        a.ci = new WorkbookFontSnapshot(b.b);
        a.c6 = this.v._d8;
        a.dc = ExcelUtils.al(b.a.ar) ? b.b._bh._getResolvedColor1(this.g.workbook) : b.a.ar;
    };
    JsCellEditManager.prototype.as = function (a, b, c, d) {
        var e = this.g._ay;
        this.a0(e, this.l);
        if (!c) {
            this.g._v.focus();
        }
        if (a != null) {
            var f = this.g._m();
            if (a == e.c9) {
            }
            else if (f != null && f == e && f.a7 != null) {
                var g = (e.c9 != null ? e.c9 : "").length;
                SpreadsheetUtilities.bk(e.a7.rootWrapper.getNativeElement(), 0, g);
                this.g._bj.ai(a);
            }
            else {
                e.c9 = a;
            }
        }
        else if (false == d) {
            var h = true;
            var i = this.g._bh.dp.ci.cf;
            if (i.a7 != null && SpreadsheetUtilities.a5(i, document.activeElement)) {
                h = false;
            }
            if (e.a7 != null && h) {
                var j = (e.c9 != null ? e.c9 : "").length;
                SpreadsheetUtilities.bk(e.a7.rootWrapper.getNativeElement(), j, j);
            }
        }
    };
    JsCellEditManager.prototype.ap = function () {
    };
    JsCellEditManager.prototype.aa = function (a) {
        this.g._at.l(false);
        return this.g._bh != null;
    };
    JsCellEditManager.prototype.ak = function () {
        var a = this.g._ay;
        var b = a.c9;
        var c = this.v._d8;
        var d = a.dg.c + a.dg.d;
        var e = this.g._a0.i(b, a.ci, a.dg, c);
        e -= d;
        e /= c;
        e += d;
        return e;
    };
    JsCellEditManager.prototype.b = function () {
        return null;
    };
    JsCellEditManager.prototype.ab = function (a) {
        var b = SpreadsheetUtilities.dd(a);
        var c = this.g._ay;
        if (b != null && c != null) {
            try {
                if ((document.queryCommandSupported && !document.queryCommandSupported(b))) {
                    return false;
                }
                if (a == 150) {
                    return true;
                }
                if (((typeof document.queryCommandEnabled === "function"))) {
                    return (document.queryCommandEnabled(b));
                }
            }
            catch (d) {
            }
        }
        return true;
    };
    JsCellEditManager.prototype.at = function () {
        this.ao();
    };
    JsCellEditManager.prototype.e = function () {
        var a = stringEmpty();
        if (this.g._ay != null) {
            a = this.g._ay.c9;
        }
        return new SpreadsheetEditorValue(a, this.l.b);
    };
    JsCellEditManager.prototype.ag = function (a, b) {
        if (b === void 0) { b = true; }
        if (!this.g.isInEditMode) {
            return false;
        }
        var c = SpreadsheetUtilities.dd(a);
        if (c == null) {
            return false;
        }
        try {
            switch (a) {
                case 149:
                    this.g._ga();
                    break;
                case 148:
                    this.g._ga();
                    this.g._bj.ai(null);
                    break;
                case 150:
                    var d = ClipboardHelper.e();
                    if (d != null && d.getDataPresent(DataFormats.d)) {
                        this.g._bj.ai(d.getData(DataFormats.d));
                    }
                    break;
                default:
                    document.execCommand(c);
                    break;
            }
        }
        catch (e) {
        }
        return true;
    };
    JsCellEditManager.prototype.ao = function () {
        var a = this.g._ay;
        if (a != null) {
            var b = this.g._am._c;
            var c = this.g._a8;
            var d = c._s(b);
            if (this.g.isInEditMode && this.l != null) {
                this.a0(a, d);
            }
            else {
                a.c9 = SpreadsheetUtilities.df(c._fk(b), c._bc, d.b);
            }
            a.cv = true;
        }
    };
    JsCellEditManager.prototype.aq = function () {
    };
    JsCellEditManager.prototype.av = function (a, b) {
    };
    JsCellEditManager.prototype.az = function () {
        var a = this.g._bh;
        if (a == null) {
            return;
        }
        var b = a.dp.ci.cf;
        var c = this.g._ay;
        var d;
        if (this.g.isInEditMode && c != null) {
            if (this.g._m() == b) {
                d = b.co;
            }
            else {
                d = c.c9;
            }
        }
        else {
            d = this.am();
        }
        b.co = d;
    };
    JsCellEditManager.$t = markType(JsCellEditManager, 'JsCellEditManager', SpreadsheetCellEditManager.$);
    return JsCellEditManager;
}(SpreadsheetCellEditManager));
export { JsCellEditManager };
/**
 * @hidden
 */
var SpreadsheetMenuBuilder$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetMenuBuilder$1, _super);
    function SpreadsheetMenuBuilder$1($t, a) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this.c = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        _this.c = a;
        return _this;
    }
    SpreadsheetMenuBuilder$1.prototype.af = function (a) {
        return a;
    };
    SpreadsheetMenuBuilder$1.prototype.e = function (a, b) {
        return this.n(a);
    };
    SpreadsheetMenuBuilder$1.prototype.as = function (a, b) {
        var c;
        switch (b) {
            case 4:
            case 0:
            case 1:
                c = EnumUtil.getName(SpreadsheetContextMenuSubItem_$type, b);
                break;
            default:
            case 5:
            case 3:
            case 2: return this.ar(a, this.c.activeCell);
        }
        var d;
        switch (a) {
            case 153:
                d = "ShiftDown";
                break;
            case 152:
                d = "ShiftRight";
                break;
            case 147:
            case 146:
                d = "Column";
                break;
            case 144:
            case 145:
                d = "Row";
                break;
            case 155:
                d = "ShiftUp";
                break;
            case 154:
                d = "ShiftLeft";
                break;
            default:
                d = EnumUtil.getName(SpreadsheetAction_$type, a);
                break;
        }
        return this.af(this.ay("MenuItem_" + c + "_" + d));
    };
    SpreadsheetMenuBuilder$1.prototype.ar = function (a, b) {
        var c;
        switch (a) {
            case 189: return this.af(SpreadsheetUtilities.db(this.c, b));
            case 187: return this.af(SpreadsheetUtilities.dk(true, this.c, b));
            case 186: return this.af(SpreadsheetUtilities.dk(false, this.c, b));
            case 203:
                c = "MenuItem_Sort_Custom";
                break;
            case 190:
                c = "MenuItem_ReapplyFilter";
                break;
            case 100:
                c = "MenuItem_InsertWorksheets";
                break;
            case 89:
            case 91:
                c = "MenuItem_Hide";
                break;
            case 90:
            case 92:
                c = "MenuItem_Unhide";
                break;
            case 94:
                c = "MenuItem_AutoFit_Columns";
                break;
            case 93:
                c = "MenuItem_AutoFit_Rows";
                break;
            case 145:
            case 147:
                c = "MenuItem_Insert";
                break;
            case 144:
            case 146:
                c = "MenuItem_Delete";
                break;
            default:
                c = "MenuItem_" + EnumUtil.getName(SpreadsheetAction_$type, a);
                break;
        }
        return this.af(this.ay(c));
    };
    SpreadsheetMenuBuilder$1.prototype.at = function (a) {
        var b;
        switch (a) {
            case 0:
                b = "MenuItem_Insert";
                break;
            case 1:
                b = "MenuItem_Delete";
                break;
            case 11:
                b = "MenuItem_SortByCellColorHeader";
                break;
            case 2:
            case 3:
            case 4:
            case 5:
            case 9:
            case 8:
            case 6:
            case 7:
            case 10:
            case 12:
            case 13:
            case 14:
            case 15:
            case 16:
            case 17:
                b = "MenuItem_" + EnumUtil.getName(SpreadsheetContextMenuSubItem_$type, a);
                break;
            default:
                b = "";
                break;
        }
        return this.af(this.ay(b));
    };
    SpreadsheetMenuBuilder$1.prototype.av = function (a) {
        if (WorkbookColorInfo.l_op_Equality(a, null) || a.isAutomatic) {
            return this.c._fs("MenuItem_Automatic");
        }
        var b = a._getResolvedColor1(this.c.workbook);
        return this.ax(b);
    };
    SpreadsheetMenuBuilder$1.prototype.ax = function (a) {
        return this.c._fs("MenuItem_ColorValue", a.o, a.n, a.m);
    };
    SpreadsheetMenuBuilder$1.prototype.au = function (a) {
        if (a == null || a == CellFill.noColor) {
            return this.ay("MenuItem_NoFill");
        }
        var b = typeCast(CellFillPattern.$, a);
        if (b != null) {
            if (b.patternStyle == 0) {
                return this.ay("MenuItem_NoFill");
            }
            else if (b.patternStyle == 1) {
                return this.av(b.backgroundColorInfo);
            }
            else {
                return this.av(b.patternColorInfo);
            }
        }
        return this.ay("MenuItem_GradientFill");
    };
    SpreadsheetMenuBuilder$1.prototype.aw = function (a) {
        var b = SpreadsheetUtilities.ao(a);
        if (b == -1) {
            return this.ay("MenuItem_NoIcon");
        }
        return this.ay("Icon_" + EnumUtil.getName(FormatConditionIcon_$type, b));
    };
    SpreadsheetMenuBuilder$1.prototype.ay = function (a) {
        var b = this.c._fs(a);
        return b;
    };
    SpreadsheetMenuBuilder$1.prototype.i = function (a, b) {
        return this.k(this.af(this.c._fs("MenuItem_Filter_" + EnumUtil.getName(ExcelComparisonOperator_$type, a))), this.ao(a));
    };
    SpreadsheetMenuBuilder$1.prototype.ao = function (a) {
        return "Op" + "_" + EnumUtil.getName(ExcelComparisonOperator_$type, a);
    };
    SpreadsheetMenuBuilder$1.prototype.j = function (a, b, c) {
        return this.k(this.af(this.c._fs("MenuItem_Filter_" + EnumUtil.getName(RelativeDateRangeDuration_$type, a) + "_" + EnumUtil.getName(RelativeDateRangeOffset_$type, b))), this.ap(a, b));
    };
    SpreadsheetMenuBuilder$1.prototype.ap = function (a, b) {
        return "RelDate" + "_" + EnumUtil.getName(RelativeDateRangeDuration_$type, a) + "_" + EnumUtil.getName(RelativeDateRangeOffset_$type, b);
    };
    SpreadsheetMenuBuilder$1.prototype.h = function (a, b, c) {
        var d;
        switch (a) {
            default:
            case 1:
                d = this.af(this.c._fs("MenuItem_Filter_QuarterNumber", b));
                break;
            case 0:
                d = SpreadsheetUtilities.dh(b, this.c.workbook._e6);
                break;
        }
        return this.k(d, this.an(a, b));
    };
    SpreadsheetMenuBuilder$1.prototype.an = function (a, b) {
        return "DatePeriod" + "_" + EnumUtil.getName(DatePeriodFilterType_$type, a) + "_" + b.toString();
    };
    SpreadsheetMenuBuilder$1.prototype.g = function (a, b) {
        return this.k(this.af(this.c._fs("MenuItem_Filter_" + EnumUtil.getName(SpreadsheetSpecialFilterMenuItems_$type, a))), this.am(a));
    };
    SpreadsheetMenuBuilder$1.prototype.am = function (a) {
        return "CustomFilter" + "_" + EnumUtil.getName(SpreadsheetSpecialFilterMenuItems_$type, a);
    };
    SpreadsheetMenuBuilder$1.prototype.f = function (a) {
        return this.k(this.ar(a, this.c.activeCell), "Action" + "_" + EnumUtil.getName(SpreadsheetAction_$type, a));
    };
    SpreadsheetMenuBuilder$1.prototype.a = function () {
        var a = new Array(0);
        var b = [this.p(11, a), this.p(12, a), this.p(13, a), this.o(), this.f(203)];
        var c = [this.p(15, a), this.p(16, a), this.p(17, a)];
        var d = [this.i(0, 7), this.i(1, 7), this.o(), this.i(6, 7), this.i(8, 7), this.o(), this.i(10, 7), this.i(11, 7), this.o(), this.g(0, 7)];
        var e = [this.i(0, 6), this.i(1, 6), this.o(), this.i(2, 6), this.i(3, 6), this.i(4, 6), this.i(5, 6), this.g(1, 6), this.o(), this.g(2, 6), this.g(3, 6), this.g(4, 6), this.o(), this.g(0, 6)];
        var f = [this.i(0, 8), this.o(), this.g(5, 8), this.g(6, 8), this.g(1, 8), this.o(), this.j(0, 2, 8), this.j(0, 1, 8), this.j(0, 0, 8), this.o(), this.j(1, 2, 8), this.j(1, 1, 8), this.j(1, 0, 8), this.o(), this.j(2, 2, 8), this.j(2, 1, 8), this.j(2, 0, 8), this.o(), this.j(3, 2, 8), this.j(3, 1, 8), this.j(3, 0, 8), this.o(), this.j(4, 2, 8), this.j(4, 1, 8), this.j(4, 0, 8), this.o(), this.g(7, 8), this.o(), this.p(9, [this.h(1, 1, 9), this.h(1, 2, 9), this.h(1, 3, 9), this.h(1, 4, 9), this.o(), this.h(0, 1, 9), this.h(0, 2, 9), this.h(0, 3, 9), this.h(0, 4, 9), this.h(0, 5, 9), this.h(0, 6, 9), this.h(0, 7, 9), this.h(0, 8, 9), this.h(0, 9, 9), this.h(0, 10, 9), this.h(0, 11, 9), this.h(0, 12, 9)]), this.o(), this.g(0, 8)];
        return [this.f(187), this.f(186), this.p(10, b), this.o(), this.f(189), this.p(14, c), this.p(7, d), this.p(6, e), this.p(8, f)];
    };
    SpreadsheetMenuBuilder$1.prototype.a1 = function ($tArg, a, b, c, d, e, f) {
        var e_12, _0;
        this.a0(a);
        var g = 0;
        var h = new List$1($tArg, 0);
        c(function (i) { return h.add(i); });
        if (h == null) {
            h.add(f);
        }
        try {
            for (var _1 = tslib_1.__values(fromEnum(h)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var i = _2.value;
                var j = e(i);
                var k = d(b, j, i);
                if (j) {
                    g++;
                }
                this.az(a, k);
            }
        }
        catch (e_12_1) { e_12 = { error: e_12_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_12) throw e_12.error; }
        }
        this.bc(a, h.count > 1 || g > 0);
    };
    SpreadsheetMenuBuilder$1.prototype.b = function (a) {
        switch (a) {
            case 7:
                {
                    var b = [this.e(174, 0), this.e(175, 0), this.e(176, 0), this.e(177, 0)];
                    var c = [this.e(178, 1), this.e(179, 1)];
                    var d = [this.e(180, 4), this.e(181, 4), this.e(182, 4)];
                    var e = [this.e(189, 3), this.e(190, 3), this.o(), this.e(191, 3), this.e(192, 3), this.e(193, 3), this.e(194, 3)];
                    var f = [this.e(187, 2), this.e(186, 2), this.e(195, 2), this.e(196, 2), this.e(197, 2), this.e(203, 2)];
                    var g = [this.e(183, 5), this.e(184, 5)];
                    return [this.n(148), this.n(149), this.n(150), this.o(), this.p(0, b), this.p(1, c), this.p(4, d), this.n(79), this.o(), this.p(2, f), this.p(3, e), this.p(5, g), this.o(), this.n(198), this.n(202), this.n(164), this.n(165)];
                }
            case 2:
                {
                    var h = [this.e(152, 0), this.e(153, 0), this.e(145, 0), this.e(147, 0)];
                    var i = [this.e(154, 1), this.e(155, 1), this.e(144, 1), this.e(146, 1)];
                    var j = [this.e(189, 3), this.e(190, 3), this.o(), this.e(191, 3), this.e(192, 3), this.e(193, 3), this.e(194, 3)];
                    var k = [this.e(187, 2), this.e(186, 2), this.e(195, 2), this.e(196, 2), this.e(197, 2), this.e(203, 2)];
                    return [this.n(148), this.n(149), this.n(150), this.o(), this.p(0, h), this.p(1, i), this.n(79), this.o(), this.p(3, j), this.p(2, k), this.o(), this.n(198), this.n(202), this.n(164), this.n(165)];
                }
            case 0: return [this.n(148), this.n(149), this.n(150), this.o(), this.n(147), this.n(146), this.n(79), this.o(), this.n(198), this.n(89), this.n(90), this.n(94), this.o(), this.n(165)];
            case 5: return [this.n(148), this.n(149), this.n(150)];
            case 4: return [this.n(148), this.n(149), this.n(150)];
            case 1: return [this.n(148), this.n(149), this.n(150), this.o(), this.n(145), this.n(144), this.n(79), this.o(), this.n(198), this.n(91), this.n(92), this.n(93), this.o(), this.n(165)];
            case 6: return [this.n(148), this.n(149), this.n(150), this.o(), this.n(198), this.n(156), this.n(157), this.n(79), this.o(), this.n(165)];
            case 3: return [this.n(100), this.n(114), this.n(113), this.o(), this.n(111), this.o(), this.n(112)];
        }
        return null;
    };
    SpreadsheetMenuBuilder$1.prototype.z = function (a) {
        if (!stringIsNullOrEmpty(a) && stringStartsWith(a, "CustomFilter")) {
            var b = stringSplit(a, ["_"], 0);
            if (b.length > 0 && b[0] == "CustomFilter") {
                return Nullable$1.toNullable(SpreadsheetSpecialFilterMenuItems_$type, EnumUtil.getEnumValue(SpreadsheetSpecialFilterMenuItems_$type, EnumUtil.parse(SpreadsheetSpecialFilterMenuItems_$type, b[1], true)));
            }
        }
        return this.$type.getStaticFields(SpreadsheetMenuBuilder$1.$).ad;
    };
    SpreadsheetMenuBuilder$1.prototype.aa = function (a) {
        if (a != null && stringStartsWith(a, "Op")) {
            var b = stringSplit(a, ["_"], 0);
            if (b.length > 0 && b[0] == "Op") {
                return Nullable$1.toNullable(ExcelComparisonOperator_$type, EnumUtil.getEnumValue(ExcelComparisonOperator_$type, EnumUtil.parse(ExcelComparisonOperator_$type, b[1], true)));
            }
        }
        return this.$type.getStaticFields(SpreadsheetMenuBuilder$1.$).ae;
    };
    SpreadsheetMenuBuilder$1.prototype.y = function (a) {
        var b = this.x(a);
        if (nullableNotEquals(b, null)) {
            return Nullable$1.toNullable(SpreadsheetAction_$type, b.value);
        }
        var c = this.aq(a);
        if (c != null && c.indexOf("_") > 0) {
            if (stringStartsWith(c, "Action") && c.length > "Action".length + 1) {
                var d_1 = c.substr("Action".length + 1);
                var e_13;
                if (((function () { var f = EnumUtil.tryParse$1(SpreadsheetAction_$type, d_1, true, e_13); e_13 = f.p2; return f.ret; })())) {
                    return Nullable$1.toNullable(SpreadsheetAction_$type, e_13);
                }
            }
        }
        return this.$type.getStaticFields(SpreadsheetMenuBuilder$1.$).ac;
    };
    SpreadsheetMenuBuilder$1.prototype.a4 = function (a) {
        var b = this.c._bp(LongValue.a(), null);
        var c = new SpreadsheetMenuBuilder_InitializeItemsState$1(this.$t);
        c.d = b;
        c.c = this.c.activeCell;
        c.e = this.c.activeTable;
        c.a = 0;
        c.f = null;
        this.a5(a, c);
    };
    SpreadsheetMenuBuilder$1.prototype.a2 = function (a, b) {
        var c = this.c._bp(LongValue.a(), b);
        var d = SpreadsheetUtilities.w(this.c.activeWorksheet, b.row, b.column);
        var e = d.a;
        if (e == 0) {
            e = 1;
        }
        var f = new SpreadsheetMenuBuilder_InitializeItemsState$1(this.$t);
        f.c = b;
        f.e = typeCast(TableSortFilterArea.$, d) !== null ? d.ah.table : null;
        f.a = e;
        f.d = c;
        f.f = b.toString();
        f.b = d;
        if (d.g) {
            var g = null;
            var h = typeCast(CustomFilter.$, d.b);
            var i = typeCast(YearToDateFilter.$, d.b);
            var j = typeCast(RelativeDateRangeFilter.$, d.b);
            var k = typeCast(DatePeriodFilter.$, d.b);
            var l = typeCast(AverageFilter.$, d.b);
            var m = typeCast(TopOrBottomFilter.$, d.b);
            if (i != null) {
                g = this.am(7);
            }
            else if (l != null) {
                g = this.am(l.type == 0 ? 3 : 4);
            }
            else if (k != null) {
                g = this.an(k.type, k.value);
            }
            else if (j != null) {
                g = this.ap(j.duration, j.offset);
            }
            else if (m != null) {
                g = this.am(2);
            }
            else if (h != null) {
                if (h.condition1 != null) {
                    if (h.condition2 != null) {
                        if (h.condition1.comparisonOperator == 3 && h.condition2.comparisonOperator == 4) {
                            g = this.am(1);
                        }
                    }
                    else {
                        g = this.ao(h.condition1.comparisonOperator);
                    }
                }
                if (g == null) {
                    g = this.am(0);
                }
            }
            f.g = g;
        }
        this.a5(a, f);
    };
    SpreadsheetMenuBuilder$1.prototype.a3 = function (a, b, c) {
        var e_14, _0;
        var d = this.c._cq(b, c.f, c.d);
        var e = true;
        switch (b) {
            case 164:
            case 165:
            case 112:
                e = d;
                break;
            case 99:
            case 100:
                e = this.c.allowAddWorksheet;
                break;
            case 114:
                e = this.c.allowDeleteWorksheet;
                break;
            case 189:
                this.be(a, this.ar(b, c.c));
                break;
            case 187:
            case 186:
                var f = c.a == 0 ? this.ar(b, c.c) : this.af(SpreadsheetUtilities.dj(b == 187, this.c, c.a));
                this.be(a, f);
                var g = false;
                if (c.b != null) {
                    var h = 0;
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(c.b.p())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var i = _2.value;
                            var j = typeCast(OrderedSortCondition.$, i);
                            if (j != null) {
                                var k = j.sortDirection == 0;
                                var l = b == 187;
                                if (k == l) {
                                    g = true;
                                }
                            }
                            h++;
                        }
                    }
                    catch (e_14_1) { e_14 = { error: e_14_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_14) throw e_14.error; }
                    }
                    if (h > 1) {
                        g = false;
                    }
                }
                this.bb(a, g);
                break;
        }
        this.bc(a, d);
        this.bd(a, e);
    };
    SpreadsheetMenuBuilder$1.prototype.a5 = function (a, b) {
        var e_15, _0;
        var _loop_4 = function (c) {
            var e_16, _0, e_17, _1, e_18, _2;
            var d = this_2.x(c);
            if (nullableNotEquals(d, null)) {
                this_2.a3(c, d.value, b);
            }
            else {
                var e = this_2.aq(c);
                if (e != null && e.indexOf("_") > 0) {
                    if (stringStartsWith(e, "Action") && e.length > "Action".length + 1) {
                        var f_2 = e.substr("Action".length + 1);
                        var g_2;
                        if (((function () { var h = EnumUtil.tryParse$1(SpreadsheetAction_$type, f_2, true, g_2); g_2 = h.p2; return h.ret; })())) {
                            this_2.a3(c, g_2, b);
                        }
                    }
                    else if (stringStartsWith(e, "CustomFilter") || stringStartsWith(e, "DatePeriod") || stringStartsWith(e, "Op") || stringStartsWith(e, "RelDate")) {
                        this_2.bc(c, 0 == (b.d.i & 64));
                        this_2.bb(c, e == b.g);
                    }
                }
            }
            var h = this_2.w(c);
            if (h != null) {
                this_2.a5(h, b);
                var i = this_2.ab(c);
                if (nullableNotEquals(i, null)) {
                    var j = b.a;
                    switch (i.value) {
                        case 6:
                            this_2.bd(c, j == 0 || j == 3);
                            break;
                        case 7:
                            this_2.bd(c, j == 0 || j == 1);
                            break;
                        case 8:
                            this_2.bd(c, j == 0 || j == 2);
                            break;
                        case 10:
                        case 14:
                            {
                                var k = false;
                                try {
                                    for (var _3 = tslib_1.__values(fromEnum(h)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                                        var l = _4.value;
                                        if (!this_2.v(l) && this_2.r(l)) {
                                            k = true;
                                            break;
                                        }
                                    }
                                }
                                catch (e_16_1) { e_16 = { error: e_16_1 }; }
                                finally {
                                    try {
                                        if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                                    }
                                    finally { if (e_16) throw e_16.error; }
                                }
                                this_2.bc(c, k);
                                break;
                            }
                        case 11:
                            this_2.a1(CellFill.$, c, false, runOn(b.b, b.b.ac), runOn(this_2, this_2.d), runOn(b.b, b.b.k), CellFill.noColor);
                            break;
                        case 12:
                            this_2.a1(WorkbookColorInfo.$, c, false, runOn(b.b, b.b.ad), runOn(this_2, this_2.l), runOn(b.b, b.b.l), WorkbookColorInfo.automatic);
                            break;
                        case 13:
                            this_2.a1(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), c, false, runOn(b.b, b.b.af), runOn(this_2, this_2.m), runOn(b.b, b.b.m), SpreadsheetUtilities.d1);
                            break;
                        case 15:
                            this_2.a1(CellFill.$, c, true, runOn(b.b, b.b.ac), runOn(this_2, this_2.d), runOn(b.b, b.b.h), CellFill.noColor);
                            break;
                        case 16:
                            this_2.a1(WorkbookColorInfo.$, c, true, runOn(b.b, b.b.ad), runOn(this_2, this_2.l), runOn(b.b, b.b.i), WorkbookColorInfo.automatic);
                            break;
                        case 17:
                            this_2.a1(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), c, true, runOn(b.b, b.b.af), runOn(this_2, this_2.m), runOn(b.b, b.b.j), SpreadsheetUtilities.d1);
                            break;
                    }
                    if (this_2.t(i.value) && this_2.s(c)) {
                        var m = false;
                        try {
                            for (var _5 = tslib_1.__values(fromEnum(h)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                var n = _6.value;
                                if (this_2.q(n)) {
                                    m = true;
                                    break;
                                }
                            }
                        }
                        catch (e_17_1) { e_17 = { error: e_17_1 }; }
                        finally {
                            try {
                                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                            }
                            finally { if (e_17) throw e_17.error; }
                        }
                        if (m == false && b.g != null) {
                            switch (i.value) {
                                case 7:
                                case 8:
                                case 6:
                                    var o = this_2.am(0);
                                    try {
                                        for (var _7 = tslib_1.__values(fromEnum(h)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                            var p = _8.value;
                                            if (this_2.s(p) && o == this_2.aq(p)) {
                                                this_2.bb(p, true);
                                                m = true;
                                                break;
                                            }
                                        }
                                    }
                                    catch (e_18_1) { e_18 = { error: e_18_1 }; }
                                    finally {
                                        try {
                                            if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                        }
                                        finally { if (e_18) throw e_18.error; }
                                    }
                                    break;
                            }
                        }
                        this_2.bb(c, m);
                    }
                }
            }
            this_2.ba(c);
        };
        var this_2 = this;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                _loop_4(c);
            }
        }
        catch (e_15_1) { e_15 = { error: e_15_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_15) throw e_15.error; }
        }
    };
    SpreadsheetMenuBuilder$1.prototype.t = function (a) {
        switch (a) {
            case 9:
            case 8:
            case 3:
            case 15:
            case 14:
            case 16:
            case 17:
            case 6:
            case 2:
            case 11:
            case 10:
            case 12:
            case 13:
            case 7: return true;
            default: return false;
        }
    };
    SpreadsheetMenuBuilder$1.prototype.a7 = function (a, b) {
        this.c._cz(a, b, null);
    };
    SpreadsheetMenuBuilder$1.prototype.a8 = function (a, b) {
        var c = EnumUtil.getEnumValue(SpreadsheetAction_$type, EnumUtil.parse(SpreadsheetAction_$type, a, true));
        this.a7(c, b);
    };
    SpreadsheetMenuBuilder$1.prototype.u = function (a) {
        if (!stringIsNullOrEmpty(a)) {
            var b = stringSplit(a, ["_"], 0);
            switch (b[0]) {
                case "Action":
                case "Op":
                case "RelDate":
                case "DatePeriod":
                case "CustomFilter": return true;
            }
        }
        return false;
    };
    SpreadsheetMenuBuilder$1.prototype.a6 = function (a, b, c) {
        var d = SpreadsheetUtilities.w(this.c.activeWorksheet, c.row, c.column);
        var e = a ? 43 : 34;
        this.c._gi(e, function () {
            if (typeCast(CellFill.$, b) !== null) {
                var f = b;
                if (a) {
                    if (d.h(f)) {
                        d.n();
                    }
                    else {
                        d.t(f);
                    }
                }
                else {
                    d.ag(new FillSortCondition(f));
                }
            }
            else if (typeCast(WorkbookColorInfo.$, b) !== null) {
                var g = b;
                if (a) {
                    if (d.i(g)) {
                        d.n();
                    }
                    else {
                        d.v(g);
                    }
                }
                else {
                    d.ag(new FontColorSortCondition(g));
                }
            }
            else if (typeCast(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), b) !== null) {
                var h = b;
                if (a) {
                    if (d.j(h)) {
                        d.n();
                    }
                    else {
                        d.w(h.c, h.d);
                    }
                }
                else {
                    d.ag(new IconSortCondition(h.c, h.d));
                }
            }
            else {
            }
        });
    };
    SpreadsheetMenuBuilder$1.prototype.a9 = function (a, b) {
        if (!stringIsNullOrEmpty(a)) {
            var c = stringSplit(a, ["_"], 0);
            var d = SpreadsheetUtilities.w(this.c.activeWorksheet, b.row, b.column);
            if (c.length > 0) {
                switch (c[0]) {
                    case "Action":
                        this.a8(c[1], b);
                        break;
                    case "Op":
                        var e = EnumUtil.getEnumValue(ExcelComparisonOperator_$type, EnumUtil.parse(ExcelComparisonOperator_$type, c[1], true));
                        this.bf(d, e);
                        break;
                    case "RelDate":
                        var f = EnumUtil.getEnumValue(RelativeDateRangeDuration_$type, EnumUtil.parse(RelativeDateRangeDuration_$type, c[1], true));
                        var g = EnumUtil.getEnumValue(RelativeDateRangeOffset_$type, EnumUtil.parse(RelativeDateRangeOffset_$type, c[2], true));
                        var h = typeCast(RelativeDateRangeFilter.$, d.b);
                        if (h != null && h.duration == f && h.offset == g) {
                            d.n();
                        }
                        else {
                            d.x(g, f);
                        }
                        break;
                    case "DatePeriod":
                        var i = EnumUtil.getEnumValue(DatePeriodFilterType_$type, EnumUtil.parse(DatePeriodFilterType_$type, c[1], true));
                        var j = parseInt(c[2]);
                        var k = typeCast(DatePeriodFilter.$, d.b);
                        if (k != null && k.type == i && k.value == j) {
                            d.n();
                        }
                        else {
                            d.u(i, j);
                        }
                        break;
                    case "CustomFilter":
                        var l = EnumUtil.getEnumValue(SpreadsheetSpecialFilterMenuItems_$type, EnumUtil.parse(SpreadsheetSpecialFilterMenuItems_$type, c[1], true));
                        switch (l) {
                            case 0:
                                this.bf(d, 13);
                                break;
                            case 5:
                                this.bf(d, 4);
                                break;
                            case 6:
                                this.bf(d, 2);
                                break;
                            case 1:
                                this.bf(d, 12);
                                break;
                            case 3:
                                var m = typeCast(AverageFilter.$, d.b);
                                if (m != null && m.type == 0) {
                                    d.n();
                                }
                                else {
                                    d.s(0);
                                }
                                break;
                            case 4:
                                var n = typeCast(AverageFilter.$, d.b);
                                if (n != null && n.type == 1) {
                                    d.n();
                                }
                                else {
                                    d.s(1);
                                }
                                break;
                            case 2:
                                this.bg(d);
                                break;
                            case 7:
                                var o = typeCast(YearToDateFilter.$, d.b);
                                if (o != null) {
                                    d.n();
                                }
                                else {
                                    d.z();
                                }
                                break;
                        }
                        break;
                }
            }
        }
    };
    SpreadsheetMenuBuilder$1.prototype.ba = function (a) {
    };
    SpreadsheetMenuBuilder$1.prototype.bf = function (a, b) {
        var c = typeCast(TableSortFilterArea.$, a);
        if (c != null) {
            this.c.showFilterDialogForTable(c.ah, b);
        }
        else {
            var d = typeCast(WorksheetSortFilterArea.$, a);
            if (d != null) {
                this.c.showFilterDialogForWorksheet(d.ai, b);
            }
        }
    };
    SpreadsheetMenuBuilder$1.prototype.bg = function (a) {
        var b = typeCast(TableSortFilterArea.$, a);
        if (b != null) {
            this.c.showTopOrBottomDialogForTable(b.ah);
        }
        else {
            var c = typeCast(WorksheetSortFilterArea.$, a);
            if (c != null) {
                this.c.showTopOrBottomDialogForWorksheet(c.ai);
            }
        }
    };
    SpreadsheetMenuBuilder$1.prototype.bh = function (a) {
        var e_19, _0;
        var b = null;
        var c = null;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                var e = this.v(d);
                var f = this.s(d);
                if (!f) {
                    if (e) {
                        if (b != null && c == null) {
                            c = d;
                        }
                    }
                }
                else if (e) {
                    if (c != null && this.s(c)) {
                        this.bd(c, false);
                    }
                    c = d;
                    b = null;
                }
                else {
                    if (c != null && !this.s(c)) {
                        this.bd(c, true);
                    }
                    c = null;
                    b = d;
                    var g = this.w(d);
                    if (g != null) {
                        this.bh(g);
                    }
                }
            }
        }
        catch (e_19_1) { e_19 = { error: e_19_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_19) throw e_19.error; }
        }
        if (c != null) {
            this.bd(c, false);
        }
    };
    SpreadsheetMenuBuilder$1.$t = markType(SpreadsheetMenuBuilder$1, 'SpreadsheetMenuBuilder$1', Base.$, null, function () {
        this.ad = Nullable$1.toNullable(SpreadsheetSpecialFilterMenuItems_$type, null);
        this.ae = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        this.ac = Nullable$1.toNullable(SpreadsheetAction_$type, null);
    });
    return SpreadsheetMenuBuilder$1;
}(Base));
export { SpreadsheetMenuBuilder$1 };
/**
 * @hidden
 */
var TsSpreadsheetMenuBuilder = /** @class */ (function (_super) {
    tslib_1.__extends(TsSpreadsheetMenuBuilder, _super);
    function TsSpreadsheetMenuBuilder(a) {
        return _super.call(this, DropDownItem.$, a) || this;
    }
    TsSpreadsheetMenuBuilder.prototype.af = function (a) {
        return SpreadsheetUtilities.c2(a);
    };
    TsSpreadsheetMenuBuilder.prototype.az = function (a, b) {
        a.k.add(b);
    };
    TsSpreadsheetMenuBuilder.prototype.bi = function (a, b, c) {
        if (c === void 0) { c = null; }
        var d = new DropDownItem();
        d.p = a;
        d.m = b;
        if (!stringIsNullOrEmpty(c)) {
            d.n = "ui-igspreadsheet-" + c + "-icon";
        }
        return d;
    };
    TsSpreadsheetMenuBuilder.prototype.a0 = function (a) {
        a.k.clear();
    };
    TsSpreadsheetMenuBuilder.prototype.d = function (a, b, c) {
        var d = this.bi(this.au(c), Tuple.a(Boolean_$type, Base.$, a, c));
        d.e = b;
        d.d = true;
        return d;
    };
    TsSpreadsheetMenuBuilder.prototype.e = function (a, b) {
        return this.bi(this.as(a, b), enumGetBox(SpreadsheetAction_$type, a), EnumUtil.getName(SpreadsheetAction_$type, a).toLowerCase());
    };
    TsSpreadsheetMenuBuilder.prototype.k = function (a, b) {
        return this.bi(a, b, b.toLowerCase());
    };
    TsSpreadsheetMenuBuilder.prototype.l = function (a, b, c) {
        var d = this.bi(this.av(c), Tuple.a(Boolean_$type, Base.$, a, c));
        d.e = b;
        d.d = true;
        return d;
    };
    TsSpreadsheetMenuBuilder.prototype.m = function (a, b, c) {
        var d = this.bi(this.aw(c), Tuple.a(Boolean_$type, Base.$, a, c));
        d.e = b;
        d.d = true;
        return d;
    };
    TsSpreadsheetMenuBuilder.prototype.n = function (a) {
        return this.bi(this.ar(a, this.c.activeCell), enumGetBox(SpreadsheetAction_$type, a), EnumUtil.getName(SpreadsheetAction_$type, a).toLowerCase());
    };
    TsSpreadsheetMenuBuilder.prototype.o = function () {
        var a = new DropDownItem();
        a.p = "-";
        return a;
    };
    TsSpreadsheetMenuBuilder.prototype.p = function (a, b) {
        var c = this.bi(this.at(a), enumGetBox(SpreadsheetContextMenuSubItem_$type, a));
        for (var d = 0; d < b.length; d++) {
            c.k.add(b[d]);
        }
        return c;
    };
    TsSpreadsheetMenuBuilder.prototype.x = function (a) {
        if (typeCast(SpreadsheetAction_$type, a.m) !== null) {
            return Nullable$1.toNullable(SpreadsheetAction_$type, EnumUtil.getEnumValue(SpreadsheetAction_$type, a.m));
        }
        return this.$type.getStaticFields(SpreadsheetMenuBuilder$1.$).ac;
    };
    TsSpreadsheetMenuBuilder.prototype.aq = function (a) {
        return typeCast(String_$type, a.m);
    };
    TsSpreadsheetMenuBuilder.prototype.q = function (a) {
        return a.e;
    };
    TsSpreadsheetMenuBuilder.prototype.r = function (a) {
        return a.f;
    };
    TsSpreadsheetMenuBuilder.prototype.s = function (a) {
        return a.h;
    };
    TsSpreadsheetMenuBuilder.prototype.w = function (a) {
        return a.k;
    };
    TsSpreadsheetMenuBuilder.prototype.ab = function (a) {
        if (typeCast(SpreadsheetContextMenuSubItem_$type, a.m) !== null) {
            return Nullable$1.toNullable(SpreadsheetContextMenuSubItem_$type, EnumUtil.getEnumValue(SpreadsheetContextMenuSubItem_$type, a.m));
        }
        return TsSpreadsheetMenuBuilder.bj;
    };
    TsSpreadsheetMenuBuilder.prototype.v = function (a) {
        return a.g;
    };
    TsSpreadsheetMenuBuilder.prototype.ba = function (a) {
        var e_20, _0;
        _super.prototype.ba.call(this, a);
        var b = this.y(a);
        if (b.hasValue) {
            switch (b.value) {
                case 203:
                case 198:
                    a.f = false;
                    a.h = false;
                    break;
            }
        }
        else if (typeof a.m === 'string') {
            var c = this.z(a.m);
            if (c.hasValue) {
                switch (c.value) {
                    case 6:
                    case 5:
                    case 1:
                    case 0:
                    case 2:
                        a.f = false;
                        a.h = false;
                        break;
                }
            }
            else {
                var d = this.aa(a.m);
                if (d.hasValue) {
                    a.f = false;
                    a.h = false;
                }
            }
        }
        if (a.c) {
            var e = 0;
            try {
                for (var _1 = tslib_1.__values(fromEnum(a.k)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    if (f.h && !f.g) {
                        e++;
                    }
                }
            }
            catch (e_20_1) { e_20 = { error: e_20_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_20) throw e_20.error; }
            }
            if (e == 0) {
                a.h = false;
            }
        }
    };
    TsSpreadsheetMenuBuilder.prototype.bb = function (a, b) {
        a.e = b;
    };
    TsSpreadsheetMenuBuilder.prototype.bc = function (a, b) {
        a.f = b;
    };
    TsSpreadsheetMenuBuilder.prototype.bd = function (a, b) {
        a.h = b;
    };
    TsSpreadsheetMenuBuilder.prototype.be = function (a, b) {
        a.p = b;
    };
    TsSpreadsheetMenuBuilder.$t = markType(TsSpreadsheetMenuBuilder, 'TsSpreadsheetMenuBuilder', SpreadsheetMenuBuilder$1.$.specialize(DropDownItem.$));
    TsSpreadsheetMenuBuilder.bj = Nullable$1.toNullable(SpreadsheetContextMenuSubItem_$type, null);
    return TsSpreadsheetMenuBuilder;
}(SpreadsheetMenuBuilder$1));
export { TsSpreadsheetMenuBuilder };
/**
 * @hidden
 */
var SpreadsheetTabEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabEditManager, _super);
    function SpreadsheetTabEditManager(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.d = false;
        _this.a = a;
        return _this;
    }
    Object.defineProperty(SpreadsheetTabEditManager.prototype, "j", {
        get: function () {
            return this.d;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabEditManager.prototype, "b", {
        get: function () {
            return this.a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabEditManager.prototype, "c", {
        get: function () {
            return this.a._bf._p;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabEditManager.prototype.e = function () {
        var _this = this;
        if (!this.a._d7(true)) {
            return false;
        }
        if (!this.i) {
            return false;
        }
        var a = Enumerable.ag(SpreadsheetTabInfo.$, this.a._bf._k, function (b) { return b._j == _this.a.activeWorksheet; });
        if (a == null || !this.f(a)) {
            return false;
        }
        this.a._bf._a7(a);
        this.m(a, a._j.name, 31);
        if (this.c != null) {
            this.o();
        }
        return this.c != null;
    };
    SpreadsheetTabEditManager.prototype.g = function (a, b, c) {
        if (this.d) {
            return false;
        }
        this.d = true;
        this.a._g9(true);
        try {
            return this.h(a, b, c);
        }
        finally {
            this.a._g9(false);
            this.d = false;
        }
    };
    SpreadsheetTabEditManager.prototype.h = function (a, b, c) {
        if (this.c == null) {
            return true;
        }
        var d = this.c;
        var e = this.l();
        var f = d._j;
        if (!a) {
            try {
                Worksheet._aw(e, "name");
            }
            catch (g) {
                if (b) {
                    return this.h(true, true, c);
                }
                this.o();
                if (this.k(d) == false) {
                    var h = new SpreadsheetUserPromptInfo(3, this.a._fs("SheetNameError_Message_Invalid", e), g, e, false);
                    this.a._dz(h);
                }
                return false;
            }
            try {
                if (f.workbook != null) {
                    f.workbook._jd(f, e, "value");
                }
            }
            catch (i) {
                if (b) {
                    return this.h(true, true, c);
                }
                this.o();
                if (this.k(d) == false) {
                    var j = new SpreadsheetUserPromptInfo(4, this.a._fs("SheetNameError_Message_NameIsUsed", e), i, e, false);
                    this.a._dz(j);
                }
                return false;
            }
        }
        if (this.c == d) {
            this.n(d, c);
            this.a._bf._a8();
            if (!a) {
                f.name = e;
            }
        }
        return this.c == null;
    };
    SpreadsheetTabEditManager.$t = markType(SpreadsheetTabEditManager, 'SpreadsheetTabEditManager');
    return SpreadsheetTabEditManager;
}(Base));
export { SpreadsheetTabEditManager };
/**
 * @hidden
 */
var JsTabEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(JsTabEditManager, _super);
    function JsTabEditManager(a) {
        return _super.call(this, a) || this;
    }
    JsTabEditManager.prototype.get_i = function () {
        return true;
    };
    Object.defineProperty(JsTabEditManager.prototype, "i", {
        get: function () {
            return this.get_i();
        },
        enumerable: true,
        configurable: true
    });
    JsTabEditManager.prototype.f = function (a) {
        return true;
    };
    JsTabEditManager.prototype.p = function (a) {
        if (a != null) {
            var b = a._ac;
            if (b != null) {
                return b.cm.getChildAt(0);
            }
        }
        return null;
    };
    JsTabEditManager.prototype.l = function () {
        var a = this.p(this.c);
        return a != null ? a.getProperty("value") : "";
    };
    JsTabEditManager.prototype.m = function (a, b, c) {
        var _this = this;
        var d = a._ac;
        var e = d.a7.createElement("input");
        e.setProperty("type", "text");
        e.setProperty("minlength", 1);
        e.setProperty("maxlength", c);
        e.setProperty("value", b);
        e.setAttribute("tabIndex", 0);
        e.setRawStyleProperty("width", this.b._a0.j(a, b, true) + "px");
        e.listen("input", function (f) {
            var g = ((function (h) { return h != null ? h : ""; })(_this.l()));
            d.cl = _this.b._a0.j(a, g);
            d.q = true;
            d._parent.cf.aj();
            var h = _this.b._a0.j(a, g, true);
            if (h < 3) {
                h = 3;
            }
            e.setRawStyleProperty("width", (h + "px"));
        });
        d.cm.setText("");
        d.cm.append(e);
        e.focus();
    };
    JsTabEditManager.prototype.n = function (a, b) {
        var c = this.p(a);
        if (c != null) {
            c.unlistenAll();
            c.remove();
        }
        var d = a._ac;
        SpreadsheetVisualElementDomBuilder.ba(d.cm, a._ae);
        d.cv = -1;
        if (d._parent != null) {
            d._parent.cf.aj();
        }
        if (!b) {
            this.b._v.focus();
        }
    };
    JsTabEditManager.prototype.k = function (a) {
        return false;
    };
    JsTabEditManager.prototype.o = function () {
        var a = this.p(this.c);
        if (a != null) {
            var b = a.getNativeElement();
            var c = a.getProperty("value");
            var d = (c.length);
            SpreadsheetUtilities.bk(b, 0, d);
            a.focus();
        }
    };
    JsTabEditManager.prototype.q = function () {
        if (this.c != null && !this.j) {
            var a = this.p(this.c);
            if (a != null) {
                a.focus();
            }
        }
    };
    JsTabEditManager.$t = markType(JsTabEditManager, 'JsTabEditManager', SpreadsheetTabEditManager.$);
    return JsTabEditManager;
}(SpreadsheetTabEditManager));
export { JsTabEditManager };
/**
 * @hidden
 */
var SpreadsheetShapeContainerElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetShapeContainerElement, _super);
    function SpreadsheetShapeContainerElement(a, b) {
        var _this = _super.call(this, b, "ShapeContainer") || this;
        _this.cf = null;
        _this.cg = null;
        _this.cj = 0;
        _this.ch = false;
        _this.cg = a;
        _this.cf = new PaneShapeVisualManager(a, _this);
        return _this;
    }
    SpreadsheetShapeContainerElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        this.cf.n();
        for (var e = 0; e < this.a9; e++) {
            var f = typeCast(SpreadsheetShapeVisualElementBase.$, this.b(e));
            if (f != null && f.cg != null && !f.ab) {
                var g = f.cg;
                var h = g.d;
                var i = SpreadsheetUtilities.b9(h);
                i = Workbook._er(h.worksheet.workbook, i, true);
                f.ck = i;
                f.cm = g.n;
                var j = f.cg.t;
                f.al(j.x - i, j.y - i, j.width + i * 2, j.height + i * 2);
            }
        }
    };
    Object.defineProperty(SpreadsheetShapeContainerElement.prototype, "ck", {
        get: function () {
            return this.cj;
        },
        set: function (a) {
            if (a != this.cj) {
                this.cj = a;
                this.ci = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetShapeContainerElement.prototype, "ci", {
        get: function () {
            return this.ch;
        },
        set: function (a) {
            if (a != this.ch) {
                this.ch = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetShapeContainerElement.$t = markType(SpreadsheetShapeContainerElement, 'SpreadsheetShapeContainerElement', VisualElement.$);
    return SpreadsheetShapeContainerElement;
}(VisualElement));
export { SpreadsheetShapeContainerElement };
/**
 * @hidden
 */
var ShapeVisualManager = /** @class */ (function (_super) {
    tslib_1.__extends(ShapeVisualManager, _super);
    function ShapeVisualManager(a, b) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.a = null;
        _this.c = false;
        _this.g = null;
        _this.h = null;
        _this.e = false;
        _this.b = a;
        _this.c = b;
        _this.g = new List$1(SpreadsheetShape.$, 0);
        _this.h = new ReadOnlyCollection$1(SpreadsheetShape.$, 1, _this.g);
        _this.a = new RotationHelper();
        return _this;
    }
    Object.defineProperty(ShapeVisualManager.prototype, "f", {
        get: function () {
            return this.h;
        },
        enumerable: true,
        configurable: true
    });
    ShapeVisualManager.k = function (a, b) {
        var e_21, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                if (c.i && c.a != null) {
                    b.remove(c);
                    a.a = c.a;
                    a.g = true;
                    a.h = true;
                    return a.a.g;
                }
            }
        }
        catch (e_21_1) { e_21 = { error: e_21_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_21) throw e_21.error; }
        }
        return null;
    };
    ShapeVisualManager.prototype.n = function () {
        var e_22, _0;
        var a = this.b._r;
        if (this.i(a, 0) != this.g.count) {
            var b = new HashSet$1(SpreadsheetShape.$, 0);
            for (var c = 0; c < this.g.count; c++) {
                b.add_1(this.g._inner[c]);
            }
            this.g.clear();
            this.l(a);
            for (var d = 0; d < this.g.count; d++) {
                b.remove(this.g._inner[d]);
            }
            for (var e = 0; e < this.g.count; e++) {
                var f = this.g._inner[e];
                if (f.o == null) {
                    f.o = this.j(f, b);
                }
            }
            try {
                for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var g = _2.value;
                    this.m(g);
                    g.m = null;
                }
            }
            catch (e_22_1) { e_22 = { error: e_22_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_22) throw e_22.error; }
            }
            this.e = true;
        }
        this.o(a);
    };
    ShapeVisualManager.p = function (a) {
        var b = a.x + a.width / 2;
        var c = a.y + a.height / 2;
        return new Rect(0, b - a.height / 2, c - a.width / 2, a.height, a.width);
    };
    ShapeVisualManager.q = function (a, b, c, d) {
        return new Rect(0, c ? b.left + (b.right - a.right) : a.x, d ? b.top + (b.bottom - a.bottom) : a.y, a.width, a.height);
    };
    ShapeVisualManager.r = function (a) {
        return a._getBoundsInTwips();
    };
    ShapeVisualManager.prototype.o = function (a) {
        if (a == null) {
            return;
        }
        var b = this.b._s;
        var c = this.b.columnScrollRegion;
        var d = this.b.rowScrollRegion;
        for (var e = 0; e < a.count; e++) {
            var f = a.item(e);
            var g = f.d;
            var h = ShapeVisualManager.r(g);
            f.v = h;
            f.e = g.flippedHorizontally;
            f.f = g.flippedVertically;
            f.k = g._b6;
            var i = h.copy();
            if (SpreadsheetUtilities.bl(g)) {
                i = ShapeVisualManager.p(i);
            }
            if (f.b != null) {
                var j = f.c;
                var k = f.b;
                var l = k.s;
                var m = k.v;
                if (typeCast(WorksheetShapeGroupBase.$, g) !== null && ExcelUtils.bd(j.d._b6) && ExcelUtils.bd(g._b6) && (j == k || ExcelUtils.bd(k.d._b6))) {
                    var n = i.width < i.height;
                    var o = n ? l.width / l.height : l.height / l.width;
                    var p = i.width * o;
                    var q = i.height / o;
                    var r = n ? (i.width - p) / 2 : (i.height - q) / 2;
                    i.x = i.x - r;
                    i.width = p;
                    i.y = i.y + r;
                    i.height = q;
                }
                else {
                    i.x = l.left + ((i.x - m.x) / m.width) * l.width;
                    i.width = (i.width / m.width) * l.width;
                    i.y = l.top + ((i.y - m.y) / m.height) * l.height;
                    i.height = (i.height / m.height) * l.height;
                }
                i = ShapeVisualManager.q(i, l, k.e, k.f);
                if (k.e != k.f) {
                    f.k = 360 - f.k;
                }
                f.f = f.f != k.f;
                f.e = f.e != k.e;
                if (k.k % 360 != 0) {
                    this.a.h(i.x, i.y, i.right, i.bottom, k.k, k.s.x + (k.s.width / 2), k.s.y + (k.s.height / 2), false);
                    var s = this.a.m;
                    var t = s.x + s.width / 2;
                    var u = s.y + s.height / 2;
                    i.x = t - i.width / 2;
                    i.y = u - i.height / 2;
                }
                f.k += k.k;
            }
            f.s = i;
            var v = c._bl();
            var w = d._bl();
            var x = g.sheet.workbook;
            var y = this.c ? c._bx : 1;
            var z = (b.convertTwipsToPixels(i.x, false) - v) * y;
            var aa = (b.convertTwipsToPixels(i.right, false) - v) * y;
            var ab = (b.convertTwipsToPixels(i.y, true) - w) * y;
            var ac = (b.convertTwipsToPixels(i.bottom, true) - w) * y;
            f.u = new Rect(0, z, ab, aa - z, ac - ab);
            f.k = f.k % 360;
            if (f.k % 360 != 0) {
                this.a.g(z, ab, aa, ac, f.k, false);
                var ad = this.a.m;
                z = ad.left;
                ab = ad.top;
                aa = ad.right;
                ac = ad.bottom;
            }
            f.t = new Rect(0, z, ab, aa - z, ac - ab);
            if (f.j != null) {
                this.o(f.j);
            }
        }
    };
    ShapeVisualManager.prototype.l = function (a) {
        var e_23, _0;
        if (a != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var b = _2.value;
                    if (b.d.visible) {
                        if (this.d(b)) {
                            this.g.add(b);
                        }
                        if (b.j != null) {
                            this.l(b.j);
                        }
                    }
                }
            }
            catch (e_23_1) { e_23 = { error: e_23_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_23) throw e_23.error; }
            }
        }
    };
    ShapeVisualManager.prototype.i = function (a, b) {
        if (a == null) {
            return -1;
        }
        for (var c = 0; c < a.count; c++) {
            var d = a.item(c);
            if (!d.d.visible || !this.d(d)) {
                if (d.o != null) {
                    return -1;
                }
            }
            else {
                if (b >= this.g.count) {
                    return -1;
                }
                if (d != this.g._inner[b]) {
                    return -1;
                }
                b++;
            }
            if (d.j != null) {
                b = this.i(d.j, b);
                if (b < 0) {
                    return b;
                }
            }
        }
        return b;
    };
    ShapeVisualManager.$t = markType(ShapeVisualManager, 'ShapeVisualManager');
    return ShapeVisualManager;
}(Base));
export { ShapeVisualManager };
/**
 * @hidden
 */
var PaneShapeVisualManager = /** @class */ (function (_super) {
    tslib_1.__extends(PaneShapeVisualManager, _super);
    function PaneShapeVisualManager(a, b) {
        var _this = _super.call(this, a._j, false) || this;
        _this.t = null;
        _this.s = null;
        _this.t = a;
        _this.s = b;
        return _this;
    }
    PaneShapeVisualManager.prototype.d = function (a) {
        if (a.i) {
            return this.b._s.spreadsheetOwnerState._l._b(a.d);
        }
        else if (typeCast(WorksheetShapeGroup.$, a.d) !== null) {
            return false;
        }
        return SpreadsheetUtilities.a4(a.d, false);
    };
    PaneShapeVisualManager.prototype.j = function (a, b) {
        var e_24, _0;
        if (a.i) {
            var c = this.t._j._s.spreadsheetOwnerState._l;
            if (c == null) {
                return null;
            }
            var d = new SpreadsheetChartVisualElement(this.s, c, this.t._j._s);
            d.cg = a;
            return d;
        }
        else if (SpreadsheetUtilities.a4(a.d, false)) {
            var e = null;
            try {
                for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    e = typeCast(SpreadsheetShapeVisualElement.$, f.o);
                    if (e != null) {
                        b.remove(f);
                        e.ci = true;
                        e.cg = a;
                        return e;
                    }
                }
            }
            catch (e_24_1) { e_24 = { error: e_24_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_24) throw e_24.error; }
            }
            e = new SpreadsheetShapeVisualElement(this.s);
            e.cg = a;
            return e;
        }
        return null;
    };
    PaneShapeVisualManager.prototype.m = function (a) {
        var b = typeCast(VisualElement.$, a.o);
        if (b != null && !b.ab) {
            b.ab = true;
            a.m = null;
            a.o = null;
        }
    };
    PaneShapeVisualManager.$t = markType(PaneShapeVisualManager, 'PaneShapeVisualManager', ShapeVisualManager.$);
    return PaneShapeVisualManager;
}(ShapeVisualManager));
export { PaneShapeVisualManager };
/**
 * Provides information about a visualization of a group of rows and columns in a [[Worksheet]]
 */
var SpreadsheetPane = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPane, _super);
    function SpreadsheetPane(a, b, c, d) {
        var _this = _super.call(this) || this;
        _this._x = null;
        _this._ad = null;
        _this._m = null;
        _this._ai = null;
        _this._i = null;
        _this._j = null;
        _this._g = null;
        _this._v = null;
        _this._z = null;
        _this._ab = null;
        _this._af = null;
        _this._o = null;
        _this._aj = false;
        _this._ak = true;
        /**
         * @hidden
         */
        _this._s = null;
        _this._ay = null;
        _this._an = 0;
        _this._n = null;
        CoreUtilities.z(d, "owner");
        _this._ai = new PropertyChangeListener$1(SpreadsheetPane.$, _this, SpreadsheetPane._aq, false);
        var e = c(_this);
        _this._s = d;
        var f = PropertyChangeListenerList.e(SpreadsheetRowScrollRegion.$, _this._ad, a, _this._ai, true);
        _this._ad = f.p0;
        var g = PropertyChangeListenerList.e(SpreadsheetColumnScrollRegion.$, _this._x, b, _this._ai, true);
        _this._x = g.p0;
        var h = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetCellValueInfo.$), _this._m, new ObservableCollectionExtended$1(SpreadsheetCellValueInfo.$, 0), _this, false);
        _this._m = h.p0;
        var i = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetShape.$), _this._o, new ObservableCollectionExtended$1(SpreadsheetShape.$, 0), _this, false);
        _this._o = i.p0;
        var j = PropertyChangeListenerList.e(SpreadsheetSelection.$, _this._af, e, _this, true);
        _this._af = j.p0;
        var k = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetDropDownButton.$), _this._n, new ObservableCollectionExtended$1(SpreadsheetDropDownButton.$, 0), _this, false);
        _this._n = k.p0;
        return _this;
    }
    Object.defineProperty(SpreadsheetPane.prototype, "columnScrollRegion", {
        /**
         * Returns the [[SpreadsheetColumnScrollRegion]] that contains the pane.
         */
        get: function () {
            return this._x;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "rowScrollRegion", {
        /**
         * Returns the [[SpreadsheetRowScrollRegion]] that contains the pane.
         */
        get: function () {
            return this._ad;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "selection", {
        /**
         * Returns an object that represents the selection within the pane.
         * <p class="body"><b>Note:</b> Only the selection of the active pane is rendered.</p>
         */
        get: function () {
            return this._af;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "visibleRange", {
        /**
         * Returns a range that represents the current visible range.
         */
        get: function () {
            return new SpreadsheetCellRange(this._ad.startIndex, this._x.startIndex, this._ad.endIndex, this._x.endIndex);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_ag", {
        /**
         * @hidden
         */
        get: function () {
            return this.rowScrollRegion._ab;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_ac", {
        /**
         * @hidden
         */
        get: function () {
            return this._ab;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._ab != a) {
                this._ab = a;
                this.a("Background");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_w", {
        /**
         * @hidden
         */
        get: function () {
            return this._v;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._v = a;
            this.a("CellFillArray");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_ao", {
        /**
         * @hidden
         */
        get: function () {
            return this._an;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._an != a) {
                this._an = a;
                this.a("CellTextArrangeVersion");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_k", {
        /**
         * @hidden
         */
        get: function () {
            return this._i;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._i = a;
            this.a("CellValueArray");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_p", {
        /**
         * @hidden
         */
        get: function () {
            return this._m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_q", {
        /**
         * @hidden
         */
        get: function () {
            return this._n;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_aa", {
        /**
         * @hidden
         */
        get: function () {
            return this._z;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._z != a) {
                this._z = a;
                this.a("GridlinePen");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_al", {
        /**
         * @hidden
         */
        get: function () {
            return this._aj;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._aj != a) {
                this._aj = a;
                this.a("HideActiveCellContent");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_l", {
        /**
         * @hidden
         */
        get: function () {
            return this._j;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._j = a;
            this.a("HyperlinkArray");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_h", {
        /**
         * @hidden
         */
        get: function () {
            return this._g;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._g = a;
            this.a("InvalidCellArray");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_ap", {
        /**
         * @hidden
         */
        get: function () {
            return CoreUtilities.p(this._ay);
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (a != this._ap) {
                this._ay = a == null ? null : new WeakReference(a);
                this.a("Panel");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_r", {
        /**
         * @hidden
         */
        get: function () {
            return this._o;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPane.prototype, "_am", {
        /**
         * @hidden
         */
        get: function () {
            return this._ak;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._ak = a;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPane.prototype.scrollCellIntoView = function () {
        var n;
        if (arguments.length === 1) {
            if (typeCast(SpreadsheetCell.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0: return this._scrollCellIntoView.apply(this, arguments);
            case 1: return this._scrollCellIntoView1.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._scrollCellIntoView = function (a) {
        this._scrollRangeIntoView(new SpreadsheetCellRange(a.row, a.column));
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._scrollCellIntoView1 = function (a) {
        this._scrollCellIntoView(new SpreadsheetCell(a));
    };
    /**
     * Used to ensure that a specified column is fully in view within the [[visibleRange]].
     * @param index 0 based index of the column to be brought into view.
     * @throws [[ArgumentOutOfRangeException]] The 'index' must be 0 or greater.
     */
    SpreadsheetPane.prototype.scrollColumnIntoView = function (index) {
        if (index < 0) {
            throw new ArgumentOutOfRangeException(0);
        }
        this._s._scrollRangeIntoView$i(this, Nullable$1.toNullable(IntRange.$, null), Nullable$1.toNullable(IntRange.$, new IntRange(1, index, index)));
    };
    SpreadsheetPane.prototype.scrollRangeIntoView = function () {
        var n;
        if (arguments.length === 1) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0: return this._scrollRangeIntoView.apply(this, arguments);
            case 1: return this._scrollRangeIntoView1.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._scrollRangeIntoView = function (a) {
        this._s._scrollRangeIntoView$i(this, Nullable$1.toNullable(IntRange.$, new IntRange(1, a.firstRow, a.lastRow)), Nullable$1.toNullable(IntRange.$, new IntRange(1, a.firstColumn, a.lastColumn)));
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._scrollRangeIntoView1 = function (a) {
        this._scrollRangeIntoView(new SpreadsheetCellRange(a));
    };
    /**
     * Used to ensure that a specified row is fully in view within the [[visibleRange]].
     * @param index 0 based index of the row to be brought into view.
     * @throws [[ArgumentOutOfRangeException]] The 'index' must be 0 or greater.
     */
    SpreadsheetPane.prototype.scrollRowIntoView = function (index) {
        if (index < 0) {
            throw new ArgumentOutOfRangeException(0);
        }
        this._s._scrollRangeIntoView$i(this, Nullable$1.toNullable(IntRange.$, new IntRange(1, index, index)), Nullable$1.toNullable(IntRange.$, null));
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._t = function (a) {
        return new SpreadsheetCell(this.rowScrollRegion._ag(a.y)._j, this.columnScrollRegion._ag(a.x)._j);
    };
    /**
     * @hidden
     */
    SpreadsheetPane.prototype._ar = function (a, b, c) {
        switch (b != null ? b : "") {
            case "StartIndex":
            case "EndIndex":
                if (a == this.rowScrollRegion || a == this.columnScrollRegion) {
                    this.a("VisibleRange");
                }
                break;
        }
    };
    /**
     * @hidden
     */
    SpreadsheetPane._aq = function (a, b, c, d) {
        a._ar(b, c, d);
    };
    SpreadsheetPane.$t = markType(SpreadsheetPane, 'SpreadsheetPane', PropertyChangeNotifierExtended.$);
    return SpreadsheetPane;
}(PropertyChangeNotifierExtended));
export { SpreadsheetPane };
/**
 * @hidden
 */
var SpreadsheetPaneShapeLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneShapeLayer, _super);
    function SpreadsheetPaneShapeLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.t) || this;
        _this._k = null;
        _this._l = null;
        _this._l = new SpreadsheetShapeContainerElement(_this, b.c);
        _this._k = new ShapeLayerObserver(a, function () {
            _this._e();
            _this._l.t = true;
        });
        return _this;
    }
    SpreadsheetPaneShapeLayer.prototype._g = function (a) {
        var b = new Rect(0, 0, 0, a.width, a.height);
        if (this._l != null) {
            var c = this._j.columnScrollRegion._bx;
            this._l.ck = c;
            this._l.al(0, 0, a.width / c, a.height / c);
        }
        return b;
    };
    SpreadsheetPaneShapeLayer.prototype.dispose = function () {
        _super.prototype.dispose.call(this);
        this._k.dispose();
        if (this._l != null) {
            this._l.ab = true;
            this._l = null;
        }
    };
    SpreadsheetPaneShapeLayer.prototype._h = function (a) {
        return new Size(0);
    };
    SpreadsheetPaneShapeLayer.$t = markType(SpreadsheetPaneShapeLayer, 'SpreadsheetPaneShapeLayer', ElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneShapeLayer;
}(ElementLayer$1));
export { SpreadsheetPaneShapeLayer };
/**
 * @hidden
 */
var ShapeGeometryPathBuilder = /** @class */ (function (_super) {
    tslib_1.__extends(ShapeGeometryPathBuilder, _super);
    function ShapeGeometryPathBuilder(a, b, c, d) {
        var _this = _super.call(this) || this;
        _this.a = 0;
        _this.b = 0;
        _this.e = 0;
        _this.f = 0;
        _this.c = 0;
        _this.d = 0;
        _this.e = a;
        _this.f = b;
        _this.c = c;
        _this.d = d;
        _this.a = c;
        _this.b = d;
        return _this;
    }
    ShapeGeometryPathBuilder.prototype.m = function (a, b, c, d) {
        var e = this.a + 2 / 3 * (a - this.a);
        var f = this.b + 2 / 3 * (b - this.b);
        var g = c + 2 / 3 * (a - c);
        var h = d + 2 / 3 * (b - d);
        this.j(e, f, g, h, c, d);
    };
    ShapeGeometryPathBuilder.g = function (a, b, c) {
        var d = Math.PI * 2;
        var e = Math.PI * a / 180;
        if (Math.abs(Math.cos(e)) < 1E-05 || Math.abs(Math.sin(e)) < 1E-05) {
            return e;
        }
        var f = Math.atan2(Math.sin(e) / Math.abs(c), Math.cos(e) / Math.abs(b));
        var g = truncate(MathUtilities.f(e / d)) - truncate(MathUtilities.f(f / d));
        return f + g * d;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DArcTo = function (value, argument) {
        return this._visitCT_Path2DArcTo$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DArcTo$i = function (a, b) {
        var c = ShapeGeometry.i(b, a.d);
        var d = ShapeGeometry.i(b, a.c);
        var e = ShapeGeometry.h(b, a.a);
        var f = ShapeGeometry.h(b, a.b);
        var g = f / 180 * Math.PI;
        var h = ShapeGeometryPathBuilder.g(e, c, d);
        var i = this.a - c * Math.cos(h);
        var j = this.b - d * Math.sin(h);
        this.h(i, j, c, d, e, f);
        var k = ShapeGeometryPathBuilder.g(e + f, c, d);
        var l = i + c * Math.cos(k);
        var m = j + d * Math.sin(k);
        this.a = l;
        this.b = m;
        return true;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DClose = function (value, argument) {
        return this._visitCT_Path2DClose$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DClose$i = function (a, b) {
        this.i();
        return true;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DCubicBezierTo = function (value, argument) {
        return this._visitCT_Path2DCubicBezierTo$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DCubicBezierTo$i = function (a, b) {
        var c = ShapeGeometry.i(b, a.a.a) + this.c;
        var d = ShapeGeometry.i(b, a.a.b) + this.d;
        var e = ShapeGeometry.i(b, a.b.a) + this.c;
        var f = ShapeGeometry.i(b, a.b.b) + this.d;
        var g = ShapeGeometry.i(b, a.c.a) + this.c;
        var h = ShapeGeometry.i(b, a.c.b) + this.d;
        this.j(c, d, e, f, g, h);
        this.a = g;
        this.b = h;
        return true;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DLineTo = function (value, argument) {
        return this._visitCT_Path2DLineTo$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DLineTo$i = function (a, b) {
        var c = ShapeGeometry.i(b, a.a.a) + this.c;
        var d = ShapeGeometry.i(b, a.a.b) + this.d;
        this.k(c, d);
        this.a = c;
        this.b = d;
        return true;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DMoveTo = function (value, argument) {
        return this._visitCT_Path2DMoveTo$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DMoveTo$i = function (a, b) {
        var c = ShapeGeometry.i(b, a.a.a) + this.c;
        var d = ShapeGeometry.i(b, a.a.b) + this.d;
        this.l(c, d);
        this.a = c;
        this.b = d;
        return true;
    };
    ShapeGeometryPathBuilder.prototype.visitCT_Path2DQuadBezierTo = function (value, argument) {
        return this._visitCT_Path2DQuadBezierTo$i.apply(this, arguments);
    };
    ShapeGeometryPathBuilder.prototype._visitCT_Path2DQuadBezierTo$i = function (a, b) {
        var c = ShapeGeometry.i(b, a.a.a) + this.c;
        var d = ShapeGeometry.i(b, a.a.b) + this.d;
        var e = ShapeGeometry.i(b, a.b.a) + this.c;
        var f = ShapeGeometry.i(b, a.b.b) + this.d;
        this.m(c, d, e, f);
        this.a = e;
        this.b = f;
        return true;
    };
    ShapeGeometryPathBuilder.$t = markType(ShapeGeometryPathBuilder, 'ShapeGeometryPathBuilder', Base.$, [IPath2DCommandVisitor$2_$type.specialize(ShapeGuideVariables.$, Boolean_$type)]);
    return ShapeGeometryPathBuilder;
}(Base));
export { ShapeGeometryPathBuilder };
/**
 * @hidden
 */
var SvgPathCreator = /** @class */ (function (_super) {
    tslib_1.__extends(SvgPathCreator, _super);
    function SvgPathCreator(a, b, c, d, e) {
        var _this = _super.call(this, b, c, d, e) || this;
        _this.n = null;
        _this.n = a;
        return _this;
    }
    SvgPathCreator.prototype.h = function (a, b, c, d, e, f) {
        if (f >= 360) {
            this.o(d, c, e, 180, a, b);
            this.o(d, c, e + 180, 180, a, b);
        }
        else {
            this.o(d, c, e, f, a, b);
        }
    };
    SvgPathCreator.prototype.i = function () {
        this.n.l(" Z");
    };
    SvgPathCreator.prototype.j = function (a, b, c, d, e, f) {
        this.n.l(" C ");
        this.p(a, b);
        this.n.l(", ");
        this.p(c, d);
        this.n.l(", ");
        this.p(e, f);
    };
    SvgPathCreator.prototype.k = function (a, b) {
        this.n.l(" L ");
        this.p(a, b);
    };
    SvgPathCreator.prototype.l = function (a, b) {
        this.n.l(" M ");
        this.p(a, b);
    };
    SvgPathCreator.prototype.m = function (a, b, c, d) {
        this.n.l(" Q ");
        this.p(a, b);
        this.n.l(", ");
        this.p(c, d);
    };
    SvgPathCreator.prototype.o = function (a, b, c, d, e, f) {
        var g = ShapeGeometryPathBuilder.g(c + d, b, a);
        var h = e + b * Math.cos(g);
        var i = f + a * Math.sin(g);
        this.n.l(" A ");
        this.p(b, a);
        this.n.l(" 0 ");
        this.n.l(Math.abs(d) >= 180 ? "1 " : "0 ");
        this.n.l(d >= 0 ? "1 " : "0 ");
        this.p(h, i);
    };
    SvgPathCreator.prototype.p = function (a, b) {
        this.n.k(a * this.e);
        this.n.l(" ");
        this.n.k(b * this.f);
    };
    SvgPathCreator.$t = markType(SvgPathCreator, 'SvgPathCreator', ShapeGeometryPathBuilder.$);
    return SvgPathCreator;
}(ShapeGeometryPathBuilder));
export { SvgPathCreator };
/**
 * @hidden
 */
var ShapeGeometry = /** @class */ (function (_super) {
    tslib_1.__extends(ShapeGeometry, _super);
    function ShapeGeometry(a, b) {
        var _this = _super.call(this) || this;
        _this.e = null;
        _this.l = null;
        _this.f = null;
        _this.g = null;
        _this.l = a;
        _this.e = b;
        _this.f = new List$1(ShapeGuide.$, 0);
        _this.g = new List$1(ShapeGuide.$, 0);
        return _this;
    }
    ShapeGeometry.m = function (a, b, c, d) {
        if (b == null || typeCast(ShapeFillNoFill.$, b) !== null) {
            a.l(" fill-opacity=\"0\"");
        }
        else if (typeCast(ShapeFillSolid.$, b) !== null) {
            var e = b;
            var f = c != null ? c.workbook : null;
            var g = e.colorInfo._aj(f, false, true);
            a.l(" fill=\"");
            a.l(g.l == 0 ? "none" : g.colorString);
            a.l("\"");
        }
        else if (typeCast(ShapeFillImage.$, b) !== null) {
            var h = b._f;
            var i = d(h);
            a.l(" fill=\"");
            a.l("url(#" + i + ")");
            a.l("\"");
        }
    };
    ShapeGeometry.o = function (a, b, c, d) {
        if (b == null || typeCast(ShapeOutlineNoOutline.$, b) !== null) {
        }
        else if (typeCast(ShapeOutlineSolid.$, b) !== null) {
            var e = 1;
            var f = b;
            var g = c != null ? c.workbook : null;
            var h = f.colorInfo._aj(g, false, true);
            var i = ExcelUtils.c1(f._d);
            i = Math.max(Workbook._er(c.workbook, i, true) * d, e);
            if (h.l != 0) {
                a.l(" stroke=\"");
                a.l(h.colorString);
                a.l("\"");
            }
            a.l(" stroke-width=\"");
            a.k(i);
            a.l("\"");
            a.l(" stroke-linejoin=\"miter\" stroke-miterlimit=\"10\"");
        }
    };
    ShapeGeometry.t = function (a, b, c, d, e, f, g) {
        var e_25, _0;
        var h = a.c;
        var i = null;
        var j = function (k) {
            if (i == null) {
                i = new Dictionary$2(ImageData.$, String_$type, 0);
            }
            var l;
            if (!((function () { var m = i.tryGetValue(k, l); l = m.p1; return m.ret; })())) {
                var m_1 = stringIsNullOrEmpty(g._b8) ? "img" : XmlConvert.v(g._b8);
                l = m_1 + i.count;
                i.item(k, l);
            }
            return l;
        };
        var k = typeCast(WorksheetImage.$, g);
        var l = k != null && k._image != null ? new ShapeFillImage(new ImageData(0, k._image.d, k._image.b)) : null;
        var m;
        if (l == null || SpreadsheetUtilities.at(g) == null) {
            m = ShapeGeometry.s(StringBuilder.$, a, b * 15, c * 15, g, function (n, o, p, q, r, s, t, u, v) { return ShapeGeometry.q(n, o, p, q, r, s, t, u, v, d / r, e / s, f, j, l); });
        }
        else {
            m = ShapeGeometry.s(StringBuilder.$, a, b * 15, c * 15, g, function (n, o, p, q, r, s, t, u, v) { return ShapeGeometry.q(n, o, p, q, r, s, t, null, v, d / r, e / s, f, j, l); });
            ShapeGeometry.s(StringBuilder.$, a, b * 15 + (d * 15), c * 15 + (e * 15), g, function (n, o, p, q, r, s, t, u, v) { return ShapeGeometry.q(n, o, p, q, r, s, null, u, null, d / r / 2, e / s / 2, f, j, null); });
        }
        if (i != null && i.count > 0) {
            var n = "<defs>";
            try {
                for (var _1 = tslib_1.__values(fromEnum(i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var o = _2.value;
                    n += "<pattern patternUnits=\"userSpaceOnUse\" x=\"" + d + "\" y=\"" + e + "\" width=\"" + b + "\" height=\"" + c + "\" id=\"" + o.value + "\">";
                    n += "   <image preserveAspectRatio=\"none\"";
                    n += " xlink:href=\"";
                    n += "data:" + ImageFormat.s(o.key.d) + ";base64," + Convert.toBase64String(o.key.b);
                    n += "\"";
                    n += " width=\"" + b + "\"";
                    n += " height=\"" + c + "\"";
                    n += "/>";
                    n += "</pattern>";
                }
            }
            catch (e_25_1) { e_25 = { error: e_25_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_25) throw e_25.error; }
            }
            n += "</defs>";
            a.x(h, n);
        }
        return m;
    };
    ShapeGeometry.q = function (a, b, c, d, e, f, g, h, i, j, k, l, m, n) {
        var e_26, _0;
        var o = new StringBuilder(0);
        var p = new SvgPathCreator(o, e, f, j, k);
        try {
            for (var _1 = tslib_1.__values(fromEnum(c.b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var q = _2.value;
                q._accept$2$i(ShapeGuideVariables.$, Boolean_$type, p, d);
            }
        }
        catch (e_26_1) { e_26 = { error: e_26_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_26) throw e_26.error; }
        }
        if (g != null || h != null) {
            a.l("<path d=\"");
            a.l(o.toString());
            a.l("\"");
            ShapeGeometry.m(a, g, b, m);
            ShapeGeometry.o(a, h, b, l);
            a.l("/>");
        }
        if (i != null) {
            a.l("<path d=\"");
            a.l(o.toString());
            a.l("\"");
            ShapeGeometry.m(a, i, b, m);
            ShapeGeometry.o(a, h, b, l);
            a.l("/>");
        }
        if (n != null) {
            a.l("<path d=\"");
            a.l(o.toString());
            a.l("\"");
            ShapeGeometry.m(a, n, b, m);
            a.l("/>");
        }
    };
    ShapeGeometry.s = function ($t, a, b, c, d, e) {
        if (d == null) {
            return Rect.empty;
        }
        var f = null;
        if (typeCast(UnknownShape.$, d) !== null && typeCast(CT_CustomGeometry2D.$, d._en) !== null) {
            f = PredefinedShapes.b.c(d._en);
        }
        else if (nullableNotEquals(d._b1, null)) {
            f = PredefinedShapes.b.d(EnumUtil.getName(ST_ShapeType_$type, d._b1.value));
        }
        else if (typeCast(WorksheetImage.$, d) !== null) {
            f = PredefinedShapes.b.d(EnumUtil.getName(ST_ShapeType_$type, 4));
        }
        if (f == null) {
            return Rect.empty;
        }
        var g = SpreadsheetUtilities.as(d);
        var h = SpreadsheetUtilities.at(d);
        var i = SpreadsheetUtilities.a0(d);
        var j = d.worksheet;
        var k = ExcelUtils.dm(b);
        var l = ExcelUtils.dm(c);
        var m = new ShapeGuideVariables();
        m.f = k;
        m.e = l;
        if (f.g.count == 0 && f.f.count == 0) {
            f.r();
        }
        ShapeGeometry.n(m, f.f);
        if (i != null) {
            var n = new List$1(ShapeGuide.$, 0);
            ShapeGeometry.p(i, n);
            ShapeGeometry.n(m, n);
        }
        ShapeGeometry.n(m, f.g);
        if (f.e.f != null) {
            var o = f.e.f.b;
            for (var p = 0; p < o.count; p++) {
                var q = o._inner[p];
                var r = ST_PositiveCoordinate.g(q.g, Nullable$1.toNullable(ST_PositiveCoordinate.$, null)) ? k / ST_PositiveCoordinate.o(q.g.value) : 1;
                var s = ST_PositiveCoordinate.g(q.e, Nullable$1.toNullable(ST_PositiveCoordinate.$, null)) ? l / ST_PositiveCoordinate.o(q.e.value) : 1;
                var t = g;
                var u = null;
                var v = h;
                if (nullableEquals(q.f, false)) {
                    v = null;
                }
                var w = q.d;
                switch (!nullableIsNull(w) ? w.value : 1) {
                    case 0:
                        t = null;
                        break;
                    case 1: break;
                    case 4:
                        u = ShapeGeometry.a;
                        break;
                    case 5:
                        u = ShapeGeometry.b;
                        break;
                    case 2:
                        u = ShapeGeometry.c;
                        break;
                    case 3:
                        u = ShapeGeometry.d;
                        break;
                }
                e(a, j, q, m, r, s, t, v, u);
            }
        }
        var x;
        if (f.e.e == null) {
            x = Rect.empty;
        }
        else {
            var y = typeCast(WorksheetShapeWithText.$, d);
            if (y == null || !y._d0) {
                x = Rect.empty;
            }
            else {
                var z = y.text;
                var aa = f.e.e;
                var ab = ShapeGeometry.i(m, aa.b);
                var ac = ShapeGeometry.i(m, aa.d);
                var ad = ShapeGeometry.i(m, aa.c);
                var ae = ShapeGeometry.i(m, aa.a);
                var af = typeCast(CT_TextBodyProperties.$, z._o);
                if (af != null) {
                    var ag = ShapeGeometry.j(af.j, 9.6);
                    var ah = ShapeGeometry.j(af.s, 4.8);
                    var ai = ShapeGeometry.j(af.m, 9.6);
                    var aj = ShapeGeometry.j(af.f, 4.8);
                    ab += ag;
                    ad -= ai;
                    ac += ah;
                    ae -= aj;
                }
                if (ad <= ab || ae <= ac) {
                    x = Rect.empty;
                }
                else {
                    x = new Rect(0, ab, ac, ad - ab, ae - ac);
                }
            }
        }
        return x;
    };
    ShapeGeometry.h = function (a, b) {
        if (nullableNotEquals(b.e, null)) {
            return a.c(b.e.value.a) / 60000;
        }
        if (ST_Angle.g(b.d, Nullable$1.toNullable(ST_Angle.$, null))) {
            return b.d.value.n();
        }
        return 0;
    };
    ShapeGeometry.i = function (a, b) {
        return ShapeGeometry.k(a, b) / 15;
    };
    ShapeGeometry.j = function (a, b) {
        if (nullableNotEquals(a, null)) {
            var c = a.value.j();
            c = ExcelUtils.c1(c);
            return c / 15;
        }
        return b;
    };
    ShapeGeometry.k = function (a, b) {
        if (nullableNotEquals(b.e, null)) {
            var c = a.c(b.e.value.a);
            c = ExcelUtils.c1(truncate(c));
            return c;
        }
        if (nullableNotEquals(b.d, null)) {
            return b.d.value.k();
        }
        return 0;
    };
    ShapeGeometry.n = function (a, b) {
        var e_27, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = c.b(a);
                a.b.item(c.c, c);
                a.g(c.c, d);
            }
        }
        catch (e_27_1) { e_27 = { error: e_27_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_27) throw e_27.error; }
        }
    };
    ShapeGeometry.p = function (a, b) {
        var e_28, _0;
        if (a != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(a.b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    b.add(ShapeGuide.a(c.b, c.a));
                }
            }
            catch (e_28_1) { e_28 = { error: e_28_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_28) throw e_28.error; }
            }
        }
    };
    ShapeGeometry.prototype.r = function () {
        ShapeGeometry.p(this.e.c, this.f);
        ShapeGeometry.p(this.e.d, this.g);
    };
    ShapeGeometry.$t = markType(ShapeGeometry, 'ShapeGeometry');
    ShapeGeometry.a = new ShapeFillSolid(new WorkbookColorInfo(Color.u(102, 0, 0, 0)));
    ShapeGeometry.b = new ShapeFillSolid(new WorkbookColorInfo(Color.u(51, 0, 0, 0)));
    ShapeGeometry.c = new ShapeFillSolid(new WorkbookColorInfo(Color.u(102, 255, 255, 255)));
    ShapeGeometry.d = new ShapeFillSolid(new WorkbookColorInfo(Color.u(51, 255, 255, 255)));
    return ShapeGeometry;
}(Base));
export { ShapeGeometry };
/**
 * @hidden
 */
var SpreadsheetContextMenu = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetContextMenu, _super);
    function SpreadsheetContextMenu(a) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.e = null;
        _this.a = null;
        _this.d = 0;
        _this.c = new SpreadsheetCell();
        _this.b = a;
        _this.e = new TsSpreadsheetMenuBuilder(a);
        return _this;
    }
    SpreadsheetContextMenu.prototype.l = function (a) {
        if (a === void 0) { a = true; }
        if (this.a != null && this.a.f) {
            if (a) {
                this.o();
            }
            this.a.o();
        }
    };
    SpreadsheetContextMenu.prototype.o = function () {
        if (this.g(document.activeElement)) {
            if (this.d == 5) {
                this.b._bh.dp.ci.cf.a7.rootWrapper.focus();
            }
            else {
                this.b._v.focus();
            }
        }
    };
    SpreadsheetContextMenu.prototype.m = function () {
        if (this.a != null) {
            this.a.o();
        }
    };
    SpreadsheetContextMenu.prototype.h = function () {
        return this.a != null && this.a.f;
    };
    SpreadsheetContextMenu.prototype.i = function (a) {
        return this.h() && this.d == a;
    };
    SpreadsheetContextMenu.prototype.g = function (a) {
        return this.a != null && this.a.e(a);
    };
    SpreadsheetContextMenu.prototype.n = function () {
        this.m();
    };
    SpreadsheetContextMenu.prototype.j = function (a, b, c, d) {
        var _this = this;
        if (d === void 0) { d = null; }
        if (this.b._bh == null || this.b._bh.a7 == null) {
            return false;
        }
        if (b == null) {
            return false;
        }
        var e = b.cd();
        e.x += c.x;
        e.y += c.y;
        if (this.a == null) {
            this.a = new ContextMenu();
            var f = this.a;
            f.itemClick = delegateCombine(f.itemClick, function (f, g) {
                if (_this.d == 8) {
                    if (_this.e.u(typeCast(String_$type, g.m))) {
                        _this.l();
                        _this.e.a9(g.m, _this.c);
                    }
                    else {
                        var h_1 = typeCast(Tuple$2.$.specialize(Boolean_$type, Base.$), g.m);
                        if (h_1 != null) {
                            _this.l();
                            _this.e.a6(h_1.c, h_1.d, _this.c);
                        }
                    }
                }
                else {
                    if (typeCast(SpreadsheetAction_$type, g.m) !== null) {
                        var i_1 = EnumUtil.getEnumValue(SpreadsheetAction_$type, g.m);
                        _this.l();
                        _this.b.executeCommand(i_1);
                    }
                }
            });
            this.a.k = function (g, h) {
                var i = typeCast(Tuple$2.$.specialize(Boolean_$type, Base.$), g.m);
                if (i != null && i.d != null) {
                    var j_1 = i.c;
                    var k_1 = i.d;
                    var l_1 = null;
                    if (typeCast(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), k_1) !== null) {
                        var m = SpreadsheetUtilities.ao(k_1);
                        l_1 = SpreadsheetUtilities.cf(_this.b, m, 16, 16);
                    }
                    else if (typeCast(WorkbookColorInfo.$, k_1) !== null) {
                        var n = k_1;
                        if (!n.isAutomatic) {
                            l_1 = SpreadsheetUtilities.cg(_this.b, n, 60, 16, SpreadsheetContextMenu.f);
                        }
                    }
                    else if (typeCast(CellFill.$, k_1) !== null) {
                        var o = k_1;
                        if (!SpreadsheetUtilities.bc(o)) {
                            l_1 = SpreadsheetUtilities.ce(_this.b, o, 60, 16, SpreadsheetContextMenu.f);
                        }
                    }
                    if (l_1 != null) {
                        l_1.setRawStyleProperty("vertical-align", "middle");
                        l_1.setRawStyleProperty("margin-right", "5px");
                        h.append(l_1);
                        var p = _this.b._fa.createElement("span");
                        p.setText(g.p);
                        h.append(p);
                        return true;
                    }
                }
                return false;
            };
        }
        var g;
        if (this.d != a || this.a.i.count == 0) {
            this.d = a;
            this.a.i.clear();
            if (a == 8) {
                g = this.e.a();
            }
            else {
                g = this.e.b(a);
            }
            this.a.i.o(g);
        }
        else {
            g = this.a.i;
        }
        if (a == 8) {
            this.c = new SpreadsheetCell(d.d, d.c);
            this.e.a2(g, this.c);
        }
        else {
            this.e.a4(g);
        }
        this.e.bh(g);
        this.b._fy(true);
        var h = this.b._bh.a7;
        var i = d != null ? d.g.width : 0;
        var j = d != null ? d.g.height : 0;
        var k = new Rect(0, e.x - i, e.y - j, i, j);
        var l = new DropDownPosition();
        l.a = 2 | 4;
        l.b = 1 | 4;
        if (d != null) {
            l.c = RelativePositionInfo.d;
            l.d = RelativePositionInfo.d;
        }
        else {
            l.c = RelativePositionInfo.e;
            l.d = RelativePositionInfo.e;
            l.b = l.b | 2;
        }
        l.e = RelativePositionInfo.e;
        l.f = RelativePositionInfo.d;
        this.a.p(h, h.rootWrapper, k, l);
        return true;
    };
    SpreadsheetContextMenu.prototype.k = function (a, b, c) {
        return SpreadsheetUtilities.cz;
    };
    SpreadsheetContextMenu.$t = markType(SpreadsheetContextMenu, 'SpreadsheetContextMenu');
    SpreadsheetContextMenu.f = new WorkbookColorInfo(Color.u(255, 130, 130, 130));
    return SpreadsheetContextMenu;
}(Base));
export { SpreadsheetContextMenu };
/**
 * @hidden
 */
var SpreadsheetMeasureHelper = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetMeasureHelper, _super);
    function SpreadsheetMeasureHelper(a) {
        var _this = _super.call(this) || this;
        _this.d = null;
        _this.k = null;
        _this.r = null;
        _this.q = null;
        _this.p = null;
        _this.n = null;
        _this.o = null;
        _this.m = null;
        _this.l = null;
        _this.a = null;
        _this.e = null;
        _this.d = a;
        _this.e = new LRUCache$2(String_$type, Number_$type, 0, 100);
        var b = EnumUtil.getValues(SpreadsheetResourceId_$type);
        var c = new Array(b.length);
        for (var e = 0; e < b.length; e++) {
            var d = b[e];
            var f = DefaultSpreadsheetColors.getDefaultColor(d);
            c[d] = Brush.create(f.colorString);
        }
        _this.a = c;
        return _this;
    }
    Object.defineProperty(SpreadsheetMeasureHelper.prototype, "s", {
        get: function () {
            return this.r;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetMeasureHelper.prototype.u = function () {
        this.e.i();
    };
    SpreadsheetMeasureHelper.prototype.b = function (a, b) {
        var c = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "width"), NaN);
        var d = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "min-width"), NaN);
        var e = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "max-width"), NaN);
        var f = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "height"), NaN);
        var g = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "min-height"), NaN);
        var h = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, "max-height"), NaN);
        var i = this.c(a, b, "margin-");
        var j = this.c(a, b, "border-", "-width");
        var k = this.c(a, b, "padding-");
        if (i == null && isNaN_(c) && isNaN_(d) && isNaN_(e) && isNaN_(f) && isNaN_(g) && isNaN_(h)) {
            return null;
        }
        return new VisualElementConstraint(c, d, e, f, g, h, i, j, k);
    };
    SpreadsheetMeasureHelper.prototype.c = function (a, b, c, d) {
        if (c === void 0) { c = "margin-"; }
        if (d === void 0) { d = ""; }
        var e = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, c + "left" + d), 0);
        var f = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, c + "right" + d), 0);
        var g = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, c + "top" + d), 0);
        var h = SpreadsheetUtilities.b3(a.getCssDefaultPropertyValue(b, c + "bottom" + d), 0);
        return new VisualElementThickness(e, g, f, h);
    };
    SpreadsheetMeasureHelper.prototype.f = function (a, b, c, d) {
        if (d === void 0) { d = false; }
        a.addClass(b);
        var e = c ? d ? a.outerWidthWithMargin() : a.outerWidth() : d ? a.outerHeightWithMargin() : a.outerHeight();
        a.removeClass(b);
        return e;
    };
    SpreadsheetMeasureHelper.prototype.t = function () {
        return this.l == null ? null : this.l.getNativeElement();
    };
    SpreadsheetMeasureHelper.prototype.g = function (a, b, c, d, e) {
        if (this.m == null) {
            return 0;
        }
        if (a != null && a.length > 0 && a.charCodeAt(a.length - 1) == 10) {
            a += " ";
        }
        else if (stringIsNullOrEmpty(a)) {
            a = " ";
        }
        SpreadsheetVisualElementDomBuilder.a8(this.m, b, d);
        SpreadsheetVisualElementDomBuilder.a9(this.m, c);
        this.m.setAttribute("wrap", "soft");
        this.m.setRawStyleProperty("width", e + "px");
        this.m.setProperty(VisualElementDomBuilder.l, a);
        return this.m.getProperty("scrollHeight");
    };
    SpreadsheetMeasureHelper.prototype.ab = function (a, b, c) {
        a.addClass(b);
        var d = c ? a.outerWidthWithMargin() : a.outerWidth();
        var e = c ? a.outerHeightWithMargin() : a.outerHeight();
        a.removeClass(b);
        return new Size(1, d, e);
    };
    SpreadsheetMeasureHelper.prototype.h = function (a, b) {
        var c;
        if (this.e.d(a)) {
            c = this.e.item(a);
        }
        else {
            this.p.setAttribute("style", a);
            this.q.setRawStyleProperty("font", b);
            c = this.q.getProperty("scrollHeight");
            this.e.item(a, c);
        }
        return c;
    };
    SpreadsheetMeasureHelper.prototype.v = function (a) {
        this.w();
        var b = a.createElement("div");
        b.setAttribute("style", "display:block;position:absolute;visibility:hidden;opacity:0");
        a.append(b);
        this.k = a.getSubRenderer(b);
        this.r = a.createElement("div");
        this.r.setAttribute("style", "display:block;position:absolute;visibility:hidden;");
        b.append(this.r);
        this.q = a.createElement("div");
        this.q.setAttribute("style", "display:block;position:absolute;visibility:hidden;white-space:nowrap;border:0;padding:0;margin:0;");
        this.p = a.createElement("span");
        this.p.setProperty("innerHTML", "Wj");
        this.q.append(this.p);
        b.append(this.q);
        this.n = a.createElement("div");
        this.n.addClass(this.d.css.tabItem);
        this.n.addClass(this.d.css.tabItemSelected);
        this.n.addClass(this.d.css.tabItemActive);
        this.n.addClass("ui-state-default");
        this.o = SpreadsheetVisualElementDomBuilder.al(a.getSubRenderer(this.n), this.d.css);
        this.k.append(this.n);
        this.m = a.createElement("textarea");
        this.m.setRawStyleProperty("height", "1px");
        this.m.setRawStyleProperty("overflow", "hidden");
        SpreadsheetVisualElementDomBuilder.a7(this.m);
        this.k.append(this.m);
        this.l = a.createElement("img");
        var c = SpreadsheetRenderCache.aj;
        this.l.setAttribute("src", "data:image/png;base64," + c);
        this.k.append(this.l);
        this.aa();
    };
    SpreadsheetMeasureHelper.prototype.i = function (a, b, c, d) {
        if (this.m == null) {
            return 0;
        }
        SpreadsheetVisualElementDomBuilder.a8(this.m, b, d);
        SpreadsheetVisualElementDomBuilder.a9(this.m, c);
        this.m.setAttribute("wrap", "off");
        this.m.setRawStyleProperty("width", "1px");
        this.m.setProperty(VisualElementDomBuilder.l, stringIsNullOrEmpty(a) ? " " : a);
        return this.m.getProperty("scrollWidth");
    };
    SpreadsheetMeasureHelper.prototype.j = function (a, b, c) {
        if (b === void 0) { b = null; }
        if (c === void 0) { c = false; }
        if (this.n == null) {
            return 18;
        }
        if (a._t) {
            this.n.addClass(this.d.css.tabItemProtected);
        }
        else {
            this.n.removeClass(this.d.css.tabItemProtected);
        }
        SpreadsheetVisualElementDomBuilder.ba(this.o, b != null ? b : a._ae);
        return c ? this.o.outerWidthWithMargin() : this.n.outerWidthWithMargin();
    };
    SpreadsheetMeasureHelper.prototype.w = function () {
        if (this.k != null) {
            this.k.rootWrapper.remove();
            this.k = null;
            this.n = null;
            this.m = null;
            this.o = null;
            this.l = null;
        }
    };
    SpreadsheetMeasureHelper.prototype.x = function (a, b, c, d, e, f) {
        this.y(a, b, c, "background-color");
        this.y(a, b, d, "color");
        this.y(a, b, e, f ? "border-right-color" : "border-bottom-color");
    };
    SpreadsheetMeasureHelper.prototype.y = function (a, b, c, d) {
        if (c >= 0) {
            var e = a.getCssDefaultPropertyValue(b, d);
            if (stringIsNullOrEmpty(e)) {
                e = DefaultSpreadsheetColors.getDefaultColor(c).colorString;
            }
            this.a[c] = Brush.create(e);
        }
    };
    SpreadsheetMeasureHelper.prototype.aa = function () {
        if (this.k == null) {
            return;
        }
        var a = this.k;
        var b = this.d.css;
        var c = this.d._a1;
        a.startCSSQuery();
        var d = a.createElement("div");
        d.setAttribute("style", "display:block;position:absolute;");
        var e = a.createElement("div");
        d.append(e);
        try {
            this.x(a, b.columnHeader, 24, 28, 33, true);
            this.x(a, b.columnHeaderSelected, 25, 29, 34, true);
            this.x(a, b.columnHeaderSelectedCells, 26, 30, 35, true);
            this.x(a, b.columnHeaderHover, 27, 31, 36, true);
            this.x(a, b.columnHeaderSelected + " " + "ui-state-highlight", -1, 32, -1, true);
            this.x(a, b.rowHeader, 11, 15, 19, false);
            this.x(a, b.rowHeaderSelected, 12, 16, 20, false);
            this.x(a, b.rowHeaderSelectedCells, 13, 17, 21, false);
            this.x(a, b.rowHeaderHover, 14, 18, 22, false);
            this.x(a, b.rowHeaderSelected + " " + "ui-state-highlight", -1, 23, -1, false);
            this.x(a, b.invalidData, -1, -1, 64, true);
            this.x(a, b.automaticGridline, 38, -1, -1, true);
            this.x(a, b.headerResizeLine, 39, -1, -1, true);
            this.x(a, b.headerResizeLine, 40, -1, -1, false);
            this.x(a, b.cellSelection, 0, -1, 1, true);
            this.y(a, b.cellSelection, 2, "outline-color");
            this.x(a, b.cellSelectionHandle, 5, -1, 6, true);
            this.x(a, b.dropDownButton, 66, 67, 65, true);
            this.x(a, b.dropDownButtonOpen, 69, 70, 68, true);
            this.y(a, b.cellSelection + " " + "ui-state-highlight", 3, "outline-color");
            this.a[37] = this.a[4] = this.a[3];
            a.append(d);
            var f = " " + "ui-state-disabled";
            c.x = this.f(e, b.tabAreaBorder, false);
            c.v = this.f(e, b.columnSplitter, true);
            c.t = this.f(e, b.rowSplitter, false);
            c.w = this.f(e, b.columnSplitter + f, true);
            c.u = this.f(e, b.rowSplitter + f, false);
            c.aa = this.f(e, b.tabAreaSplitter, true);
            c.z = this.f(e, b.tabAreaSplitter, false);
            c.b = this.b(a, b.formulaBar);
            c.c = this.b(a, b.nameBoxContainer);
            c.a = this.b(a, b.formulaBarButtonContainer);
            c.ap = this.ab(e, b.nameBoxSplitter, true);
            c.ao = this.ab(e, b.formulaBarTextAreaSplitter, true);
            c.an = this.ab(e, b.formulaBarExpandButton, true);
            c.al = this.ab(e, b.formulaBarCancelButton, true);
            c.am = this.ab(e, b.formulaBarEnterButton, true);
            this.z(a, b, c);
            c.s = this.f(e, b.scrollBarVertical, true, true);
            c.r = this.f(e, b.scrollBarHorizontal, false, true);
            c.d = this.b(a, b.scrollBarHorizontal);
            c.e = this.b(a, b.scrollBarVertical);
            c.p = this.f(e, b.scrollBarArrowRight, true);
            c.q = this.f(e, b.scrollBarArrowLeft, true);
            c.aj = this.f(e, b.scrollBarArrowDown, false);
            c.ak = this.f(e, b.scrollBarArrowUp, false);
            c.ai = this.f(e, b.scrollPreviousTabButton, true);
            c.ah = this.f(e, b.scrollPreviousTabButton, false);
            c.ag = this.f(e, b.scrollNextTabButton, true);
            c.af = this.f(e, b.scrollNextTabButton, false);
            c.ac = this.f(e, b.scrollFirstTabButton, true);
            c.ab = this.f(e, b.scrollFirstTabButton, false);
            c.ae = this.f(e, b.scrollLastTabButton, true);
            c.ad = this.f(e, b.scrollLastTabButton, false);
            c.i = this.f(e, b.activatePreviousHiddenTabButton, true);
            c.h = this.f(e, b.activatePreviousHiddenTabButton, false);
            c.g = this.f(e, b.activateNextHiddenTabButton, true);
            c.f = this.f(e, b.activateNextHiddenTabButton, false);
            c.k = this.f(e, b.addNewWorksheetButton, true);
            c.j = this.f(e, b.addNewWorksheetButton, false);
        }
        finally {
            d.remove();
            a.endCSSQuery();
        }
        SpreadsheetVisualElementDomBuilder.ba(this.o, "Wj");
        var g = ["", "ui-state-hover", "ui-state-active", "ui-state-active" + " " + "ui-state-hover", b.tabItemProtected, b.tabItemProtected + " " + "ui-state-hover", b.tabItemProtected + " " + "ui-state-active", b.tabItemProtected + " " + "ui-state-active" + " " + "ui-state-hover"];
        var h = this.n.getAttribute("className");
        var i = 0;
        for (var j = 0; j < g.length; j++) {
            var k = g[j];
            if (j > 0) {
                this.n.addClass(g[j]);
            }
            i = Math.max(this.n.outerHeightWithMargin(), i);
            if (j > 0) {
                this.n.removeClass(g[j]);
            }
        }
        this.n.setAttribute("className", h);
        c.y = i;
    };
    SpreadsheetMeasureHelper.prototype.z = function (a, b, c) {
        var d = new SpreadsheetMeasureHelper_MeasureStack(a);
        var e = d.e("div", b.formulaBar);
        var f = d.e("div", b.formulaBarTextAreaContainer);
        var g = d.e("textarea").rootWrapper;
        SpreadsheetVisualElementDomBuilder.a5(g);
        g.setProperty("rows", 1);
        g.setProperty("value", "Wj");
        this.d._a1.m = g.getProperty("scrollHeight");
        g.setProperty("rows", 2);
        g.setProperty("value", "Wj\r\nWj");
        this.d._a1.n = g.getProperty("scrollHeight");
        g.setProperty("rows", 3);
        g.setProperty("value", "Wj\r\nWj\r\nWj");
        this.d._a1.o = g.getProperty("scrollHeight");
        d.c();
        d.c();
        var h = d.e("div", b.nameBoxContainer).rootWrapper;
        var i = d.e("div");
        var j = i.rootWrapper;
        var k = SpreadsheetVisualElementDomBuilder.am(i);
        this.d._a1.l = j.getProperty("scrollHeight");
        SpreadsheetVisualElementDomBuilder.as(k);
        d.f();
    };
    SpreadsheetMeasureHelper.$t = markType(SpreadsheetMeasureHelper, 'SpreadsheetMeasureHelper');
    return SpreadsheetMeasureHelper;
}(Base));
export { SpreadsheetMeasureHelper };
/**
 * @hidden
 */
export var ISpreadsheetView_$type = new Type(null, 'ISpreadsheetView');
/**
 * @hidden
 */
var SpreadsheetView = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetView, _super);
    function SpreadsheetView(a) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.a = null;
        _this.b = a;
        return _this;
    }
    SpreadsheetView.prototype.beforeExecuteCommand = function (command, commandParameter, sourceElement) {
        return unwrapNullable(this._beforeExecuteCommand$i.apply(this, arguments));
    };
    SpreadsheetView.prototype._beforeExecuteCommand$i = function (a, b, c) {
        switch (a) {
            case 148:
            case 149:
            case 150:
                var d = SpreadsheetUtilities.dd(a);
                var e = this.b._bj;
                if (e != null && !e.af(a) && ((typeof document.queryCommandSupported === "function")) && (document.queryCommandSupported(d))) {
                    var f = e.aj;
                    e.aj = new List$1(String_$type, 0);
                    try {
                        document.execCommand(d);
                        if (e.aj != null && e.aj.contains(SpreadsheetUtilities.de(a))) {
                            return Nullable$1.toNullable(Boolean_$type, true);
                        }
                    }
                    finally {
                        e.aj = f;
                    }
                }
                break;
        }
        return SpreadsheetUtilities.cz;
    };
    SpreadsheetView.prototype.createChartTitleElement = function (a, b) {
        if (a == null) {
            return null;
        }
        var c = a.wrapText;
        var d = SpreadsheetUtilities.ab(a._aj);
        var e = false;
        var f = a.workbook;
        var g = new ResolvedWorkbookFont(a.defaultFont, f._styles$i.normalStyle.styleFormat.font, f);
        var h = a.text;
        var i = h != null ? SpreadsheetUtilities.q(h, d, g, e) : SpreadsheetUtilities.t(this.b._fr(a), f, d, g, e);
        var j = a.border;
        var k = j == null ? 7 : j.lineStyle;
        var l = k == 7 || j.widthInPoints == 0 ? 0 : Math.max(Workbook._er(f, Workbook._eq(j.widthInPoints) / 2, false, true), 1);
        var m = this.b._fa.createElement("div");
        m.setRawStyleProperty("position", "relative");
        m.setRawStyleProperty("display", "inline-block");
        var n = this.b._fa.createElement("div");
        n.setRawStyleProperty("display", "table");
        n.setRawStyleProperty("position", "relative");
        var o = SpreadsheetUtilities.c5(a._ad, f);
        var p = !stringIsNullOrEmpty(o) ? "background:" + o + ";" : "";
        var q = JsSpreadsheetRenderCache.a6(i, this.b.workbook, 1, c, NaN, p);
        n.setProperty("innerHTML", q);
        n.setRawStyleProperty("padding", l + "px");
        n.setRawStyleProperty("margin", "auto");
        m.append(n);
        var r = this.b._fa.createElement("div");
        SpreadsheetUtilities.eg(r);
        SpreadsheetUtilities.d8(r, l, j, 0, f);
        m.append(r);
        return m.getNativeElement();
    };
    SpreadsheetView.prototype.createRenderCache = function () {
        return new JsSpreadsheetRenderCache(this.b);
    };
    Object.defineProperty(SpreadsheetView.prototype, "hasKeyboardFocusWithin", {
        get: function () {
            return SpreadsheetUtilities.a5(this.b._bh, document.activeElement);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetView.prototype, "isCellDropDownOpen", {
        get: function () {
            return this.b._at.i(8) || this.b._c6;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetView.prototype, "isInNameBox", {
        get: function () {
            if (this.b._bh != null) {
                return SpreadsheetUtilities.a5(this.b._bh.dp.cg, document.activeElement);
            }
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetView.prototype, "isScrollLockToggled", {
        get: function () {
            return this.b.isScrollLocked;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetView.prototype, "updateEditorValueMode", {
        get: function () {
            return 0;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetView.prototype.addCellTextLocations = function (a, b) {
        var c = typeCast(PaneLayerContainer.$, b._ap);
        if (c != null) {
            var d = c.e;
            for (var e = 0, f = d.a9; e < f; e++) {
                var g = d.b(e);
                if (g.bx == "SpreadsheetCellValueLayer") {
                    var h = g.a9;
                    for (var i = 0, j = g.a9; i < j; i++) {
                        var k = g.b(i);
                        if (k.bx == "SpreadsheetCellValue") {
                            var l = k;
                            var m = new Rect(0, l.co + l.ax, l.cp + l.a2, l.cq, l.cn);
                            a.item(new SpreadsheetCell(l.cg.ak, l.cg.ab), m);
                        }
                    }
                }
            }
        }
    };
    SpreadsheetView.prototype.closeMenu = function () {
        this.b._at.l();
    };
    SpreadsheetView.prototype.createCellEditManager = function () {
        return new JsCellEditManager(this.b);
    };
    SpreadsheetView.prototype.createTabEditManager = function () {
        return new JsTabEditManager(this.b);
    };
    SpreadsheetView.prototype.focus = function () {
        if (this.b._ay != null && this.b._ay.a7 != null) {
            SpreadsheetUtilities.d7(this.b._ay.a7.rootWrapper.getNativeElement());
            return true;
        }
        return true;
    };
    SpreadsheetView.prototype.getLayoutManager = function () {
        return this.b._ad;
    };
    SpreadsheetView.prototype.notifyCanExecuteChanged = function () {
        this.b.scheduleArrange();
    };
    SpreadsheetView.prototype.onDataObjectPasting = function (a) {
    };
    SpreadsheetView.prototype.onHasPendingChangeNotification = function () {
        this.b.scheduleArrange();
    };
    SpreadsheetView.prototype.onNameBoxValueChanged = function () {
    };
    SpreadsheetView.prototype.onNameBoxWidthChanged = function () {
    };
    SpreadsheetView.prototype.onSheetManagerChanged = function (a, b) {
        if (a != null) {
            a._al._j.al();
        }
        if (this.b._ad != null) {
            this.b._ad.e3 = false;
            this.b._ad.e2 = false;
        }
    };
    SpreadsheetView.prototype.onStateVerified = function () {
    };
    SpreadsheetView.prototype.remeasureRootPanel = function () {
        this.b._fy(false);
    };
    SpreadsheetView.prototype.shouldIncludeClipboardFormat = function (a, b) {
        return true;
    };
    SpreadsheetView.prototype.shouldCopyToClipboard = function (a, b) {
        return true;
    };
    SpreadsheetView.prototype.showCellDropDown = function (pane, cellRect, dropdownItems, initialSelectedIndex, onSelectionCommitted) {
        arguments[1] = rectFromLiteral(arguments[1]);
        return this._showCellDropDown$i.apply(this, arguments);
    };
    SpreadsheetView.prototype._showCellDropDown$i = function (a, b, c, d, e) {
        return this.b._d5(a, b, c, d, e);
    };
    SpreadsheetView.prototype.showSelectAllContextMenu = function (context, relativePoint) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._showSelectAllContextMenu$i.apply(this, arguments);
    };
    SpreadsheetView.prototype._showSelectAllContextMenu$i = function (a, b) {
        this.b._at.j(6, a, b);
    };
    SpreadsheetView.prototype.ShowPaneContextMenu = function (pane, area, relativePoint) {
        arguments[2] = pointFromLiteral(arguments[2]);
        return this._ShowPaneContextMenu$i.apply(this, arguments);
    };
    SpreadsheetView.prototype._ShowPaneContextMenu$i = function (a, b, c) {
        var d = this.b._n(a);
        this.b._at.j(b, d, c);
    };
    SpreadsheetView.prototype.ShowHeaderContextMenu = function (scrollRegion, relativePoint) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._ShowHeaderContextMenu$i.apply(this, arguments);
    };
    SpreadsheetView.prototype._ShowHeaderContextMenu$i = function (a, b) {
        var c = a._aw ? 1 : 0;
        var d = this.b._o(a);
        this.b._at.j(c, d, b);
    };
    SpreadsheetView.prototype.ShowTabContextMenu = function (tab, point) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._ShowTabContextMenu$i.apply(this, arguments);
    };
    SpreadsheetView.prototype._ShowTabContextMenu$i = function (a, b) {
        this.b._at.j(3, a._ac, b);
    };
    SpreadsheetView.prototype.showFilterMenu = function (a, b) {
        var c = this.b._n(a);
        return this.b._at.j(8, c, { $type: Point_$type, x: b.g.right, y: b.g.bottom }, b);
    };
    SpreadsheetView.prototype.showMessageBox = function (a, b, c, d, e) {
        VisualElementInputProxy.q++;
        switch (c) {
            case 0:
                {
                    window.alert(a);
                    return e;
                }
            case 1:
                {
                    return window.confirm(a) ? 1 : 2;
                }
            case 4:
                {
                    return window.confirm(a) ? 6 : 7;
                }
            case 3:
                {
                    return window.confirm(a) ? 6 : 2;
                }
        }
        return e;
    };
    Object.defineProperty(SpreadsheetView.prototype, "usesLogicalPixels", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetView.prototype.verifyLayout = function () {
    };
    SpreadsheetView.prototype.showFilterDialog = function (a) {
        var b = new FilterDialogManager(this.b, a);
        b.u();
    };
    SpreadsheetView.prototype.showTopOrBottomDialog = function (a) {
        var b = new TopOrBottomDialogManager(this.b, a);
        b.q();
    };
    SpreadsheetView.prototype.showCustomSortDialog = function (a, b) {
        var c = new SortDialogManager(this.b, a);
        c.aj(b);
    };
    SpreadsheetView.prototype.showFormatCellsDialog = function (a, b) {
        var c = new FormatCellsDialogManager(this.b, a, b);
        c.ea();
    };
    Object.defineProperty(SpreadsheetView.prototype, "spreadsheetDialogServicesManager", {
        get: function () {
            if (null == this.a) {
                this.a = new SpreadsheetDialogServicesManager();
            }
            return this.a;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetView.prototype.getRect = function (scrollRegion) {
        return rectToLiteral(this._getRect$i.apply(this, arguments));
    };
    SpreadsheetView.prototype._getRect$i = function (a) {
        var b = this.b._o(a);
        return b != null ? b.ce() : Rect.empty;
    };
    SpreadsheetView.prototype.getPaneRect = function (pane) {
        return rectToLiteral(this._getPaneRect$i.apply(this, arguments));
    };
    SpreadsheetView.prototype._getPaneRect$i = function (a) {
        var b = this.b._n(a);
        return b != null ? b.ce() : Rect.empty;
    };
    SpreadsheetView.prototype.initializeEditFont = function (a, b) {
    };
    SpreadsheetView.$t = markType(SpreadsheetView, 'SpreadsheetView', Base.$, [ISpreadsheetView_$type]);
    return SpreadsheetView;
}(Base));
export { SpreadsheetView };
/**
 * @hidden
 */
var SpreadsheetAreaLayoutManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetAreaLayoutManager, _super);
    function SpreadsheetAreaLayoutManager() {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.m = null;
        _this.v = null;
        _this.g = new SpreadsheetAreaLayoutManager_RowColumnInfo(true);
        _this.f = new SpreadsheetAreaLayoutManager_RowColumnInfo(false);
        _this.ao = null;
        _this.aq = 0;
        _this.o = null;
        _this.ei = null;
        _this.ar = 0;
        _this.d = 0;
        _this.as = 0;
        _this.at = 0;
        _this.ep = null;
        _this.en = null;
        _this.w = null;
        _this.au = 0;
        _this.t = null;
        _this.s = null;
        _this.et = new Size();
        _this.eo = null;
        _this.y = null;
        _this.a = 0;
        _this.z = false;
        _this.aa = false;
        _this.ab = false;
        _this.ai = false;
        _this.ac = false;
        _this.ad = false;
        _this.ag = false;
        _this.ah = false;
        _this.ae = false;
        _this.af = false;
        _this.v = new PropertyChangeListener$1(SpreadsheetAreaLayoutManager.$, _this, SpreadsheetAreaLayoutManager.ds, false);
        _this.ao = new List$1(SpreadsheetAreaLayoutManager_SheetLayerInfo$1.$.specialize(SpreadsheetPane.$), 0);
        return _this;
    }
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "h", {
        get: function () {
            return this.f;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "e", {
        get: function () {
            return this.d;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "aj", {
        get: function () {
            return this.ag;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "ev", {
        get: function () {
            return this.et;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "ap", {
        get: function () {
            return this.ao;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "x", {
        get: function () {
            return this.w;
        },
        set: function (a) {
            this.w = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "er", {
        get: function () {
            return this.eo;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "i", {
        get: function () {
            return this.g;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "n", {
        get: function () {
            return this.m;
        },
        set: function (a) {
            if (a != this.m) {
                var b = this.m;
                var c = PropertyChangeListenerList.e(SpreadsheetPaneManager.$, this.m, a, this.v, true);
                this.m = c.p0;
                if (this.m != null) {
                    this.f.e = this.m._dg;
                    this.g.e = this.m._dm;
                }
                else {
                    this.g.e = this.f.e = boxArray$1(new Array(0));
                }
                this.cs();
                this.dm(b, a);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "c", {
        get: function () {
            return this.b;
        },
        set: function (a) {
            if (a != this.b) {
                var b = PropertyChangeListenerList.e(Spreadsheet.$, this.b, a, this.v, true);
                this.b = b.p0;
                this.n = this.b != null ? this.b._a8 : null;
                this.p = this.b != null ? this.b._bf : null;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "p", {
        get: function () {
            return this.o;
        },
        set: function (a) {
            if (a != this.o) {
                var b = this.o;
                var c = PropertyChangeListenerList.e(SpreadsheetTabManager.$, this.o, a, this.v, true);
                this.o = c.p0;
                this.du(b, a);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetAreaLayoutManager.prototype, "be", {
        get: function () {
            return this.m != null ? this.m._d8 : 1;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetAreaLayoutManager.prototype.bt = function (a, b, c, d, e, f, g) {
        var h = f;
        var i = g;
        var j = c / b;
        var k = this.b._ai.l;
        var l = k.a.e == 7 ? k.a.t : k.a.j;
        if (l) {
            return {
                p5: f,
                p6: g
            };
        }
        switch (k.a.e) {
            case 5: break;
            case 1:
            case 4:
                {
                    if (f + d > g) {
                        g = f + d;
                        var m = a.columnScrollRegion._ag(g);
                        g = a.columnScrollRegion._bn(m._j, false);
                    }
                    break;
                }
            case 3:
                {
                    f = Math.max(Math.min(f, g - d), 0);
                    if (h > f) {
                        var n = a.columnScrollRegion._ag(f);
                        f = Math.max(a.columnScrollRegion._bn(n._j, true), 0);
                    }
                    break;
                }
            case 2:
            case 7:
            case 6:
                {
                    if (g - f < d) {
                        var o = (g - f) / 2 + f;
                        var p = Math.min(d, j);
                        if (f > o - p / 2) {
                            f = o - p / 2;
                            g = o + (p / 2);
                            var q = g - j;
                            var r = 0 - f;
                            var s = Math.max(q, r);
                            if (s > 0) {
                                f += s;
                                g -= s;
                            }
                            var t = a.columnScrollRegion._ag(f);
                            var u = a.columnScrollRegion._bn(t._j, true);
                            var v = a.columnScrollRegion._ag(g - e);
                            var w = a.columnScrollRegion._bn(v._j, false);
                            var x = o - u;
                            var y = w - o;
                            var z = Math.min(x, y);
                            f = o - z;
                            g = o + z;
                        }
                    }
                    break;
                }
        }
        return {
            p5: f,
            p6: g
        };
    };
    SpreadsheetAreaLayoutManager.prototype.df = function (a) {
    };
    SpreadsheetAreaLayoutManager.prototype.eu = function (a) {
        var _this = this;
        this.df(a);
        var b = a;
        var c = new Rect(0, 0, 0, a.width, a.height);
        var d = this.g.i;
        var e = this.aq;
        var f = 0;
        if (this.ag || this.ae) {
            var g_3, h_2;
            var i = ((function () { var j = _this.aw(Math.max(a.width - d, 0), g_3, h_2); g_3 = j.p1; h_2 = j.p2; return j.ret; })());
            if (this.ah) {
                this.cb(new Rect(0, i, a.height - e, g_3, e));
            }
            if (this.ag) {
                this.ca(new Rect(0, 0, a.height - e, Math.min(i, this.bd), e));
                f = i + g_3;
            }
            if (this.af) {
                this.b9(new Rect(0, 0, a.height - e, a.width - d, this.a9));
            }
            if (this.ae) {
                this.b8(new Rect(0, 0, a.height - e, a.width, e));
            }
        }
        if (this.g.a != null) {
            this.b3(this.g, true, this.f.g, a, d, 0, this.t, this.aq);
            c.width = Math.max(c.width - d, 0);
        }
        if (this.f.a != null) {
            this.b3(this.f, false, this.g.g, a, e, f, this.s, this.f.i);
        }
        c.height = Math.max(c.height - e, 0);
        this.eo = c.copy();
        var j = this.bu(this.g, SpreadsheetUtilities.e3(c.x, c.y + this.f.g), c);
        c = j.p2;
        var k = this.bu(this.f, SpreadsheetUtilities.e3(c.x, c.y), c);
        c = k.p2;
        if (this.ac) {
            var l = new Rect(0, c.x - this.g.h, c.y - this.f.h, this.g.h, this.f.h);
            this.b4(l);
        }
        var m = 30;
        var n = new Rect(0, c.x - this.g.h, c.y - this.f.h, c.width + this.g.h + d, c.height + this.f.h + e);
        n.inflate(m, m);
        this.ep = n;
        var o = Rect.empty;
        if (this.g.c) {
            o = new Rect(0, c.x - this.g.h, c.y + this.m._dn.item(0).actualExtent, c.width + this.g.h, this.m._d3);
            var p = o.copy();
            if (!this.g.e.item(0).isFrozen) {
                o.width += d;
            }
            if (CoreUtilities.f(o.top, c.bottom)) {
                o.height = 0;
            }
            this.b5(true, o);
            if (this.g.d) {
                var q = new Rect(0, p.x, this.at - p.height / 2, p.width, p.height);
                if (this.f.d) {
                    if (this.as < n.x || this.as >= n.right) {
                        q = p;
                    }
                }
                if (this.at < n.y || this.at >= n.bottom) {
                    q = p;
                }
                if (q.y < c.y) {
                    q.y = c.y;
                }
                else if (q.bottom > c.bottom) {
                    q.y = c.bottom - q.height;
                }
                this.b7(true, q);
            }
        }
        var r = Rect.empty;
        if (this.f.c) {
            r = new Rect(0, c.x + this.m._dh.item(0).actualExtent, c.y - this.f.h, this.m._d4, c.height + this.f.h);
            var s = r.copy();
            if (!this.f.e.item(0).isFrozen) {
                r.height += e;
            }
            if (CoreUtilities.f(r.left, c.right)) {
                r.width = 0;
            }
            this.b5(false, r);
            if (this.f.d) {
                var t = new Rect(0, this.as - s.width / 2, s.y, s.width, s.height);
                if (this.g.d) {
                    if (this.at < n.y || this.at >= n.bottom) {
                        t = s;
                    }
                }
                if (this.as < n.x || this.as >= n.right) {
                    t = s;
                }
                if (t.x < c.x) {
                    t.x = c.x;
                }
                else if (t.right > c.right) {
                    t.x = c.right - t.width;
                }
                this.b7(false, t);
            }
        }
        var u = Rect.empty;
        if (this.ad) {
            var v = new Rect(0, r.x, o.y, r.width, o.height);
            this.b6(v);
            var w = r.x - o.x + (r.width / 2);
            var x = o.y - r.y + (o.height / 2);
            u = new Rect(0, w - 9, x - 9, 18, 18);
        }
        this.cv(u);
        this.en = c;
        this.b1(c);
        this.bx(a);
        this.by(this.en);
        return b;
    };
    SpreadsheetAreaLayoutManager.prototype.bu = function (a, b, c) {
        var e_29, _0;
        var d = b.x;
        var e = b.y;
        var f = 0;
        var g = 0;
        if (a.f.count > 0) {
            var h = this.be;
            var i = a.e;
            var j = a.h;
            var k = a.b;
            if (k) {
                f = j;
            }
            else {
                g = j;
            }
            var l = -1;
            try {
                for (var _1 = tslib_1.__values(fromEnum(i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var m = _2.value;
                    l++;
                    if (k) {
                        g = m.actualExtent + 1;
                        e -= 1;
                    }
                    else {
                        f = m.actualExtent + 1;
                        d -= 1;
                    }
                    var n = new Rect(0, d, e, f, g);
                    this.b0(SpreadsheetScrollRegion.$, a.f._inner[l].b, n);
                    if (k) {
                        e += g + this.m._d3;
                    }
                    else {
                        d += f + this.m._d4;
                    }
                }
            }
            catch (e_29_1) { e_29 = { error: e_29_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_29) throw e_29.error; }
            }
            if (k) {
                c.x += j;
                c.width = Math.max(c.width - j, 0);
            }
            else {
                c.y += j;
                c.height = Math.max(c.height - j, 0);
            }
        }
        return {
            p2: c
        };
    };
    SpreadsheetAreaLayoutManager.prototype.bx = function (a) {
        var b = this.l();
        var c = this.j();
        var d = new Rect(4);
        var e = Rect.empty;
        if (b != null) {
            var f = Enumerable.ag(SpreadsheetAreaLayoutManager_SheetLayerInfo$1.$.specialize(SpreadsheetPane.$), this.ao, function (g) { return g.a == b; });
            if (f != null) {
                var g = this.b.isInEditMode;
                var h = this.x;
                var i = 1 / h.d;
                var j = -this.a2(f.c.x);
                var k = -this.a3(f.c.y);
                var l = b.rowScrollRegion._bx;
                var m = f.c.width;
                var n = f.c.height;
                var o = b.columnScrollRegion._bn(c.firstColumn, true);
                var p = b.rowScrollRegion._bn(c.firstRow, true);
                var q = b.columnScrollRegion._bn(c.lastColumn, false);
                var r = b.rowScrollRegion._bn(c.lastRow, false);
                var s = q;
                var t = r;
                r = Math.max(r, p + this.ay());
                if (g) {
                    var u = this.bt(b, l, m, this.b._ai.al(), i, o, q);
                    o = u.p5;
                    q = u.p6;
                }
                var v = Math.max(Math.min(q - o, (m - (o * l)) / l) - i, 0);
                var w = Math.max(Math.min(r - p, (n - (p * l)) / l) - i, 0);
                var x = f.c.x + h.h(o * l) - j;
                var y = f.c.x + h.h(o * l + v) - j;
                var z = f.c.y + h.h(p * l) - k;
                var aa = f.c.y + h.h(p * l + w) - k;
                d.x = x;
                d.y = z;
                d.width = Math.max(y - x, 0);
                d.height = Math.max(aa - z, 0);
                var ab = f.c.x + h.h(s * l) - j;
                var ac = f.c.y + h.h(t * l) - k;
                var ad = new Rect(0, x, z, Math.max(ab - x - i, 0), Math.max(ac - z - i, 0));
                var ae = b.rowScrollRegion._ag(r - i);
                if (ae._j > c.lastRow) {
                    var af = b.rowScrollRegion._bn(ae._j, false);
                    w = Math.max(Math.min(af - p, (n - (p * l)) / l) - i, 0);
                }
                ad.union(new Rect(0, x, z, Math.max(v * l, 0), Math.max(w * l, 0)));
                e = f.c;
                this.bw(ad, e);
            }
        }
        this.bv(d, e);
    };
    SpreadsheetAreaLayoutManager.prototype.by = function (a) {
        var _this = this;
        if (this.m != null) {
            var b = this.a8;
            var c = this.a7;
            var d = Enumerable.ag(SpreadsheetAreaLayoutManager_SheetLayerInfo$1.$.specialize(SpreadsheetPane.$), this.ao, function (e) { return e.a == _this.m._ao; });
            var e = d != null ? d.a._ag : null;
            var f = this.m._bc._jg;
            if (!this.ai) {
                this.bz(new Rect(0, -10000, -10000, b, c));
            }
            else if (this.d == 2) {
                this.bz(new Rect(0, this.as - this.ei.x, this.at - this.ei.y, b, c));
            }
            else if (PointUtil.notEquals(f, null)) {
                this.bz(new Rect(0, f.x + this.en.x, f.y + this.en.y, b, c));
            }
            else if (e != null) {
                var g = d.c;
                var h = e._r;
                var i = d.a.rowScrollRegion._bx;
                var j = d.a.rowScrollRegion._bn(h.firstRow, true) * i;
                var k = d.a.rowScrollRegion._bn(h.lastRow, false) * i;
                var l = d.a.columnScrollRegion._bn(h.firstColumn, true) * i;
                var m = d.a.columnScrollRegion._bn(h.lastColumn, false) * i;
                var n = 5;
                var o = SpreadsheetUtilities.e3(l + (m - l) / 2, k + n);
                var p = this.es(d, new Rect(2, SpreadsheetUtilities.e3(l, j), SpreadsheetUtilities.e3(m, k)));
                var q = this.em(d, o);
                var r = new Rect(0, q.x, q.y, b, c);
                if (!a.containsRect(r)) {
                    if (r.y < a.y) {
                        r.y = a.y;
                    }
                    else if (r.bottom > a.bottom) {
                        r.y = Math.max(a.y, a.bottom - r.height);
                    }
                    if (r.x < a.x) {
                        r.x = a.x;
                    }
                    else if (r.right > a.right) {
                        r.x = Math.max(a.x, a.right - r.width);
                    }
                    var s = new Rect(0, a.x, a.y, a.width, g.height);
                    s.intersect(p);
                    if (s.isEmpty == false && s.intersectsWith(r)) {
                        var t = Math.max(a.y, Math.min(this.em(d, SpreadsheetUtilities.e3(0, j + (k - j) / 2)).y, a.bottom - r.height));
                        if (a.right - s.right >= n + r.width) {
                            r.x = s.right + n;
                            r.y = t;
                        }
                        else if (s.top >= n + r.height) {
                            r.y = s.y - (n + r.height);
                        }
                        else if (s.left >= n + r.width) {
                            r.x = s.left - (n + r.width);
                            r.y = t;
                        }
                        else {
                            var u = new Array(4);
                            u[0] = new Rect(0, s.left - (n + r.width), t, r.width, r.height);
                            u[1] = new Rect(0, r.x, s.y - (n + r.height), r.width, r.height);
                            u[2] = new Rect(0, s.right + n, t, r.width, r.height);
                            u[3] = new Rect(0, r.x, s.bottom + n, r.width, r.height);
                            var v = -1;
                            var w = 0;
                            for (var x = 0; x < u.length; x++) {
                                var y = new Rect(0, a.x, a.y, a.width, a.height);
                                y.intersect(u[x]);
                                if (y.isEmpty == false) {
                                    var z = y.width * y.height;
                                    if (z > w) {
                                        v = x;
                                        w = z;
                                    }
                                }
                            }
                            if (v >= 0) {
                                r = u[v];
                            }
                        }
                    }
                }
                this.bz(r);
            }
        }
    };
    SpreadsheetAreaLayoutManager.prototype.b1 = function (a) {
        var b = a.x;
        var c = a.y;
        var d = this.be;
        var e = this.f.e.count;
        for (var f = 0; f < this.ao.count; f++) {
            var g = intDivide(f, e);
            var h = f % e;
            var i = this.g.e.item(g);
            var j = this.f.e.item(h);
            var k = new Rect(0, b, c, j.actualExtent, i.actualExtent);
            this.ao._inner[f].c = k;
            this.b0(SpreadsheetPane.$, this.ao._inner[f].b, k);
            if (h == e - 1) {
                b = a.x;
                c += i.actualExtent + this.m._d3;
            }
            else {
                b += j.actualExtent + this.m._d4;
            }
        }
    };
    SpreadsheetAreaLayoutManager.prototype.b3 = function (a, b, c, d, e, f, g, h) {
        var i = a.a;
        if (i == null) {
            return;
        }
        var j = a.e;
        var k = getEnumerator((j || boxArray$1(new Array(0))));
        var l = i.e.getEnumerator();
        var m = 0;
        var n = b ? new Rect(0, d.width - e, f, e, 0) : new Rect(0, f, d.height - e, 0, e);
        var o = c;
        while (k.moveNext()) {
            l.moveNext();
            var p = l.current.b;
            var q = k.current;
            var r = q.actualExtent;
            if (p != null) {
                r = Math.max(r + o - f, 0);
                o = 0;
                if (b) {
                    n.height = r;
                }
                else {
                    n.width = r;
                }
                this.b2(p, n);
                if (b) {
                    n.y += r + this.m._d3;
                }
                else {
                    n.x += r + this.m._d4;
                }
                f = 0;
            }
            else {
                o += r;
            }
            m++;
        }
        if (m == 0 && g != null) {
            var s = b ? d.height : d.width;
            o -= h;
            s = Math.max(s + o - f, 0);
            o = 0;
            if (b) {
                n.height = s;
            }
            else {
                n.width = s;
            }
            this.b2(g, n);
        }
    };
    SpreadsheetAreaLayoutManager.prototype.av = function (a, b) {
        var _this = this;
        return {
            ret: ((function () { var c = _this.aw(_this.au, a, b); a = c.p1; b = c.p2; return c.ret; })()),
            p0: a,
            p1: b
        };
    };
    SpreadsheetAreaLayoutManager.prototype.aw = function (a, b, c) {
        this.au = a;
        b = 0;
        c = a;
        var d = 0;
        if (this.g != null && this.g.e.count > 0) {
            c = this.g.g;
        }
        if (this.ag) {
            if (this.f.e != null) {
                for (var e = 0; e < this.f.e.count; e++) {
                    var f = this.f.e.item(e);
                    c += f.actualExtent;
                    if (e > 0) {
                        c += this.m._d4;
                    }
                    if (this.f.a != null && this.f.a.e.item(e).b != null) {
                        break;
                    }
                }
            }
            if (this.ah) {
                b = this.bc;
                c = Math.max(c - b, 0);
            }
            d = this.p._a1 / 1000 * c;
        }
        return {
            ret: d,
            p1: b,
            p2: c
        };
    };
    SpreadsheetAreaLayoutManager.prototype.cc = function () {
        if (this.d != 0) {
            var a = this.d;
            this.d = 0;
            if (this.g.d) {
                this.g.d = false;
                this.d4(true);
            }
            if (this.f.d) {
                this.f.d = false;
                this.d4(false);
            }
            this.cd();
            this.di(a, 0);
        }
    };
    SpreadsheetAreaLayoutManager.prototype.ce = function () {
        if (this.y != null) {
            this.y.c();
            this.y = null;
        }
    };
    SpreadsheetAreaLayoutManager.prototype.cq = function (a) {
        var e_30, _0, e_31, _1;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this.g.a.e)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var b = _3.value;
                if (b.b != null) {
                    a(b.b);
                }
            }
        }
        catch (e_30_1) { e_30 = { error: e_30_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_30) throw e_30.error; }
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this.f.a.e)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var c = _5.value;
                if (c.b != null) {
                    a(c.b);
                }
            }
        }
        catch (e_31_1) { e_31 = { error: e_31_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_31) throw e_31.error; }
        }
        if (this.s != null) {
            a(this.s);
        }
        if (this.t != null) {
            a(this.t);
        }
    };
    SpreadsheetAreaLayoutManager.prototype.j = function () {
        if (this.b == null) {
            return SpreadsheetCellRange.empty;
        }
        if (this.b.isInEditMode) {
            return this.b._ai.p;
        }
        return this.b._am;
    };
    SpreadsheetAreaLayoutManager.prototype.l = function () {
        if (this.b == null) {
            return null;
        }
        if (this.b.isInEditMode) {
            return this.b._ai.t;
        }
        return this.b._a5;
    };
    SpreadsheetAreaLayoutManager.prototype.ax = function () {
        this.m._jn(this.m._jo);
        return this.f.h + this.aq + 2;
    };
    SpreadsheetAreaLayoutManager.prototype.a2 = function (a) {
        return 0;
    };
    SpreadsheetAreaLayoutManager.prototype.a3 = function (a) {
        return 0;
    };
    SpreadsheetAreaLayoutManager.prototype.k = function (a) {
        var b = this.ej(a);
        var _loop_5 = function (c) {
            var d = this_3.ao._inner[c];
            var e = this_3.eq(SpreadsheetPane.$, d.b);
            if (e.containsPoint(b)) {
                var f_3 = d.a;
                var g_4 = this_3.ek(d, b);
                var h_3 = new WorksheetItemPosition();
                if (!((function () { var i = f_3.rowScrollRegion._az(g_4.y / f_3.rowScrollRegion._bx, h_3); h_3 = i.p1; return i.ret; })())) {
                    return { value: null };
                }
                var i = h_3._j;
                if (!((function () { var j = f_3.columnScrollRegion._az(g_4.x / f_3.columnScrollRegion._bx, h_3); h_3 = j.p1; return j.ret; })())) {
                    return { value: null };
                }
                var j = h_3._j;
                return { value: new SpreadsheetCellHitTestResult(new SpreadsheetCell(i, j), f_3) };
            }
        };
        var this_3 = this;
        for (var c = 0; c < this.ao.count; c++) {
            var state_4 = _loop_5(c);
            if (typeof state_4 === "object")
                return state_4.value;
        }
        var _loop_6 = function (k) {
            var l = k == 0;
            var m = l ? this_4.g : this_4.f;
            if (m != null) {
                var _loop_7 = function (n) {
                    var o = m.f._inner[n];
                    var p = this_4.eq(SpreadsheetScrollRegion.$, o.b);
                    if (p.containsPoint(b)) {
                        var q_1 = o.a;
                        var r_1 = this_4.el(o, b);
                        var s_1 = new WorksheetItemPosition();
                        if (!((function () { var t = q_1._az((l ? r_1.y : r_1.x) / q_1._bx, s_1); s_1 = t.p1; return t.ret; })())) {
                            return { value: null };
                        }
                        return { value: new SpreadsheetHeaderHitTestResult(s_1._j, q_1) };
                    }
                };
                for (var n = 0; n < m.f.count; n++) {
                    var state_6 = _loop_7(n);
                    if (typeof state_6 === "object")
                        return state_6;
                }
            }
        };
        var this_4 = this;
        for (var k = 0; k < 2; k++) {
            var state_5 = _loop_6(k);
            if (typeof state_5 === "object")
                return state_5.value;
        }
        return null;
    };
    SpreadsheetAreaLayoutManager.prototype.cs = function () {
        if (!this.ab) {
            return;
        }
        var a = this.m != null ? this.m._fu : null;
        this.ai = a != null;
        if (!this.ai) {
            this.cr();
        }
        else {
            this.d9(a.d, a.c);
        }
    };
    SpreadsheetAreaLayoutManager.prototype.dg = function (a) {
    };
    SpreadsheetAreaLayoutManager.prototype.ew = function (a) {
        var _this = this;
        this.dg(a);
        var b = new Size(0);
        this.et = new Size(1, a.width, a.height);
        var c = this.m;
        if (c != null) {
            c._i5();
        }
        var d = c != null ? c._bc.workbook : null;
        {
            var e = Workbook._fc(d);
            try {
                var f = void 0, g = void 0;
                if (c != null) {
                    g = c._ca;
                    f = c._ce;
                }
                else if (this.o != null && this.o._y != null) {
                    f = (this.o._y.windowOptions.scrollBars & 2) != 0;
                    g = (this.o._y.windowOptions.scrollBars & 1) != 0;
                }
                else {
                    f = g = false;
                }
                if (f == false) {
                    var h = this.d0(this.g, this.t);
                    this.t = h.p1;
                }
                else {
                    var i = this.c6(this.g, this.t);
                    this.t = i.p1;
                }
                if (g == false) {
                    var j = this.d0(this.f, this.s);
                    this.s = j.p1;
                }
                else {
                    var k = this.c6(this.f, this.s);
                    this.s = k.p1;
                }
                var l = this.g.i;
                var m = this.f.i;
                var n = new Size(1, a.width, a.height);
                if (c != null && c._ce) {
                    n.width = Math.max(n.width - l, 0);
                }
                var o = new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);
                var p = this.o != null && this.o._ah;
                if (p != this.ag) {
                    this.ag = p;
                    if (!p) {
                        this.d7();
                    }
                    else {
                        this.co();
                    }
                }
                if (this.ag) {
                    if (m > 0) {
                        m += this.w.d;
                    }
                    this.dd(o);
                    m = Math.max(m, this.ba);
                }
                var q = p;
                if (q != this.af) {
                    this.af = q;
                    if (!q) {
                        this.d6();
                    }
                    else {
                        this.cn();
                    }
                }
                if (this.af) {
                    this.dc(o);
                }
                var r = p || g;
                if (r != this.ae) {
                    this.ae = r;
                    if (!r) {
                        this.d5();
                    }
                    else {
                        this.cm();
                    }
                }
                if (this.ae) {
                    this.db(o);
                }
                var s = p && g;
                if (s != this.ah) {
                    this.ah = s;
                    if (!s) {
                        this.d8();
                    }
                    else {
                        this.cp();
                    }
                }
                if (this.ah) {
                    this.de(o);
                    m = Math.max(m, this.bb);
                }
                this.aq = m;
                if (g || p) {
                    n.height = Math.max(n.height - m, 0);
                }
                var t = this.a6(this.f);
                var u = this.a6(this.g);
                if (c != null) {
                    c._d4 = t;
                    c._d3 = u;
                }
                var v = this.f.c && this.g.c;
                if (v != this.ad) {
                    this.ad = v;
                    if (!v) {
                        this.d3();
                    }
                    else {
                        this.ck();
                    }
                }
                if (this.ad) {
                    this.c9(new Size(1, c._d4, c._d3));
                }
                var w = c != null && c._bc.displayOptions.showRowAndColumnHeaders;
                var x = c != null && w ? c._al._j.x(c._bc, c._d1) : 0;
                this.f.h = x;
                var y = Math.max(n.height - x, 0);
                var z = c != null ? c._eh(y) : 0;
                var aa = c != null && w ? c._al._j.ab(z, c._bc, c._d0) : 0;
                this.g.h = aa;
                this.f.g = this.f.h;
                this.g.g = this.g.h;
                if (c != null) {
                    c._dx = this.f.g;
                    c._d2 = this.g.g;
                    c._dn.item(0)._bv = c._dn.item(0)._v == 2 ? this.f.g : 0;
                    c._dh.item(0)._bv = c._dh.item(0)._v == 2 ? this.g.g : 0;
                }
                n.height = Math.max(n.height - this.f.g, 0);
                n.width = Math.max(n.width - this.g.g, 0);
                var ab = c != null ? c._jn(n) : new Size(0);
                b.width += ab.width + l + this.g.h;
                b.height += ab.height + m + this.f.h;
                this.c4();
                this.a5(this.f);
                this.a5(this.g);
                var ac = this.f.f.count > 0 && this.g.f.count > 0;
                if (ac != this.ac) {
                    this.ac = ac;
                    if (!ac) {
                        this.d1();
                    }
                    else {
                        this.ci();
                    }
                }
                if (this.ac) {
                    this.c7(new Size(1, this.g.h, this.f.h));
                }
                this.c1(a);
                if (this.ag) {
                    var ad_1, ae_1;
                    var af_1 = isInfinity(a.width) ? 0 : Math.max(a.width - l, 0);
                    var ag = ((function () { var ah = _this.aw(af_1, ad_1, ae_1); ad_1 = ah.p1; ae_1 = ah.p2; return ah.ret; })());
                    if (this.o != null) {
                        this.o._as = Math.max(ag - this.bd, 0);
                    }
                    if (this.bd > ag) {
                        this.dd(new Size(1, ag, Number.POSITIVE_INFINITY));
                    }
                }
                if (!this.ab) {
                    this.ab = true;
                    this.ch();
                }
                this.cs();
                this.c2(o);
            }
            finally {
                if (e != null) {
                    e.dispose();
                }
            }
        }
        return b;
    };
    SpreadsheetAreaLayoutManager.prototype.c1 = function (a) {
        if (!this.z) {
            this.z = true;
            this.cf();
        }
        var b = this.l();
        var c = new Size(0);
        if (b != null) {
            var d = this.b.isInEditMode;
            var e = this.j();
            var f = 1 / this.x.d;
            var g = b.rowScrollRegion._bx;
            var h = b.columnScrollRegion.actualExtent;
            var i = b.rowScrollRegion.actualExtent;
            var j = b.columnScrollRegion._bn(e.firstColumn, true);
            var k = b.rowScrollRegion._bn(e.firstRow, true);
            var l = b.columnScrollRegion._bn(e.lastColumn, false);
            var m = b.rowScrollRegion._bn(e.lastRow, false);
            if (d) {
                var n = this.bt(b, g, h, this.b._ai.al(), f, j, l);
                j = n.p5;
                l = n.p6;
            }
            var o = Math.max(Math.min(l - j, (h - (j * g)) / g) - f, 0);
            var p = Math.max((i - (k * g)) / g - f, 0);
            c.width = o;
            c.height = p;
        }
        this.cz(c);
        if (!this.aa) {
            this.aa = true;
            this.cg();
        }
        this.c0(new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY));
    };
    SpreadsheetAreaLayoutManager.prototype.a5 = function (a) {
        var e_32, _0;
        var b = a.e;
        var c = b.count;
        var d = a.f;
        var e = this.m != null && this.m._bc.displayOptions.showRowAndColumnHeaders;
        var f = a.b;
        var g = 0;
        this.eg(SpreadsheetScrollRegion.$, e ? b : boxArray$1(new Array(0)), d, function (h) {
        }, function (h) {
        }, runOn(this, this.q));
        if (c > 0) {
            var h = new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY);
            try {
                for (var _1 = tslib_1.__values(fromEnum(d)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var i = _2.value;
                    this.c3(SpreadsheetScrollRegion.$, i.b, h);
                }
            }
            catch (e_32_1) { e_32 = { error: e_32_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_32) throw e_32.error; }
            }
        }
        return g;
    };
    SpreadsheetAreaLayoutManager.prototype.c4 = function () {
        var e_33, _0;
        var a = this.m != null ? this.m._dl : boxArray$1(new Array(0));
        var b = this.ao;
        this.eg(SpreadsheetPane.$, a, b, function (c) { return c.a._ap = c.b; }, function (c) { return c.a._ap = null; }, runOn(this, this.r));
        if (this.m != null) {
            var c = this.be;
            try {
                for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    var e = d.a;
                    var f = new Size(1, e.columnScrollRegion.actualExtent, e.rowScrollRegion.actualExtent);
                    this.c3(SpreadsheetPane.$, d.b, f);
                }
            }
            catch (e_33_1) { e_33 = { error: e_33_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_33) throw e_33.error; }
            }
        }
    };
    SpreadsheetAreaLayoutManager.prototype.c6 = function (a, b) {
        var c = a.a;
        if (c == null) {
            c = a.a = new ScrollBarVisibilityCoordinator();
        }
        var d = a.e;
        var e = a.b;
        this.ef(d, c, e ? 1 : 0);
        var f = getEnumerator((d || boxArray$1(new Array(0))));
        var g = c.e.getEnumerator();
        var h = 0;
        var i = 0;
        var j = 0;
        while (f.moveNext()) {
            g.moveNext();
            var k = g.current.b;
            var l = f.current;
            var m = l.actualExtent;
            if (k != null) {
                var n = Math.max(m + i, 0);
                if (n == 0) {
                    n = Number.POSITIVE_INFINITY;
                }
                var o = e ? new Size(1, Number.POSITIVE_INFINITY, n) : new Size(1, n, Number.POSITIVE_INFINITY);
                this.c5(k, o);
                i = 0;
                j = Math.max(j, e ? this.a0(k) : this.az(k));
            }
            else {
                i += m;
            }
            h++;
        }
        if (h == 0) {
            if (b == null) {
                b = this.u(e ? 1 : 0);
                this.ct(b, null);
            }
            this.c5(b, new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY));
            j = Math.max(j, e ? this.a0(b) : this.az(b));
        }
        else {
            var p = this.dv(b);
            b = p.p0;
        }
        a.i = j;
        return {
            p1: b
        };
    };
    SpreadsheetAreaLayoutManager.prototype.a6 = function (a) {
        var b = a.e;
        var c = b.count > 1;
        if (c != a.c) {
            a.c = c;
            if (c) {
                this.cj(a.b);
            }
            else {
                this.d2(a.b);
            }
        }
        if (a.c) {
            this.cu(a.b, b.item(0)._v == 2, b.item(0), b.item(1));
            this.c8(a.b, new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY));
            if (a.d) {
                this.da(a.b, new Size(1, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY));
            }
            return this.a1(a.b);
        }
        else {
            return 0;
        }
    };
    SpreadsheetAreaLayoutManager.prototype.dh = function () {
        if (this.m != null) {
            this.m._bc._jg = null;
        }
    };
    SpreadsheetAreaLayoutManager.prototype.di = function (a, b) {
    };
    SpreadsheetAreaLayoutManager.prototype.dj = function (a) {
        this.as = a.x;
        this.at = a.y;
        if (this.d == 2) {
            var b = this.as;
            var c = this.at;
            if (this.as < this.en.x) {
                b = this.en.x;
            }
            else if (this.as > this.en.right) {
                b = this.en.right;
            }
            if (this.at < this.en.y) {
                c = this.en.y;
            }
            else if (this.at > this.en.bottom) {
                c = this.en.bottom;
            }
            this.as = b;
            this.at = c;
        }
        else if (this.d == 3) {
            var d = Math.max(Math.min(a.x - this.ei.x, this.ar), 0);
            var e = truncate(Math.max(Math.min(MathUtilities.f((d / this.ar) * 1000), 1000), 0));
            if (this.p != null && this.p._y != null) {
                this.p._y.windowOptions.tabBarWidth = e;
            }
        }
        this.cw();
    };
    SpreadsheetAreaLayoutManager.prototype.dk = function () {
        switch (this.d) {
            default:
            case 0:
            case 3:
                this.cc();
                break;
            case 1:
                this.dn();
                break;
            case 2:
                var a = SpreadsheetUtilities.e3(this.as - this.ei.x - this.en.x, this.at - this.ei.y - this.en.y);
                this.cc();
                if (this.m != null) {
                    this.m._bc._jg = a;
                }
                break;
        }
    };
    SpreadsheetAreaLayoutManager.prototype.ak = function (a, b, c) {
        this.ce();
        if (b.a() == 1) {
            this.a = a;
            if (b.e() == 2) {
                this.b._g2(a == 0 || a == 2, a == 1 || a == 2);
            }
            else if (!this.b._d7(true)) {
            }
            else {
                this.ei = b.h();
                this.as = c.x;
                this.at = c.y;
                if (b.d()) {
                    this.y = new TimedOperation(runOn(this, this.dr), SpreadsheetUtilities.cl);
                }
            }
            return true;
        }
        return false;
    };
    SpreadsheetAreaLayoutManager.prototype.al = function (a) {
        if (this.y != null) {
            var b = a.h();
            var c = this.ei;
            if (Math.abs(b.x - c.x) > 16 || Math.abs(b.y - c.y) > 16) {
                this.ec();
            }
            return true;
        }
        return false;
    };
    SpreadsheetAreaLayoutManager.prototype.dq = function (a) {
        this.ce();
    };
    SpreadsheetAreaLayoutManager.prototype.dp = function () {
        this.ce();
    };
    SpreadsheetAreaLayoutManager.prototype.dn = function () {
        var a = this.as;
        var b = this.at;
        var c = this.g.d;
        var d = this.f.d;
        var e = this.ep;
        var f = this.en;
        this.cc();
        if (!e.containsLocation(a, b)) {
            if (c && d) {
                return;
            }
            if (c && (b < e.y || b >= e.bottom)) {
                return;
            }
            if (d && (a < e.x || a >= e.right)) {
                return;
            }
        }
        var g = Nullable$1.toNullable(Number_$type, null);
        var h = Nullable$1.toNullable(Number_$type, null);
        if (c) {
            g = Nullable$1.toNullable(Number_$type, this.m._ei(true, b - f.y, f.height - this.m._d3, this.f.g));
        }
        if (d) {
            h = Nullable$1.toNullable(Number_$type, this.m._ei(false, a - f.x, f.width - this.m._d4, this.g.g));
        }
        var i = this.m._bc.displayOptions.unfrozenPaneSettings;
        if (nullableNotEquals(g, null)) {
            i.topPaneHeight = g.value;
        }
        if (nullableNotEquals(h, null)) {
            i.leftPaneWidth = h.value;
        }
    };
    SpreadsheetAreaLayoutManager.prototype.dr = function () {
        this.ec();
    };
    SpreadsheetAreaLayoutManager.prototype.dt = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (this.m != null && this.m._cl(a)) {
                    d = true;
                }
                else if (getInstanceType(a) == SpreadsheetUtilities.d5) {
                    d = true;
                }
                break;
            case "":
                if (a == this.m || typeCast(SpreadsheetScrollRegion.$, a) !== null) {
                    d = true;
                }
                break;
            case "Extent":
            case "IsFrozen":
                if (typeCast(SpreadsheetScrollRegion.$, a) !== null) {
                    d = true;
                }
                break;
            case "ActiveCellPane":
            case "HasHorizontalScrollBar":
            case "HasVerticalScrollBar":
            case "IsLayoutDirty":
            case "ZoomLevel":
            case "ActiveCellInputMessage":
                if (a == this.m) {
                    d = true;
                }
                break;
            case "ActiveCellInputMessagePosition":
                if (a == this.m) {
                    this.cw();
                }
                break;
            case "HasSingleSelectionWithAllRowsAndColumns":
                if (this.ac && a == this.m) {
                    this.cy();
                }
                break;
            case "Offset":
                if (typeCast(SpreadsheetScrollInfo.$, a) !== null) {
                    d = true;
                }
                break;
            case "IsVisible":
            case "Width":
            case "ScrollBars":
                if (a == this.o) {
                    d = true;
                }
                break;
            case "ActiveCellAsRange":
                if (typeCast(SpreadsheetSelection.$, a) !== null) {
                    if (this.z) {
                        d = true;
                    }
                    if (this.m != null && this.m._fu != null) {
                        this.cw();
                    }
                }
                break;
            case "SheetManager":
                if (a == this.b) {
                    this.n = a._a8;
                }
                break;
            case "IsInEditMode":
                if (a == this.b) {
                    d = true;
                }
                break;
        }
        if (d) {
            this.cx();
        }
    };
    SpreadsheetAreaLayoutManager.ds = function (a, b, c, d) {
        a.dt(b, c, d);
    };
    SpreadsheetAreaLayoutManager.prototype.dv = function (a) {
        if (a != null) {
            var b = a;
            a = null;
            this.dz(b);
        }
        return {
            p0: a
        };
    };
    SpreadsheetAreaLayoutManager.prototype.d0 = function (a, b) {
        var c = a.a;
        if (c != null) {
            var d = Enumerable.a(ScrollBarInfoMediator.$, c.e);
            for (var f = 0; f < d.length; f++) {
                var e = d[f];
                var g = e.b;
                c.h(e);
                e.k();
                if (g != null) {
                    this.dz(g);
                }
            }
            a.a = null;
            a.i = 0;
        }
        var h = this.dv(b);
        b = h.p0;
        return {
            p1: b
        };
    };
    SpreadsheetAreaLayoutManager.prototype.ea = function (a, b, c) {
        this.cc();
        var d = this.d;
        this.d = a;
        this.as = c.x;
        this.at = c.y;
        if (!this.am(b)) {
            this.cc();
        }
        if (this.d == a) {
            this.di(d, a);
        }
    };
    SpreadsheetAreaLayoutManager.prototype.eb = function (a, b) {
        this.ei = a;
        this.ea(2, 0, b);
    };
    SpreadsheetAreaLayoutManager.prototype.ec = function () {
        this.ed(this.a == 0 || this.a == 2, this.a == 1 || this.a == 2, SpreadsheetUtilities.e3(this.as, this.at));
    };
    SpreadsheetAreaLayoutManager.prototype.ed = function (a, b, c) {
        this.ce();
        if (a && !this.g.c) {
            a = false;
        }
        if (b && !this.f.c) {
            b = false;
        }
        if (a == false && b == false) {
            return;
        }
        if (a) {
            this.g.d = true;
            this.cl(true);
        }
        if (b) {
            this.f.d = true;
            this.cl(false);
        }
        var d = a ? b ? 16 : 15 : 14;
        this.ea(1, d, c);
    };
    SpreadsheetAreaLayoutManager.prototype.an = function (a, b) {
        if (this.b._de) {
            return false;
        }
        this.ei = a;
        var c;
        var d = this.av(c, this.ar);
        c = d.p0;
        this.ar = d.p1;
        this.ea(3, 18, b);
        return true;
    };
    SpreadsheetAreaLayoutManager.prototype.ee = function (a, b, c) {
        var e_34, _0;
        var d = b.e;
        var e = new List$1(IPlatformScrollBarAdapter_$type, 0);
        var f = a == null ? new Array(0) : Enumerable.a(SpreadsheetScrollRegion.$, a);
        var g = Enumerable.a(SpreadsheetScrollInfo.$, Enumerable.o(SpreadsheetScrollRegion.$, SpreadsheetScrollInfo.$, f, function (h) { return h._x; }));
        var h = new Dictionary$2(ScrollInfo.$, ScrollBarInfoMediator.$, 0);
        for (var i = d.count - 1; i >= 0; i--) {
            var j = d.item(i);
            var k = arrayIndexOf1(ScrollInfo.$, g, j.d);
            if (k >= 0 && (f[k].isFrozen == (j.b == null))) {
                h.item(j.d, j);
            }
            else {
                if (j.b != null) {
                    e.add(j.b);
                }
                j.k();
            }
            b.h(j);
        }
        var _loop_8 = function (l) {
            var m = g[l];
            var n;
            if (!((function () { var o = h.tryGetValue(m, n); n = o.p1; return o.ret; })())) {
                n = new ExtendedScrollBarInfoMediator(m);
                n.g = function () {
                };
                if (!f[l].isFrozen) {
                    var o = void 0;
                    if (e.count > 0) {
                        var p = e.count - 1;
                        o = e._inner[p];
                        e.removeAt(p);
                    }
                    else {
                        o = this_5.u(c);
                    }
                    n.b = o;
                    this_5.ct(o, m);
                }
            }
            b.f(n);
        };
        var this_5 = this;
        for (var l = 0; l < g.length; l++) {
            _loop_8(l);
        }
        try {
            for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var q = _2.value;
                this.dz(q);
            }
        }
        catch (e_34_1) { e_34 = { error: e_34_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_34) throw e_34.error; }
        }
    };
    SpreadsheetAreaLayoutManager.prototype.ef = function (a, b, c) {
        var d = b.e;
        if (a == null) {
            if (d.count == 0) {
                return;
            }
        }
        else {
            var e = getEnumerator(a);
            var f = d.getEnumerator();
            var g = false;
            do {
                var h = e.moveNext();
                var i = f.moveNext();
                if (h != i) {
                    g = true;
                }
                else if (!h) {
                    break;
                }
                else if (e.current._x != f.current.d) {
                    g = true;
                }
                else {
                    var j = f.current.b != null;
                    var k = !e.current.isFrozen;
                    if (j != k) {
                        g = true;
                    }
                }
            } while (!g);
            if (!g) {
                return;
            }
        }
        this.ee(a, b, c);
    };
    SpreadsheetAreaLayoutManager.prototype.eg = function ($t, a, b, c, d, e) {
        var f = a.count != b.count;
        var g = EqualityComparer$1.defaultEqualityComparerValue($t);
        if (!f) {
            for (var h = 0; h < b.count; h++) {
                if (!g.equalsC(b._inner[h].a, a.item(h))) {
                    f = true;
                    break;
                }
            }
        }
        if (f) {
            var i = Enumerable.z(SpreadsheetAreaLayoutManager_SheetLayerInfo$1.$.specialize($t), b);
            b.clear();
            var _loop_9 = function (j) {
                var k = i.i(function (l) { return g.equalsC(l.a, a.item(j)); });
                b.add(null);
                if (k >= 0) {
                    b._inner[j] = i._inner[k];
                    i.removeAt(k);
                }
            };
            for (var j = 0; j < a.count; j++) {
                _loop_9(j);
            }
            for (var l = 0; l < i.count; l++) {
                var m = i._inner[l];
                if (null != d) {
                    d(m);
                }
                this.dl($t, m.b);
            }
            for (var n = 0; n < a.count; n++) {
                if (b._inner[n] == null) {
                    var o = e(a.item(n));
                    b._inner[n] = new SpreadsheetAreaLayoutManager_SheetLayerInfo$1($t, a.item(n), o);
                    if (null != c) {
                        c(b._inner[n]);
                    }
                }
            }
        }
    };
    SpreadsheetAreaLayoutManager.prototype.eh = function () {
        this.n = this.b != null ? this.b._a8 : null;
    };
    SpreadsheetAreaLayoutManager.$t = markType(SpreadsheetAreaLayoutManager, 'SpreadsheetAreaLayoutManager');
    return SpreadsheetAreaLayoutManager;
}(Base));
export { SpreadsheetAreaLayoutManager };
/**
 * @hidden
 */
var VisualElementSpreadsheetAreaLayoutManager = /** @class */ (function (_super) {
    tslib_1.__extends(VisualElementSpreadsheetAreaLayoutManager, _super);
    function VisualElementSpreadsheetAreaLayoutManager(a) {
        var _this = _super.call(this) || this;
        _this.ez = null;
        _this.e2 = false;
        _this.e3 = false;
        _this.ez = a;
        return _this;
    }
    VisualElementSpreadsheetAreaLayoutManager.prototype.ey = function (a) {
        var e_35, _0;
        var b = a._aw ? this.i : this.h;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b.f)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                if (c.a == a) {
                    return c.b.e;
                }
            }
        }
        catch (e_35_1) { e_35 = { error: e_35_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_35) throw e_35.error; }
        }
        return null;
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.ex = function (a) {
        var e_36, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.ap)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                if (b.a == a) {
                    return b.b.e;
                }
            }
        }
        catch (e_36_1) { e_36 = { error: e_36_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_36) throw e_36.error; }
        }
        return null;
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.dg = function (a) {
        _super.prototype.dg.call(this, a);
        this.e3 = true;
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.df = function (a) {
        if (!this.e3) {
            this.ew(a);
        }
        _super.prototype.df.call(this, a);
        this.e2 = true;
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.cw = function () {
        this.ez.q = true;
        this.e2 = false;
        var a = this.c;
        if (a != null) {
            a.scheduleArrange();
        }
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.cx = function () {
        this.ez.q = true;
        this.e3 = false;
        this.e2 = false;
        var a = this.c;
        if (a != null) {
            a.scheduleArrange();
        }
    };
    VisualElementSpreadsheetAreaLayoutManager.prototype.e4 = function () {
        this.cx();
    };
    VisualElementSpreadsheetAreaLayoutManager.$t = markType(VisualElementSpreadsheetAreaLayoutManager, 'VisualElementSpreadsheetAreaLayoutManager', SpreadsheetAreaLayoutManager.$);
    return VisualElementSpreadsheetAreaLayoutManager;
}(SpreadsheetAreaLayoutManager));
export { VisualElementSpreadsheetAreaLayoutManager };
/**
 * @hidden
 */
var JsSpreadsheetAreaLayoutManager = /** @class */ (function (_super) {
    tslib_1.__extends(JsSpreadsheetAreaLayoutManager, _super);
    function JsSpreadsheetAreaLayoutManager(a) {
        var _this = _super.call(this, a) || this;
        _this.fc = null;
        _this.fn = new Size(0);
        _this.fb = null;
        _this.fd = null;
        _this.fh = null;
        _this.ff = null;
        _this.fe = null;
        _this.e6 = null;
        _this.e5 = null;
        _this.fg = null;
        _this.fi = null;
        _this.e9 = null;
        _this.e7 = null;
        _this.e8 = null;
        return _this;
    }
    JsSpreadsheetAreaLayoutManager.prototype.fa = function (a) {
        if (a != null) {
            a.ab = true;
        }
        return null;
    };
    JsSpreadsheetAreaLayoutManager.prototype.cf = function () {
        this.fc = new SpreadsheetInplaceEditorElement(this.ez);
        this.fc.bu = 1000;
        var a = this.fc;
        a.cellValueChanged = delegateCombine(a.cellValueChanged, runOn(this, this.fl));
    };
    JsSpreadsheetAreaLayoutManager.prototype.fl = function (a, b) {
        this.c._ai.ar();
        this.cx();
    };
    JsSpreadsheetAreaLayoutManager.prototype.dw = function () {
        this.fc = this.fa(this.fc);
    };
    JsSpreadsheetAreaLayoutManager.prototype.cz = function (a) {
        this.fn.width = a.width;
        this.fn.height = a.height;
    };
    JsSpreadsheetAreaLayoutManager.prototype.bv = function (a, b) {
        var c = this.be;
        var d = a.copy();
        d.width *= c;
        d.height *= c;
        if (b.containsRect(d)) {
            this.fc.am(d);
            this.fc.de = null;
        }
        else {
            if (b.intersectsWith(d)) {
                this.fc.am(d);
                d.intersect(b);
                this.fc.de = d;
            }
            else {
                if (d.bottom < b.y) {
                    d.y = b.y;
                    d.height = 0;
                }
                if (d.y > b.bottom) {
                    d.y = b.bottom;
                    d.height = 0;
                }
                if (d.right < b.x) {
                    d.x = b.x;
                    d.width = 0;
                }
                if (d.x > b.right) {
                    d.x = b.right;
                    d.width = 0;
                }
                this.fc.am(d);
                this.fc.de = Rect.empty;
            }
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.ay = function () {
        var a = this.c._ai.l;
        if (a == null) {
            return 0;
        }
        var b = this.be;
        var c = this.fn.width;
        var d = truncate((Math.ceil(c * b)));
        var e = this.c._ay;
        var f = e.c9;
        var g = e.dg.e + e.dg.b;
        var h = this.c._a0.g(f, e.ci, e.dg, b, d);
        h -= g;
        h /= b;
        h += g;
        return h;
    };
    JsSpreadsheetAreaLayoutManager.prototype.cg = function () {
        this.fb = new SpreadsheetInplaceBackgroundElement(this.ez);
        this.fb.bu = 900;
    };
    JsSpreadsheetAreaLayoutManager.prototype.dx = function () {
        this.fb = this.fa(this.fb);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c0 = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.bw = function (a, b) {
        var c = a.copy();
        this.fb.am(c);
        if (b.containsRect(c)) {
            this.fb.cn = null;
        }
        else {
            c.intersect(b);
            this.fb.cn = c;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.get_e0 = function () {
        return this.fc;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "e0", {
        get: function () {
            return this.get_e0();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.ch = function () {
        this.fd = new SpreadsheetInputMessageElement(this.ez);
        this.fd.bu = 800;
        this.fd.ac = false;
    };
    JsSpreadsheetAreaLayoutManager.prototype.dy = function () {
        this.fd = this.fa(this.fd);
    };
    JsSpreadsheetAreaLayoutManager.prototype.bz = function (a) {
        this.fd.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c2 = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.cr = function () {
        this.fd.ac = false;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d9 = function (a, b) {
        this.fd.cm(b, a);
        this.fd.ac = true;
    };
    JsSpreadsheetAreaLayoutManager.prototype.get_a8 = function () {
        return this.fd.cj;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "a8", {
        get: function () {
            return this.get_a8();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.get_a7 = function () {
        return this.fd.ci;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "a7", {
        get: function () {
            return this.get_a7();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.eq = function ($t, a) {
        var b = a;
        var c = b.e;
        return new Rect(0, c.ax, c.a2, c.a3, c.av);
    };
    JsSpreadsheetAreaLayoutManager.prototype.q = function (a) {
        var b = a._aw ? "SpreadsheetRowHeaderContainer" : "SpreadsheetColumnHeaderContainer";
        var c = this.ez.c(b);
        var d = null;
        if (c != null) {
            c.ab = false;
            d = c.b(0);
            this.fm(SpreadsheetScrollRegion.$, d);
        }
        else {
            c = new SpreadsheetLayerContainerElement$1(SpreadsheetScrollRegion.$, this.ez, b);
            c.bu = 200;
        }
        if (d == null) {
            d = new RendererLayerVisualElement$2(SpreadsheetScrollRegion.$, ISpreadsheetGraphics_$type, c, "SpreadsheetRenderer");
        }
        this.fj(SpreadsheetScrollRegion.$, d, new SpreadsheetHeaderBackgroundLayer(a, new RendererLayerVisualElementView$1(SpreadsheetScrollRegion.$, d)));
        this.fj(SpreadsheetScrollRegion.$, d, new SpreadsheetHeaderGridlineLayer(a, new RendererLayerVisualElementView$1(SpreadsheetScrollRegion.$, d)));
        this.fj(SpreadsheetScrollRegion.$, d, new SpreadsheetHeaderContentLayer(a, new RendererLayerVisualElementView$1(SpreadsheetScrollRegion.$, d)));
        this.fj(SpreadsheetScrollRegion.$, d, new SpreadsheetHeaderSelectionLayer(a, new RendererLayerVisualElementView$1(SpreadsheetScrollRegion.$, d)));
        var e = new ScrollRegionLayerContainer(c, a);
        c.cg = e.d;
        return e;
    };
    JsSpreadsheetAreaLayoutManager.prototype.fm = function ($t, a) {
        var e_37, _0;
        var b = new List$1(RendererElementLayer$2.$.specialize($t, ISpreadsheetGraphics_$type), 1, a.cp());
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                a.cs(c);
                c.dispose();
                c._d.detach(c);
            }
        }
        catch (e_37_1) { e_37 = { error: e_37_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_37) throw e_37.error; }
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.fj = function ($t, a, b) {
        b._d.attach(b);
        a.cr(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.r = function (a) {
        var b = this.ez.c("SpreadsheetPaneContainer");
        var c = null;
        var d = null;
        var e = null;
        var f = null;
        var g = null;
        var h = null;
        if (b != null) {
            b.ab = false;
            c = b.b(0);
            d = b.b(1).cf;
            e = b.b(2);
            f = b.b(3).cf;
            g = b.b(4).cf;
            h = b.b(5).cf;
            this.fm(SpreadsheetPane.$, c);
            d.d();
            this.fm(SpreadsheetPane.$, e);
            f.d();
            g.d();
            h.d();
        }
        else {
            b = new SpreadsheetLayerContainerElement$1(SpreadsheetPane.$, this.ez, "SpreadsheetPaneContainer");
            c = new RendererLayerVisualElement$2(SpreadsheetPane.$, ISpreadsheetGraphics_$type, b, "SpreadsheetRenderer");
            d = new SpreadsheetCellValueLayerElement(b).cf;
            e = new RendererLayerVisualElement$2(SpreadsheetPane.$, ISpreadsheetGraphics_$type, b, "SpreadsheetRenderer");
            f = new SpreadsheetSingleLayerElement(b, "Layer").cf;
            g = new SpreadsheetDrawingLayerElement(b).cf;
            h = new SpreadsheetDrawingLayerElement(b).cf;
        }
        this.fj(SpreadsheetPane.$, c, new SpreadsheetPaneCellBackgroundLayer(a, new RendererLayerVisualElementView$1(SpreadsheetPane.$, c)));
        this.fj(SpreadsheetPane.$, c, new SpreadsheetPaneGridlineLayer(a, new RendererLayerVisualElementView$1(SpreadsheetPane.$, c)));
        d.attach(new SpreadsheetPaneCellValueLayer(a, d));
        this.fj(SpreadsheetPane.$, e, new SpreadsheetPaneCellBorderLayer(a, new RendererLayerVisualElementView$1(SpreadsheetPane.$, e)));
        this.fj(SpreadsheetPane.$, e, new SpreadsheetPaneButtonLayer(a, new RendererLayerVisualElementView$1(SpreadsheetPane.$, e)));
        this.fj(SpreadsheetPane.$, e, new SpreadsheetPaneSelectionLayer(a, new RendererLayerVisualElementView$1(SpreadsheetPane.$, e)));
        f.attach(new SpreadsheetPaneShapeLayer(a, f));
        g.attach(new SpreadsheetPaneInvalidDataLayer(a, g));
        h.attach(new SpreadsheetPaneInteractionOverlayLayer(a, h));
        var i = new PaneLayerContainer(b, a);
        b.cg = i.d;
        return i;
    };
    JsSpreadsheetAreaLayoutManager.prototype.dl = function ($t, a) {
        var b = a;
        this.fa(b.e);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c3 = function ($t, a, b) {
        var c = a;
        c.f(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b0 = function ($t, a, b) {
        var c = a;
        c.e.am(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.u = function (a) {
        var b = new JsScrollBarAdapter(new JsScrollBar(a, this.ez));
        var c = b.a.a;
        c.bu = 300;
        this.fk(c);
        return b;
    };
    JsSpreadsheetAreaLayoutManager.prototype.fk = function (a) {
        var b = a.cl == 0;
        var c = this.c._a1;
        a.h = b ? c.d : c.e;
        if (b) {
            a.cg.a3 = c.q;
            a.cf.a3 = c.p;
        }
        else {
            a.cg.av = c.ak;
            a.cf.av = c.aj;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.dz = function (a) {
        var b = a;
        b.d();
    };
    JsSpreadsheetAreaLayoutManager.prototype.ct = function (a, b) {
        a.setIsEnabled(b != null);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b2 = function (a, b) {
        var c = a;
        c.a.a.am(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c5 = function (a, b) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.a0 = function (a) {
        return this.c._a1.s;
    };
    JsSpreadsheetAreaLayoutManager.prototype.az = function (a) {
        return this.c._a1.r;
    };
    JsSpreadsheetAreaLayoutManager.prototype.ci = function () {
        this.fh = new SpreadsheetSelectAllButtonElement(this.ez);
        this.fh.bu = 100;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d1 = function () {
        this.fh = this.fa(this.fh);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b4 = function (a) {
        this.fh.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c7 = function (a) {
        this.cy();
    };
    JsSpreadsheetAreaLayoutManager.prototype.cy = function () {
        if (this.fh != null) {
            this.fh.cg = this.n._cd;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.cu = function (a, b, c, d) {
        var e = a ? this.ff : this.fe;
        e.u = b;
    };
    JsSpreadsheetAreaLayoutManager.prototype.cj = function (a) {
        var b;
        if (a) {
            this.ff = b = new SpreadsheetPaneSplitterElement(this.ez, 0);
        }
        else {
            this.fe = b = new SpreadsheetPaneSplitterElement(this.ez, 1);
        }
        b.bu = 400;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d2 = function (a) {
        if (a) {
            this.ff = this.fa(this.ff);
        }
        else {
            this.fe = this.fa(this.fe);
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.b5 = function (a, b) {
        var c = a ? this.ff : this.fe;
        c.am(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c8 = function (a, b) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.a1 = function (a) {
        var b = a ? this.ff : this.fe;
        var c = this.c._a1;
        return b.u ? a ? c.t : c.v : a ? c.u : c.w;
    };
    JsSpreadsheetAreaLayoutManager.prototype.cl = function (a) {
        var b = new VisualElement(this.ez, a ? "RowSplitterPreview" : "ColSplitterPreview");
        b.bu = 600;
        b.w = false;
        if (a) {
            this.e6 = b;
        }
        else {
            this.e5 = b;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.d4 = function (a) {
        if (a) {
            this.e6 = this.fa(this.e6);
        }
        else {
            this.e5 = this.fa(this.e5);
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.b7 = function (a, b) {
        var c = a ? this.e6 : this.e5;
        c.am(b);
    };
    JsSpreadsheetAreaLayoutManager.prototype.da = function (a, b) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.cv = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.ck = function () {
        this.fg = new SpreadsheetPaneSplitterElement(this.ez, 2);
        this.fg.bu = 500;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d3 = function () {
        this.fg = this.fa(this.fg);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b6 = function (a) {
        this.fg.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.c9 = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.co = function () {
        this.fi = new SpreadsheetTabItemAreaElement(this.ez, "TabItemArea");
        this.fi.cm.cf.h = this.c._bf;
        this.fi.ch.ac = this.c.allowAddWorksheet;
        this.fi.bu = 330;
        this.fi.cq();
    };
    JsSpreadsheetAreaLayoutManager.prototype.d7 = function () {
        this.fi.cm.cf.h = null;
        this.fi = this.fa(this.fi);
    };
    JsSpreadsheetAreaLayoutManager.prototype.ca = function (a) {
        this.fi.al(a.x, a.y, a.width, a.height);
    };
    JsSpreadsheetAreaLayoutManager.prototype.dd = function (a) {
        this.fi.cm.cf.a8();
    };
    JsSpreadsheetAreaLayoutManager.prototype.get_ba = function () {
        var a = this.c._a1.y;
        if (this.fi.co > a) {
            a = this.fi.co;
        }
        return a;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "ba", {
        get: function () {
            return this.get_ba();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.get_bd = function () {
        var a = this.fi.cp;
        if (!this.fi.ch.ac) {
            a -= this.fi.ch.a3;
        }
        return a + this.fi.cm.cf.bb;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "bd", {
        get: function () {
            return this.get_bd();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.get_e1 = function () {
        return this.fi;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "e1", {
        get: function () {
            return this.get_e1();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.cp = function () {
        this.e9 = new SpreadsheetTabAreaSplitterElement(this.ez);
        this.e9.bu = 370;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d8 = function () {
        this.e9 = this.fa(this.e9);
    };
    JsSpreadsheetAreaLayoutManager.prototype.cb = function (a) {
        this.e9.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.de = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.get_bb = function () {
        return this.c._a1.z;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "bb", {
        get: function () {
            return this.get_bb();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.get_bc = function () {
        return this.c._a1.aa;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "bc", {
        get: function () {
            return this.get_bc();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.cm = function () {
        this.e7 = new VisualElement(this.ez, "TabAreaBackground");
        this.e7.bu = 225;
        this.e7.w = false;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d5 = function () {
        this.e7 = this.fa(this.e7);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b8 = function (a) {
        this.e7.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.db = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.cn = function () {
        this.e8 = new VisualElement(this.ez, "TabAreaBorder");
        this.e8.bu = 250;
        this.e8.w = false;
    };
    JsSpreadsheetAreaLayoutManager.prototype.d6 = function () {
        this.e8 = this.fa(this.e8);
    };
    JsSpreadsheetAreaLayoutManager.prototype.b9 = function (a) {
        this.e8.am(a);
    };
    JsSpreadsheetAreaLayoutManager.prototype.dc = function (a) {
    };
    JsSpreadsheetAreaLayoutManager.prototype.get_a9 = function () {
        return this.c._a1.x;
    };
    Object.defineProperty(JsSpreadsheetAreaLayoutManager.prototype, "a9", {
        get: function () {
            return this.get_a9();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetAreaLayoutManager.prototype.du = function (a, b) {
        this.cx();
        this.cw();
    };
    JsSpreadsheetAreaLayoutManager.prototype.dm = function (a, b) {
        this.cx();
        this.cw();
    };
    JsSpreadsheetAreaLayoutManager.prototype.cd = function () {
        this.ez.bw = null;
        this.ez.d().dk(this.ez);
    };
    JsSpreadsheetAreaLayoutManager.prototype.di = function (a, b) {
        _super.prototype.di.call(this, a, b);
        switch (a) {
            case 2:
                if (this.fd != null) {
                    this.fd.s = false;
                }
                break;
            case 3:
                if (this.e9 != null) {
                    this.e9.s = false;
                }
                break;
            case 1:
                if (this.ff != null) {
                    this.ff.s = false;
                }
                if (this.fe != null) {
                    this.fe.s = false;
                }
                if (this.fg != null) {
                    this.fg.s = false;
                }
                break;
        }
        switch (b) {
            case 2:
                if (this.fd != null) {
                    this.fd.s = true;
                }
                break;
            case 3:
                if (this.e9 != null) {
                    this.e9.s = true;
                }
                break;
            case 1:
                if (this.e6 != null) {
                    this.ff.s = true;
                }
                if (this.e5 != null) {
                    this.fe.s = true;
                }
                if (this.e6 != null && this.e5 != null) {
                    this.fg.s = true;
                }
                break;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.am = function (a) {
        if (this.ez.d().cq(this.ez)) {
            this.ez.bw = SpreadsheetCursorHelper.a(a);
            return true;
        }
        return false;
    };
    JsSpreadsheetAreaLayoutManager.prototype.ek = function (a, b) {
        var c = a.b.e;
        return { $type: Point_$type, x: b.x - (c.ax), y: b.y - (c.a2) };
    };
    JsSpreadsheetAreaLayoutManager.prototype.el = function (a, b) {
        var c = a.b.e;
        return { $type: Point_$type, x: b.x - (c.ax), y: b.y - (c.a2) };
    };
    JsSpreadsheetAreaLayoutManager.prototype.es = function (a, b) {
        var c = a.b.e;
        return new Rect(0, b.x + (c.ax), b.y + (c.a2), b.width, b.height);
    };
    JsSpreadsheetAreaLayoutManager.prototype.em = function (a, b) {
        var c = a.b.e;
        return { $type: Point_$type, x: b.x + (c.ax), y: b.y + (c.a2) };
    };
    JsSpreadsheetAreaLayoutManager.prototype.ej = function (a) {
        return { $type: Point_$type, x: a.x - this.ez.ax, y: a.y - this.ez.a2 };
    };
    JsSpreadsheetAreaLayoutManager.prototype.dt = function (a, b, c) {
        _super.prototype.dt.call(this, a, b, c);
        switch (b) {
            case "AllowAddWorksheet":
                if (this.fi != null) {
                    this.fi.ch.ac = this.c.allowAddWorksheet;
                }
                break;
            case "IsInEditMode":
                if (a == this.c) {
                    if (this.fc != null) {
                        this.fc.c3 = this.c.isInEditMode;
                        this.fc.cw = true;
                    }
                    if (this.fb != null) {
                        this.fb.cg = this.c._ai.x;
                    }
                }
                break;
        }
    };
    JsSpreadsheetAreaLayoutManager.prototype.e4 = function () {
        var _this = this;
        _super.prototype.e4.call(this);
        if (this.fi != null) {
            this.fi.cm.cf.bd();
            this.fi.cm.cf.aj();
            this.fi.cq();
        }
        this.cq(function (a) {
            var b = a.a.a;
            _this.fk(b);
            b.t = true;
        });
    };
    JsSpreadsheetAreaLayoutManager.$t = markType(JsSpreadsheetAreaLayoutManager, 'JsSpreadsheetAreaLayoutManager', VisualElementSpreadsheetAreaLayoutManager.$);
    return JsSpreadsheetAreaLayoutManager;
}(VisualElementSpreadsheetAreaLayoutManager));
export { JsSpreadsheetAreaLayoutManager };
/**
 * @hidden
 */
var SpreadsheetElementLayerContainer$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetElementLayerContainer$1, _super);
    function SpreadsheetElementLayerContainer$1($t, a, b) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this.e = null;
        _this.b = null;
        _this.d = null;
        _this.a = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        CoreUtilities.y(a);
        CoreUtilities.y(b);
        _this.e = a;
        _this.b = b;
        _this.d = _this.c();
        return _this;
    }
    SpreadsheetElementLayerContainer$1.prototype.f = function (a) {
        for (var b = 0, c = this.e.a9; b < c; b++) {
            var d = typeCast(LayerVisualElement.$, this.e.b(b));
            if (d != null) {
                d.cg(a);
            }
        }
    };
    SpreadsheetElementLayerContainer$1.prototype.focusControlIfNeeded = function () {
        var a = document.activeElement;
        var b = typeCast(SpreadsheetVisualElement.$, this.e.d());
        if (b != null && (a == null || b.dq._v.hasKeyboardFocusWithin)) {
            b.dq._v.focus();
        }
    };
    SpreadsheetElementLayerContainer$1.prototype.getRelativeSpreadsheetControlBounds = function () {
        return rectToLiteral(this._getRelativeSpreadsheetControlBounds$i.apply(this, arguments));
    };
    SpreadsheetElementLayerContainer$1.prototype._getRelativeSpreadsheetControlBounds$i = function () {
        var a = this.e.d();
        return new Rect(0, a.ax - this.e.ax, a.a2 - this.e.a2, a.a3, a.av);
    };
    SpreadsheetElementLayerContainer$1.prototype.getLayerContainerSize = function () {
        return sizeToLiteral(this._getLayerContainerSize$i.apply(this, arguments));
    };
    SpreadsheetElementLayerContainer$1.prototype._getLayerContainerSize$i = function () {
        return new Size(1, this.e.a3, this.e.av);
    };
    SpreadsheetElementLayerContainer$1.prototype.hideToolTip = function () {
        this.e.b0();
    };
    SpreadsheetElementLayerContainer$1.prototype.isMouseOver = function () {
        return this.e.y;
    };
    SpreadsheetElementLayerContainer$1.prototype.isToolTipAllowed = function () {
        return true;
    };
    SpreadsheetElementLayerContainer$1.prototype.onCursorChanged = function (a) {
        this.e.bw = SpreadsheetCursorHelper.a(a);
    };
    SpreadsheetElementLayerContainer$1.prototype.showToolTip = function (a) {
        this.e.ca(a.b.toString(), a.d.x, a.d.y, a.c);
    };
    SpreadsheetElementLayerContainer$1.$t = markType(SpreadsheetElementLayerContainer$1, 'SpreadsheetElementLayerContainer$1', Base.$, [ISpreadsheetInteractionManagerOwner_$type, IElementLayerContainer_$type]);
    return SpreadsheetElementLayerContainer$1;
}(Base));
export { SpreadsheetElementLayerContainer$1 };
/**
 * @hidden
 */
var PaneLayerContainer = /** @class */ (function (_super) {
    tslib_1.__extends(PaneLayerContainer, _super);
    function PaneLayerContainer(a, b) {
        return _super.call(this, SpreadsheetPane.$, a, b) || this;
    }
    PaneLayerContainer.prototype.c = function () {
        return new SpreadsheetPaneInteractionManager(this.b, this);
    };
    PaneLayerContainer.$t = markType(PaneLayerContainer, 'PaneLayerContainer', SpreadsheetElementLayerContainer$1.$.specialize(SpreadsheetPane.$));
    return PaneLayerContainer;
}(SpreadsheetElementLayerContainer$1));
export { PaneLayerContainer };
/**
 * @hidden
 */
var SpreadsheetRendererElementLayer$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetRendererElementLayer$1, _super);
    function SpreadsheetRendererElementLayer$1($tViewModel, a, b, c) {
        var _this = _super.call(this, $tViewModel, ISpreadsheetGraphics_$type, a, b, c) || this;
        _this.$tViewModel = null;
        _this.$tViewModel = $tViewModel;
        _this.$type = _this.$type.specialize(_this.$tViewModel);
        return _this;
    }
    SpreadsheetRendererElementLayer$1.$t = markType(SpreadsheetRendererElementLayer$1, 'SpreadsheetRendererElementLayer$1', RendererElementLayer$2.$.specialize(0, ISpreadsheetGraphics_$type));
    return SpreadsheetRendererElementLayer$1;
}(RendererElementLayer$2));
export { SpreadsheetRendererElementLayer$1 };
/**
 * Base class for the object that represents a row or column of [[SpreadsheetPane]] instances.
 */
var SpreadsheetScrollRegion = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetScrollRegion, _super);
    function SpreadsheetScrollRegion() {
        var _this = _super.call(this) || this;
        _this._w = null;
        _this._cd = 0;
        _this._ca = 0;
        _this._bb = 0;
        _this._bc = 0;
        _this._a3 = 0;
        _this._ao = false;
        _this._a6 = 0;
        _this._bd = 0;
        _this._k = null;
        _this._j = null;
        _this._p = null;
        _this._q = null;
        _this._u = 0;
        _this._by = null;
        _this._bz = null;
        _this._b1 = null;
        _this._b2 = null;
        _this._b3 = null;
        _this._be = 0;
        _this._a5 = 0;
        _this._a4 = 0;
        _this._a9 = 1;
        _this._ba = 1;
        _this._b0 = null;
        _this._ae = null;
        _this._aa = null;
        _this._y = null;
        _this._n = null;
        _this._cc = 0;
        _this._cb = 0;
        _this._ac = null;
        _this._ck = Nullable$1.toNullable(Number_$type, null);
        _this._g = null;
        _this._h = null;
        _this._cl = Nullable$1.toNullable(Number_$type, null);
        _this._a7 = 0;
        _this._cn = Nullable$1.toNullable(Number_$type, null);
        _this._cm = Nullable$1.toNullable(Number_$type, null);
        _this._an = true;
        _this._ah = 0;
        /**
         * @hidden
         */
        _this._bg = 0;
        /**
         * @hidden
         */
        _this._bh = 0;
        _this._a8 = 0;
        /**
         * @hidden
         */
        _this._ak = null;
        /**
         * @hidden
         */
        _this._am = null;
        /**
         * @hidden
         */
        _this._al = null;
        var a = PropertyChangeListenerList.e(SpreadsheetScrollInfo.$, _this._w, new SpreadsheetScrollInfo(_this), _this, false);
        _this._w = a.p0;
        var b = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(WorksheetItemPosition.$), _this._k, new ObservableCollectionExtended$1(WorksheetItemPosition.$, 2, false, false), _this, false);
        _this._k = b.p0;
        _this._l = _this._k;
        return _this;
    }
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype.e = function (sender, property, extraInfo) {
        switch (property != null ? property : "") {
            case "":
            case "Offset":
                if (sender == this._w) {
                    this._g = this._h = null;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (sender == this._k) {
                    this._g = this._h = null;
                }
                break;
        }
        _super.prototype.e.call(this, sender, property, extraInfo);
    };
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "actualExtent", {
        /**
         * Returns the actual displayed width or height of the area.
         */
        get: function () {
            return this._a3;
        },
        /**
         * Returns the actual displayed width or height of the area.
         */
        set: function (a) {
            if (this._a3 != a) {
                this._a3 = a;
                this.a("ActualExtent");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "endIndex", {
        /**
         * Returns the index of the last visible item including partially visible.
         */
        get: function () {
            return this._ca;
        },
        /**
         * Returns the index of the last visible item including partially visible.
         */
        set: function (a) {
            if (this._ca != a) {
                this._ca = a;
                this.a("EndIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "isFrozen", {
        /**
         * Returns a boolean indicating if the area supports scrolling.
         */
        get: function () {
            return this._ao;
        },
        /**
         * Returns a boolean indicating if the area supports scrolling.
         */
        set: function (a) {
            if (this._ao != a) {
                this._ao = a;
                this.a("IsFrozen");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "startIndex", {
        /**
         * Returns the index of the first visible item.
         */
        get: function () {
            return this._cd;
        },
        /**
         * Returns the index of the first visible item.
         */
        set: function (a) {
            if (this._cd != a) {
                this._cd = a;
                this.a("StartIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ab", {
        /**
         * @hidden
         */
        get: function () {
            return this._aa;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (a != this._aa) {
                var b = this._aa;
                var c = PropertyChangeListenerList.e(SpreadsheetSelection.$, this._aa, a, this, true);
                this._aa = c.p0;
                this.a("ActiveSelection");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_l", {
        /**
         * @hidden
         */
        get: function () {
            return this._j;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._j != a) {
                if (this._j != this._m && this._j != null) {
                    SpreadsheetUtilities.ec(this._j, this);
                }
                this._j = a;
                if (a != null && a != this._m) {
                    SpreadsheetUtilities.d6(this._j, this, true);
                }
                this.a("ActualItemPositions");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_z", {
        /**
         * @hidden
         */
        get: function () {
            return this._y;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._y != a) {
                this._y = a;
                this.a("AdjacentRowColumn");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ap", {
        /**
         * @hidden
         */
        get: function () {
            return this._an;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._an != a) {
                this._an = a;
                this.a("AreHeadersVisible");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b4", {
        /**
         * @hidden
         */
        get: function () {
            return this._by;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._by = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b5", {
        /**
         * @hidden
         */
        get: function () {
            return this._bz;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._bz = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_r", {
        /**
         * @hidden
         */
        get: function () {
            return this._p;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._p != a) {
                this._p = a;
                this.a("CurrentScrollPageCache");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bi", {
        /**
         * @hidden
         */
        get: function () {
            return this._a4;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._a4 != a) {
                this._a4 = a;
                this.a("DpiX");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bj", {
        /**
         * @hidden
         */
        get: function () {
            return this._a5;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._a5 != a) {
                this._a5 = a;
                this.a("DpiY");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bk", {
        /**
         * @hidden
         */
        get: function () {
            return this._a6;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._a6 = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b6", {
        /**
         * @hidden
         */
        get: function () {
            return this._b0;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._b0 != a) {
                this._b0 = a;
                this.a("GetHeaderText");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b7", {
        /**
         * @hidden
         */
        get: function () {
            return this._b1;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._b1 = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b8", {
        /**
         * @hidden
         */
        get: function () {
            return this._b2;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._b2 = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_b9", {
        /**
         * @hidden
         */
        get: function () {
            return this._b3;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._b3 = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_af", {
        /**
         * @hidden
         */
        get: function () {
            return this._ae;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._ae != a) {
                this._ae = a;
                this.a("HeaderFont");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_co", {
        /**
         * @hidden
         */
        get: function () {
            return this._ck;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (nullableNotEquals(this._ck, a)) {
                this._ck = a;
                this.a("HotTrackedIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_cp", {
        /**
         * @hidden
         */
        get: function () {
            return this._cl;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (nullableNotEquals(a, this._cl)) {
                this._cl = a;
                if (nullableEquals(this._cl, null)) {
                    this._l = this._m;
                }
                else {
                    var b = new ObservableCollectionExtended$1(WorksheetItemPosition.$, 0);
                    b._a3(this._m);
                    this._l = b;
                }
                this.a("ItemBeingResized");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bp", {
        /**
         * @hidden
         */
        get: function () {
            return this._a7;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._a7 != a) {
                this._a7 = a;
                this.a("ItemBeingResizedRelativeEdge");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_m", {
        /**
         * @hidden
         */
        get: function () {
            return this._k;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ch", {
        /**
         * @hidden
         */
        get: function () {
            return this._cb;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._cb != a) {
                this._cb = a;
                this.a("MaxItemExtent");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bq", {
        /**
         * @hidden
         */
        get: function () {
            return this._a8;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._a8 != a) {
                this._a8 = a;
                this.a("MaxScrollRangeExtent");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ci", {
        /**
         * @hidden
         */
        get: function () {
            return this._cc;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._cc != a) {
                this._cc = a;
                this.a("MaxItemIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_s", {
        /**
         * @hidden
         */
        get: function () {
            return this._q;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._q != a) {
                this._q = a;
                this.a("MaxScrollPageCache");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_cq", {
        /**
         * @hidden
         */
        get: function () {
            return this._cm;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (nullableNotEquals(this._cm, a)) {
                this._cm = a;
                this.a("NextVisibleItemIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_br", {
        /**
         * @hidden
         */
        get: function () {
            return this._a9;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._a9 != a) {
                this._a9 = a;
                this.a("PixelSizeX");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bs", {
        /**
         * @hidden
         */
        get: function () {
            return this._ba;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._ba != a) {
                this._ba = a;
                this.a("PixelSizeY");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bt", {
        /**
         * @hidden
         */
        get: function () {
            return this._bb;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._bb != a) {
                this._bb = a;
                this.a("PreferredExtent");
                this.a("PreferredExtentResolved");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bu", {
        /**
         * @hidden
         */
        get: function () {
            return Math.max(this._bb - this._bc, 0);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_cr", {
        /**
         * @hidden
         */
        get: function () {
            return this._cn;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (nullableNotEquals(this._cn, a)) {
                this._cn = a;
                this.a("PreviousVisibleItemIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bv", {
        /**
         * @hidden
         */
        get: function () {
            return this._bc;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._bc != a) {
                this._bc = a;
                this.a("ReservedExtent");
                this.a("PreferredExtentResolved");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ad", {
        /**
         * @hidden
         */
        get: function () {
            return this._ac;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (a != this._ac) {
                var b = this._ac;
                var c = PropertyChangeListenerList.e(ISpreadsheetResourceProvider_$type, this._ac, a, this, true);
                this._ac = c.p0;
                this.a("ResourceProvider");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_x", {
        /**
         * @hidden
         */
        get: function () {
            return this._w;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_ai", {
        /**
         * @hidden
         */
        get: function () {
            return this._ah;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._ah != a) {
                this._ah = a;
                this.a("SelectionMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_o", {
        /**
         * @hidden
         */
        get: function () {
            return this._n;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._n = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_v", {
        /**
         * @hidden
         */
        get: function () {
            return this._u;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._u != a) {
                this._u = a;
                this.a("SizingMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bw", {
        /**
         * @hidden
         */
        get: function () {
            return this._bd;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._bd = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollRegion.prototype, "_bx", {
        /**
         * @hidden
         */
        get: function () {
            return this._be;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (a != this._be) {
                this._be = a;
                this._g = null;
                this.a("ZoomLevel");
            }
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     */
    SpreadsheetScrollRegion._aq = function (a, b) {
        var c = null;
        if (b != null && b.count > 0) {
            c = function (d, e) {
                if (d._h < e) {
                    return -1;
                }
                else if (d._i > e) {
                    return 1;
                }
                else {
                    return 0;
                }
            };
            return CoreUtilities.n(IntRange.$, Number_$type, b, c, a) >= 0;
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._t = function (a) {
        var b = nullableEquals(a, this._ck);
        if (this._ar()) {
            if (this._as(a)) {
                if (this._ax(a)) {
                    return b ? 4 : 2;
                }
                else if (!b) {
                    return 1;
                }
            }
        }
        if (b) {
            return 3;
        }
        return 0;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._ag = function (a) {
        var b = new WorksheetItemPosition();
        var c = this._az(a, b);
        b = c.p1;
        return b;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._cf = function (a) {
        if (a >= this.startIndex && a <= this.endIndex) {
            for (var b = 0, c = this._k.count; b < c; b++) {
                if (this._k._inner[b]._j == a) {
                    return b;
                }
            }
        }
        return -1;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._aj = function (a) {
        var b = this.startIndex;
        var c = this.endIndex;
        if (a) {
            if (this._bk > 0 && c > b) {
                c--;
            }
            if (this._bw > 0 && b < c) {
                b++;
            }
        }
        return new IntRange(1, b, c);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._a1 = function (a) {
        if (a > this._ci) {
            return boxArray$1(new Array(0));
        }
        var b = this.actualExtent / this._bx;
        var c = this._b5(b);
        return this._b3(a, c);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._bl = function () {
        return this._b4(truncate(MathUtilities.f(this._w._ac)));
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._i = function (a, b) {
        if (b === void 0) { b = false; }
        var c = b ? this._j : this._k;
        var d = a ? this._g : this._h;
        if (c != this._k) {
            d = null;
        }
        if (d == null) {
            var e = c.count;
            if (e == 0) {
                d = new Array(0);
            }
            else {
                var f = a ? this._bx : 1;
                d = new Array(e + 1);
                for (var g = 0; g < e; g++) {
                    d[g] = this._bm(c._inner[g], true) * f;
                }
                d[e] = this._bm(c._inner[e - 1], false) * f;
                if (c == this._k) {
                    if (a) {
                        this._g = d;
                    }
                    else {
                        this._h = d;
                    }
                }
            }
        }
        return d;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._bm = function (a, b, c) {
        if (c === void 0) { c = true; }
        var d = a._m;
        if (!b) {
            d += a._i;
        }
        if (c) {
            d -= truncate(MathUtilities.f(this._w._ac));
        }
        return this._b4(d);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._bn = function (a, b, c) {
        if (c === void 0) { c = true; }
        var d = this._m.count;
        var e = this._m;
        var f = new WorksheetItemPosition();
        if (d == 0 || a < e._inner[0]._j || a > e._inner[d - 1]._j) {
            f = this._b7(a);
        }
        else {
            var g = CoreUtilities.n(WorksheetItemPosition.$, Number_$type, e, function (h, i) { return Base.compareSimple(h._j, i); }, a);
            if (g < 0) {
                b = true;
                g = ~g;
            }
            f = e._inner[g];
        }
        return this._bm(f, b, c);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._bo = function (a, b) {
        if (b <= 0) {
            return this._bn(a, true);
        }
        else if (b >= 100) {
            return this._bn(a, false);
        }
        else {
            var c = this._bn(a, true);
            var d = this._bn(a, false);
            return c + (d - c) * (b / 100);
        }
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._cg = function (a, b) {
        if (b >= this.startIndex && a <= this.endIndex) {
            for (var c = 0, d = this._k.count; c < d; c++) {
                var e = this._k._inner[c]._j;
                if (a <= e) {
                    return e <= b ? c : -1;
                }
            }
        }
        return -1;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._ar = function () {
        var a = this._a2();
        if (a != null && a.count > 0) {
            var b = a.item(0);
            var c = a.item(a.count - 1);
            return b._i <= this.endIndex && c._h >= this.startIndex;
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._as = function (a) {
        if (this._ai == 2) {
            return false;
        }
        var b = this._a2();
        return SpreadsheetScrollRegion._aq(a, b);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._au = function (a, b) {
        if (b === void 0) { b = false; }
        var c = b ? this._j : this._k;
        if (c.count > 0 && a < c.count) {
            if (a == c.count - 1) {
                var d = c._inner[c.count - 1]._j;
                if (nullableEquals(this._cm, null)) {
                    return d != this._ci;
                }
                return this._cm.value - d > 1;
            }
            return c._inner[a + 1]._j - c._inner[a]._j > 1;
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._av = function (a, b) {
        if (b === void 0) { b = false; }
        var c = b ? this._j : this._k;
        if (c.count > 0 && a < c.count) {
            if (a == 0) {
                if (nullableEquals(this._cn, null)) {
                    return c._inner[0]._j > 0;
                }
                return c._inner[0]._j - this._cn.value > 1;
            }
            return c._inner[a]._j - c._inner[a - 1]._j > 1;
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._ax = function (a) {
        if (this._ai == 2) {
            return false;
        }
        var b = this._a0();
        return SpreadsheetScrollRegion._aq(a, b);
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._ay = function (a) {
        return a == this._a0() || a == this._a2();
    };
    /**
     * @hidden
     */
    SpreadsheetScrollRegion.prototype._az = function (a, b) {
        var c = this._b4(truncate(MathUtilities.f(this._w._ac)));
        c += a;
        var d = this._b5(Math.max(c, 0));
        b = this._b8(d);
        return {
            ret: b._m <= d && d < b._l,
            p1: b
        };
    };
    SpreadsheetScrollRegion.$t = markType(SpreadsheetScrollRegion, 'SpreadsheetScrollRegion', PropertyChangeNotifierExtended.$);
    return SpreadsheetScrollRegion;
}(PropertyChangeNotifierExtended));
export { SpreadsheetScrollRegion };
/**
 * @hidden
 */
var SpreadsheetHeaderContentLayerBase$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderContentLayerBase$1, _super);
    function SpreadsheetHeaderContentLayerBase$1($tVisual, a, b, c) {
        var _this = _super.call(this, SpreadsheetScrollRegion.$, a, b, PredefinedSpreadsheetLayers.o) || this;
        _this.$tVisual = null;
        _this._x = null;
        _this._z = null;
        _this._u = null;
        _this._y = false;
        _this.$tVisual = $tVisual;
        _this.$type = _this.$type.specialize(_this.$tVisual);
        _this._y = c;
        _this._z = new Dictionary$2(Number_$type, SpreadsheetHeaderContentLayerBase_HeaderInfo$1.$.specialize(_this.$tVisual), 0);
        _this._x = new PropertyChangeListener$1(SpreadsheetHeaderContentLayerBase$1.$.specialize(_this.$tVisual), _this, runOn(_this, _this._af), false);
        SpreadsheetUtilities.d6(a, _this._x, true);
        return _this;
    }
    SpreadsheetHeaderContentLayerBase$1.prototype._g = function (a) {
        if (this._y) {
            _super.prototype._g.call(this, a);
        }
        var b = new Rect(0, 0, 0, a.width, a.height);
        var c = this._j;
        var d = c._bx;
        var e = c._aw;
        var f = 0;
        var g = 0;
        var h = a.width / d;
        var i = a.height / d;
        var j = c._i(false, true);
        var k = j.length - 1;
        var l = c._l;
        var m = c._ar();
        var n = c._ad;
        var o = 1;
        var p = 1;
        if (e) {
            g += p;
        }
        else {
            f += p;
        }
        var q = Math.max(h - f, 0);
        var r = Math.max(i - g - o, 0);
        for (var s = 0; s < k; s++) {
            var t = j[s];
            var u = j[s + 1];
            var v = l._inner[s];
            var w = this._z.item(v._j);
            if (e) {
                g = t + p;
                i = u + p;
                r = Math.max(i - g - o, 0);
            }
            else {
                f = t + p;
                h = u + p;
                q = Math.max(h - f, 0);
            }
            var x = c._t(v._j);
            if (w.c) {
                if (w.b != x) {
                    w.c = false;
                    w.b = x;
                    this._ab(c, w, v._j, c._b6(v._j));
                }
            }
            else {
                w.b = x;
            }
            if (w.e > q || w.d > r) {
                var y = Math.min(q, w.e);
                var z = Math.min(r, w.d);
                w.f(w.e / 2 - y / 2, w.d / 2 - z / 2, y, z);
            }
            else {
                w.g();
            }
            w.h(f + q / 2 - w.e / 2, g + r / 2 - w.d / 2);
            w.c = true;
        }
        return b;
    };
    SpreadsheetHeaderContentLayerBase$1.prototype._h = function (a) {
        var _this = this;
        var e_38, _0, e_39, _1;
        if (this._y) {
            _super.prototype._h.call(this, a);
        }
        var b = this._j;
        var c = new Size(0);
        var d = b._aw;
        var e = b._bx;
        if (b == null || b._l.count == 0) {
            this._ah();
            this._z.clear();
        }
        else {
            var f_4 = new Dictionary$2(Number_$type, SpreadsheetHeaderContentLayerBase_HeaderInfo$1.$.specialize(this.$tVisual), 3, this._z);
            this._z.clear();
            var _loop_10 = function (g) {
                var h;
                if (((function () { var i = f_4.tryGetValue(g._j, h); h = i.p1; return i.ret; })())) {
                    this_6._z.addItem(g._j, h);
                    f_4.removeItem(g._j);
                }
            };
            var this_6 = this;
            try {
                for (var _2 = tslib_1.__values(fromEnum(b._l)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var g = _3.value;
                    _loop_10(g);
                }
            }
            catch (e_38_1) { e_38 = { error: e_38_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_38) throw e_38.error; }
            }
            var i = Enumerable.z(this.$tVisual, Enumerable.o(SpreadsheetHeaderContentLayerBase_HeaderInfo$1.$.specialize(this.$tVisual), this.$tVisual, f_4.values, function (j) { return j.a; }));
            f_4.clear();
            var j = i.count - 1;
            var _loop_11 = function (k) {
                var l;
                if (!((function () { var m = _this._z.tryGetValue(k._j, l); l = m.p1; return m.ret; })()) || this_7._u == null) {
                    if (l == null) {
                        this_7._z.item(k._j, l = this_7._v());
                        if (j >= 0) {
                            l.a = i._inner[j];
                            i.removeAt(j--);
                        }
                        else {
                            l.a = this_7._t();
                        }
                    }
                    var m = k._j;
                    l.c = false;
                    this_7._ab(b, l, m, b._b6(m));
                }
                if (d) {
                    var n = l.e * e;
                    if (n > c.width) {
                        c.width = n;
                    }
                }
                else if (!d) {
                    var o = l.d * e;
                    if (o > c.height) {
                        c.height = o;
                    }
                }
            };
            var this_7 = this;
            try {
                for (var _4 = tslib_1.__values(fromEnum(b._l)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var k = _5.value;
                    _loop_11(k);
                }
            }
            catch (e_39_1) { e_39 = { error: e_39_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_39) throw e_39.error; }
            }
            for (var p = 0, q = i.count; p < q; p++) {
                this._ai(i._inner[p]);
            }
        }
        if (this._u == null) {
            this._u = this._v();
            this._ab(b, this._u, 100, b._b6(100));
        }
        if (d) {
            var r = this._u.e * e;
            if (r > c.width) {
                c.width = r;
            }
        }
        else if (!d) {
            var s = this._u.d * e;
            if (s > c.height) {
                c.height = s;
            }
        }
        if (d) {
            c.width += 3 * b._br;
        }
        else {
            c.height += 3 * b._bs;
        }
        if (d) {
            c.width += b._br;
        }
        else {
            c.height += b._bs;
        }
        var t = d ? c.width : c.height;
        return c;
    };
    SpreadsheetHeaderContentLayerBase$1.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._x);
        }
    };
    SpreadsheetHeaderContentLayerBase$1.prototype.get__m = function () {
        return 2;
    };
    Object.defineProperty(SpreadsheetHeaderContentLayerBase$1.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderContentLayerBase$1.prototype._q = function (a, b, c, d) {
    };
    SpreadsheetHeaderContentLayerBase$1.prototype.get__s = function () {
        return this._j._o.renderCache;
    };
    Object.defineProperty(SpreadsheetHeaderContentLayerBase$1.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetHeaderContentLayerBase$1.prototype, "_aa", {
        get: function () {
            return this._z.values;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderContentLayerBase$1._w = function ($tVisual, a, b) {
        var c;
        switch (b) {
            default:
            case 0:
                c = a ? 15 : 28;
                break;
            case 2:
                c = a ? 16 : 29;
                break;
            case 4:
                c = a ? 23 : 32;
                break;
            case 1:
                c = a ? 17 : 30;
                break;
            case 3:
                c = a ? 18 : 31;
                break;
        }
        return c;
    };
    SpreadsheetHeaderContentLayerBase$1.prototype._ag = function (a, b, c) {
        var d = false;
        var e = false;
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._j._l) {
                    e = d = true;
                }
                else if (this._j._ay(a)) {
                    e = true;
                }
                break;
            case "ZoomLevel":
                if (a == this._j) {
                    e = d = true;
                    this._ae();
                    if (this._j._o.renderCache.p) {
                        this._u = null;
                    }
                }
                break;
            case "HeaderFont":
            case "GetHeaderText":
            case "ResourceProvider":
                if (a == this._j) {
                    this._u = null;
                    e = d = true;
                }
                break;
            case "ActualItemPositions":
                if (a == this._j) {
                    e = d = true;
                }
                break;
            case "HotTrackedIndex":
            case "SelectionMode":
                if (a == this._j) {
                    e = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._j._ad) {
                    this._u = null;
                    e = d = true;
                }
                break;
            case "":
            case "Offset":
                if (a == this._j._x) {
                    e = true;
                }
                break;
        }
        if (d) {
            this._ac();
        }
        if (e) {
            this._ad();
        }
    };
    SpreadsheetHeaderContentLayerBase$1.prototype._af = function (a, b, c, d) {
        a._ag(b, c, d);
    };
    SpreadsheetHeaderContentLayerBase$1.$t = markType(SpreadsheetHeaderContentLayerBase$1, 'SpreadsheetHeaderContentLayerBase$1', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetHeaderContentLayerBase$1;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetHeaderContentLayerBase$1 };
/**
 * @hidden
 */
var SpreadsheetHeaderContentLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderContentLayer, _super);
    function SpreadsheetHeaderContentLayer(a, b) {
        return _super.call(this, HeaderVisual.$, a, b, true) || this;
    }
    SpreadsheetHeaderContentLayer.prototype._v = function () {
        return new HeaderVisualInfo();
    };
    SpreadsheetHeaderContentLayer.prototype._t = function () {
        return new HeaderVisual();
    };
    SpreadsheetHeaderContentLayer.prototype._ab = function (a, b, c, d) {
        var e = b;
        var f = a._o.renderCache;
        e.p = c;
        e.q = d;
        var g = a._bx;
        b.d = f.w(f.l, truncate((g * 100)), a._bs);
        b.e = f.z(a, d);
    };
    SpreadsheetHeaderContentLayer.prototype._ad = function () {
        this._e();
        this._o();
    };
    SpreadsheetHeaderContentLayer.prototype._ac = function () {
        this._f();
    };
    SpreadsheetHeaderContentLayer.prototype._ae = function () {
    };
    SpreadsheetHeaderContentLayer.prototype._q = function (a, b, c, d) {
        var e_40, _0;
        var e = this._j._aw;
        var f = this._j._bx;
        var g = this._j._af;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._aa)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var h = _2.value;
                var i = h;
                var j = SpreadsheetHeaderContentLayerBase$1._w(HeaderVisual.$, e, i.b);
                var k = (i.n + i.e / 2) * f;
                var l = (i.o + i.d / 2) * f;
                a.drawHeaderText(g, i.q, k, l, j, f);
            }
        }
        catch (e_40_1) { e_40 = { error: e_40_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_40) throw e_40.error; }
        }
        _super.prototype._q.call(this, a, b, c, d);
    };
    SpreadsheetHeaderContentLayer.prototype._ah = function () {
    };
    SpreadsheetHeaderContentLayer.prototype._ai = function (a) {
    };
    SpreadsheetHeaderContentLayer.$t = markType(SpreadsheetHeaderContentLayer, 'SpreadsheetHeaderContentLayer', SpreadsheetHeaderContentLayerBase$1.$.specialize(HeaderVisual.$));
    return SpreadsheetHeaderContentLayer;
}(SpreadsheetHeaderContentLayerBase$1));
export { SpreadsheetHeaderContentLayer };
/**
 * @hidden
 */
var SpreadsheetCellValueInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellValueInfo, _super);
    function SpreadsheetCellValueInfo() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.an = null;
        _this.d = null;
        _this.h = null;
        _this.w = 0;
        _this.af = 0;
        _this.ab = 0;
        _this.ak = 0;
        _this.x = 0;
        _this.ag = 0;
        _this.ao = null;
        _this.ap = null;
        _this.aa = 0;
        _this.ae = 0;
        _this.ad = 0;
        _this.am = Nullable$1.toNullable(Number_$type, null);
        _this.al = Nullable$1.toNullable(Number_$type, null);
        _this.v = 0;
        _this.ac = 0;
        _this.y = 0;
        _this.z = 0;
        _this.ah = 0;
        _this.ai = 0;
        _this.e = 0;
        _this.f = 0;
        _this.g = null;
        _this.ar = new Color();
        _this.c = null;
        _this.u = 0;
        _this.a = null;
        _this.b = 0;
        return _this;
    }
    SpreadsheetCellValueInfo.prototype.o = function (a) {
        return this.b == a.b && this.e == a.e && this.f == a.f && this.c == a.c;
    };
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "r", {
        get: function () {
            return this.m(1);
        },
        set: function (a) {
            this.aq(1, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "i", {
        get: function () {
            return this.m(2);
        },
        set: function (a) {
            this.aq(2, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "aj", {
        get: function () {
            var a = this.y;
            switch (this.e) {
                case 0:
                case 1:
                case 4:
                case 5:
                case 7:
                case 3:
                    a += this.ah + this.ai;
                    break;
            }
            return a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "s", {
        get: function () {
            return this.m(4);
        },
        set: function (a) {
            this.aq(4, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "j", {
        get: function () {
            return this.m(8);
        },
        set: function (a) {
            this.aq(8, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "t", {
        get: function () {
            return this.m(16);
        },
        set: function (a) {
            this.aq(16, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "n", {
        get: function () {
            return this.m(32);
        },
        set: function (a) {
            this.aq(32, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "k", {
        get: function () {
            return this.m(64);
        },
        set: function (a) {
            this.aq(64, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "q", {
        get: function () {
            return this.m(128);
        },
        set: function (a) {
            this.aq(128, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "l", {
        get: function () {
            return this.m(256);
        },
        set: function (a) {
            this.aq(256, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueInfo.prototype, "p", {
        get: function () {
            return this.m(512);
        },
        set: function (a) {
            this.aq(512, a);
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellValueInfo.prototype.m = function (a) {
        return (this.b & a) != 0;
    };
    SpreadsheetCellValueInfo.prototype.aq = function (a, b) {
        if (b) {
            this.b |= a;
        }
        else {
            this.b &= ~a;
        }
    };
    SpreadsheetCellValueInfo.$t = markType(SpreadsheetCellValueInfo, 'SpreadsheetCellValueInfo');
    return SpreadsheetCellValueInfo;
}(Base));
export { SpreadsheetCellValueInfo };
/**
 * @hidden
 */
var SpreadsheetPaneCellValueLayerBase$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellValueLayerBase$1, _super);
    function SpreadsheetPaneCellValueLayerBase$1($tVisual, a, b, c) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.o) || this;
        _this.$tVisual = null;
        _this._u = null;
        _this._x = null;
        _this._v = false;
        _this.$tVisual = $tVisual;
        _this.$type = _this.$type.specialize(_this.$tVisual);
        _this._v = c;
        _this._x = new List$1(SpreadsheetPaneCellValueLayerBase_CellInfo$1.$.specialize(_this.$tVisual), 0);
        _this._u = new PropertyChangeListener$1(SpreadsheetPaneCellValueLayerBase$1.$.specialize(_this.$tVisual), _this, runOn(_this, _this._ac), false);
        SpreadsheetUtilities.d6(a, _this._u, true);
        return _this;
    }
    SpreadsheetPaneCellValueLayerBase$1.prototype.get__m = function () {
        return 2;
    };
    Object.defineProperty(SpreadsheetPaneCellValueLayerBase$1.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellValueLayerBase$1.prototype._p = function () {
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._u);
        }
    };
    SpreadsheetPaneCellValueLayerBase$1.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneCellValueLayerBase$1.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellValueLayerBase$1.prototype._q = function (a, b, c, d) {
        var e_41, _0;
        var e = this._j;
        if (e != null) {
            var f = e.columnScrollRegion._br;
            var g = d.x;
            var h = d.y;
            var i = e.columnScrollRegion;
            var j = e.rowScrollRegion;
            var k = i._bx;
            var l = b.d;
            var m = l / 2;
            var n = -g;
            var o = -h;
            var p = ExcelUtils.gv;
            var q = this._v;
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._x)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var r = _2.value;
                    var s = r.a;
                    var t = s.a;
                    var u = s.d != null && s.d.iconInfo != null ? s.d.iconInfo.icon : -1;
                    if (t == null && u == -1) {
                        continue;
                    }
                    var v = c.x + i._bn(s.ab, true, q) * k;
                    var w = s.e == 4 ? s.ab : s.x;
                    var x = c.x + i._bn(w, false, q) * k;
                    var y = c.y + j._bn(s.ak, true, q) * k;
                    var z = c.y + j._bn(s.ag, false, q) * k;
                    var aa = x - v;
                    var ab = z - y;
                    y += s.ac * k;
                    z -= s.v * k;
                    if (u != -1) {
                        var ac = Math.floor(s.ah * k);
                        var ad = v + ((s.y + (intDivide(s.ai, 2))) * k);
                        var ae = y;
                        var af = (intDivide(s.ai, 2) + 3) * k;
                        switch (s.f) {
                            default:
                            case -1:
                            case 2:
                            case 4:
                            case 3:
                                ae = z - (ac + af);
                                break;
                            case 0:
                                y += af;
                                break;
                            case 1:
                                ae = y + (z - y) / 2 - ac / 2;
                                break;
                        }
                        a.drawIcon(u, b.h(ad) - n, b.h(ae) - o, ac, ac, v, y, x - v, z - y);
                    }
                    if (t == null || s.ap == null) {
                        continue;
                    }
                    var ag = t.a && s.c != null && (s.c.b * k) < aa;
                    var ah = ag ? s.c.b * k : 0;
                    var ai = t.b ? 1 : 2;
                    if (ag && s.e == 4) {
                        if (s.k) {
                            continue;
                        }
                        var aj = ah;
                        var ak = c.x + i._bn(s.x, false, q) * k;
                        var al = ak - v;
                        while (al > aj) {
                            ah += aj;
                            al -= aj;
                        }
                    }
                    var am = Math.max(t.c / 1.5, 1);
                    if (ag) {
                        v += s.aj * k;
                        x -= s.z * k;
                        aa = ah;
                        switch (s.e) {
                            default:
                            case -1:
                            case 1:
                            case 0:
                            case 4:
                                x = v + aa;
                                break;
                            case 2:
                            case 6:
                            case 5:
                            case 7:
                                v = v + (x - v) / 2 - aa / 2;
                                x = v + aa;
                                break;
                            case 3:
                                x -= l;
                                v = x - aa;
                                break;
                        }
                    }
                    else {
                        x -= l;
                        v += am;
                        x -= am;
                    }
                    v = b.h(v) - n;
                    x = b.h(x) - n;
                    var an = t.c * k;
                    var ao = an;
                    an /= 3;
                    var ap = an % l;
                    if (ap != 0) {
                        an += ap < an / 2 ? -ap : l - ap;
                    }
                    if (an < l) {
                        an = l;
                    }
                    if (aa > an * 2) {
                        p = s.ar;
                        var aq = an / 2;
                        var ar = s.u * k;
                        var as = void 0;
                        switch (s.f) {
                            default:
                            case -1:
                            case 2:
                            case 4:
                            case 3:
                                as = z - ao;
                                break;
                            case 0:
                                as = y + ar;
                                break;
                            case 1:
                                as = y + (z - y) / 2 + ar / 2 - l;
                                break;
                        }
                        z = b.h(z);
                        if (ai == 1) {
                            var at = b.h(as + an);
                            at -= (aq - h);
                            if (at <= z) {
                                a._drawLine4$i(an, p, f, v, at, x, at);
                            }
                        }
                        else {
                            var au = b.h(as);
                            au -= (aq - h);
                            if (au <= z) {
                                a._drawLine4$i(an, p, f, v, au, x, au);
                            }
                            au += an * 2;
                            if (au <= z) {
                                a._drawLine4$i(an, p, f, v, au, x, au);
                            }
                        }
                    }
                }
            }
            catch (e_41_1) { e_41 = { error: e_41_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_41) throw e_41.error; }
            }
        }
    };
    Object.defineProperty(SpreadsheetPaneCellValueLayerBase$1.prototype, "_w", {
        get: function () {
            return this._x;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellValueLayerBase$1.prototype._z = function (a, b, c) {
        var e_42, _0;
        var d = 0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var e = _2.value;
                var f = void 0;
                while (d < c.count && c._inner[d] == null) {
                    d++;
                }
                if (d < c.count) {
                    f = c._inner[d];
                    f.a = e;
                    c._inner[d] = null;
                    d++;
                }
                else {
                    f = new SpreadsheetPaneCellValueLayerBase_CellInfo$1(this.$tVisual, e, this._t());
                }
                a.add(f);
            }
        }
        catch (e_42_1) { e_42 = { error: e_42_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_42) throw e_42.error; }
        }
    };
    SpreadsheetPaneCellValueLayerBase$1.prototype._ad = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j.rowScrollRegion._x || a == this._j.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._j._k || a == this._j._p) {
                    d = true;
                }
                break;
            case "HideActiveCellContent":
                if (a == this._j) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._e();
            this._o();
            this._n();
        }
    };
    SpreadsheetPaneCellValueLayerBase$1.prototype._ac = function (a, b, c, d) {
        a._ad(b, c, d);
    };
    SpreadsheetPaneCellValueLayerBase$1.prototype._ae = function () {
        var a = this._j;
        if (a != null) {
            a._ao++;
        }
        if (a == null || a._p.count == 0) {
            this._af();
            this._x.clear();
        }
        else {
            var b = Nullable$1.toNullable(SpreadsheetCell.$, null);
            if (a._al) {
                b = Nullable$1.toNullable(SpreadsheetCell.$, a.rowScrollRegion._ab._r._c);
            }
            var c = a._p;
            for (var d = 0, e = this._x.count; d < e; d++) {
                var f = this._x._inner[d];
                var g = f.a;
                if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && g.w == b.value.column && g.ak == b.value.row) {
                    continue;
                }
                g.an = getBoxIfEnum(this.$tVisual, f.b);
            }
            var h = new List$1(SpreadsheetCellValueInfo.$, 0);
            for (var i = 0, j = c.count; i < j; i++) {
                var k = c._inner[i];
                if (k.an == null) {
                    if (k.ap == null) {
                        if (k.d == null || k.d.iconInfo == null || k.d.iconInfo.icon == -1) {
                            continue;
                        }
                    }
                    if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && k.w == b.value.column && k.ak == b.value.row) {
                        continue;
                    }
                    var l = typeCast(String_$type, k.ap);
                    if (l != null && l.length == 0) {
                        continue;
                    }
                    h.add(k);
                }
                else {
                    k.an = this.$type.getStaticFields(SpreadsheetPaneCellValueLayerBase$1.$)._y;
                }
            }
            var m = new List$1(SpreadsheetPaneCellValueLayerBase_CellInfo$1.$.specialize(this.$tVisual), 0);
            for (var n = 0, o = this._x.count; n < o; n++) {
                var p = this._x._inner[n];
                if (p.a.an == this.$type.getStaticFields(SpreadsheetPaneCellValueLayerBase$1.$)._y) {
                    m.add(p);
                    this._x._inner[n] = null;
                }
                else {
                    p.a.an = null;
                }
            }
            var q = this._x;
            this._x = m;
            if (h.count > 0) {
                this._z(this._x, h, q);
            }
            var r = a.rowScrollRegion._br;
            var s = a.columnScrollRegion._bx;
            var t = this._v;
            for (var u = 0, v = this._x.count; u < v; u++) {
                var w = this._x._inner[u];
                var x = w.a;
                var y = a.columnScrollRegion._bn(x.ab, true, t) + x.aj;
                var z = a.rowScrollRegion._bn(x.ak, true, t) + x.ac;
                var aa = a.columnScrollRegion._bn(x.x, false, t) - x.z - r;
                if (w.a.an == this.$type.getStaticFields(SpreadsheetPaneCellValueLayerBase$1.$)._y) {
                    w.a.an = null;
                }
                else {
                    var ab = a.rowScrollRegion._bn(x.ag, false, t) - x.v - r;
                    this._aa(w.b, x, y, z, aa, ab);
                }
                if (x.e == 3 && aa < y) {
                    y = aa;
                }
                this._ab(w.b, y, z);
            }
            for (var ac = 0, ad = q.count; ac < ad; ac++) {
                var ae = q._inner[ac];
                if (ae != null) {
                    this._ag(ae.b);
                }
            }
        }
    };
    SpreadsheetPaneCellValueLayerBase$1.$t = markType(SpreadsheetPaneCellValueLayerBase$1, 'SpreadsheetPaneCellValueLayerBase$1', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$), null, function () {
        this._y = {};
    });
    return SpreadsheetPaneCellValueLayerBase$1;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneCellValueLayerBase$1 };
/**
 * @hidden
 */
var SpreadsheetCellValueElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellValueElement, _super);
    function SpreadsheetCellValueElement(a, b) {
        var _this = _super.call(this, a, "SpreadsheetCellValue") || this;
        _this.cv = null;
        _this.ck = false;
        _this.cr = 0;
        _this.cu = null;
        _this.cp = 0;
        _this.co = 0;
        _this.ct = null;
        _this.cq = 0;
        _this.cn = 0;
        _this.cs = null;
        _this.cm = 0;
        _this.cl = 0;
        _this.ci = false;
        _this.cf = null;
        _this.ch = null;
        _this.ch = b;
        return _this;
    }
    Object.defineProperty(SpreadsheetCellValueElement.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (a != this.cf) {
                this.ci = true;
                this.cf = a;
                this.b1();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellValueElement.prototype, "cj", {
        get: function () {
            return this.ci;
        },
        set: function (a) {
            if (a != this.ci) {
                this.ci = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellValueElement.$t = markType(SpreadsheetCellValueElement, 'SpreadsheetCellValueElement', VisualElement.$);
    return SpreadsheetCellValueElement;
}(VisualElement));
export { SpreadsheetCellValueElement };
/**
 * @hidden
 */
var SpreadsheetPaneCellValueLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellValueLayer, _super);
    function SpreadsheetPaneCellValueLayer(a, b) {
        return _super.call(this, SpreadsheetCellValueElement.$, a, b, false) || this;
    }
    SpreadsheetPaneCellValueLayer.prototype._g = function (a) {
        this._ae();
        var b = this._ah.cg;
        var c = this._ah.ci;
        c.g(this._s);
        this._q(c, SpreadsheetPaneCellValueLayer._ai, new Rect(1, 0, 0, a), PointUtil.create());
        c.f();
        SpreadsheetDrawingElementHelper.a(b, c, 0);
        var d = this._j;
        var e = d.columnScrollRegion._bx;
        var f = e * d.columnScrollRegion._b4(truncate(MathUtilities.f(d.columnScrollRegion._x._ac)));
        var g = e * d.rowScrollRegion._b4(truncate(MathUtilities.f(d.rowScrollRegion._x._ac)));
        var h = e * d.columnScrollRegion._b4(truncate(Math.ceil(d.columnScrollRegion._bq)));
        var i = e * d.rowScrollRegion._b4(truncate(Math.ceil(d.rowScrollRegion._bq)));
        b.al(-f, -g, h, i);
        return _super.prototype._g.call(this, a);
    };
    SpreadsheetPaneCellValueLayer.prototype._t = function () {
        return this._ah.ch(null);
    };
    SpreadsheetPaneCellValueLayer.prototype._z = function (a, b, c) {
        var d = c.count;
        var e = b.count;
        for (var f = 0, g = b.count; f < g; f++) {
            var h = b._inner[f];
            for (var i = 0; i < d; i++) {
                var j = c._inner[f];
                if (j != null && j.f(h)) {
                    e--;
                    c._inner[f] = null;
                    b._inner[f] = null;
                    j.c(h);
                    a.add(j);
                    break;
                }
            }
        }
        if (e > 0) {
            var k = this._ah;
            var l = 0;
            for (var m = 0, n = b.count; m < n; m++) {
                if (b._inner[m] != null) {
                    while (l < d && c._inner[l] == null) {
                        l++;
                    }
                    var o = void 0;
                    if (l < d) {
                        o = c._inner[l];
                        c._inner[l] = null;
                        l++;
                        o.c(b._inner[m]);
                    }
                    else {
                        o = new SpreadsheetPaneCellValueLayer_JsCellInfo(b._inner[m], k.ch(b._inner[m]));
                    }
                    a.add(o);
                }
            }
        }
    };
    SpreadsheetPaneCellValueLayer.prototype._aa = function (a, b, c, d, e, f) {
        var g = this._j.columnScrollRegion;
        var h = g._bx;
        a.ab = false;
        a.cg = b;
        a.al(c * h, d * h, (e - c) * h, (f - d) * h);
    };
    SpreadsheetPaneCellValueLayer.prototype._ab = function (a, b, c) {
        var d = this._j.rowScrollRegion._bx;
        a.al(b * d, c * d, a.a3, a.av);
    };
    SpreadsheetPaneCellValueLayer.prototype._af = function () {
        this._ah.cl();
    };
    SpreadsheetPaneCellValueLayer.prototype._ag = function (a) {
        this._ah.ck(a);
    };
    Object.defineProperty(SpreadsheetPaneCellValueLayer.prototype, "_ah", {
        get: function () {
            return this._d.c;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellValueLayer.$t = markType(SpreadsheetPaneCellValueLayer, 'SpreadsheetPaneCellValueLayer', SpreadsheetPaneCellValueLayerBase$1.$.specialize(SpreadsheetCellValueElement.$));
    SpreadsheetPaneCellValueLayer._ai = new PixelConverter();
    return SpreadsheetPaneCellValueLayer;
}(SpreadsheetPaneCellValueLayerBase$1));
export { SpreadsheetPaneCellValueLayer };
/**
 * @hidden
 */
var SpreadsheetPaneCellValueLayerBase_CellInfo$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellValueLayerBase_CellInfo$1, _super);
    function SpreadsheetPaneCellValueLayerBase_CellInfo$1($tVisual, a, b) {
        var _this = _super.call(this) || this;
        _this.$tVisual = null;
        _this.a = null;
        _this.b = null;
        _this.$tVisual = $tVisual;
        _this.$type = _this.$type.specialize(_this.$tVisual);
        _this.a = a;
        _this.b = b;
        return _this;
    }
    SpreadsheetPaneCellValueLayerBase_CellInfo$1.$t = markType(SpreadsheetPaneCellValueLayerBase_CellInfo$1, 'SpreadsheetPaneCellValueLayerBase_CellInfo$1');
    return SpreadsheetPaneCellValueLayerBase_CellInfo$1;
}(Base));
export { SpreadsheetPaneCellValueLayerBase_CellInfo$1 };
/**
 * @hidden
 */
var SpreadsheetPaneCellValueLayer_JsCellInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellValueLayer_JsCellInfo, _super);
    function SpreadsheetPaneCellValueLayer_JsCellInfo(a, b) {
        var _this = _super.call(this, SpreadsheetCellValueElement.$, a, b) || this;
        _this.e = false;
        _this.d = null;
        _this.c(a);
        return _this;
    }
    SpreadsheetPaneCellValueLayer_JsCellInfo.prototype.c = function (a) {
        this.a = a;
        this.e = a.e == 4;
        this.d = a.c;
        return this;
    };
    SpreadsheetPaneCellValueLayer_JsCellInfo.prototype.f = function (a) {
        var b = a.e == 4;
        return b == this.e && Base.equalsStatic(this.d, a.c);
    };
    SpreadsheetPaneCellValueLayer_JsCellInfo.$t = markType(SpreadsheetPaneCellValueLayer_JsCellInfo, 'SpreadsheetPaneCellValueLayer_JsCellInfo', SpreadsheetPaneCellValueLayerBase_CellInfo$1.$.specialize(SpreadsheetCellValueElement.$));
    return SpreadsheetPaneCellValueLayer_JsCellInfo;
}(SpreadsheetPaneCellValueLayerBase_CellInfo$1));
export { SpreadsheetPaneCellValueLayer_JsCellInfo };
/**
 * @hidden
 */
var SpreadsheetInstructionGraphics = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetInstructionGraphics, _super);
    function SpreadsheetInstructionGraphics(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.e = null;
        _this.d = null;
        _this.b = null;
        _this.a = a;
        _this.e = new List$1(SpreadsheetDrawingOperation.$, 0);
        _this.d = new List$1(SpreadsheetDrawingOperation.$, 0);
        return _this;
    }
    SpreadsheetInstructionGraphics.prototype.g = function (a) {
        this.b = a;
        this.d.o(this.e);
        this.e.clear();
    };
    SpreadsheetInstructionGraphics.prototype.f = function () {
        this.b = null;
    };
    SpreadsheetInstructionGraphics.prototype.c = function (a) {
        var b;
        var c = this.d.count - 1;
        if (c >= 0) {
            b = this.d._inner[c];
            this.d.removeAt(c);
        }
        else {
            b = new SpreadsheetDrawingOperation();
        }
        b.b = a;
        return b;
    };
    SpreadsheetInstructionGraphics.prototype.drawDropDownGlyph = function (a, b, c, d, e) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.drawEllipse = function (a, b, c, d, e, f, g) {
        var h = this.c(2);
        h.a = 6;
        h.i = this.b.ba(b);
        h.d = c * a;
        h.e = d;
        h.g = e;
        h.f = d + f;
        h.h = e + g;
        this.e.add(h);
    };
    SpreadsheetInstructionGraphics.prototype.drawHeaderText = function (a, b, c, d, e, f) {
        if (f === void 0) { f = 1; }
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.drawIcon = function (a, b, c, d, e, f, g, h, i) {
        if (a != -1) {
            var j = this.c(1);
            j.c = a;
            j.i = null;
            j.e = b;
            j.g = c;
            j.f = b + d;
            j.h = c + e;
            this.e.add(j);
        }
    };
    SpreadsheetInstructionGraphics.prototype.drawLine3 = function (a, b, c, d, e, f) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.drawLine4 = function (penWidth, color, dpiFactor, x1, y1, x2, y2) {
        arguments[1] = Color.create(arguments[1]);
        return this._drawLine4$i.apply(this, arguments);
    };
    SpreadsheetInstructionGraphics.prototype._drawLine4$i = function (a, b, c, d, e, f, g) {
        this._drawLine2$i(6, b, c * a, d, e, f, g);
    };
    SpreadsheetInstructionGraphics.prototype.drawLine2 = function (pen, color, dpiFactor, x1, y1, x2, y2) {
        arguments[1] = Color.create(arguments[1]);
        return this._drawLine2$i.apply(this, arguments);
    };
    SpreadsheetInstructionGraphics.prototype._drawLine2$i = function (a, b, c, d, e, f, g) {
        var h = this.c(0);
        h.a = a;
        h.i = b.colorString;
        h.d = c;
        h.e = d;
        h.g = e;
        h.f = f;
        h.h = g;
        this.e.add(h);
    };
    SpreadsheetInstructionGraphics.prototype.drawLine1 = function (a, b, c, d, e, f, g) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.drawLine = function (a, b, c, d, e, f, g) {
        var h = this.c(0);
        h.a = a;
        h.i = this.b.ba(b);
        h.d = c;
        h.e = d;
        h.g = e;
        h.f = f;
        h.h = g;
        this.e.add(h);
    };
    SpreadsheetInstructionGraphics.prototype.drawRectangle1 = function (a, b, c, d, e, f, g) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.drawRectangle = function (a, b, c, d, e, f, g) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle1 = function (a, b, c, d, e) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle5 = function (a, b, c, d, e) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle3 = function (a, b, c, d, e) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle4 = function (a, b, c, d, e, f, g) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle = function (a, b, c, d, e, f, g) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.fillRectangle2 = function (a, b, c, d, e, f, g, h, i) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.prototype.getFarPixelAdjustment = function (a) {
        throw new NotImplementedException(0);
    };
    SpreadsheetInstructionGraphics.$t = markType(SpreadsheetInstructionGraphics, 'SpreadsheetInstructionGraphics', Base.$, [ISpreadsheetGraphics_$type]);
    return SpreadsheetInstructionGraphics;
}(Base));
export { SpreadsheetInstructionGraphics };
/**
 * @hidden
 */
var SpreadsheetDrawingElementHelper = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetDrawingElementHelper, _super);
    function SpreadsheetDrawingElementHelper() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetDrawingElementHelper.a = function (a, b, c) {
        var d = a.a9;
        var e = 0;
        var f = 0;
        var g = 0;
        for (var h = 0, i = b.e.count; h < i; h++) {
            var j = b.e._inner[h];
            var k = void 0, l = void 0, m = void 0, n = void 0;
            switch (j.b) {
                case 0:
                    var o = Math.max(c, j.d);
                    if (j.g == j.h) {
                        k = j.e;
                        m = j.f - k;
                        l = j.g - o / 2;
                        n = j.d;
                    }
                    else if (j.e == j.f) {
                        l = j.g;
                        n = j.h - l;
                        k = j.e - o / 2;
                        m = j.d;
                    }
                    else {
                        continue;
                    }
                    var p = null;
                    for (; e < d; e++) {
                        var q = a.b(e);
                        if (q.bx == "Line") {
                            p = q;
                            e++;
                            break;
                        }
                    }
                    if (p == null) {
                        p = new LineVisualElement(a, "Line");
                    }
                    p.ci = j.i;
                    p.al(k, l, m, n);
                    break;
                case 1:
                    k = j.e;
                    m = j.f - k;
                    l = j.g;
                    n = j.h - l;
                    var r = null;
                    for (; f < d; f++) {
                        var s = a.b(f);
                        if (s.bx == "Icon") {
                            r = s;
                            f++;
                            break;
                        }
                    }
                    if (r == null) {
                        r = new SpreadsheetIconElement(a);
                    }
                    r.cg = j.c;
                    r.al(k, l, m, n);
                    break;
                case 2:
                    k = j.e;
                    m = j.f - k;
                    l = j.g;
                    n = j.h - l;
                    var t = null;
                    for (; g < d; g++) {
                        var u = a.b(g);
                        if (u.bx == "InvalidData") {
                            t = u;
                            g++;
                            break;
                        }
                    }
                    if (t == null) {
                        t = new SpreadsheetInvalidDataElement(a);
                    }
                    t.cm = j.i;
                    t.ck = Math.max(j.d, c);
                    var v = t.ck;
                    t.al(k - v / 2, l - v / 2, m + v, n + v);
                    break;
            }
        }
        var w = e;
        if (f < w) {
            w = f;
        }
        if (g < w) {
            w = g;
        }
        for (var x = w; x < d; x++) {
            var y = a.b(x).bx;
            if ((x >= e && y == "Line") || (x >= f && y == "Icon") || (x >= g && y == "InvalidData")) {
                a.b(x).ab = true;
            }
        }
    };
    SpreadsheetDrawingElementHelper.$t = markType(SpreadsheetDrawingElementHelper, 'SpreadsheetDrawingElementHelper');
    return SpreadsheetDrawingElementHelper;
}(Base));
export { SpreadsheetDrawingElementHelper };
/**
 * @hidden
 */
var SpreadsheetSingleLayerView = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSingleLayerView, _super);
    function SpreadsheetSingleLayerView(a) {
        var _this = _super.call(this) || this;
        _this.c = null;
        _this.c = a;
        return _this;
    }
    SpreadsheetSingleLayerView.prototype.d = function () {
        var a = this.b;
        a.dispose();
        this.detach(a);
    };
    SpreadsheetSingleLayerView.prototype.invalidateMeasure = function () {
        this.c.t = true;
    };
    SpreadsheetSingleLayerView.prototype.invalidateArrange = function () {
        this.c.t = true;
    };
    SpreadsheetSingleLayerView.prototype.createRenderer = function () {
        return new SpreadsheetSingleLayerView_Renderer(this);
    };
    SpreadsheetSingleLayerView.prototype.releaseRenderer = function (a) {
    };
    SpreadsheetSingleLayerView.$t = markType(SpreadsheetSingleLayerView, 'SpreadsheetSingleLayerView', ElementLayerViewSingle.$, [IRendererElementLayerView$2_$type.specialize(SpreadsheetPane.$, ISpreadsheetGraphics_$type)]);
    return SpreadsheetSingleLayerView;
}(ElementLayerViewSingle));
export { SpreadsheetSingleLayerView };
/**
 * @hidden
 */
var SpreadsheetSingleLayerView_Renderer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSingleLayerView_Renderer, _super);
    function SpreadsheetSingleLayerView_Renderer(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.a = a;
        return _this;
    }
    SpreadsheetSingleLayerView_Renderer.prototype.onUnloaded = function () {
        this.a = null;
    };
    SpreadsheetSingleLayerView_Renderer.prototype.invalidateLayout = function () {
        if (this.a != null) {
            this.a.invalidateArrange();
        }
    };
    SpreadsheetSingleLayerView_Renderer.prototype.invalidateRender = function () {
        if (this.a != null) {
            this.a.invalidateArrange();
        }
    };
    SpreadsheetSingleLayerView_Renderer.prototype.measure = function (availableSize) {
        arguments[0] = sizeFromLiteral(arguments[0]);
        return this._measure$i.apply(this, arguments);
    };
    SpreadsheetSingleLayerView_Renderer.prototype._measure$i = function (a) {
    };
    SpreadsheetSingleLayerView_Renderer.prototype.arrange = function (finalSize) {
        arguments[0] = sizeFromLiteral(arguments[0]);
        return this._arrange$i.apply(this, arguments);
    };
    SpreadsheetSingleLayerView_Renderer.prototype._arrange$i = function (a) {
    };
    SpreadsheetSingleLayerView_Renderer.$t = markType(SpreadsheetSingleLayerView_Renderer, 'SpreadsheetSingleLayerView_Renderer', Base.$, [ILayerRenderer_$type]);
    return SpreadsheetSingleLayerView_Renderer;
}(Base));
export { SpreadsheetSingleLayerView_Renderer };
/**
 * @hidden
 */
var SpreadsheetSingleLayerElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSingleLayerElement, _super);
    function SpreadsheetSingleLayerElement(a, b) {
        var _this = _super.call(this, a, b) || this;
        _this.cf = null;
        _this.cf = new SpreadsheetSingleLayerView(_this);
        _this.w = false;
        return _this;
    }
    SpreadsheetSingleLayerElement.prototype.bz = function () {
        var a = this.cf.b;
        if (a != null) {
            a.dispose();
            this.cf.detach(a);
        }
        _super.prototype.bz.call(this);
    };
    SpreadsheetSingleLayerElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        var e = new Size(1, c, d);
        this.cf.b._h(e);
        this.cf.b._g(e);
    };
    SpreadsheetSingleLayerElement.prototype.b5 = function () {
        _super.prototype.b5.call(this);
        this.t = true;
    };
    SpreadsheetSingleLayerElement.$t = markType(SpreadsheetSingleLayerElement, 'SpreadsheetSingleLayerElement', VisualElement.$);
    return SpreadsheetSingleLayerElement;
}(VisualElement));
export { SpreadsheetSingleLayerElement };
/**
 * @hidden
 */
var SpreadsheetCellValueLayerElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellValueLayerElement, _super);
    function SpreadsheetCellValueLayerElement(a) {
        var _this = _super.call(this, a, "SpreadsheetCellValueLayer") || this;
        _this.cg = null;
        _this.cj = null;
        _this.ci = null;
        _this.ci = new SpreadsheetInstructionGraphics(_this);
        _this.cj = new List$1(SpreadsheetCellValueElement.$, 0);
        _this.cg = new VisualElement(_this, "CellContainer");
        _this.w = false;
        return _this;
    }
    SpreadsheetCellValueLayerElement.prototype.b5 = function () {
        _super.prototype.b5.call(this);
        this.cl();
    };
    SpreadsheetCellValueLayerElement.prototype.ch = function (a) {
        var b = this.cf.b;
        for (var c = 0, d = this.cj.count; c < d; c++) {
            var e = this.cj._inner[c];
            if (a.o(e.cg)) {
                this.cj.removeAt(c);
                e.ch = b._j;
                e.ac = true;
                return e;
            }
        }
        if (this.cj.count > 300) {
            var f = this.cj.count - 1;
            var g = this.cj._inner[f];
            this.cj.removeAt(f);
            g.ch = b._j;
            g.ac = true;
            return g;
        }
        return new SpreadsheetCellValueElement(this.cg, b._j);
    };
    SpreadsheetCellValueLayerElement.prototype.ck = function (a) {
        if (this.cj.count < 1000) {
            a.ac = false;
            this.cj.add(a);
        }
        else {
            a.ab = true;
        }
    };
    SpreadsheetCellValueLayerElement.prototype.cl = function () {
        for (var a = 0, b = this.cg.a9; a < b; a++) {
            var c = this.cg.b(a);
            if (c.ac && c.bx == "SpreadsheetCellValue") {
                c.ac = false;
                this.cj.add1(c);
            }
        }
    };
    SpreadsheetCellValueLayerElement.$t = markType(SpreadsheetCellValueLayerElement, 'SpreadsheetCellValueLayerElement', SpreadsheetSingleLayerElement.$);
    return SpreadsheetCellValueLayerElement;
}(SpreadsheetSingleLayerElement));
export { SpreadsheetCellValueLayerElement };
/**
 * @hidden
 */
var SpreadsheetDrawingLayerElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetDrawingLayerElement, _super);
    function SpreadsheetDrawingLayerElement(a) {
        var _this = _super.call(this, a, "SpreadsheetDrawingLayer") || this;
        _this.cg = null;
        _this.cg = new SpreadsheetInstructionGraphics(_this);
        return _this;
    }
    SpreadsheetDrawingLayerElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        var e = this.cf.b;
        var f = this.cg;
        f.g(e._s);
        e._q(f, SpreadsheetDrawingLayerElement.ch, new Rect(0, 0, 0, c, d), PointUtil.create());
        f.f();
        SpreadsheetDrawingElementHelper.a(this, f, 1);
    };
    SpreadsheetDrawingLayerElement.$t = markType(SpreadsheetDrawingLayerElement, 'SpreadsheetDrawingLayerElement', SpreadsheetSingleLayerElement.$);
    SpreadsheetDrawingLayerElement.ch = new PixelConverter();
    return SpreadsheetDrawingLayerElement;
}(SpreadsheetSingleLayerElement));
export { SpreadsheetDrawingLayerElement };
/**
 * @hidden
 */
var ScrollRegionLayerContainer = /** @class */ (function (_super) {
    tslib_1.__extends(ScrollRegionLayerContainer, _super);
    function ScrollRegionLayerContainer(a, b) {
        return _super.call(this, SpreadsheetScrollRegion.$, a, b) || this;
    }
    ScrollRegionLayerContainer.prototype.c = function () {
        return new SpreadsheetScrollRegionInteractionManager(this.b, this);
    };
    ScrollRegionLayerContainer.$t = markType(ScrollRegionLayerContainer, 'ScrollRegionLayerContainer', SpreadsheetElementLayerContainer$1.$.specialize(SpreadsheetScrollRegion.$));
    return ScrollRegionLayerContainer;
}(SpreadsheetElementLayerContainer$1));
export { ScrollRegionLayerContainer };
/**
 * @hidden
 */
var Spreadsheet = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet, _super);
    function Spreadsheet() {
        var _this = _super.call(this) || this;
        _this._az = null;
        _this._e9 = null;
        _this._cc = false;
        _this._i9 = new Rect(0, 0, 0, 0, 0);
        _this._bg = null;
        _this._bi = null;
        _this._as = null;
        _this.css = null;
        _this.createRendererContainer = null;
        _this._a1 = new SpreadsheetMetricsCache();
        _this._cd = false;
        _this._eb = null;
        _this._cj = false;
        _this._height = 0;
        _this._width = 0;
        _this._fm = null;
        _this._ei = 1;
        _this._e8 = null;
        _this._p = null;
        _this._eg = new List$1(Spreadsheet_ElementCommandInfo.$, 0);
        _this._i5 = null;
        _this._s = null;
        _this._t = null;
        _this._a7 = null;
        _this._b1 = null;
        _this._ac = null;
        _this._bs = null;
        _this._j = null;
        _this._b0 = null;
        _this._l = null;
        _this._z = 0;
        _this._bq = null;
        _this._ah = null;
        _this._bb = null;
        _this._b6 = null;
        _this._b3 = null;
        _this._be = null;
        _this._ab = null;
        _this._ao = null;
        _this._eh = null;
        _this._aa = null;
        _this._fe = 0;
        _this._y = null;
        _this._a2 = null;
        _this._fu = null;
        _this._ec = null;
        _this._fl = null;
        _this._ae = new SpreadsheetCell();
        _this._al = new SpreadsheetCellRange();
        _this._a4 = null;
        _this._a9 = null;
        _this._by = null;
        _this._bv = null;
        _this._b8 = true;
        _this._b9 = true;
        _this._ca = true;
        _this._cb = true;
        _this._aj = 0;
        _this._bm = null;
        _this._av = 0;
        _this._fd = 2;
        _this._ce = true;
        _this._cf = false;
        _this._cg = true;
        _this._ch = false;
        _this._ci = false;
        _this._ck = true;
        _this._ej = 102;
        _this._aq = 0;
        _this._g = null;
        _this._b4 = null;
        _this._i6 = null;
        _this._bt = null;
        _this._ff = 100;
        _this._fp = null;
        _this._bk = null;
        _this._w = null;
        _this._fc = 0;
        _this._e6 = null;
        _this._b7 = false;
        _this.actionExecuted = null;
        _this.actionExecuting = null;
        _this.activeCellChanged = null;
        _this.activePaneChanged = null;
        _this.activeTableChanged = null;
        _this.activeWorksheetChanged = null;
        _this._cellDropDownItemSelecting = null;
        _this.editModeExiting = null;
        _this.editModeExited = null;
        _this.editModeEntering = null;
        _this.editModeEntered = null;
        _this.editModeValidationError = null;
        _this.editRangePasswordNeeded = null;
        _this.hyperlinkExecuting = null;
        _this.selectionChanged = null;
        _this.userPromptDisplaying = null;
        _this.workbookDirtied = null;
        _this._v = new Spreadsheet_NullView(_this);
        _this._b0 = new PropertyChangeListener$1(Spreadsheet.$, _this, Spreadsheet._hd, false);
        _this._bq = new DeferredOperation(runOn(_this, _this._i0));
        _this._l = SpreadsheetCommandBuilder.b();
        _this._j = new ReadOnlyNotifyCollection$1(SpreadsheetPane.$, boxArray$1(new Array(0)));
        _this._b1 = new PixelConverter();
        _this._ac = new Spreadsheet_WorkbookOwner(_this);
        _this._bs = _this._ac;
        _this._aa = new Spreadsheet_NameBoxList(_this);
        _this._ab = new Spreadsheet_SelectionWorksheetCellFormat(_this);
        _this._ao = new SpreadsheetCellRangeFormat(_this._ab);
        var a = PropertyChangeListenerList.e(SpreadsheetTabManager.$, _this._be, new SpreadsheetTabManager(_this), _this._b0, false);
        _this._be = a.p0;
        _this.undoManager = new UndoManager();
        _this._id(4, true);
        _this._is();
        _this._g1();
        return _this;
    }
    Object.defineProperty(Spreadsheet.prototype, "_at", {
        get: function () {
            if (this._as == null) {
                this._as = new SpreadsheetContextMenu(this);
            }
            return this._as;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isDisabled", {
        get: function () {
            return this._cd;
        },
        set: function (a) {
            if (a != this._cd) {
                this._cd = a;
                if (this._bg != null) {
                    if (this._bg.co != null) {
                        this._bg.co.ab = a;
                    }
                    this._bg.dp.cg.cf.u = !a;
                    this._bg.u = !a;
                    if (a) {
                        this._c1(false);
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "brushes", {
        get: function () {
            return this._eb;
        },
        set: function (a) {
            if (a != this._eb) {
                this._eb = a;
                if (this._a7 != null) {
                    this._a7._al._j.al();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isScrollLocked", {
        get: function () {
            return this._cj;
        },
        set: function (a) {
            if (a != this._cj) {
                this._cj = a;
                this._ht(1);
                this.a("IsScrollLocked");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bj", {
        get: function () {
            return this._bi;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_fa", {
        get: function () {
            return this._e9;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "height", {
        get: function () {
            return this._height;
        },
        set: function (a) {
            this._height = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "width", {
        get: function () {
            return this._width;
        },
        set: function (a) {
            this._width = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_a0", {
        get: function () {
            return this._az;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ad", {
        get: function () {
            return this._bg != null ? this._bg.dr.cf : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bh", {
        get: function () {
            return this._bg;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ay", {
        get: function () {
            return this._bg != null ? this._bg.dr.cf.e0 : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ja", {
        get: function () {
            return this._i9;
        },
        set: function (a) {
            if (Rect.l_op_Inequality(this._i9, a)) {
                this._i9 = a;
                if (this._bg != null) {
                    this._bg.al(a.left, a.top, a.width, a.height);
                }
                this.scheduleArrange();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_c3", {
        get: function () {
            return this._c2(256);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_language", {
        get: function () {
            return this._fm;
        },
        set: function (a) {
            if (this._fm != a) {
                this._fm = a;
                this._at.n();
                if (this._bg != null) {
                    var b = this._bg.dp.cg.cf.a7;
                    if (b != null) {
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype.containerResized = function () {
        if (this._e9 != null) {
            var a = this._e9.rootWrapper.getNativeElement().getBoundingClientRect();
            var b = (a.width);
            var c = (a.height);
            this._ja = new Rect(0, 0, 0, b, c);
        }
    };
    Spreadsheet.prototype.destroy = function () {
        this.provideContainer(null);
    };
    Spreadsheet.prototype.executeCommand = function (a) {
        return this._cz(a, null, null);
    };
    Spreadsheet.prototype.flush = function () {
        if (this._cc) {
            this._fx();
        }
    };
    Spreadsheet.prototype.onInitialized = function () {
        this._gn();
    };
    Spreadsheet.prototype._gq = function () {
        if (this._bg != null) {
            this._bg.ao(function (a) {
                if (a.bx == "SpreadsheetRenderer") {
                    a.ck();
                    return false;
                }
                return a.bx != "SpreadsheetCellValueLayer" && a.bx != "TabItemArea";
            });
        }
    };
    Object.defineProperty(Spreadsheet.prototype, "_ek", {
        get: function () {
            return this._ei;
        },
        set: function (a) {
            if (a != this._ei) {
                this._ei = a;
                this._gq();
                this.scheduleArrange();
            }
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype.provideContainer = function (a) {
        var _this = this;
        var b = this._e9;
        var c = a;
        this._e9 = c;
        if (b != null) {
            window.removeEventListener("resize", this._e8, false);
            this._e8 = null;
            this._at.m();
            if (this._bg != null) {
                this._bg.ab = true;
                this._bg.b8();
                this._bg.bz();
                this._bg.dr.cf.c = null;
                this._bg = null;
            }
            if (this._az != null) {
                this._az.w();
            }
            if (this._a7 != null) {
                this._a7._al._j.al();
            }
        }
        if (c != null) {
            if (this._bi == null) {
                this._bi = new SpreadsheetVisualElementDomBuilder(this);
            }
            this._bi.ad = this.css;
            if (this._az == null) {
                this._az = new SpreadsheetMeasureHelper(this);
            }
            if (this._as == null) {
                this._as = new SpreadsheetContextMenu(this);
            }
            this._az.v(c);
            var d = c.rootWrapper;
            d.setRawStyleProperty("position", "relative");
            var e = c.createElement("div");
            e.setAttribute("style", "position:absolute;outline:0");
            e.setAttribute("tabIndex", 0);
            c.append(e);
            var f = c.getSubRenderer(e);
            e.listen("focus", function (g) {
                if (_this.isRenamingWorksheet && !_this._bc.j) {
                    _this._bc.q();
                }
            });
            var g = new SpreadsheetVisualElement(this);
            this._bg = g;
            g.a7 = f;
            var h = new SpreadsheetDOMEventProxy(this, f.rootWrapper, f);
            g.co = h;
            h.ab = this.isDisabled;
            this._e8 = function (i) {
                var j = _this._ek;
                if (window.devicePixelRatio != undefined && window.devicePixelRatio != j) {
                    _this._ek = window.devicePixelRatio;
                }
            };
            window.addEventListener("resize", this._e8, false);
            this._e8(null);
            var i = new JsSpreadsheetAreaLayoutManager(g.dr);
            g.dr.cf = i;
            i.c = this;
            i.x = this._b2;
            this.containerResized();
            g.afterHasDescendantChanged = delegateCombine(g.afterHasDescendantChanged, function (j, k) { return _this.scheduleArrange(); });
            this._hi();
            this._fy(true);
        }
    };
    Spreadsheet.prototype.scheduleArrange = function () {
        if (!this._cc) {
            this._cc = true;
            window.setTimeout(runOn(this, this._fx), 0);
        }
    };
    Spreadsheet.prototype.styleUpdated = function () {
        if (this._az != null) {
            this._az.u();
        }
        if (this._a7 != null) {
            this._a7._hv();
        }
        if (this._bi != null) {
            this._bi.ad = this.css;
        }
        if (this._az != null) {
            this._az.aa();
        }
        if (this._bg != null) {
            this._bg.dp.cp();
            this._bg.dr.cf.e4();
            this._gq();
        }
    };
    Spreadsheet.prototype._ga = function () {
        if (this.isInEditMode) {
            var a = this._m();
            if (a != null) {
                var b = a.a7.rootWrapper.getNativeElement();
                var c = b.selectionStart;
                var d = b.selectionEnd;
                var e = b.value;
                var f = (e.substring(c, d));
                var g = ClipboardHelper.d();
                g.setData(DataFormats.d, f);
                ClipboardHelper.c(g, true);
            }
        }
    };
    Spreadsheet.prototype._fb = function (a) {
        return this._fa.createElement(a);
    };
    Spreadsheet.prototype._m = function () {
        var a = null;
        var b = document.activeElement;
        if (SpreadsheetUtilities.a5(this._ay, b)) {
            a = this._ay;
        }
        else if (SpreadsheetUtilities.a5(this._bh.dp.ci.cf, b)) {
            a = this._bh.dp.ci.cf;
        }
        return a;
    };
    Spreadsheet.prototype._o = function (a) {
        return this._bg == null ? null : this._bg.dr.cf.ey(a);
    };
    Spreadsheet.prototype._n = function (a) {
        return this._bg == null ? null : this._bg.dr.cf.ex(a);
    };
    Spreadsheet.prototype._di = function () {
        if (this._v.isInNameBox) {
            var a = this._bg.dp.cg;
            if (a.cf.a7 != null) {
                var b = a.cf.cr;
                return b != null && b.e;
            }
        }
        return false;
    };
    Object.defineProperty(Spreadsheet.prototype, "_c6", {
        get: function () {
            return this._p != null && this._p.c;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype._f7 = function () {
        if (this._p != null) {
            this._p.f();
        }
    };
    Spreadsheet.prototype._d5 = function (a, b, c, d, e) {
        if (this._p == null) {
            this._p = new CellDropDown(this);
        }
        return this._p.d(a, b, c, d, e);
    };
    Spreadsheet.prototype._ha = function (a) {
        var b = this._ay;
        if (b != null && this._m() != b) {
            b.c9 = a;
        }
        this._ai.ar();
        if (this._bg != null) {
            this._bg.dr.cf.cx();
        }
    };
    Spreadsheet.prototype._dy = function (a, b, c) {
        if (this._as != null) {
            var d = this._as.k(a, b, c);
            if (d.hasValue) {
                return d.value;
            }
        }
        return this._d0(a, b);
    };
    Spreadsheet.prototype._h8 = function (a, b) {
        this._eg.add(new Spreadsheet_ButtonElementCommandInfo(a, b, this));
    };
    Spreadsheet.prototype._r = function (a, b, c) {
        var _this = this;
        if (c === void 0) { c = false; }
        var d = function () { return _this._v.focus(); };
        return this._q(a, b, d, c);
    };
    Spreadsheet.prototype._q = function (a, b, c, d) {
        if (d === void 0) { d = false; }
        if (this._e9 == null) {
            throw new InvalidOperationException(0);
        }
        var e = this._fa.getWrapper(a);
        this._e9.append(e);
        var f = IgDialogWrapper.a(a, b, d);
        if (null != c) {
            f.closed = delegateCombine(f.closed, function (g, h) { return c(); });
        }
        return f;
    };
    Spreadsheet.prototype._fx = function () {
        if (this._cc) {
            this._fy(true);
        }
    };
    Spreadsheet.prototype._fy = function (a) {
        var b = this._cc;
        this._cc = false;
        this._hq();
        if (this._bg != null) {
            var c = this._bp(LongValue.a(), null);
            for (var d = 0; d < this._eg.count; d++) {
                var e = this._eg._inner[d];
                e.a.u = this._cq(e.c, null, c, true);
            }
            this._bg.al(this._i9.left, this._i9.top, this._i9.width, this._i9.height);
            if (this._bg.t) {
                this._bg.b6();
            }
            var f = new Size(1, this._bg.dr.a3, this._bg.dr.av);
            if (!this._bg.dr.cf.e3) {
                this._bg.dr.cf.ew(f);
            }
            if (!this._bg.dr.cf.e2) {
                this._bg.dr.cf.eu(f);
            }
            this._bg.cb();
            if (a) {
                this._bg.dl();
                this._bg.by(this._bi);
            }
            else {
                if (this._bg.l && b && !this._cc) {
                    this._cc = true;
                }
            }
        }
    };
    Spreadsheet.prototype._g0 = function (a, b) {
        if (this._i5 != null) {
            ClipboardHelper.b(a, this._i5);
        }
        else {
        }
    };
    Spreadsheet.prototype._g1 = function () {
        this._u = new SpreadsheetView(this);
        if (ClipboardHelper.e() == null) {
            var a = ClipboardHelper.d();
            a.setData(DataFormats.d, stringEmpty());
            ClipboardHelper.c(a, false);
        }
    };
    Object.defineProperty(Spreadsheet.prototype, "activeCell", {
        get: function () {
            return this._ae;
        },
        set: function (a) {
            if (SpreadsheetCell.l_op_Inequality(a, this._ae)) {
                var b = this.activeSelection;
                var c = this._ae;
                var d = a;
                this._ae = a;
                this._gd();
                this._c1(true);
                if (b != null) {
                    b._setActiveCell(d, Nullable$1.toNullable(Number_$type, null));
                }
                this._i0();
                this.a("ActiveCell");
                this.a("ActiveCellAddress");
                this._fv("ActiveCellChanged", c);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activeCellAddress", {
        get: function () {
            return this._ae.toString();
        },
        set: function (a) {
            this.activeCell = new SpreadsheetCell(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_am", {
        get: function () {
            return this._al;
        },
        set: function (a) {
            if (SpreadsheetCellRange.l_op_Inequality(a, this._al)) {
                this._al = a;
                this._ht(4096 | 8192 | 16777216);
                this._i0();
                this.a("ActiveCellAsRange");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activePane", {
        get: function () {
            return this._a4;
        },
        set: function (a) {
            if (a != this._a4) {
                var b = this._a4;
                var c = a;
                this._a4 = a;
                this.activeSelection = c != null ? c.selection : null;
                this._c1(true);
                this._i0();
                this.a("ActivePane");
                this._fv("ActivePaneChanged", b);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activeSelection", {
        get: function () {
            return this._a9;
        },
        set: function (a) {
            if (a != this._a9) {
                var b = this._a9;
                var c = a;
                this._a9 = a;
                if (b != null) {
                    b._x = 0;
                }
                this._gd();
                this._ht(4096);
                var d = b;
                var e = PropertyChangeListenerList.f(SpreadsheetSelection.$, d, c, this._b0, false);
                d = e.p0;
                this.activeCell = c != null ? c.activeCell : new SpreadsheetCell();
                this._am = c != null ? c._r : new SpreadsheetCellRange();
                if (c != null) {
                    c._x = this.selectionMode;
                }
                this._i0();
                this.a("ActiveSelection");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activeSelectionCellRangeFormat", {
        get: function () {
            return this._ao;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activeTable", {
        get: function () {
            return this._by;
        },
        set: function (a) {
            if (a != this._by) {
                var b = this._by;
                this._by = a;
                this.a("ActiveTable");
                this._fv("ActiveTableChanged", b);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "activeWorksheet", {
        get: function () {
            return this._bv;
        },
        set: function (a) {
            if (a != this._bv) {
                var b = this._bv;
                var c = a;
                this._bv = a;
                this._eh = null;
                this._ht(4096 | 8192 | 16777216);
                if (c != null && c.workbook != null) {
                    c.workbook.windowOptions._ae(c, false);
                }
                this._i0();
                this.a("ActiveWorksheet");
                this._fv("ActiveWorksheetChanged", b);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "allowAddWorksheet", {
        get: function () {
            return this._b8;
        },
        set: function (a) {
            if (a != this._b8) {
                this._b8 = a;
                this._ht(1);
                this.a("AllowAddWorksheet");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "allowDeleteWorksheet", {
        get: function () {
            return this._b9;
        },
        set: function (a) {
            if (a != this._b9) {
                this._b9 = a;
                this._ht(1);
                this.a("AllowDeleteWorksheet");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "areGridlinesVisible", {
        get: function () {
            return this._ca;
        },
        set: function (a) {
            if (a != this._ca) {
                this._ca = a;
                if (!this._c2(524288)) {
                    this._iy();
                    if (this._a7 != null) {
                        this._a7._iq(this.areGridlinesVisible);
                    }
                }
                this.a("AreGridlinesVisible");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "areHeadersVisible", {
        get: function () {
            return this._cb;
        },
        set: function (a) {
            if (a != this._cb) {
                this._cb = a;
                if (!this._c2(131072)) {
                    this._iy();
                    if (this._a7 != null) {
                        this._a7._ir(this.areHeadersVisible);
                    }
                }
                this.a("AreHeadersVisible");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "cellEditMode", {
        get: function () {
            return this._aj;
        },
        set: function (a) {
            if (a != this._aj) {
                this._aj = a;
                this._ah.aq();
                this.a("CellEditMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "chartAdapter", {
        get: function () {
            return this._bm;
        },
        set: function (a) {
            if (a != this._bm) {
                this._bm = a;
                if (this._a7 != null) {
                    this._a7._al._l = a;
                }
                this.a("ChartAdapter");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "enterKeyNavigationDirection", {
        get: function () {
            return this._av;
        },
        set: function (a) {
            if (a != this._av) {
                this._av = a;
                this.a("EnterKeyNavigationDirection");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "fixedDecimalPlaceCount", {
        get: function () {
            return this._fd;
        },
        set: function (a) {
            if (a != this._fd) {
                this._fd = a;
                this.a("FixedDecimalPlaceCount");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isEnterKeyNavigationEnabled", {
        get: function () {
            return this._ce;
        },
        set: function (a) {
            if (a != this._ce) {
                this._ce = a;
                this._ht(1);
                this.a("IsEnterKeyNavigationEnabled");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isFixedDecimalEnabled", {
        get: function () {
            return this._cf;
        },
        set: function (a) {
            if (a != this._cf) {
                this._cf = a;
                this.a("IsFixedDecimalEnabled");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isFormulaBarVisible", {
        get: function () {
            return this._cg;
        },
        set: function (a) {
            if (a != this._cg) {
                this._cg = a;
                this.a("IsFormulaBarVisible");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isInEditMode", {
        get: function () {
            return this._c2(8388608);
        },
        set: function (a) {
            if (a != this.isInEditMode) {
                var b = a;
                this._id(8388608, b);
                this._ht(1);
                if (this._a7 != null) {
                    this._a7._al._s = b;
                }
                this.a("IsInEditMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isInEndMode", {
        get: function () {
            return this._ch;
        },
        set: function (a) {
            if (a != this._ch) {
                this._ch = a;
                this._ht(1);
                this.a("IsInEndMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isRenamingWorksheet", {
        get: function () {
            return this._ci;
        },
        set: function (a) {
            if (a != this._ci) {
                this._ci = a;
                this.a("IsRenamingWorksheet");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "isUndoEnabled", {
        get: function () {
            return this._ck;
        },
        set: function (a) {
            if (a != this._ck) {
                this._ck = a;
                this._f5(this.undoManager);
                this._id(4, a);
                this.a("IsUndoEnabled");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "nameBoxWidth", {
        get: function () {
            return this._ej;
        },
        set: function (a) {
            if (a != this._ej) {
                this._ej = a;
                this._t.onNameBoxWidthChanged();
                this.a("NameBoxWidth");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "panes", {
        get: function () {
            return this._j;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype._getPanesAsArray = function () {
        return Enumerable.a(SpreadsheetPane.$, this.panes);
    };
    Object.defineProperty(Spreadsheet.prototype, "selectionMode", {
        get: function () {
            return this._aq;
        },
        set: function (a) {
            if (a != this._aq) {
                this._aq = a;
                var b = this.activeSelection;
                if (b != null) {
                    b._x = a;
                }
                this._ht(1);
                this.a("SelectionMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "selectedWorksheets", {
        get: function () {
            return this._g;
        },
        set: function (a) {
            var e_43, _0;
            if (a != this._g) {
                var b = this._g;
                var c = a;
                var d = b != null && b.length > 1;
                var e = c != null && c.length > 1;
                if (e != d) {
                    this._ht(1);
                }
                if (c != null && c.length > 0) {
                    for (var g = 0; g < c.length; g++) {
                        var f = c[g];
                        if (f == null) {
                            throw new ArgumentException(0);
                        }
                    }
                    for (var h = 1; h < c.length; h++) {
                        if (c[h].workbook != c[h - 1].workbook) {
                            throw new InvalidOperationException(0);
                        }
                    }
                    this._g = a;
                    var i = c[0].workbook;
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(i._worksheets$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var j = _2.value;
                            j._w = arrayIndexOf1(Worksheet.$, c, j) >= 0;
                        }
                    }
                    catch (e_43_1) { e_43 = { error: e_43_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_43) throw e_43.error; }
                    }
                    if (this._dn == false && (i.windowOptions.selectedWorksheet == null || arrayIndexOf1(Worksheet.$, c, i.windowOptions.selectedWorksheet) < 0)) {
                        this.activeWorksheet = Enumerable.ad(Worksheet.$, c);
                    }
                }
                else {
                    this._g = a;
                }
                this._i0();
                this.a("SelectedWorksheets");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "undoManager", {
        get: function () {
            return this._b4;
        },
        set: function (a) {
            if (a != this._b4) {
                if (a == null) {
                    throw new InvalidOperationException(1, "UndoManager property can not be set to null. Set IsUndoEnabled to false instead.");
                }
                var b = this._b4;
                var c = a;
                this._b4 = a;
                if (b != null) {
                    this._f5(b);
                    if (this._b6 != null) {
                        this._b6.e();
                        this._b6 = null;
                    }
                }
                this._b3 = c;
                if (c != null) {
                    this._b6 = new WeakPropertyChangedHandler$1(Spreadsheet.$, this, c, Spreadsheet._hg);
                    c.propertyChanged = delegateCombine(c.propertyChanged, runOn(this._b6, this._b6.f));
                }
                this._ht(16 | 1);
                this.a("UndoManager");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "validationInputMessagePosition", {
        get: function () {
            return this._i6;
        },
        set: function (a) {
            if (PointUtil.notEquals(a, this._i6)) {
                this._i6 = a;
                this._iy();
                if (this._a7 != null) {
                    this._a7._bc._jg = this.validationInputMessagePosition;
                }
                this.a("ValidationInputMessagePosition");
            }
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype._hk = function (a, b) {
        var e_44, _0;
        if (a != null) {
            this._f6(this._b3, a);
            a._i6(this._bs);
            try {
                for (var _1 = tslib_1.__values(fromEnum(a._worksheets$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    c._fd.clear();
                }
            }
            catch (e_44_1) { e_44 = { error: e_44_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_44) throw e_44.error; }
            }
        }
        if (b != null) {
            b._iq(this._bs);
        }
        this._c1(false);
        this._id(2048, false);
        this._be._y = b;
        if (this._u != null) {
            if (!this._c2(2)) {
                this._iy();
            }
            this._i0();
        }
        else {
            this._hs();
        }
    };
    Object.defineProperty(Spreadsheet.prototype, "workbook", {
        get: function () {
            return this._bt;
        },
        set: function (a) {
            if (a != this._bt) {
                var b = this._bt;
                var c = a;
                this._bt = c;
                this._ht(1);
                this._hk(b, c);
                this.a("Workbook");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "zoomLevel", {
        get: function () {
            return this._ff;
        },
        set: function (a) {
            var _this = this;
            if (a != this._ff) {
                this._ff = a;
                if (!this._c2(32768)) {
                    this._iy();
                    if (this._a7 != null) {
                        this._gi(5, function () { return _this._a7._is(_this.zoomLevel); });
                    }
                }
                this.a("ZoomLevel");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_a5", {
        get: function () {
            return this._a7 != null ? this._a7._ao : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ai", {
        get: function () {
            return this._ah;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_de", {
        get: function () {
            return this._bd != null || this.isInEditMode;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_dg", {
        get: function () {
            return this._c2(2097152);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_dh", {
        get: function () {
            return this._c2(33554432);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_dn", {
        get: function () {
            return this._fe > 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_a3", {
        get: function () {
            return this._a2;
        },
        set: function (a) {
            if (a != this._a2) {
                this._a2 = a;
                if (a == null && this._c2(1)) {
                    this._hs();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ef", {
        get: function () {
            return this._aa;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ft", {
        get: function () {
            return this._fp;
        },
        set: function (a) {
            if (a != this._fp) {
                this._fp = a;
                this._t.onNameBoxValueChanged();
                this.a("NameBoxValue");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_dr", {
        get: function () {
            return this._c2(1024);
        },
        set: function (a) {
            this._ht(1024);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_ds", {
        get: function () {
            return this._c2(8192);
        },
        set: function (a) {
            this._ht(8192);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_b2", {
        get: function () {
            return this._b1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bl", {
        get: function () {
            return this._bk;
        },
        set: function (a) {
            if (a != this._bk) {
                this._bk = a;
                if (this._a7 != null) {
                    this._a7._a6 = a;
                }
                this.a("ResourceProvider");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_a8", {
        get: function () {
            return this._a7;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bc", {
        get: function () {
            return this._bb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bd", {
        get: function () {
            return this._be != null ? this._be._p : null;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_bf", {
        get: function () {
            return this._be;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_u", {
        get: function () {
            return this._s;
        },
        set: function (a) {
            this._s = a;
            this._v = this._s;
            if (a != null) {
                if (!this._c2(2)) {
                    this._iy();
                }
                this._i0();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_v", {
        get: function () {
            return this._t;
        },
        set: function (a) {
            var b = a || new Spreadsheet_NullView(this);
            if (b != this._t || this._t == null) {
                this._c1(false);
                this._t = b;
                if (this._a7 != null) {
                    this._a7._al._j = this._t.createRenderCache();
                }
                this._go();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet.prototype, "_x", {
        get: function () {
            if (this._w == null) {
                this._w = new SpreadsheetVisualDataManager();
            }
            return this._w;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet.prototype.exportVisualData = function () {
        return this._x.exportVisualData(this);
    };
    Spreadsheet.prototype._hitTest = function (a) {
        var b = this._v.getLayoutManager();
        return b != null ? b.k(a) : null;
    };
    Spreadsheet.prototype.showFilterDialogForWorksheet = function (a, b) {
        if (b === void 0) { b = 13; }
        this._iu();
        var c = new FilterDialogViewModel(0, this.activeWorksheet, a, b);
        var d = this._v;
        d.showFilterDialog(c);
    };
    Spreadsheet.prototype.showFilterDialogForTable = function (a, b) {
        if (b === void 0) { b = 13; }
        this._iu();
        if (a == null) {
            throw new ArgumentNullException(1);
        }
        if (a._worksheet != this.activeWorksheet) {
            throw new InvalidOperationException(1, "Cannot show the filter dialog for a table column that is not in the active worksheet.");
        }
        var c = new FilterDialogViewModel(1, a, b);
        var d = this._v;
        d.showFilterDialog(c);
    };
    Spreadsheet.prototype.showTopOrBottomDialogForWorksheet = function (a) {
        this._iv();
        var b = new TopOrBottomDialogViewModel(0, this.activeWorksheet, a);
        var c = this._v;
        c.showTopOrBottomDialog(b);
    };
    Spreadsheet.prototype.showTopOrBottomDialogForTable = function (a) {
        this._iv();
        if (a == null) {
            throw new ArgumentNullException(1);
        }
        if (a._worksheet != this.activeWorksheet) {
            throw new InvalidOperationException(1, "Cannot show the Top or Bottom Dialog for a table column that is not in the active worksheet.");
        }
        var b = new TopOrBottomDialogViewModel(1, a);
        var c = this._v;
        c.showTopOrBottomDialog(b);
    };
    Spreadsheet.prototype._ii = function (a) {
        this._it();
        if (a == null) {
            throw new ArgumentNullException(0, "sortTarget");
        }
        var b = this._v;
        var c = this._a7;
        var d = c._a1;
        var e = c.activePane;
        var f;
        if (e == null) {
            f = function (g) {
            };
        }
        else {
            var g = e.selection;
            var h_4 = g.activeCell;
            var i_2 = new SpreadsheetSelection(this, c.activePane, true);
            c._a1 = i_2;
            f = function (j) {
                if (j._n) {
                    var k_2 = SpreadsheetUtilities.z(j);
                    var l = h_4.row;
                    var m = h_4.column;
                    if (!k_2._contains2(l, m)) {
                        m = Math.max(k_2.firstColumn, Math.min(k_2.lastColumn, m));
                        l = Math.max(k_2.firstRow, Math.min(k_2.lastRow, l));
                    }
                    i_2._resetSelection2(k_2, new SpreadsheetCell(l, m), false);
                }
            };
        }
        var j = new SortDialogViewModel(this, a, f);
        var k = function () { return c._a1 = d; };
        b.showCustomSortDialog(j, k);
    };
    Spreadsheet.prototype._cl = function (a) {
        return this._a7.activatePane(a);
    };
    Spreadsheet.prototype._f0 = function () {
        if (this._c2(2097152)) {
            throw new InvalidOperationException(0);
        }
        this._ir();
        this._id(2097152, true);
    };
    Spreadsheet.prototype._f1 = function (a, b, c, d, e, f) {
        this._iy();
        if (this._a7 != null) {
            this._a7._f4(a, b, c, d, e, f);
        }
    };
    Spreadsheet.prototype._cw = function (a, b) {
        if (b) {
            this._iw();
        }
        return this._c2(a ? 32 : 64);
    };
    Spreadsheet.prototype._cr = function (a, b, c) {
        if (c === void 0) { c = true; }
        var d = this._bo(a, b);
        return this._cq(a, b, d, c);
    };
    Spreadsheet.prototype._cq = function (a, b, c, d) {
        if (d === void 0) { d = true; }
        if (false == this._l.c(a, c)) {
            return false;
        }
        switch (a) {
            case 96:
            case 98:
            case 95:
            case 97:
                if (this._a7 != null && !this._a7._bu()) {
                    return false;
                }
                break;
            case 164:
                if (!this._cs()) {
                    return false;
                }
                break;
            case 165:
                if (this._a7 != null && !this._a7._bv(true)) {
                    return false;
                }
                break;
            case 114:
                if (SpreadsheetUtilities.a3(this.workbook)) {
                    return false;
                }
                break;
            case 150:
                if (this._c7()) {
                    return false;
                }
                break;
            case 156:
            case 157:
                if (this._a7 != null && !this._a7._bs(a == 156)) {
                    return false;
                }
                break;
            case 176:
            case 177:
            case 179:
                if (this._a7 == null || !this._a7._bt(a != 179)) {
                    return false;
                }
                break;
            case 188:
            case 190:
                if (this._a7 == null || !this._a7._b8()) {
                    return false;
                }
                break;
            case 189:
                if (this._a7 == null || !this._a7._cx(true, this._ag(b))) {
                    return false;
                }
                break;
            case 187:
            case 186:
            case 195:
            case 196:
            case 197:
            case 203:
                if ((16 & c.i) != 0) {
                    if (SpreadsheetCell._l_op_Equality_Lifted$i(this._fk(b), Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                        return false;
                    }
                }
                if (a == 203) {
                    return false;
                }
                break;
            case 198: return false;
        }
        if (this._bd != null) {
            switch (a) {
                case 86:
                case 85: return false;
            }
        }
        if (d && this.isInEditMode) {
            if (false == this._ah.ab(a)) {
                return false;
            }
        }
        return true;
    };
    Spreadsheet.prototype._ct = function (a) {
        if (this._a7 == null) {
            return false;
        }
        if (nullableNotEquals(this._a7._en(), false)) {
            var b = a ? 16 : 8;
            if (nullableNotEquals(this._a7._fj(b), true)) {
                return false;
            }
        }
        return true;
    };
    Spreadsheet.prototype._cv = function (a) {
        return this._a7 != null && this._a7._canSelect1(a);
    };
    Spreadsheet.prototype._cu = function (a) {
        return this._a7 != null && this._a7._canSelect(a);
    };
    Spreadsheet.prototype._f8 = function () {
        this._t.closeMenu();
    };
    Spreadsheet.prototype._ge = function () {
        this._ht(16 | 1);
    };
    Spreadsheet.prototype._gf = function () {
        this._id(2097152, false);
        this._ia();
    };
    Spreadsheet.prototype._cx = function (a, b, c) {
        if (b === void 0) { b = false; }
        if (c === void 0) { c = false; }
        return this._bb.g(a, b, c);
    };
    Spreadsheet.prototype._gg = function (a) {
        var b = this.activePane;
        if (null != b && !b.visibleRange._contains(a)) {
            this._f1(b, a, 0.5, 0.5, 0.5, 0.5);
        }
    };
    Spreadsheet.prototype._gh = function (a, b) {
        if (this._a7 != null && this._a7._dl.contains(b) && (this._a7.activePane == b || this._a7.canActivatePane(b) == false)) {
            var c_1 = a.y / b.rowScrollRegion._bx;
            var d_2 = a.x / b.columnScrollRegion._bx;
            var e_45 = new WorksheetItemPosition(), f_5 = new WorksheetItemPosition();
            var g = ((function () { var h = b.rowScrollRegion._az(c_1, e_45); e_45 = h.p1; return h.ret; })());
            var h = ((function () { var i = b.columnScrollRegion._az(d_2, f_5); f_5 = i.p1; return i.ret; })());
            if (g && h) {
                var i = b._ag.activeCell;
                var j = this._a7._fk(i) == null;
                if (this._ah.y(i, j)) {
                    this._ah.av(a, true);
                }
            }
        }
    };
    Spreadsheet.prototype._cz = function (a, b, c) {
        var d = this._bo(a, b);
        return this._c0(a, b, c, d);
    };
    Spreadsheet.prototype._c0 = function (a, b, c, d) {
        var _this = this;
        var e = this._v._beforeExecuteCommand$i(a, b, c);
        if (e.hasValue) {
            return e.value;
        }
        if (!this._cq(a, b, d)) {
            return false;
        }
        this._i0();
        var f = new SpreadsheetCommandExecutingEventArgs(a, b, c);
        this._gu(f);
        if (f.cancel) {
            return true;
        }
        var g = true;
        try {
            this._ir();
            if (this._ah.ag(a, false)) {
            }
            else {
                if (!this._d8(a)) {
                    return true;
                }
                if (this._v.isInNameBox) {
                    if (!this._v.focus() || this._v.isInNameBox) {
                        return true;
                    }
                }
                switch (a) {
                    case 1:
                        this._a7._fw();
                        this._gg(this.activeCell);
                        break;
                    case 0:
                        this._a7._fx();
                        this._gg(this.activeCell);
                        break;
                    case 9:
                        this._a7._g3(3, 0, false);
                        break;
                    case 8:
                        this._a7._g3(2, 0, false);
                        break;
                    case 7:
                        this._a7._g3(0, 0, false);
                        break;
                    case 6:
                        this._a7._g3(1, 0, false);
                        break;
                    case 13:
                        this._a7._g3(3, 1, false);
                        break;
                    case 12:
                        this._a7._g3(2, 1, false);
                        break;
                    case 10:
                        this._a7._g3(0, 1, false);
                        break;
                    case 11:
                        this._a7._g3(1, 1, false);
                        break;
                    case 17:
                        this._a7._g3(3, 2, false);
                        break;
                    case 16:
                        this._a7._g3(2, 2, false);
                        break;
                    case 14:
                        this._a7._g3(0, 2, false);
                        break;
                    case 15:
                        this._a7._g3(1, 2, false);
                        break;
                    case 19:
                        this._a7._g4(2, false);
                        break;
                    case 18:
                        this._a7._g4(3, false);
                        break;
                    case 21:
                        this._a7._g4(0, false);
                        break;
                    case 20:
                        this._a7._g4(1, false);
                        break;
                    case 3:
                        this._a7._hc(0);
                        break;
                    case 2:
                        this._a7._hc(1);
                        break;
                    case 4:
                        this._a7._hc(2);
                        break;
                    case 5:
                        this._a7._hc(3);
                        break;
                    case 29:
                        this._a7._ia(3);
                        break;
                    case 28:
                        this._a7._ia(2);
                        break;
                    case 26:
                        this._a7._ia(0);
                        break;
                    case 27:
                        this._a7._ia(1);
                        break;
                    case 25:
                        this._a7._h9(3);
                        break;
                    case 24:
                        this._a7._h9(2);
                        break;
                    case 22:
                        this._a7._h9(0);
                        break;
                    case 23:
                        this._a7._h9(1);
                        break;
                    case 30:
                        this._a7._g6(false, false);
                        break;
                    case 33:
                        this._a7._g6(false, true);
                        break;
                    case 31:
                        this._a7._g5(true, false);
                        break;
                    case 35:
                        this._a7._g5(false, false);
                        break;
                    case 32:
                        this._a7._g7(false, false);
                        break;
                    case 34:
                        this._a7._g7(false, true);
                        break;
                    case 36:
                        this.isInEndMode = true;
                        break;
                    case 37:
                        this.isInEndMode = false;
                        break;
                    case 68:
                        this.selectionMode = 0;
                        break;
                    case 69:
                        this.selectionMode = 1;
                        break;
                    case 70:
                        this.selectionMode = 2;
                        break;
                    case 39:
                        this._a7._hb(false);
                        break;
                    case 38:
                        this._a7._ha(false);
                        break;
                    case 40:
                        this._a7._id();
                        break;
                    case 44:
                        this._a7._g3(3, 0, true);
                        break;
                    case 43:
                        this._a7._g3(2, 0, true);
                        break;
                    case 42:
                        this._a7._g3(0, 0, true);
                        break;
                    case 41:
                        this._a7._g3(1, 0, true);
                        break;
                    case 48:
                        this._a7._g3(3, 1, true);
                        break;
                    case 47:
                        this._a7._g3(2, 1, true);
                        break;
                    case 45:
                        this._a7._g3(0, 1, true);
                        break;
                    case 46:
                        this._a7._g3(1, 1, true);
                        break;
                    case 52:
                        this._a7._g3(3, 2, true);
                        break;
                    case 51:
                        this._a7._g3(2, 2, true);
                        break;
                    case 49:
                        this._a7._g3(0, 2, true);
                        break;
                    case 50:
                        this._a7._g3(1, 2, true);
                        break;
                    case 54:
                        this._a7._g4(2, true);
                        break;
                    case 53:
                        this._a7._g4(3, true);
                        break;
                    case 56:
                        this._a7._g4(0, true);
                        break;
                    case 55:
                        this._a7._g4(1, true);
                        break;
                    case 58:
                        this._a7._g5(true, true);
                        break;
                    case 62:
                        this._a7._g5(false, true);
                        break;
                    case 57:
                        this._a7._g6(true, false);
                        break;
                    case 60:
                        this._a7._g6(true, true);
                        break;
                    case 59:
                        this._a7._g7(true, false);
                        break;
                    case 61:
                        this._a7._g7(true, true);
                        break;
                    case 63:
                        this._a7._ha(true);
                        break;
                    case 64:
                        this._a7._hb(true);
                        break;
                    case 66:
                        this._a7._ie(false);
                        break;
                    case 65:
                        this._a7._ie(true);
                        break;
                    case 67:
                        this._a7._ic();
                        break;
                    case 71:
                        this._a7._g9(true);
                        break;
                    case 72:
                        this._a7._g9(false);
                        break;
                    case 73:
                        this._ah.y(this.activeCell, false);
                        break;
                    case 151:
                        this.cellEditMode = this.cellEditMode == 1 ? 2 : 1;
                        break;
                    case 74:
                        this._ah.y(this.activeCell, true, stringEmpty());
                        break;
                    case 75:
                        this._ah.ae(1, false);
                        break;
                    case 76:
                        this._ah.ae(2, false);
                        break;
                    case 77:
                        this._ah.ae(3, false);
                        break;
                    case 78:
                        this._ah.ae(0, false);
                        break;
                    case 79:
                        this._f3();
                        break;
                    case 158:
                        this._gi(28, function () { return _this._a7._gc(true, true); });
                        break;
                    case 80:
                        this._a7._c4();
                        break;
                    case 83:
                        this._a7._ii();
                        break;
                    case 81:
                        this._a7._f6(true);
                        break;
                    case 82:
                        this._a7._f6(false);
                        break;
                    case 84:
                        this._a7._ib();
                        break;
                    case 86:
                        this.undoManager.bf();
                        break;
                    case 85:
                        this.undoManager.a7();
                        break;
                    case 87:
                    case 88:
                        this._ho(a == 88);
                        break;
                    case 92:
                    case 91:
                        this._gl(a == 91, true);
                        break;
                    case 90:
                    case 89:
                        this._gl(a == 89, false);
                        break;
                    case 93:
                    case 94:
                        this._fz(a == 93);
                        break;
                    case 96:
                        this._gr(1);
                        break;
                    case 95:
                        this._gr(2);
                        break;
                    case 97:
                        this._gr(3);
                        break;
                    case 98:
                        this._gr(0);
                        break;
                    case 99:
                        this._gj(0);
                        break;
                    case 100:
                        this._gj(1);
                        break;
                    case 101:
                        this._gj(8);
                        break;
                    case 102:
                        this._gj(9);
                        break;
                    case 103:
                        this._gj(10);
                        break;
                    case 104:
                        this._gj(11);
                        break;
                    case 105:
                        this._gj(5);
                        break;
                    case 106:
                        this._gj(4);
                        break;
                    case 107:
                        this._gj(2);
                        break;
                    case 108:
                        this._gj(3);
                        break;
                    case 109:
                        this._gj(6);
                        break;
                    case 110:
                        this._gj(7);
                        break;
                    case 111:
                        this._gj(12);
                        break;
                    case 112:
                        this._gj(13);
                        break;
                    case 114:
                        this._gj(14);
                        break;
                    case 113:
                        this._h9();
                        break;
                    case 115:
                        this._i4(0);
                        break;
                    case 116:
                        this._i4(1);
                        break;
                    case 117:
                        this._i4(2);
                        break;
                    case 118:
                        this._i4(3);
                        break;
                    case 119:
                        this._ic(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.c0(this._bx()._c2), SpreadsheetUtilities.ef, 6, 128);
                        break;
                    case 120:
                        this._ic(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.c0(this._bx()._c3), SpreadsheetUtilities.eo, 7, 1024);
                        break;
                    case 121:
                        this._ic(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.c0(this._bx()._c4), SpreadsheetUtilities.et, 8, 4096);
                        break;
                    case 160:
                        this._ic(FontUnderlineStyle_$type, SpreadsheetUtilities.al(this._bx()._a1, this._d3()), SpreadsheetUtilities.ew, 20, 16384);
                        break;
                    case 161:
                        this._ic(FontUnderlineStyle_$type, SpreadsheetUtilities.ak(this._bx()._a1, this._d3()), SpreadsheetUtilities.ew, 20, 16384);
                        break;
                    case 122:
                        this._ic(Nullable$1.$.specialize(Boolean_$type), Nullable$1.toNullable(Boolean_$type, this._bx()._b8 ? false : true), SpreadsheetUtilities.ey, 9, 536870912);
                        break;
                    case 162:
                        this._ic(FontSuperscriptSubscriptStyle_$type, this._bx()._a0 == 1 ? 0 : 1, SpreadsheetUtilities.ev, 19, 8192);
                        break;
                    case 163:
                        this._ic(FontSuperscriptSubscriptStyle_$type, this._bx()._a0 == 2 ? 0 : 2, SpreadsheetUtilities.ev, 19, 8192);
                        break;
                    case 123:
                        this._gm(true);
                        break;
                    case 124:
                        this._gm(false);
                        break;
                    case 125:
                        this._ic(Number_$type, SpreadsheetUtilities.cj(this._bx()._cq, true), SpreadsheetUtilities.el, 11, 512);
                        break;
                    case 126:
                        this._ic(Number_$type, SpreadsheetUtilities.cj(this._bx()._cq, false), SpreadsheetUtilities.el, 11, 512);
                        break;
                    case 127:
                        this._ic(HorizontalCellAlignment_$type, SpreadsheetUtilities.aq(this._bx()._a4, 2), SpreadsheetUtilities.ee, 15, 1);
                        break;
                    case 129:
                        this._ic(HorizontalCellAlignment_$type, SpreadsheetUtilities.aq(this._bx()._a4, 1), SpreadsheetUtilities.ee, 13, 1);
                        break;
                    case 130:
                        this._ic(HorizontalCellAlignment_$type, SpreadsheetUtilities.aq(this._bx()._a4, 3), SpreadsheetUtilities.ee, 14, 1);
                        break;
                    case 128:
                        this._ic(HorizontalCellAlignment_$type, SpreadsheetUtilities.aq(this._bx()._a4, 5), SpreadsheetUtilities.ee, 12, 1);
                        break;
                    case 131:
                        this._ic(VerticalCellAlignment_$type, 0, SpreadsheetUtilities.ex, 16, 268435456);
                        break;
                    case 133:
                        this._ic(VerticalCellAlignment_$type, 2, SpreadsheetUtilities.ex, 17, 268435456);
                        break;
                    case 132:
                        this._ic(VerticalCellAlignment_$type, 1, SpreadsheetUtilities.ex, 18, 268435456);
                        break;
                    case 134:
                        this._a7._iy(false);
                        break;
                    case 135:
                        this._a7._iy(true);
                        break;
                    case 137:
                        this._a7._gm(0, 1);
                        break;
                    case 136:
                        this._a7._gm(1, 0);
                        break;
                    case 142:
                    case 140:
                    case 138:
                        this._a7._hy(a != 138, a != 140);
                        break;
                    case 141:
                    case 139:
                    case 143:
                        this._a7._it(a != 139, a != 141);
                        break;
                    case 145:
                        this._gi(24, runOn(this._a7, this._a7._gy));
                        break;
                    case 144:
                        this._gi(22, runOn(this._a7, this._a7._gh));
                        break;
                    case 147:
                        this._gi(25, runOn(this._a7, this._a7._gx));
                        break;
                    case 146:
                        this._gi(22, runOn(this._a7, this._a7._gg));
                        break;
                    case 156:
                        this._gi(23, function () { return _this._a7._gw(Nullable$1.toNullable(Boolean_$type, null)); });
                        break;
                    case 157:
                        this._gi(22, function () { return _this._a7._gf(Nullable$1.toNullable(Boolean_$type, null)); });
                        break;
                    case 153:
                        this._gi(23, function () { return _this._a7._gw(Nullable$1.toNullable(Boolean_$type, false)); });
                        break;
                    case 154:
                        this._gi(22, function () { return _this._a7._gf(Nullable$1.toNullable(Boolean_$type, true)); });
                        break;
                    case 152:
                        this._gi(23, function () { return _this._a7._gw(Nullable$1.toNullable(Boolean_$type, true)); });
                        break;
                    case 155:
                        this._gi(22, function () { return _this._a7._gf(Nullable$1.toNullable(Boolean_$type, false)); });
                        break;
                    case 150:
                        this._hn();
                        break;
                    case 149:
                        this._gb(false);
                        break;
                    case 148:
                        this._gb(true);
                        break;
                    case 159:
                        this._a7._ix();
                        break;
                    case 164:
                        this._hm();
                        break;
                    case 165:
                        this._gi(29, function () { return _this._a7._hw(true); });
                        break;
                    case 166:
                        this._gi(30, function () { return _this._a7._hw(false); });
                        break;
                    case 167:
                    case 168:
                        this._a7._g8(a == 167);
                        break;
                    case 169:
                        this.nameBoxWidth = 102;
                        break;
                    case 171:
                        this._a7._ge();
                        break;
                    case 170:
                        this._a7._gb();
                        break;
                    case 173:
                        this._cx(false);
                        break;
                    case 172:
                        this._cx(true);
                        break;
                    case 174:
                        this._gi(35, function () { return _this._a7._gz(true); });
                        break;
                    case 175:
                        this._gi(36, function () { return _this._a7._fy(true); });
                        break;
                    case 176:
                        this._gi(37, function () { return _this._a7._gz(false); });
                        break;
                    case 177:
                        this._gi(38, function () { return _this._a7._fy(false); });
                        break;
                    case 178:
                        this._gi(39, function () { return _this._a7._gi(true); });
                        break;
                    case 179:
                        this._gi(40, function () { return _this._a7._gi(false); });
                        break;
                    case 180:
                    case 181:
                        this._a7._ig(a == 181);
                        break;
                    case 182:
                        this._a7._ih();
                        break;
                    case 183:
                        this._gi(32, function () { return _this._a7._bh.isTotalsRowVisible = !_this._a7._bh.isTotalsRowVisible; });
                        break;
                    case 184:
                        this._gi(33, function () { return _this._a7._bc._tables$i.remove_1(_this._a7._bh, true); });
                        break;
                    case 185:
                        if (this._a7._cg()) {
                            this._gi(41, function () { return _this._a7._il(false); });
                        }
                        else {
                            this._gi(42, function () { return _this._a7._il(true); });
                        }
                        break;
                    case 187:
                        this._gi(34, function () { return _this._a7._iu(0, true, _this._fk(b)); });
                        break;
                    case 186:
                        this._gi(34, function () { return _this._a7._iu(0, false, _this._fk(b)); });
                        break;
                    case 188:
                        this._gi(44, function () { return _this._a7._gd(); });
                        break;
                    case 189:
                        this._gi(43, function () { return _this._a7._cx(false, _this._ag(b)); });
                        break;
                    case 190:
                        this._gi(45, function () { return _this._a7._hu(); });
                        break;
                    case 192:
                        this._gi(43, function () { return _this._a7._gl(2); });
                        break;
                    case 193:
                        this._gi(43, function () { return _this._a7._gl(1); });
                        break;
                    case 194:
                        this._gi(43, function () { return _this._a7._gl(3); });
                        break;
                    case 191:
                        this._gi(43, function () { return _this._a7._gl(0); });
                        break;
                    case 196:
                        this._gi(34, function () { return _this._a7._iu(1, true, _this._fk(b)); });
                        break;
                    case 197:
                        this._gi(34, function () { return _this._a7._iu(3, true, _this._fk(b)); });
                        break;
                    case 195:
                        this._gi(34, function () { return _this._a7._iu(2, true, _this._fk(b)); });
                        break;
                    case 200:
                        this._gs(false);
                        break;
                    case 199:
                        this._gs(true);
                        break;
                    case 201:
                        this._ig();
                        break;
                    case 202:
                        this._ih();
                        break;
                    case 198:
                        this._il();
                        break;
                    case 203:
                        this._im(this._fk(b));
                        break;
                    default:
                        g = false;
                        break;
                }
            }
        }
        finally {
            this._ia();
        }
        this._gt(new SpreadsheetCommandExecutedEventArgs(a, b, c));
        return g;
    };
    Spreadsheet.prototype._c1 = function (a) {
        if (this.isInEditMode && !this._ah.ae(a ? 1 : 0, true)) {
            return false;
        }
        if (this._bd != null && !this._cx(a, true)) {
            return false;
        }
        return true;
    };
    Spreadsheet._i7 = function (a, b) {
        if (b === void 0) { b = false; }
        if (a == null) {
            return PointUtil.create();
        }
        var c = a._ag;
        var d = SpreadsheetUtilities.aa(c);
        var e = a.rowScrollRegion._bx;
        var f = c.activeCell;
        var g = Math.min(Math.max(f.column, a.columnScrollRegion.startIndex), a.columnScrollRegion.endIndex);
        var h = Math.min(Math.max(f.row, a.rowScrollRegion.startIndex), a.rowScrollRegion.endIndex);
        var i = false;
        var j = false;
        if (b) {
            d = 2;
        }
        switch (d) {
            case 7:
            case 2: break;
            case 0:
                h = a.rowScrollRegion.startIndex;
                i = true;
                break;
            case 1:
                g = a.columnScrollRegion.startIndex;
                j = true;
                break;
        }
        var k = a.columnScrollRegion._bn(g, j) * e;
        var l = a.rowScrollRegion._bn(h, i) * e;
        return SpreadsheetUtilities.e3(k, l);
    };
    Spreadsheet.prototype._an = function () {
        if (this._a7 == null) {
            return SpreadsheetCellRange.empty;
        }
        return this._a7._aa();
    };
    Spreadsheet.prototype._fr = function (a) {
        if (a != null) {
            var b = a.chart;
            var c = b.chartTitle;
            if (c == null) {
                return "";
            }
            if (b._seriesCollection$i.count == 1) {
                var d = b._seriesCollection$i.item(0).name;
                if (d != null) {
                    return d.toString();
                }
            }
            else {
                var e = -1;
                for (var f = 0; f < b._seriesCollection$i.count; f++) {
                    var g = b._seriesCollection$i.item(f).values.getValues();
                    if (g != null && g.length > 0) {
                        if (e >= 0) {
                            e = -1;
                            break;
                        }
                        else {
                            e = f;
                        }
                    }
                }
                if (e >= 0) {
                    var h = b._seriesCollection$i.item(e).name;
                    if (h != null) {
                        return h.toString();
                    }
                }
            }
        }
        return this._fs("DefaultChartTitle");
    };
    Spreadsheet.prototype._fs = function (a) {
        var b = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            b[_0 - 1] = arguments[_0];
        }
        var c;
        if (this._e9 != null) {
            c = this._e9.getResourceString(a);
            c = Localization.c("spreadsheet", a);
        }
        else {
            c = Localization.c("spreadsheet", a);
        }
        switch (a) {
            case "NewSheetName":
                c = "Sheet{0}";
                break;
        }
        if (!stringIsNullOrEmpty(c) && b != null && b.length > 0) {
            c = stringFormat1.apply(void 0, tslib_1.__spread([c], b));
        }
        return c;
    };
    Spreadsheet.prototype._gn = function () {
        if (this._c2(2)) {
            return;
        }
        this._id(2, true);
        this._i0();
    };
    Spreadsheet.prototype._dt = function (a) {
        if (!this._d7(true)) {
            return false;
        }
        return true;
    };
    Spreadsheet.prototype._g2 = function (a, b) {
        var c = Nullable$1.toNullable(SpreadsheetAction_$type, null);
        if ((a && this._a7._ct(true)) || (b && this._a7._ct(false))) {
            if (a && b) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 143);
            }
            else if (a) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 141);
            }
            else if (b) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 139);
            }
        }
        else {
            if (a && b) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 142);
            }
            else if (a) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 140);
            }
            else if (b) {
                c = Nullable$1.toNullable(SpreadsheetAction_$type, 138);
            }
        }
        if (nullableNotEquals(c, null)) {
            this._cz(c.value, null, null);
        }
    };
    Spreadsheet.prototype._g9 = function (a) {
        if (a) {
            if (this._fc == 0) {
                this._e6 = Localization.a;
            }
            this._fc++;
        }
        else {
            this._fc--;
            if (this._fc == 0) {
                Localization.a = this._e6;
                this._e6 = null;
            }
        }
    };
    Spreadsheet.prototype._dv = function (a, b) {
        if (this._d7(true)) {
            this._t.focus();
            var c = this.activePane;
            if (c != null) {
                var d = a.g();
                var e = c.rowScrollRegion._ab;
                var f = e._x;
                var g = ((d & 4) != 0) || f == 1;
                var h = ((d & 2) != 0) || f == 2;
                var i = false;
                if (h == g || !g) {
                    var j = this.panes.item(0);
                    var k = j.rowScrollRegion._o;
                    if (k.canActivatePane(j)) {
                        if (k.activatePane(j)) {
                            if (j == this.activePane) {
                                c = j;
                                e = j.selection;
                            }
                        }
                        else {
                            i = true;
                        }
                    }
                }
                if (!i) {
                    var l = this._an();
                    var m = g && !h ? e.activeCell : c.visibleRange._c;
                    if (this._cv(l)) {
                        if (h && !g) {
                            e._addActiveCellRange1(l, m);
                        }
                        else {
                            e._resetSelection2(l, m);
                        }
                    }
                    if (a.a() == 2) {
                        this._v._showSelectAllContextMenu$i(b, a.h());
                    }
                    return true;
                }
            }
        }
        return false;
    };
    Spreadsheet.prototype._dw = function (a, b, c) {
        var _this = this;
        if (b === void 0) { b = false; }
        if (c === void 0) { c = false; }
        var d = stringCompare1(a, this._ft, 1) == 0;
        if (d && this._c2(8) && stringCompare1(a, this._ft, 0) == 0) {
            return true;
        }
        var e = this.activeCell;
        var f = this.workbook;
        var g = this.activeWorksheet;
        if (g == null) {
            return false;
        }
        var h = this.activeSelection;
        var i = this.activePane;
        if (h == null || i == null) {
            return false;
        }
        if (!b && this.selectionMode == 1) {
            b = true;
        }
        else if (!c && this.selectionMode == 2) {
            c = true;
        }
        if (b && c) {
            b = c = false;
        }
        var j = null;
        var k = null;
        if (stringIsNullOrWhiteSpace(a)) {
            if (this._y != null) {
                j = this._y;
            }
        }
        else {
            var l = a;
            var m_2;
            a = a.trim();
            if (stringStartsWith(a, "=")) {
                if (a.length == 1) {
                    return this._dz(new SpreadsheetUserPromptInfo(9, null, null, l, false));
                }
                a = a.substr(1);
            }
            var n_1 = b ? 1 : c ? 2 : 0;
            var o = SelectionSnapshot._d(g, h);
            var p = f.getTable(a);
            if (p != null) {
                var q = SpreadsheetUtilities.z(p.dataAreaRegion._h);
                j = o._e(p.worksheet, q, n_1);
            }
            else if (stringCompare1(a, "c", 1) == 0) {
                var r = this._an();
                j = o._f(g, new SpreadsheetCellRange(r.firstRow, e.column, r.lastRow, e.column), new SpreadsheetCell(this.activePane.rowScrollRegion.startIndex, e.column), n_1);
            }
            else if (stringCompare1(a, "r", 1) == 0) {
                var s = this._an();
                j = o._f(g, new SpreadsheetCellRange(e.row, s.firstColumn, e.row, s.lastColumn), new SpreadsheetCell(e.row, this.activePane.columnScrollRegion.startIndex), n_1);
            }
            else {
                var t_1 = g._rows$i.item(e.row);
                var u_1 = e.column;
                var v_1 = ((function () { var w = f._ar(a, f.cellReferenceMode, g, t_1, u_1, m_2, true); m_2 = w.p5; return w.ret; })());
                if (v_1 == null) {
                    var w_1 = f.cellReferenceMode == 1 ? 0 : 1;
                    v_1 = ((function () { var x = f._ar(a, w_1, g, t_1, u_1, m_2); m_2 = x.p5; return x.ret; })());
                    if (v_1 != null && w_1 == 1) {
                        return this._dz(new SpreadsheetUserPromptInfo(9, null, null, l, false));
                    }
                }
                if (v_1 != null) {
                    if (m_2) {
                        v_1 = this._br(v_1, t_1, u_1);
                        if (v_1 == null) {
                            return false;
                        }
                    }
                    if (!((function () { var x = _this._d6(v_1, j, n_1); j = x.p1; return x.ret; })())) {
                        return this._dz(new SpreadsheetUserPromptInfo(9, null, null, l, false));
                    }
                }
                else {
                    if (g.isProtected) {
                        return false;
                    }
                    try {
                        f._jc(a, null);
                    }
                    catch (x) {
                        return this._dz(new SpreadsheetUserPromptInfo(9, null, x, l, false));
                    }
                    var y = NamedReferenceBase._s(a);
                    var z = y ? g : null;
                    var aa = ExcelUtils.d5(null, g.name);
                    var ab = FormulaParser.bx(f._e6);
                    var ac = new StringBuilder(0);
                    ac.l("=");
                    for (var ad = 0, ae = h.cellRanges.count; ad < ae; ad++) {
                        if (ad > 0) {
                            ac.h(ab);
                        }
                        ac.l(aa);
                        ac.l(h.cellRanges.item(ad)._af(f.cellReferenceMode, false));
                    }
                    try {
                        var af = ac.toString();
                        if (y) {
                            k = f._namedReferences$i._add3(a, af, f.cellReferenceMode, g);
                        }
                        else {
                            k = f._namedReferences$i._add2(a, af, f.cellReferenceMode);
                        }
                    }
                    catch (ag) {
                        return this._dz(new SpreadsheetUserPromptInfo(9, null, ag, l, false));
                    }
                }
            }
        }
        var ah = false;
        if (k != null) {
            ah = true;
        }
        else if (j != null) {
            this._y = SelectionSnapshot._d(g, h);
            ah = j != null && false == j._i(g, h);
            var ai = this._ft;
            this._ie(j, true);
            if (ah && ai != this._ft) {
                ah = false;
            }
        }
        if (this._t.hasKeyboardFocusWithin) {
            this._t.focus();
        }
        if (ah && k != null && this.selectionMode != 0) {
            this._cz(68, null, null);
        }
        return ah;
    };
    Spreadsheet.prototype._du = function (a) {
        if (this._a7 == null) {
            return false;
        }
        if (a.b == 1 || a.b == 0) {
            var b = this._a7._bc;
            if (!b.isProtected || b.protection.allowFiltering) {
                if (!this._d7(false) || this.selectedWorksheets == null || this.selectedWorksheets.length > 1) {
                    return false;
                }
                return true;
            }
        }
        else {
            if (!this._d7(false)) {
                return false;
            }
        }
        return true;
    };
    Spreadsheet.prototype._dz = function (a) {
        this._h6(a);
        if (a.e) {
            var b = a.h;
            var c = a.b ? 1 : 0;
            var d = a.b && a.c ? 2 : 1;
            var e = this._u.showMessageBox(a.i, b, c, 0, d);
            if (this.isInEditMode && this.cellEditMode == 1) {
                this._cz(151, null, null);
            }
            if (e == 2) {
                return true;
            }
            return false;
        }
        else {
            if (a.b) {
                return a.c;
            }
            return false;
        }
    };
    Spreadsheet.prototype._hi = function () {
        if (this._a7 != null) {
            this._a7._hk();
        }
        this._ht(8192 | 16777216);
    };
    Spreadsheet.prototype._ho = function (a) {
        var b = SpreadsheetUtilities.o(this.enterKeyNavigationDirection);
        if (a) {
            b = SpreadsheetUtilities.n(b);
        }
        this._a7._hm(b);
    };
    Spreadsheet.prototype._d0 = function (a, b) {
        var e_46, _0;
        var c = false;
        var d = this._bp(LongValue.a(), null);
        var e = this._l.e(a, b, d);
        if (null != e) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    c = this._c0(f, null, this, d) || c;
                }
            }
            catch (e_46_1) { e_46 = { error: e_46_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_46) throw e_46.error; }
            }
        }
        return c;
    };
    Spreadsheet.prototype._d1 = function (a, b) {
        if (this._a7 == null || this._bd != null || this._a2 != null) {
            return false;
        }
        this._a7._cu(a, b);
        return true;
    };
    Spreadsheet.prototype._hq = function () {
        if (this._c2(128)) {
            this._id(128, false);
            this._i0();
        }
    };
    Spreadsheet.prototype._d2 = function (a, b) {
        if (b === void 0) { b = false; }
        if (this.isInEditMode) {
            return false;
        }
        var c = false;
        if (!stringIsNullOrEmpty(a) && !b) {
            for (var d = 0; d < a.length; d++) {
                var e = a.charAt(d);
                var f = false;
                if (/\s/i.test(e) || isLetterOrDigit(e)) {
                    f = true;
                }
                else {
                    var g = CharUnicodeInfo.e(e);
                    if (SpreadsheetUtilities.bf(g) || SpreadsheetUtilities.bg(g)) {
                        f = true;
                    }
                }
                if (f) {
                    c = true;
                    break;
                }
            }
        }
        if (!c && !b) {
            return false;
        }
        var h = null;
        if (!stringIsNullOrEmpty(a) && a != Environment.newLine && (a.length > 1 || indexOfAny(a, ['\r', '\n']) < 0)) {
            h = a;
        }
        else if (b) {
            h = a;
        }
        this._ah.y(this.activeCell, true, h);
        return true;
    };
    Spreadsheet.prototype._ia = function (a) {
        if (a === void 0) { a = true; }
        this._fe--;
        if (this._fe == 0) {
            this._g9(false);
        }
        if (this._fe == 0 && a && !this._c2(8)) {
            this._i1();
        }
    };
    Spreadsheet.prototype._d4 = function (a, b) {
        var _this = this;
        var e_47, _0, e_48, _1, e_49, _2;
        if (!this._du(b)) {
            return false;
        }
        if (b.b == 1 || b.b == 0) {
            return this._v.showFilterMenu(a, b);
        }
        var c = this._a7;
        var d = c._bc;
        var e = c._getCellRange1(b.d, b.c);
        var f = d._rows$i._aj(e.firstRow);
        var g = new List$1(String_$type, 0);
        var h = -1;
        var i = null;
        switch (b.b) {
            case 4:
                {
                    var j = -1;
                    var k_3 = new HashSet$1(String_$type, 0);
                    var l_2 = d._de(e.firstRow, e.firstColumn);
                    var m = function (n, o) {
                        if (n.index != o) {
                            return false;
                        }
                        var p = n._getCellValue1(e.firstColumn);
                        if (p == null) {
                            return false;
                        }
                        if (l_2 == null) {
                            var q = d._de(o, e.firstColumn);
                            if (q != null) {
                                return false;
                            }
                        }
                        if (typeof p === 'string') {
                            k_3.add_1(p);
                        }
                        else if (typeCast(FormattedString.$, p) !== null) {
                            k_3.add_1(p.unformattedString);
                        }
                        return true;
                    };
                    var n = l_2 != null ? l_2.dataAreaRegion.firstRow : 0;
                    var o = l_2 != null ? l_2.dataAreaRegion.lastRow : d.workbook.maxRowCount - 1;
                    if (e.firstRow > n && (l_2 == null || !l_2.isHeaderRowVisible || e.firstRow > l_2._by._ac)) {
                        j = e.firstRow - 1;
                        try {
                            for (var _3 = tslib_1.__values(fromEnum(d._rows$i._n(n, e.firstRow - 1, false))), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                                var p = _4.value;
                                if (m(p, j)) {
                                    j--;
                                }
                                else {
                                    break;
                                }
                            }
                        }
                        catch (e_47_1) { e_47 = { error: e_47_1 }; }
                        finally {
                            try {
                                if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                            }
                            finally { if (e_47) throw e_47.error; }
                        }
                    }
                    if (e.firstRow < o && (l_2 == null || !l_2.isTotalsRowVisible || e.firstRow < l_2._by._ae)) {
                        j = e.firstRow + 1;
                        try {
                            for (var _5 = tslib_1.__values(fromEnum(d._rows$i._m(e.firstRow + 1, o))), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                var q = _6.value;
                                if (m(q, j)) {
                                    j++;
                                }
                                else {
                                    break;
                                }
                            }
                        }
                        catch (e_48_1) { e_48 = { error: e_48_1 }; }
                        finally {
                            try {
                                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                            }
                            finally { if (e_48) throw e_48.error; }
                        }
                    }
                    g.o(k_3);
                    g.y();
                    i = function (r) {
                        if (r < 0 || r >= g.count) {
                            return;
                        }
                        var s = g._inner[r];
                        var t = function () { return d._rows$i.item(e.firstRow).setCellValue(e.firstColumn, s); };
                        _this._gi(0, t, [e], void 0, s);
                    };
                }
                break;
            case 2:
                {
                    var r = typeCast(ListDataValidationRule.$, d._dataValidationRules$i._e(new WorksheetRegionAddress(1, e.firstRow, e.firstRow, e.firstColumn, e.firstColumn)));
                    if (r == null) {
                        return false;
                    }
                    var s = new Spreadsheet_CustomEditValueParser(this, d._b4(f, e.firstColumn));
                    var t_2 = r._bj(runOn(s, s.d));
                    if (t_2 != null) {
                        for (var u = 0; u < t_2.length; u++) {
                            var v = t_2[u];
                            if (typeCast(Spreadsheet_CustomEditValue.$, v) !== null) {
                                g.add(v.c);
                            }
                            else {
                                g.add(v != null ? v.toString() : "");
                            }
                        }
                    }
                    else {
                        var w = r._bl(new WorksheetCellAddress(1, e.firstRow, e.firstColumn));
                        if (w == null) {
                            return false;
                        }
                        var x = new List$1(Base.$, 0);
                        try {
                            for (var _7 = tslib_1.__values(fromEnum(w)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                var y = _8.value;
                                if (y.isReference) {
                                    var z = y._j(false);
                                    var aa = typeCast(CellCalcReference.$, z.context);
                                    if (aa != null) {
                                        x.add1(aa._w._getCellValue1(aa._ao));
                                        g.add(aa._w._getCellText1(aa._ao, 1));
                                        continue;
                                    }
                                }
                                var ab = CalcUtilities.m(y._bj(false, false), true);
                                x.add1(ab);
                                g.add(ab != null ? ab.toString() : "");
                            }
                        }
                        catch (e_49_1) { e_49 = { error: e_49_1 }; }
                        finally {
                            try {
                                if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                            }
                            finally { if (e_49) throw e_49.error; }
                        }
                        t_2 = x.toArray();
                    }
                    var ac = f != null ? f._getCellText1(e.firstColumn, 1) : "";
                    h = g.indexOf(ac);
                    i = function (ad) {
                        if (ad < 0 || ad >= t_2.length) {
                            return;
                        }
                        _this._gi(48, function () {
                            var ae = t_2[ad];
                            if (typeCast(Spreadsheet_CustomEditValue.$, ae) !== null) {
                                var af = ae;
                                ae = af.b;
                                if (af.a != -1) {
                                    var ag = d.workbook._b2.item(af.a);
                                    d._rows$i.item(e.firstRow)._cellFormatInternal.formatString = ag;
                                }
                            }
                            d._rows$i.item(e.firstRow).setCellValue(e.firstColumn, ae);
                        });
                    };
                }
                break;
            case 3:
                {
                    var ad_2 = d._de(e.firstRow, e.firstColumn);
                    if (ad_2 == null) {
                        return false;
                    }
                    var ae_2 = FormulaParser.bx(d.workbook._e6);
                    var af = f == null ? null : f.getCellFormula(e.firstColumn);
                    var ag_1 = af != null ? af._toString1(1) : null;
                    h = 0;
                    var ah_1 = new List$1(String_$type, 0);
                    var ai = function (aj, ak) {
                        g.add(_this._fs(aj));
                        var al = ad_2._columns$i._item(e.firstColumn - ad_2._by._w);
                        var am = StructuredTableReference.ad(al.name);
                        var an = "=SUBTOTAL(" + ak + ae_2 + "[" + am + "])";
                        if (an == ag_1) {
                            h = ah_1.count;
                        }
                        ah_1.add(an);
                    };
                    g.add(this._fs("TotalRow_None"));
                    ah_1.add(null);
                    ai("TotalRow_Average", 101);
                    ai("TotalRow_Count", 103);
                    ai("TotalRow_CountNumbers", 102);
                    ai("TotalRow_Max", 104);
                    ai("TotalRow_Min", 105);
                    ai("TotalRow_Sum", 109);
                    ai("TotalRow_StdDev", 107);
                    ai("TotalRow_Var", 110);
                    i = function (aj) {
                        if (aj < 0 || aj >= ah_1.count) {
                            return;
                        }
                        _this._gi(47, function () {
                            var ak = ah_1._inner[aj];
                            var al = d._rows$i.item(e.firstRow);
                            if (stringIsNullOrEmpty(ak)) {
                                al.setCellValue(e.firstColumn, null);
                            }
                            else {
                                al._applyCellFormula$i(e.firstColumn, ak, Nullable$1.toNullable(CellReferenceMode_$type, 1));
                            }
                        });
                    };
                }
                break;
        }
        var aj = a.columnScrollRegion._b7(e.firstColumn);
        var ak = e._ad == 1 ? aj : a.columnScrollRegion._b7(e.lastColumn);
        var al = a.rowScrollRegion._b7(e.firstRow);
        var am = al;
        var an = a.columnScrollRegion._bx;
        var ao = a.columnScrollRegion._bm(aj, true) * an;
        var ap = a.columnScrollRegion._bm(ak, false) * an;
        var aq = a.rowScrollRegion._bm(al, true) * an;
        var ar = a.rowScrollRegion._bm(am, false) * an;
        var as = new Rect(0, ao, aq, ap - ao, ar - aq);
        as.union(b.g);
        var at = function (au) {
            if (au >= 0 && au < g.count) {
                _this._gz(e._c, g._inner[au]);
            }
            i(au);
        };
        return this._v._showCellDropDown$i(a, as, g, h, at);
    };
    Spreadsheet.prototype._il = function () {
        var _this = this;
        var a = this._v;
        var b = false;
        var c = false;
        var d = false;
        var e = 63;
        var f = null;
        var g;
        var h;
        if (this.isInEditMode) {
            h = FormatCellsDialogDataBuilder.g(this);
            e = 4;
            g = function (i) { return SetFormatCellsDialogDataHelper.g(_this.activeSelectionCellRangeFormat.font, i, h); };
        }
        else {
            var i = this.activeSelection;
            var j_2 = Enumerable.a(SpreadsheetCellRange.$, i.cellRanges);
            h = FormatCellsDialogDataBuilder.f(this.selectedWorksheets, j_2);
            var k = this.activeWorksheet._rows$i._g(i.activeCell.row, false);
            for (var m = 0; m < j_2.length; m++) {
                var l = j_2[m];
                if (l._ad > 1) {
                    b = true;
                }
                if (l._aa > 1) {
                    c = true;
                }
            }
            d = this._cr(96, null);
            var p = this.selectedWorksheets;
            for (var o = 0; o < p.length; o++) {
                var n = p[o];
                if (n.isProtected) {
                    e &= ~32;
                }
            }
            if (k != null) {
                f = k._getCellValue1(i.activeCell.column);
                if (typeCast(FormattedString.$, f) !== null) {
                    f = f.unformattedString;
                }
            }
            g = function (q) { return _this._gi(10, function () {
                var r = new SetFormatCellsDialogDataHelper();
                r.e = _this._a7;
                r.a = j_2;
                r.c = q;
                r.b = h;
                r.f();
            }, j_2); };
        }
        h.o = this.workbook;
        var q = h.a();
        var r = ((function () {
            var $ret = new FormatCellsDialogOptions();
            $ret.i = Nullable$1.toNullable(FormatCellsDialogTab_$type, null);
            $ret.b = true;
            $ret.c = true;
            $ret.d = c;
            $ret.e = b;
            $ret.f = d;
            $ret.g = true;
            $ret.h = true;
            return $ret;
        })());
        r.a = e;
        var s = new FormatCellsDialogViewModel(r, h, a.spreadsheetDialogServicesManager, f, this._fl);
        a.showFormatCellsDialog(s, function (t) {
            if (!t.a) {
                g(q);
            }
            _this._fl = s._q.b;
        });
    };
    Spreadsheet.prototype._ir = function () {
        if (this._fe == 0) {
            this._g9(true);
        }
        this._fe++;
    };
    Spreadsheet.prototype._d7 = function (a) {
        if (this.isInEditMode && !this._ah.ae(a ? 1 : 0, false, true)) {
            return false;
        }
        if (this._bd != null) {
            if (!this._cx(false) || this._bd != null) {
                return false;
            }
        }
        return true;
    };
    Spreadsheet.prototype._is = function () {
        var a = new Workbook(2);
        var b = a._worksheets$i._add1(this._fs("NewSheetName", 1));
        a.windowOptions.selectedWorksheet = b;
        this.workbook = a;
    };
    Spreadsheet.prototype._i0 = function () {
        if (this._dn || this._c2(8)) {
            return;
        }
        try {
            this._ir();
            this._i1();
        }
        finally {
            this._ia();
        }
    };
    Spreadsheet.prototype._fv = function (a, b) {
        if (this._ec == null) {
            this._ec = new Dictionary$2(String_$type, Base.$, 0);
        }
        if (!this._ec.containsKey(a)) {
            this._ec.item(a, b);
            this._ht(134217728);
        }
    };
    Spreadsheet.prototype._fw = function () {
        if (this._a7 != null && !this._a7._cj) {
            if (this._c2(134217728)) {
                this._id(134217728, false);
                this._hy();
            }
        }
    };
    Spreadsheet.prototype._fz = function (a) {
        var _this = this;
        var b = a ? 2 : 3;
        this._gi(b, function () { return _this._a7._f1(a); });
    };
    Spreadsheet.prototype._f2 = function () {
        if (this._fu != null) {
            var a = this._fu;
            this._fu = null;
            a.c.c();
        }
    };
    Spreadsheet.prototype._cs = function () {
        if (this._a7 != null) {
            var a = this._a7.activePane;
            if (a != null) {
                var b = a._ag;
                if (b.cellRanges.count == 1) {
                    var c = b.cellRanges.item(0);
                    var d = b.activeCell;
                    var e = void 0;
                    if (c.isSingleCell) {
                        e = true;
                    }
                    else {
                        var f = b._t(d);
                        e = SpreadsheetCellRange.l_op_Equality(f, c);
                    }
                    if (e) {
                        var g = this._a7._bc._rows$i._aj(d.row);
                        return this._a7._bc._ck(g, d.row, d.column) != null;
                    }
                }
            }
        }
        return false;
    };
    Spreadsheet.prototype._f3 = function () {
        var _this = this;
        if (this._a7._c9() == false) {
            return;
        }
        this._gi(1, function () { return _this._a7._ak(0, false); }, void 0, true);
    };
    Spreadsheet.prototype._f5 = function (a) {
        this._f6(a, this.workbook);
    };
    Spreadsheet.prototype._f6 = function (a, b) {
        if (b != null) {
            a.a8(function (c) { return c.d == b; });
        }
    };
    Spreadsheet.prototype._f4 = function (a) {
        var b = this.undoManager;
        if (a != null) {
            b.a8(function (c) {
                var d = typeCast(IWorksheetUndoUnit_$type, c);
                return d != null ? d.sheet == a : false;
            }, true);
        }
    };
    Spreadsheet.prototype._gb = function (a) {
        var _this = this;
        var b = this._a7;
        if (a && b._b1(false, true)) {
            return;
        }
        if (!a) {
            var c = b.activePane;
            var d = c != null ? c.selection : null;
            if (null != d && d.cellRanges.count > 1 && b._b1(false, true)) {
                return;
            }
        }
        if (a && !b._da()) {
            return;
        }
        var e = new WorkbookDataObjectManager(this.workbook);
        e.beforeCopying = delegateCombine(e.beforeCopying, function (f, g) {
            if (b._b8(true)) {
                if (_this._cz(83, null, null)) {
                    b._i2();
                }
            }
        });
        e.copying = delegateCombine(e.copying, function (f, g) {
            if (!_this._t.shouldCopyToClipboard(g._dataObject, g._isDragDrop)) {
                g._cancel = true;
            }
            else if (a) {
                var h_5 = 1;
                _this._gi(27, function () {
                    h_5 = b._ak(0, false);
                    if (h_5 == 2) {
                        b._h1(true);
                        b._h0(true);
                        b._gc(false, false);
                    }
                }, void 0, true);
                if (h_5 != 2) {
                    g._cancel = true;
                }
            }
            if (!g._cancel) {
                _this._g0(g._dataObject, g._isDragDrop);
            }
        });
        e.settingData = delegateCombine(e.settingData, function (f, g) {
            if (!_this._t.shouldIncludeClipboardFormat(g._dataObject, g._format)) {
                g._cancel = true;
            }
        });
        e.error = delegateCombine(e.error, function (f, g) {
            var h = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
            if (typeCast(InvalidMultipleRangeSelection.$, g._exception) !== null) {
                h = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 18);
            }
            var i = nullableNotEquals(h, null) ? new SpreadsheetUserPromptInfo(h.value, null, g._exception, null, false) : new SpreadsheetUserPromptInfo(14, _this._fs("PasteError_General_Message", g._exception.message), g._exception, null, false);
            _this._dz(i);
        });
        var f = function () {
            var g = new SpreadsheetUserPromptInfo(31, null, null, null, true);
            g.c = true;
            g.d = false;
            return !_this._dz(g);
        };
        e.c(f);
    };
    Spreadsheet.prototype._gd = function () {
        this._ht(1024 | 8192);
        this._ab._ai(false);
    };
    Spreadsheet.prototype._gi = function (a, b, c, d, e, f, g) {
        if (c === void 0) { c = null; }
        if (d === void 0) { d = false; }
        if (e === void 0) { e = null; }
        if (f === void 0) { f = true; }
        if (g === void 0) { g = false; }
        var h = g && !this._c2(4);
        if (h) {
            this._id(4, true);
        }
        try {
            if (this._c2(4)) {
                var i_3 = null;
                var j = this.activePane;
                if (j != null && f) {
                    var k = j.selection;
                    var l = Enumerable.a(SpreadsheetCellRange.$, k.cellRanges);
                    if (c == null && d) {
                        c = l;
                    }
                    var m = new SelectionSnapshot(this._a7._bc, l, k.activeCell, k.activeCellRangeIndex);
                    i_3 = new SpreadsheetSelectionUndoTransaction(this, this._a7._bc, a, e, c, m, runOn(this, this._ie));
                }
                else {
                    if (j != null && c == null && d) {
                        c = Enumerable.a(SpreadsheetCellRange.$, j.selection.cellRanges);
                    }
                    i_3 = new SpreadsheetUndoTransaction(this, this._a7._bc, a, e, c);
                }
                this._b3.az(i_3, b);
                if (h) {
                    this._b3.a8(function (n) { return n == i_3; }, true);
                }
            }
            else {
                b();
            }
        }
        catch (n) {
            if (!(typeCast(EditModeDataValidationException.$, n) !== null)) {
                this._dz(new SpreadsheetUserPromptInfo(19, null, n, enumGetBox(SpreadsheetTransactionOperation_$type, a), false));
            }
        }
        finally {
            if (h) {
                this._id(4, this.isUndoEnabled);
            }
        }
    };
    Spreadsheet.prototype._gj = function (a) {
        if (this._bd != null && !this._cx(false, false)) {
            return;
        }
        switch (a) {
            case 14:
                if (this._dz(new SpreadsheetUserPromptInfo(5, null, null, null, true))) {
                    return;
                }
                break;
        }
        this._be._a5(a);
    };
    Spreadsheet.prototype._fk = function (a) {
        if (a != null) {
            if (typeof a === 'string') {
                return Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(a));
            }
            if (typeCast(SpreadsheetCell.$, a) !== null) {
                return Nullable$1.toNullable(SpreadsheetCell.$, a);
            }
        }
        return Nullable$1.toNullable(SpreadsheetCell.$, null);
    };
    Spreadsheet.prototype._ag = function (a) {
        var b = this._fk(a);
        if (b.hasValue) {
            return b.value;
        }
        return this.activeCell;
    };
    Spreadsheet.prototype._bo = function (a, b) {
        var c = this._l.b(a);
        var d = c == null ? LongValue.a() : LongValue.c(c.a, c.b);
        return this._bp(d, b);
    };
    Spreadsheet.prototype._bp = function (a, b) {
        this._iw();
        var c = new LongValue(0);
        if ((a.j & (1 | 1048576)) != 0) {
            var d = this.workbook;
            if ((a.j & 1) != 0 && d != null) {
                c.j |= 1;
            }
            if ((a.j & 1048576) != 0 && d != null && this.workbook.protection.allowEditStructure == false) {
                c.j |= 1048576;
            }
        }
        if ((a.i & 2) != 0 && this.allowAddWorksheet) {
            c.i |= 2;
        }
        if ((a.i & 4) != 0 && this.allowDeleteWorksheet) {
            c.i |= 4;
        }
        if ((a.j & 4) != 0 && this.panes.count > 1) {
            c.j |= 4;
        }
        if (this._a7 != null) {
            if ((a.j & 2) != 0) {
                c.j |= 2;
            }
            if ((a.j & 65536) != 0 && this._a7._dh.count > 1) {
                c.j |= 65536;
            }
            if ((a.j & 32768) != 0 && this._a7._dn.count > 1) {
                c.j |= 32768;
            }
            if ((a.j & 8) != 0 && this._a7._b9) {
                c.j |= 8;
            }
            if ((a.j & -2147483648) != 0 && this._v.isInNameBox) {
                c.j |= -2147483648;
            }
            if ((a.j & (262144 | 524288)) != 0) {
                if (this._a7.activePane != null) {
                    var e = this._a7.activePane.selection;
                    if ((a.j & 262144) != 0 && e._bj.count > 0) {
                        c.j |= 262144;
                    }
                    if ((a.j & 524288) != 0 && e._bi.count > 0) {
                        c.j |= 524288;
                    }
                }
            }
            if ((a.i & (128 | 256)) != 0) {
                if (this._a7.activePane != null) {
                    var f = this._a7.activePane.selection;
                    if ((a.i & 128) != 0 && f.cellRanges.count > 1) {
                        c.i |= 128;
                    }
                    if ((a.i & 256) != 0 && f.cellRanges.count == 1 && SpreadsheetCellRange.l_op_Equality(f._r, f.cellRanges.item(0))) {
                        c.i |= 256;
                    }
                }
            }
            if (this._a7._bc.isProtected) {
                if ((a.j & 2097152) != 0) {
                    c.j |= 2097152;
                }
                var g = this._a7._bc.protection;
                if ((a.j & 4194304) != 0 && g.selectionMode == 1) {
                    c.j |= 4194304;
                }
                if ((a.j & 8388608) != 0 && g.allowFormattingCells == false) {
                    c.j |= 8388608;
                }
                if ((a.j & 16777216) != 0 && g.allowFormattingColumns == false) {
                    c.j |= 16777216;
                }
                if ((a.j & 33554432) != 0 && g.allowFormattingRows == false) {
                    c.j |= 33554432;
                }
                if ((a.j & 67108864) != 0 && g.allowInsertingColumns == false) {
                    c.j |= 67108864;
                }
                if ((a.j & 134217728) != 0 && g.allowInsertingRows == false) {
                    c.j |= 134217728;
                }
                if ((a.j & 268435456) != 0 && g.allowDeletingColumns == false) {
                    c.j |= 268435456;
                }
                if ((a.j & 536870912) != 0 && g.allowDeletingRows == false) {
                    c.j |= 536870912;
                }
                if ((a.i & 32) != 0 && g.allowSorting == false) {
                    c.i |= 32;
                }
                if ((a.i & 64) != 0 && g.allowFiltering == false) {
                    c.i |= 64;
                }
            }
            if ((a.i & 8) != 0 && this.activeTable != null) {
                c.i |= 8;
            }
            if ((a.i & 16) != 0) {
                if (this._a7._cb()) {
                    c.i |= 16;
                }
            }
        }
        if ((a.j & 16) != 0) {
            if (this._v.isScrollLockToggled) {
                c.j |= 16;
            }
        }
        if ((a.j & 32) != 0 && this.isInEndMode) {
            c.j |= 32;
        }
        var h = 64 | 128 | 256;
        if ((a.j & h) != 0) {
            switch (this.selectionMode) {
                case 0:
                    c.j |= 64;
                    break;
                case 1:
                    c.j |= 128;
                    break;
                case 2:
                    c.j |= 256;
                    break;
            }
        }
        if ((a.j & 512) != 0 && this.isInEditMode) {
            c.j |= 512;
        }
        if ((a.i & 1) != 0 && this._bd != null) {
            c.i |= 1;
        }
        if ((a.j & 1024) != 0 && this._c2(32)) {
            c.j |= 1024;
        }
        if ((a.j & 2048) != 0 && this._c2(64)) {
            c.j |= 2048;
        }
        if ((a.j & 4096) != 0 && this.isEnterKeyNavigationEnabled) {
            c.j |= 4096;
        }
        if ((a.j & 8192) != 0 && this._be._ae) {
            c.j |= 8192;
        }
        if ((a.j & 16384) != 0 && this._be._ac) {
            c.j |= 16384;
        }
        if ((a.j & 131072) != 0 && this._be._j.count > 1) {
            c.j |= 131072;
        }
        if ((a.j & 1073741824) != 0 && this.cellEditMode == 2) {
            c.j |= 1073741824;
        }
        return c;
    };
    Spreadsheet.prototype._c2 = function (a) {
        return (this._z & a) != 0;
    };
    Spreadsheet.prototype._br = function (a, b, c) {
        var d = typeCast(NamedCalcReference.$, a);
        if (d == null) {
            return null;
        }
        var e = b._as(c);
        return d._a3._bo(true, e);
    };
    Spreadsheet.prototype._bx = function () {
        var a = this._a7.activePane.selection;
        var b = a.activeCell;
        var c = this._a7._bc._rows$i._aj(b.row);
        var d = this._a7._bc._b4(c, b.column);
        return d;
    };
    Spreadsheet.prototype._ee = function () {
        var a = this.activeSelection;
        return a != null ? a.cellRanges : boxArray$1(new Array(0));
    };
    Spreadsheet.prototype._gl = function (a, b) {
        var _this = this;
        var c = b ? 2 : 3;
        this._gi(c, function () { return _this._a7._gp(a, b); });
    };
    Spreadsheet.prototype._gm = function (a) {
        var _this = this;
        if (this._a7 == null || this._a7.activePane == null) {
            return;
        }
        var b = this._a7.activePane.selection;
        this._gi(10, function () { return _this._a7._f7(a); });
    };
    Spreadsheet.prototype._go = function () {
        this._ah = this._t.createCellEditManager() || new Spreadsheet_NullCellEditManager(this);
        this._bb = this._t.createTabEditManager() || new Spreadsheet_NullTabEditManager(this);
        this.a("CellEditManager");
        this.a("TabEditManager");
    };
    Spreadsheet.prototype._gp = function (a, b) {
        if (this._a7 != null) {
            var c = this._a7._bc;
            var d = this._c2(a);
            this._id(a, true);
            try {
                b(c);
            }
            finally {
                this._id(a, d);
            }
        }
    };
    Spreadsheet._c4 = function (a) {
        switch (a.a) {
            case 5:
            case 24:
            case 81:
            case 82:
            case 83:
            case 89:
            case 4:
            case 27:
            case 61:
            case 85:
            case 88:
            case 87:
            case 66:
            case 68:
            case 69:
            case 67:
            case 70:
            case 71:
            case 16:
            case 47:
            case 48:
            case 49:
            case 42:
            case 43:
            case 44:
            case 45:
            case 72:
            case 73:
            case 74:
            case 75:
            case 76:
            case 84:
            case 77:
            case 78: return true;
        }
        return false;
    };
    Spreadsheet._c5 = function (a) {
        switch (a.a) {
            case 4:
            case 27:
            case 61:
            case 66:
            case 68:
            case 69:
            case 67:
            case 70:
            case 71:
            case 85:
            case 88:
            case 87: return true;
        }
        return false;
    };
    Spreadsheet.prototype._c7 = function () {
        if (this._b7) {
            return false;
        }
        try {
            var a = ClipboardHelper.e();
            return WorkbookDataObjectManager.d(a) == false;
        }
        catch (b) {
            this._b7 = true;
            return false;
        }
    };
    Spreadsheet._dc = function (a) {
        switch (a.a) {
            case 5: return true;
        }
        return Spreadsheet._c5(a);
    };
    Spreadsheet._dj = function (a) {
        switch (a.a) {
            case 87:
            case 90:
            case 9:
            case 65:
                if (a.c == "IsProtected") {
                    return true;
                }
                break;
            case 103:
                if (a.c == "SelectionMode") {
                    return true;
                }
                break;
            case 1:
            case 23:
            case 38:
            case 2:
            case 22:
            case 80:
            case 73:
            case 84:
            case 79:
            case 75:
            case 76:
            case 77:
            case 78: return true;
        }
        return false;
    };
    Spreadsheet._dm = function (a) {
        switch (a.a) {
            case 17:
            case 53:
            case 54:
            case 25:
            case 73:
            case 84:
            case 79:
            case 92:
            case 91: return true;
            case 87:
                switch (a.c) {
                    case "":
                    case "CellReferenceMode":
                    case "CurrentFormat": return true;
                }
                break;
            case 52:
            case 72:
                switch (a.c) {
                    case "Name": return true;
                }
                break;
        }
        return false;
    };
    Spreadsheet._dq = function (a) {
        switch (a.a) {
            case 99: return false;
            case 86:
                switch (a.c) {
                    case "BoundsInTwips":
                    case "FirstVisibleTabIndex":
                    case "Minimized":
                    case "TabBarWidth":
                    case "SelectedSheet": return false;
                }
                break;
            case 65:
                switch (a.c) {
                    case "IsTabSelected": return false;
                }
                break;
        }
        return true;
    };
    Spreadsheet.prototype._gr = function (a) {
        var _this = this;
        this._gi(4, function () { return _this._a7._g2(a); });
    };
    Spreadsheet.prototype._gs = function (a) {
        if (this._a7 == null) {
            return;
        }
        var b = this._a7.activePane.selection;
        b._by();
        if (this._a7._bh == null) {
            return;
        }
        var c = this._a7._bh;
        var d = b.activeCell;
        var e = c._by;
        var f = c.dataAreaRegion;
        var g = f != null && f._q(d.row, d.column);
        var h = !g && c.isHeaderRowVisible && d.row == e._ac;
        var i = this._a7._bc;
        if (!g && !h) {
            this._a7._hc(a ? 1 : 0);
            return;
        }
        var j = e._ae;
        var k = e._ac;
        var l = false;
        if (a) {
            var m = i._rows$i._aj(e._ae);
            var n = (i._dv && m == null) || (m != null && m.hidden);
            l = !n;
            if (l && !c.isTotalsRowVisible) {
                j = Math.min(this._a7._aa().lastRow, e._ae + 1);
            }
        }
        else {
            if (c.isTotalsRowVisible) {
                j = e._ae - 1;
            }
        }
        if (!h) {
            k += 1;
        }
        var o = new SpreadsheetCellRange(k, e._w, j, e._x);
        var p = a ? this._a7._fa(o, Nullable$1.toNullable(SpreadsheetCell.$, d)) : this._a7._fg(o, Nullable$1.toNullable(SpreadsheetCell.$, d));
        if (SpreadsheetCell._l_op_Equality_Lifted$i(p, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            p = a ? this._a7._fa(o, Nullable$1.toNullable(SpreadsheetCell.$, null)) : this._a7._fg(o, Nullable$1.toNullable(SpreadsheetCell.$, null));
        }
        else if (a) {
            if (l && p.value.row == o.lastRow && e._ae < this._a7._aa().lastRow) {
                this._gi(38, function () {
                    var e_50, _0;
                    var q = false;
                    var r = i._rows$i._aj(o.lastRow);
                    if (r != null) {
                        try {
                            for (var _1 = tslib_1.__values(fromEnum(r._ch(o.firstColumn, o.lastColumn, true))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                                var s = _2.value;
                                if (s.o) {
                                    q = true;
                                    break;
                                }
                            }
                        }
                        catch (e_50_1) { e_50 = { error: e_50_1 }; }
                        finally {
                            try {
                                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                            }
                            finally { if (e_50) throw e_50.error; }
                        }
                    }
                    if (q) {
                        c.insertDataRows(f._aa);
                    }
                    else {
                        var t = new WorksheetRegion(i, e._ac, e._w, e._ae + 1, e._x);
                        c._resize(t);
                    }
                });
            }
        }
        if (SpreadsheetCell._l_op_Equality_Lifted$i(p, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            return;
        }
        this._a7._ik(p.value, false, Nullable$1.toNullable(SpreadsheetCellRange.$, new SpreadsheetCellRange(p.value.row, p.value.column)));
    };
    Spreadsheet.prototype._hm = function () {
        var a = this.activeSelection;
        if (a != null && a.cellRanges.count == 1) {
            var b = a.cellRanges.item(0);
            var c = a.activeCell;
            var d = a._t(c);
            if (SpreadsheetCellRange.l_op_Equality(d, b)) {
                var e = this._a7._bc;
                var f = e._rows$i._aj(c.row);
                var g = e._ck(f, c.row, c.column);
                if (g != null) {
                    this._i2(g);
                }
            }
        }
    };
    Spreadsheet.prototype._dx = function (a) {
        var b = a.e(true);
        var c = new SpreadsheetEditRangePasswordNeededEventArgs(b, boxArray$1(Enumerable.a(Worksheet.$, Enumerable.o(LockedEditRangeInfoForWorksheet.$, Worksheet.$, a.c, function (d) { return d.b; }))));
        this._h4(c);
        return c.cancel == false;
    };
    Spreadsheet.prototype._he = function (a, b, c) {
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (this._a7 != null && this._a7._ck(a)) {
                    this._ht(1);
                }
                else if (this._be._af(a)) {
                    this._ht(512);
                }
                else {
                    var d = getInstanceType(a);
                    if (d == SpreadsheetUtilities.d3 || d == SpreadsheetUtilities.d2) {
                        this._ht(4096 | 1);
                    }
                }
                break;
            case "ActivePane":
                if (a == this._a7) {
                    this.activePane = this._a7.activePane;
                }
                break;
            case "ActiveTable":
                if (a == this._a7) {
                    this.activeTable = this._a7._bh;
                }
                break;
            case "ZoomLevel":
                if (a == this._a7) {
                    this._ht(65536);
                }
                break;
            case "ActiveCellInputMessagePosition":
                if (a == this._a7) {
                    this._ht(67108864);
                }
                break;
            case "ActiveCell":
                if (a == this.activeSelection) {
                    this.activeCell = this.activeSelection.activeCell;
                }
                break;
            case "ActiveCellAsRange":
                if (a == this.activeSelection) {
                    this._am = this.activeSelection._r;
                }
                break;
            case "ActiveTab":
                if (a == this._be) {
                    this._ht(256);
                }
                break;
            case "IsNextItemOutOfView":
            case "IsPreviousItemOutOfView":
                if (a == this._be) {
                    this._ht(1);
                }
                break;
            case "TabInEdit":
                if (a == this._be) {
                    this._ht(16384);
                }
                break;
        }
    };
    Spreadsheet._hd = function (a, b, c, d) {
        a._he(b, c, d);
    };
    Spreadsheet._hg = function (a, b, c) {
        var d = c.propertyName;
        if (stringIsNullOrEmpty(d) || d == "CanUndo" || d == "CanRedo") {
            a._ht(16);
        }
    };
    Spreadsheet.prototype._hj = function ($tContext, $tValue, a, b) {
        var c = this._a7;
        var d = b.k(a);
        if (c != null && (c._bc == d || d == null)) {
            c._hd($tContext, $tValue, a, b);
            if (!this._c2(16777216 | 8192) && Spreadsheet._c4(b)) {
                this._ht(16777216 | 8192);
            }
        }
        if (this._be != null) {
            this._be._a6(b);
        }
        if (!this._ab._ab) {
            if (Spreadsheet._c5(b)) {
                this._gd();
            }
        }
        if (this._eh != null || !this._c2(4096)) {
            if (Spreadsheet._dm(b)) {
                this._eh = null;
                this._ht(4096);
            }
        }
        if (!this._c2(1)) {
            if (Spreadsheet._dj(b)) {
                this._ht(1);
            }
        }
        if (!this._c2(8192)) {
            if (Spreadsheet._dc(b)) {
                this._ht(8192);
            }
        }
        if (!this._c2(2048)) {
            if (Spreadsheet._dq(b)) {
                this._ht(2048);
            }
        }
        if (!this._c2(128)) {
            this._id(128, true);
            this._v.onHasPendingChangeNotification();
        }
        switch (b.a) {
            case 87:
                if (b.c == "CurrentFormat") {
                    this._ir();
                    try {
                        if (this._a7 != null) {
                            this._a7._hg();
                        }
                    }
                    finally {
                        this._ia();
                    }
                    this._f6(this._b3, this.workbook);
                }
                break;
            case 35:
                this._ht(1048576 | 262144);
                break;
            case 9:
            case 90:
            case 65:
                if (b.c == "IsProtected") {
                    if (d != null && d.isProtected) {
                        this._f4(d);
                    }
                }
                break;
        }
    };
    Spreadsheet.prototype._hn = function () {
        var _this = this;
        var a = this._a7;
        var b = new WorkbookDataObjectManager(this.workbook);
        var c = null;
        b.error = delegateCombine(b.error, function (d, e) {
            if (_this._a7 != null) {
                _this._a7._gt();
            }
            var f = typeCast(WorkbookSerializationLoadException.$, e._exception);
            var g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
            if (f != null) {
                switch (f._c) {
                    case 2:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 10);
                        break;
                    case 1:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 11);
                        break;
                    case 0:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 13);
                        break;
                    case 3:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 12);
                        break;
                    case 5:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 15);
                        break;
                    case 4:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 16);
                        break;
                    case 6:
                        g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 7);
                        break;
                    default: break;
                }
            }
            else if (typeCast(InvalidMultipleRangeSelection.$, e._exception) !== null) {
                g = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 12);
            }
            var h = nullableNotEquals(g, null) ? new SpreadsheetUserPromptInfo(g.value, null, e._exception, null, false) : new SpreadsheetUserPromptInfo(14, _this._fs("PasteError_General_Message", e._exception.message), e._exception, null, false);
            _this._dz(h);
            if (c != null) {
                _this._ie(c, false);
            }
        });
        b.pasting = delegateCombine(b.pasting, function (d, e) {
            _this._v.onDataObjectPasting(e);
            if (!e._cancel && e._dataObject != null) {
                if (a._b8(true)) {
                    c = SelectionSnapshot._d(_this.activeWorksheet, _this.activeSelection);
                    if (_this._cz(83, null, null)) {
                        a._i2();
                    }
                }
            }
        });
        var d = null;
        var e = function (f, g, h) {
            var i = Enumerable.a(Worksheet.$, f);
            var j = Enumerable.a(WorksheetRegionAddress.$, g);
            var k = f.item(0).workbook.windowOptions.selectedWorksheet;
            var l = k.displayOptions._af.a(k.displayOptions._z);
            var m = _this._ea(f, g, h);
            if (m) {
                TableExpansionInfo.f(i, j, l.b);
                d = TableExpansionInfo.a(i, j);
            }
            return m;
        };
        var f = ((function () {
            var $ret = new WorkbookSerializationLoadOptions();
            $ret.b = 8370167;
            $ret.g = _this.fixedDecimalPlaceCount;
            $ret.c = _this.isFixedDecimalEnabled;
            $ret.d = false;
            $ret.a = 0;
            $ret.e = runOn(_this, _this._d9);
            $ret.f = runOn(_this, _this._ea);
            return $ret;
        })());
        var g = false;
        this._gi(26, function () { return g = b.e(f); });
        if (g) {
            if (this._a7 != null) {
                this._a7._gt();
            }
            if (d != null) {
                this._gi(46, runOn(d, d.g));
            }
        }
    };
    Spreadsheet.prototype._hp = function (a) {
        var _this = this;
        if (this._c2(16777216)) {
            if (a) {
                this._f2();
                this._id(16777216, false);
                var b = this._c2(33554432);
                this._id(33554432, true);
                try {
                    this._ah.ao();
                }
                finally {
                    this._id(33554432, b);
                }
            }
            else {
                if (this._fu == null || SpreadsheetCell.l_op_Inequality(this._fu.d, this.activeCell)) {
                    this._f2();
                    this._fu = Tuple.a(TimedOperation.$, SpreadsheetCell.$, new TimedOperation(function () { return _this._hp(true); }, 250), this.activeCell);
                }
            }
        }
    };
    Spreadsheet.prototype._hs = function () {
        if (!this._c2(8)) {
            this._bq.m();
        }
    };
    Spreadsheet.prototype._ht = function (a) {
        if ((this._z & a) != a) {
            this._id(a, true);
            this._hs();
        }
    };
    Spreadsheet.prototype._hy = function () {
        var a = this._ec;
        this._ec = null;
        var b;
        if (a != null) {
            var c = this.activeCell;
            var d = this.activePane;
            var e = this.activeTable;
            var f = this.activeWorksheet;
            if (((function () { var g = a.tryGetValue("ActiveCellChanged", b); b = g.p1; return g.ret; })()) && a.removeItem("ActiveCellChanged")) {
                this._gv(new SpreadsheetActiveCellChangedEventArgs(b, c));
            }
            if (((function () { var g = a.tryGetValue("ActivePaneChanged", b); b = g.p1; return g.ret; })()) && a.removeItem("ActivePaneChanged")) {
                this._gw(new SpreadsheetActivePaneChangedEventArgs(b, d));
            }
            if (((function () { var g = a.tryGetValue("ActiveTableChanged", b); b = g.p1; return g.ret; })()) && a.removeItem("ActiveTableChanged")) {
                this._gx(new SpreadsheetActiveTableChangedEventArgs(b, e));
            }
            if (((function () { var g = a.tryGetValue("ActiveWorksheetChanged", b); b = g.p1; return g.ret; })()) && a.removeItem("ActiveWorksheetChanged")) {
                this._gy(new SpreadsheetActiveWorksheetChangedEventArgs(b, f));
            }
        }
    };
    Spreadsheet.prototype._h9 = function () {
        this._bb.e();
    };
    Spreadsheet.prototype._ic = function ($t, a, b, c, d) {
        var _this = this;
        if (this._a7 != null && this._a7.activePane != null) {
            var e_51 = this._a7.activePane.selection;
            this._gi(c, function () { return _this._a7._io($t, a, b, e_51.cellRanges, d); });
            this._ht(1024);
        }
    };
    Spreadsheet.prototype._id = function (a, b) {
        if (b) {
            this._z |= a;
        }
        else {
            this._z &= ~a;
        }
    };
    Spreadsheet.prototype._ie = function (a, b) {
        if (a == null) {
            return;
        }
        var c = a._h;
        if (c == null) {
            return;
        }
        var d = this.workbook;
        if (d == null || d != c.workbook) {
            return;
        }
        var e = false;
        if (c != null && c != this.activeWorksheet) {
            d.windowOptions.selectedWorksheet = c;
            e = true;
            this._i1();
        }
        var f = this.activeSelection;
        if (f != null) {
            f._resetSelection(a._a, a._g, a._j, b);
            if (this._a7 != null && this._a7._bc == c) {
                if (e) {
                    this._v.remeasureRootPanel();
                }
                this._a7._f5(null, a._a[a._j]);
            }
        }
    };
    Spreadsheet.prototype._d3 = function () {
        return SpreadsheetUtilities.p(this._bx()._cs) == 3;
    };
    Spreadsheet.prototype._ig = function () {
        if (this._a7 == null) {
            return;
        }
        var a = new List$1(SpreadsheetDropDownButton.$, 0);
        var b = this._a7._ao;
        var c = b._ag.activeCell;
        this._a7._b6(a, b, c.row, c.row, c.column, c.column, null);
        if (a.count > 0) {
            this._v.focus();
            var d = a._inner[0];
            SpreadsheetPaneButtonLayer._w(b, d, this._b2);
            this._d4(this._a5, d);
        }
        else {
            this._ih();
        }
    };
    Spreadsheet.prototype._ih = function () {
        if (this._a7 == null) {
            return;
        }
        if (this._a7._bc.isProtected) {
            return;
        }
        var a = this._a7._ao;
        var b = a._ag.activeCell;
        this._v.focus();
        var c = new SpreadsheetDropDownButton();
        c.b = 4;
        c.d = b.row;
        c.c = b.column;
        SpreadsheetPaneButtonLayer._w(a, c, this._b2);
        this._d4(this._a5, c);
    };
    Spreadsheet.prototype._im = function (a) {
        var b = this._a7;
        if (b == null) {
            return;
        }
        var c = b._q(a);
        if (c == null) {
            return;
        }
        this._ii(c);
    };
    Spreadsheet.prototype._d6 = function (a, b, c) {
        if (c === void 0) { c = 0; }
        var d = a._am();
        if (d == null || d.count == 0) {
            b = null;
            return {
                ret: false,
                p1: b
            };
        }
        var e = a._u;
        var f = -1;
        var g = new List$1(SpreadsheetCellRange.$, 0);
        var h = new SpreadsheetCell();
        switch (c) {
            default:
            case 0:
                {
                    var i = a._v();
                    for (var j = 0; j < d.count; j++) {
                        g.add(SpreadsheetPaneManager._extendRangeForMergedCells1(e, SpreadsheetUtilities.z(d.item(j)._h)));
                    }
                    f = d.indexOf(i);
                    if (f < 0) {
                        f = g.count - 1;
                    }
                    h = g._inner[f]._c;
                    break;
                }
            case 2:
                {
                    if (e != this.activeWorksheet) {
                        b = null;
                        return {
                            ret: false,
                            p1: b
                        };
                    }
                    g.o(this.activeSelection.cellRanges);
                    for (var k = 0; k < d.count; k++) {
                        g.add(SpreadsheetPaneManager._extendRangeForMergedCells1(e, SpreadsheetUtilities.z(d.item(k)._h)));
                    }
                    f = g.count - 1;
                    h = g._inner[f]._c;
                    break;
                }
            case 1:
                {
                    if (e != this.activeWorksheet) {
                        b = null;
                        return {
                            ret: false,
                            p1: b
                        };
                    }
                    g.o(this.activeSelection.cellRanges);
                    h = this.activeSelection.activeCell;
                    f = this.activeSelection.activeCellRangeIndex;
                    g._inner[f] = SpreadsheetPaneManager._getCellRange2(h.row, h.column, e);
                    for (var l = 0; l < d.count; l++) {
                        g._inner[f] = g._inner[f].union(SpreadsheetUtilities.z(d.item(l)._h));
                    }
                    g._inner[f] = SpreadsheetPaneManager._extendRangeForMergedCells1(e, g._inner[f]);
                    break;
                }
        }
        if (f < 0) {
            f = g.count - 1;
        }
        b = new SelectionSnapshot(e, g.toArray(), h, f);
        return {
            ret: true,
            p1: b
        };
    };
    Spreadsheet.prototype._d8 = function (a) {
        if (!this.isInEditMode) {
            return true;
        }
        switch (a) {
            default: return true;
            case 0:
            case 1:
            case 6:
            case 7:
            case 8:
            case 9:
            case 10:
            case 11:
            case 12:
            case 13:
            case 14:
            case 15:
            case 16:
            case 17:
            case 18:
            case 19:
            case 20:
            case 21:
            case 30:
            case 31:
            case 32:
            case 33:
            case 34:
            case 35:
            case 2:
            case 3:
            case 4:
            case 5:
            case 38:
            case 39:
            case 71:
            case 72:
            case 87:
            case 88:
            case 85:
            case 86:
            case 79:
            case 81:
            case 82:
            case 104:
            case 103:
            case 110:
            case 109:
            case 101:
            case 102:
            case 199:
            case 200:
            case 201: return this._d7(true);
            case 107:
            case 108:
            case 106:
            case 105:
            case 22:
            case 23:
            case 24:
            case 25:
            case 26:
            case 27:
            case 28:
            case 29: return true;
            case 36:
            case 37: return this._d7(true);
            case 68:
            case 69:
            case 70: return true;
            case 202: return false;
            case 198: return true;
            case 73:
            case 74:
            case 151:
            case 75:
            case 76:
            case 77:
            case 78:
            case 173:
            case 172: return true;
            case 41:
            case 42:
            case 43:
            case 44:
            case 45:
            case 46:
            case 47:
            case 48:
            case 40:
            case 49:
            case 50:
            case 51:
            case 52:
            case 53:
            case 54:
            case 55:
            case 56:
            case 57:
            case 58:
            case 59:
            case 60:
            case 61:
            case 62:
            case 63:
            case 64:
            case 65:
            case 66:
            case 67:
            case 83:
            case 84:
            case 80: return this._d7(true);
        }
    };
    Spreadsheet.prototype._d9 = function (a) {
        if (a > 16384000) {
            var b = new SpreadsheetUserPromptInfo(29, null, null, null, true);
            b.c = true;
            b.d = false;
            if (this._dz(b)) {
                return false;
            }
        }
        return true;
    };
    Spreadsheet.prototype._ea = function (a, b, c) {
        if (this._a7 != null && !this._a7._c8(a, b, c)) {
            return false;
        }
        return true;
    };
    Spreadsheet.prototype._iu = function () {
        if (this.workbook == null) {
            throw new InvalidOperationException(1, "The Workbook property cannot be null");
        }
        if (this.selectedWorksheets.length != 1) {
            throw new InvalidOperationException(1, "Showing the filter dialog requires one (and one only) selected worksheet.");
        }
    };
    Spreadsheet.prototype._iv = function () {
        if (this.workbook == null) {
            throw new InvalidOperationException(1, "The Workbook property cannot be null");
        }
        if (this.selectedWorksheets.length != 1) {
            throw new InvalidOperationException(1, "Showing the filter dialog requires one (and one only) selected worksheet.");
        }
    };
    Spreadsheet.prototype._it = function () {
        if (this.workbook == null) {
            throw new InvalidOperationException(1, "The Workbook property cannot be null");
        }
        if (this.selectedWorksheets.length != 1) {
            throw new InvalidOperationException(1, "Showing the filter dialog requires one (and one only) selected worksheet.");
        }
    };
    Spreadsheet.prototype._iw = function () {
        if (this._c2(16)) {
            var a = this.undoManager;
            this._id(16, false);
            var b = void 0, c = void 0;
            if (!this.isInEditMode) {
                b = a != null && a.aa;
                c = a != null && a.z;
            }
            else {
                c = this._ai.ac;
                b = this._ai.ad;
            }
            if (b != this._c2(32) || c != this._c2(64)) {
                this._id(64, c);
                this._id(32, b);
                this._id(1, true);
            }
        }
    };
    Spreadsheet.prototype._ix = function () {
        var e_52, _0, e_53, _1;
        var a = this._bt;
        if (a == null) {
            return;
        }
        var b = a.windowOptions.selectedWorksheet;
        if (b == null) {
            try {
                for (var _2 = tslib_1.__values(fromEnum(a._worksheets$i)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var c = _3.value;
                    if (c._w) {
                        b = c;
                        break;
                    }
                }
            }
            catch (e_52_1) { e_52 = { error: e_52_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_52) throw e_52.error; }
            }
            if (b == null) {
                try {
                    for (var _4 = tslib_1.__values(fromEnum(a._worksheets$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var d = _5.value;
                        if (d.displayOptions.visibility == 0) {
                            b = d;
                            break;
                        }
                    }
                }
                catch (e_53_1) { e_53 = { error: e_53_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_53) throw e_53.error; }
                }
            }
            if (b == null) {
                b = Enumerable.af(Worksheet.$, a._worksheets$i);
            }
            if (b != null) {
                a.windowOptions._ae(b, true);
            }
        }
    };
    Spreadsheet.prototype._iy = function () {
        var _this = this;
        var a = this._a7;
        var b = a;
        var c = this.workbook;
        if (c == null || c._worksheets$i.count == 0) {
            a = null;
        }
        else {
            this._ix();
            var d_3 = c.windowOptions.selectedWorksheet || Enumerable.ad(Worksheet.$, c._worksheets$i);
            if (a == null || a._bc != d_3) {
                var e = ((function () {
                    var $ret = new SpreadsheetOwnerState();
                    $ret._o = runOn(_this, _this._fw);
                    $ret._l = _this.chartAdapter;
                    $ret._s = _this.isInEditMode;
                    $ret._p = runOn(_this, _this._i2);
                    $ret._x = runOn(_this, _this._dx);
                    $ret._j = _this._v.createRenderCache();
                    $ret._w = function (f) {
                        var g = d_3._rows$i._aj(f.row);
                        return g == null ? null : g._getCellText1(f.column, 1);
                    };
                    $ret._h = _this;
                    $ret._t = _this._v.usesLogicalPixels;
                    return $ret;
                })());
                a = new SpreadsheetPaneManager(d_3, function (f) { return new SpreadsheetSelection(_this, f, false); }, function (f) { return _this._d7(true); }, runOn(this, this._dz), this._be, e);
            }
        }
        if (this._a7 != a) {
            if (this._a7 != null) {
                this._a7._hv();
                this._a7._gj();
            }
            this._y = null;
        }
        var f = PropertyChangeListenerList.e(SpreadsheetPaneManager.$, this._a7, a, this._b0, false);
        this._a7 = f.p0;
        if (this._a7 != null) {
            this._a7._a6 = this._bl;
            if (this._y != null && this._y._h == null) {
                this._y = null;
            }
        }
        if (b != this._a7) {
            this._t.onSheetManagerChanged(b, this._a7);
        }
        var g = this._a7 != null;
        this._j.m(g ? this._a7._dl : boxArray$1(new Array(0)));
        this.activePane = g ? this._a7.activePane : null;
        this.activeTable = g ? this._a7._bh : null;
        if (b != this._a7) {
            if (b != null) {
                b._al._o = null;
                b._hh();
            }
            this._ht(1 | 4096 | 65536 | 67108864 | 262144 | 16777216 | 1048576);
            this.a("SheetManager");
        }
    };
    Spreadsheet.prototype._iz = function () {
        var e_54, _0;
        if (this._eh == null) {
            this._eh = new List$1(Spreadsheet_SimpleNamedReference.$, 0);
            var a = this.workbook;
            if (a != null) {
                var b = a.windowOptions.selectedWorksheet;
                try {
                    for (var _1 = tslib_1.__values(fromEnum(a._namedReferences$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var c = _2.value;
                        if (c._p) {
                            continue;
                        }
                        var d = c._j;
                        if (d == null || d._af()) {
                            continue;
                        }
                        var e = c._bo(false);
                        if (e != null && typeCast(TableCalcReferenceBase.$, e) !== null) {
                        }
                        else {
                            var f = c._bh(e, b);
                            if (f != null && f.length == 1) {
                                this._eh.add(new Spreadsheet_SimpleNamedReference(1, c, f[0]));
                            }
                        }
                    }
                }
                catch (e_54_1) { e_54 = { error: e_54_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_54) throw e_54.error; }
                }
                this._eh.y();
            }
        }
    };
    Spreadsheet.prototype._i1 = function () {
        var _this = this;
        var e_55, _0, e_56, _1, e_57, _2;
        this._bq.i();
        var a = this._c2(8);
        try {
            this._id(8, true);
            this._be._bd();
            this._iy();
            if (this._a7 != null) {
                this._a7._i5();
            }
            if (this._a7 != null) {
                this._a7._i3(false);
            }
            this._iw();
            if (this._c2(256)) {
                var b = this._be._o;
                this.activeWorksheet = b != null ? b._j : null;
                this._id(256, false);
            }
            if (this._c2(512)) {
                this.selectedWorksheets = Enumerable.a(Worksheet.$, Enumerable.o(SpreadsheetTabInfo.$, Worksheet.$, this._be._j, function (c) { return c._j; }));
                this._id(512, false);
            }
            if (this._c2(65536)) {
                this._id(65536, false);
                this._gp(32768, function (c) { return _this.zoomLevel = c.displayOptions.magnificationInNormalView; });
            }
            if (this._c2(67108864)) {
                this._id(67108864, false);
                this.validationInputMessagePosition = this._a7 == null ? null : this._a7._jh;
            }
            if (this._c2(1048576)) {
                this._id(1048576, false);
                this._gp(524288, function (c) { return _this.areGridlinesVisible = c.displayOptions.showGridlines; });
            }
            if (this._c2(262144)) {
                this._id(262144, false);
                this._gp(131072, function (c) { return _this.areHeadersVisible = c.displayOptions.showRowAndColumnHeaders; });
            }
            if (this._c2(1024)) {
                this._id(1024, false);
                this._ab._aj();
                this._ah.aw();
            }
            if (this._c2(8192)) {
                this._id(8192, false);
                this._ah.az();
            }
            if (this._c2(4096)) {
                this._id(4096, false);
                var c = this.activeSelection;
                var d = null;
                if (c != null) {
                    var e = this.workbook;
                    var f = e.windowOptions.selectedWorksheet;
                    if (c.cellRanges.count == 1) {
                        var g = SpreadsheetUtilities.ay(c.cellRanges.item(0));
                        if (f != null && f._tables$i.count > 0) {
                            try {
                                for (var _3 = tslib_1.__values(fromEnum(f._tables$i)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                                    var h = _4.value;
                                    if (h._by._h(g) && WorksheetRegionAddress._o(g, h.dataAreaRegion._h)) {
                                        d = h.name;
                                        break;
                                    }
                                }
                            }
                            catch (e_55_1) { e_55 = { error: e_55_1 }; }
                            finally {
                                try {
                                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                                }
                                finally { if (e_55) throw e_55.error; }
                            }
                        }
                        if (d == null && e._cv) {
                            this._iz();
                            try {
                                for (var _5 = tslib_1.__values(fromEnum(this._eh)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                    var i = _6.value;
                                    if (WorksheetRegionAddress._o(g, i._b)) {
                                        d = i._a.name;
                                        break;
                                    }
                                }
                            }
                            catch (e_56_1) { e_56 = { error: e_56_1 }; }
                            finally {
                                try {
                                    if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                                }
                                finally { if (e_56) throw e_56.error; }
                            }
                            if (d == null && SpreadsheetCellRange.l_op_Equality(c._r, c.cellRanges.item(0))) {
                                var j = c.activeCell;
                                try {
                                    for (var _7 = tslib_1.__values(fromEnum(this._eh)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                        var k = _8.value;
                                        var l = k._b;
                                        if (l._m && l._ac == j.row && l._w == j.column) {
                                            d = k._a.name;
                                            break;
                                        }
                                    }
                                }
                                catch (e_57_1) { e_57 = { error: e_57_1 }; }
                                finally {
                                    try {
                                        if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                    }
                                    finally { if (e_57) throw e_57.error; }
                                }
                            }
                        }
                    }
                    if (d == null) {
                        var m = c._r._c;
                        var n = e.cellReferenceMode;
                        var o = n == 1;
                        d = ((function (p, q, r, s, t, u) { return CellAddress.u(p, q, r, t, u, void 0, void 0, void 0, s); })(m.row, m.column, e.currentFormat, n, o, o));
                    }
                }
                this._ft = d;
                this._aa._q();
            }
            this._hp(this._t.updateEditorValueMode == 0);
            if (this._c2(1) && this._a3 == null) {
                this._id(1, false);
                this._v.notifyCanExecuteChanged();
            }
        }
        finally {
            this._id(8, a);
        }
        if (this._c2(16384)) {
            this._id(16384, false);
            this.isRenamingWorksheet = this._bd != null;
        }
        if (this._c2(2048)) {
            this._id(2048, false);
            this._h7();
        }
        if (this._c2(134217728)) {
            if (this._a7 == null || !this._a7._cj) {
                this._id(134217728, false);
                this._hy();
            }
        }
        this._t.onStateVerified();
    };
    Spreadsheet.prototype._i2 = function (v) {
        var _this = this;
        var w = new SpreadsheetHyperlinkExecutingEventArgs(v);
        var x = this.workbook != null ? this.workbook._gw : null;
        if (!stringIsNullOrEmpty(x)) {
            w.workingDirectory = IOPath.getDirectoryName(x);
        }
        this._hb(w);
        if (w.cancel == false) {
            var y_1 = null;
            if (v.targetNamedReference != null) {
                var z = v.worksheet._rows$i.item(0);
                var aa = z._as(0);
                var ab = v.targetNamedReference._bo(true, aa);
                if (ab != null) {
                    var ac = this._d6(ab, y_1);
                    y_1 = ac.p1;
                }
                else {
                    this._dz(new SpreadsheetUserPromptInfo(22, null, null, v, false));
                }
            }
            else if (v.targetRegion != null) {
                var ad = v.targetRegion;
                var ae = SpreadsheetUtilities.z(ad._h);
                if (ad.worksheet.workbook == this.workbook) {
                    y_1 = new SelectionSnapshot(ad.worksheet, [ae], ae._c, 0);
                }
                else {
                    this._dz(new SpreadsheetUserPromptInfo(22, null, null, v, false));
                }
            }
            else if (WorksheetCell.l_op_Inequality(v.targetCell, null)) {
                var af = v.targetCell;
                if (WorksheetCell.l_op_Inequality(af, null) && af.worksheet != null && af.worksheet.workbook == this.workbook) {
                    var ag = new SpreadsheetCellRange(af.rowIndex, af.columnIndex);
                    y_1 = new SelectionSnapshot(af.worksheet, [ag], ag._c, 0);
                }
                else {
                    this._dz(new SpreadsheetUserPromptInfo(22, null, null, v, false));
                }
            }
            else if (v._t) {
                this._dz(new SpreadsheetUserPromptInfo(22, null, null, v, false));
            }
            else {
                var ah_2 = v.targetAddress;
                if (v.isSealed && !stringIsNullOrEmpty(ah_2)) {
                    var ai_1 = this.workbook;
                    var aj_1 = this.activeWorksheet;
                    var ak_1;
                    var al_1 = ((function () { var am = ai_1._ar(ah_2, ai_1.cellReferenceMode, aj_1, null, 0, ak_1, true); ak_1 = am.p5; return am.ret; })());
                    if (al_1 != null) {
                        if (ak_1) {
                            al_1 = this._br(al_1, aj_1._rows$i.item(0), 0);
                        }
                        if (al_1 != null) {
                            if (!((function () { var am = _this._d6(al_1, y_1); y_1 = am.p1; return am.ret; })())) {
                                this._dz(new SpreadsheetUserPromptInfo(22, null, null, v, false));
                            }
                        }
                    }
                }
                if (y_1 == null) {
                    var am = false;
                    if (!stringIsNullOrEmpty(ah_2)) {
                        try {
                            this._i3(ah_2, w.workingDirectory);
                            am = true;
                        }
                        catch (an) {
                            this._dz(((function (ao, ap, aq) { return new SpreadsheetUserPromptInfo(ao, null, aq, ap, false); })(21, ah_2, an)));
                        }
                    }
                    if (am) {
                        v._av();
                    }
                }
            }
            if (y_1 != null) {
                this._ie(y_1, true);
                v._av();
            }
        }
    };
    Spreadsheet.prototype._i3 = function (v, w) {
        var x;
        if (((function () { var y = Uri.tryCreate(v, 0, x); x = y.p2; return y.ret; })())) {
            if (!x.isAbsoluteUri) {
                if (SpreadsheetUtilities.bb(v)) {
                    v = "mailto:" + v;
                }
                else if (stringStartsWith(v, "www.")) {
                    v = "http://" + v;
                }
                else if (stringStartsWith(v, "ftp.")) {
                    v = "ftp://" + v;
                }
            }
        }
        window.open(v, "_blank");
    };
    Spreadsheet.prototype._i4 = function (v) {
        var _this = this;
        this._gi(5, function () { return _this._a7._je(v); });
    };
    Spreadsheet.prototype._gt = function (v) {
        var w = this.actionExecuted;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._gu = function (v) {
        var w = this.actionExecuting;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hu = function (v) {
        this._gv(v);
    };
    Spreadsheet.prototype._gv = function (v) {
        var w = this.activeCellChanged;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hv = function (v) {
        this._gw(v);
    };
    Spreadsheet.prototype._gw = function (v) {
        var w = this.activePaneChanged;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hw = function (v) {
        this._gx(v);
    };
    Spreadsheet.prototype._gx = function (v) {
        var w = this.activeTableChanged;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hx = function (v) {
        this._gy(v);
    };
    Spreadsheet.prototype._gy = function (v) {
        var w = this.activeWorksheetChanged;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._gz = function (v, w) {
        var x = this._cellDropDownItemSelecting;
        if (x != null) {
            x(this, new SpreadsheetCellDropDownItemSelectingEventArgs(v, w));
        }
    };
    Spreadsheet.prototype._h2 = function (v) {
        this._g6(v);
    };
    Spreadsheet.prototype._g6 = function (v) {
        var w = this.editModeExiting;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h1 = function (v) {
        this._g5(v);
    };
    Spreadsheet.prototype._g5 = function (v) {
        var w = this.editModeExited;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h0 = function (v) {
        this._g4(v);
    };
    Spreadsheet.prototype._g4 = function (v) {
        var w = this.editModeEntering;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hz = function (v) {
        this._g3(v);
    };
    Spreadsheet.prototype._g3 = function (v) {
        var w = this.editModeEntered;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h3 = function (v) {
        this._g7(v);
    };
    Spreadsheet.prototype._g7 = function (v) {
        var w = this.editModeValidationError;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h4 = function (v) {
        this._g8(v);
    };
    Spreadsheet.prototype._g8 = function (v) {
        var w = this.editRangePasswordNeeded;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._hb = function (v) {
        var w = this.hyperlinkExecuting;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h5 = function (v) {
        this._hf(v);
    };
    Spreadsheet.prototype._hf = function (v) {
        var w = this.selectionChanged;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h6 = function (v) {
        this._hh(new SpreadsheetUserPromptDisplayingEventArgs(v));
    };
    Spreadsheet.prototype._hh = function (v) {
        var w = this.userPromptDisplaying;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.prototype._h7 = function () {
        this._hl(new SpreadsheetWorkbookDirtiedEventArgs());
    };
    Spreadsheet.prototype._hl = function (v) {
        var w = this.workbookDirtied;
        if (null != w) {
            w(this, v);
        }
    };
    Spreadsheet.$t = markType(Spreadsheet, 'Spreadsheet', PropertyChangeNotifierExtended.$);
    return Spreadsheet;
}(PropertyChangeNotifierExtended));
export { Spreadsheet };
/**
 * @hidden
 */
var Spreadsheet_ElementCommandInfo = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_ElementCommandInfo, _super);
    function Spreadsheet_ElementCommandInfo(a, b, c) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.c = 0;
        _this.b = null;
        _this.a = a;
        _this.c = b;
        _this.b = c;
        a.disposed = delegateCombine(a.disposed, runOn(_this, _this.d));
        return _this;
    }
    Spreadsheet_ElementCommandInfo.prototype.d = function (a, b) {
        var c = this.a;
        c.disposed = delegateRemove(c.disposed, runOn(this, this.d));
        this.b._eg.remove(this);
    };
    Spreadsheet_ElementCommandInfo.$t = markType(Spreadsheet_ElementCommandInfo, 'Spreadsheet_ElementCommandInfo');
    return Spreadsheet_ElementCommandInfo;
}(Base));
export { Spreadsheet_ElementCommandInfo };
/**
 * @hidden
 */
var Spreadsheet_ButtonElementCommandInfo = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_ButtonElementCommandInfo, _super);
    function Spreadsheet_ButtonElementCommandInfo(a, b, c) {
        var _this = _super.call(this, a, b, c) || this;
        var d = _this.a;
        d.click = delegateCombine(d.click, runOn(_this, _this.e));
        return _this;
    }
    Spreadsheet_ButtonElementCommandInfo.prototype.d = function (a, b) {
        var c = this.a;
        c.click = delegateRemove(c.click, runOn(this, this.e));
        _super.prototype.d.call(this, a, b);
    };
    Spreadsheet_ButtonElementCommandInfo.prototype.e = function (a, b) {
        this.b.executeCommand(this.c);
    };
    Spreadsheet_ButtonElementCommandInfo.$t = markType(Spreadsheet_ButtonElementCommandInfo, 'Spreadsheet_ButtonElementCommandInfo', Spreadsheet_ElementCommandInfo.$);
    return Spreadsheet_ButtonElementCommandInfo;
}(Spreadsheet_ElementCommandInfo));
export { Spreadsheet_ButtonElementCommandInfo };
/**
 * @hidden
 */
var Spreadsheet_WorkbookOwner = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_WorkbookOwner, _super);
    function Spreadsheet_WorkbookOwner(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.a = a;
        return _this;
    }
    Object.defineProperty(Spreadsheet_WorkbookOwner.prototype, "isUndoEnabled", {
        get: function () {
            return this.a._c2(4);
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_WorkbookOwner.prototype.onCellValueChange = function (a, b) {
        var c = this.a._a7;
        if (c != null) {
            c._he(a.worksheet, a.index, b);
        }
    };
    Spreadsheet_WorkbookOwner.prototype._onChange$2$i = function ($tContext, $tValue, a, b, c, d, e) {
        if (b && e.s && this.a._c2(4)) {
            var f = new WorkbookUndoUnit$2($tContext, $tValue, a, c, e);
            this.a._b3.av(f);
        }
        this.a._hj($tContext, $tValue, a, e);
    };
    Spreadsheet_WorkbookOwner.prototype.onConditionalFormatChange = function (a) {
        var b = this.a._a7;
        if (b != null && b._bc == a.worksheet) {
            b._hf(a);
        }
    };
    Spreadsheet_WorkbookOwner.prototype.onCustomViewApplied = function (a) {
        this.a.isFormulaBarVisible = a.windowOptions.showFormulaBar ? true : false;
    };
    Spreadsheet_WorkbookOwner.prototype.onTransactionalChangeBegin = function (a, b) {
        if (this.a._c2(4)) {
            if (this.a._b3.p == null) {
                var c = new WorksheetUndoTransaction(SpreadsheetUtilities.da(this.a, a, b));
                this.a._b3.bd(c);
                return c;
            }
        }
        return null;
    };
    Spreadsheet_WorkbookOwner.prototype.onTransactionalChangeEnd = function (a) {
        var b = typeCast(UndoTransaction.$, a);
        if (b != null) {
            b.ad();
        }
    };
    Spreadsheet_WorkbookOwner.prototype.onTransactionalChangeRollback = function (a) {
        var b = typeCast(UndoTransaction.$, a);
        if (b != null) {
            b.af();
        }
    };
    Spreadsheet_WorkbookOwner.prototype.onSheetRemoving = function (a) {
        if (this.a._c2(4)) {
            this.a._f4(a);
        }
    };
    Spreadsheet_WorkbookOwner.$t = markType(Spreadsheet_WorkbookOwner, 'Spreadsheet_WorkbookOwner', Base.$, [IWorkbookOwner_$type]);
    return Spreadsheet_WorkbookOwner;
}(Base));
export { Spreadsheet_WorkbookOwner };
/**
 * @hidden
 */
var RangeWorksheetCellFormatBase = /** @class */ (function (_super) {
    tslib_1.__extends(RangeWorksheetCellFormatBase, _super);
    function RangeWorksheetCellFormatBase() {
        var _this = _super.call(this) || this;
        _this._aa = true;
        _this._p = 0;
        _this._t = null;
        _this._i = 0;
        _this._u = null;
        _this._o = 0;
        _this._j = 0;
        _this._n = null;
        _this._h = null;
        _this._ah = null;
        _this._ac = 0;
        _this._v = null;
        _this._k = 0;
        _this._ae = Nullable$1.toNullable(Boolean_$type, null);
        _this._w = null;
        _this._l = 0;
        _this._ad = 0;
        _this._af = Nullable$1.toNullable(Boolean_$type, null);
        _this._z = null;
        _this._x = null;
        _this._m = 0;
        _this._r = 0;
        _this._ag = Nullable$1.toNullable(Boolean_$type, null);
        _this._h = new RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont(_this);
        return _this;
    }
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "alignment", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(HorizontalCellAlignment_$type, _this._p); _this._p = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(HorizontalCellAlignment_$type, SpreadsheetUtilities.ee, a, 1);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "bottomBorderColorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookColorInfo.$, _this._t); _this._t = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookColorInfo.$, function (b, c) { return b._av(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 2);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "bottomBorderStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellBorderLineStyle_$type, _this._i); _this._i = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellBorderLineStyle_$type, function (b, c) { return b._aw(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 4);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "diagonalBorderColorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookColorInfo.$, _this._u); _this._u = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookColorInfo.$, function (b, c) { return b._ax(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 8);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "diagonalBorders", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(DiagonalBorders_$type, _this._o); _this._o = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(DiagonalBorders_$type, SpreadsheetUtilities.eh, a, 16);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "diagonalBorderStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellBorderLineStyle_$type, _this._j); _this._j = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellBorderLineStyle_$type, function (b, c) { return b._az(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 32);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "fill", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellFill.$, _this._n); _this._n = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellFill.$, SpreadsheetUtilities.ei, a, 64);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "font", {
        get: function () {
            return this._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "formatOptions", {
        get: function () {
            return 63;
        },
        set: function (a) {
            throw new NotSupportedException(0);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "formatString", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(String_$type, _this._ah); _this._ah = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(String_$type, SpreadsheetUtilities.em, a, 65536);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "indent", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(Number_$type, _this._ac); _this._ac = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(Number_$type, SpreadsheetUtilities.en, a, 131072);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "_ab", {
        get: function () {
            return this._aa;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "leftBorderColorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookColorInfo.$, _this._v); _this._v = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookColorInfo.$, function (b, c) { return b._a9(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 262144);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "leftBorderStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellBorderLineStyle_$type, _this._k); _this._k = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellBorderLineStyle_$type, function (b, c) { return b._ba(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 524288);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "locked", {
        get: function () {
            return unwrapNullable(this._locked$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._locked$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "_locked$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(Nullable$1.$.specialize(Boolean_$type), _this._ae); _this._ae = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.ep, a, 1048576);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "rightBorderColorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookColorInfo.$, _this._w); _this._w = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookColorInfo.$, function (b, c) { return b._bd(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 2097152);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "rightBorderStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellBorderLineStyle_$type, _this._l); _this._l = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellBorderLineStyle_$type, function (b, c) { return b._be(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 4194304);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "rotation", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(Number_$type, _this._ad); _this._ad = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(Number_$type, SpreadsheetUtilities.er, a, 8388608);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "shrinkToFit", {
        get: function () {
            return unwrapNullable(this._shrinkToFit$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._shrinkToFit$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "_shrinkToFit$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(Nullable$1.$.specialize(Boolean_$type), _this._af); _this._af = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.es, a, 16777216);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "style", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookStyle.$, _this._z); _this._z = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookStyle.$, SpreadsheetUtilities.eu, a, 33554432);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "topBorderColorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(WorkbookColorInfo.$, _this._x); _this._x = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(WorkbookColorInfo.$, function (b, c) { return b._bi(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 67108864);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "topBorderStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(CellBorderLineStyle_$type, _this._m); _this._m = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(CellBorderLineStyle_$type, function (b, c) { return b._bj(c, true, typeCast(RowColumnBase.$, b._s) !== null ? 32 : 0); }, a, 134217728);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "verticalAlignment", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(VerticalCellAlignment_$type, _this._r); _this._r = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(VerticalCellAlignment_$type, SpreadsheetUtilities.ex, a, 268435456);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "wrapText", {
        get: function () {
            return unwrapNullable(this._wrapText$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._wrapText$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase.prototype, "_wrapText$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._g(Nullable$1.$.specialize(Boolean_$type), _this._ag); _this._ag = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.ey, a, 536870912);
        },
        enumerable: true,
        configurable: true
    });
    RangeWorksheetCellFormatBase.prototype.setFormatting = function (a) {
        this._al(IWorksheetCellFormat_$type, function (b, c) { return b.setFormatting(c); }, a, 0x7FFFFFFF);
    };
    RangeWorksheetCellFormatBase.prototype._ai = function (a) {
        if (a === void 0) { a = true; }
        if (this._aa == false) {
            this._aa = true;
            if (a) {
                this._aj();
            }
        }
    };
    RangeWorksheetCellFormatBase.prototype._aj = function () {
        this.a(stringEmpty());
    };
    RangeWorksheetCellFormatBase.prototype._g = function ($t, a) {
        if (this._aa) {
            this._aa = false;
            var b = this._q() || RangeWorksheetCellFormatBase_EmptyFormat._ao;
            this._am(b);
        }
        return {
            ret: a,
            p0: a
        };
    };
    RangeWorksheetCellFormatBase.prototype._am = function (a) {
        CoreUtilities.z(a, "source");
        this._p = a.alignment;
        this._t = a.bottomBorderColorInfo;
        this._i = a.bottomBorderStyle;
        this._u = a.diagonalBorderColorInfo;
        this._o = a.diagonalBorders;
        this._j = a.diagonalBorderStyle;
        this._n = a.fill;
        this._ah = a.formatString;
        this._ac = a.indent;
        this._v = a.leftBorderColorInfo;
        this._k = a.leftBorderStyle;
        this._ae = a._locked$i;
        this._w = a.rightBorderColorInfo;
        this._l = a.rightBorderStyle;
        this._ad = a.rotation;
        this._af = a._shrinkToFit$i;
        this._z = a.style;
        this._x = a.topBorderColorInfo;
        this._m = a.topBorderStyle;
        this._r = a.verticalAlignment;
        this._ag = a._wrapText$i;
        this._h._k(a.font);
    };
    RangeWorksheetCellFormatBase.prototype._an = function (a) {
        return WorkbookFontSnapshot._l(a, this._s);
    };
    RangeWorksheetCellFormatBase._y = function (a) {
        a = ExcelUtils.g0(a);
        return ExcelUtils.ag(a);
    };
    RangeWorksheetCellFormatBase.$t = markType(RangeWorksheetCellFormatBase, 'RangeWorksheetCellFormatBase', PropertyChangeNotifierExtended.$, [IWorksheetCellFormat_$type]);
    return RangeWorksheetCellFormatBase;
}(PropertyChangeNotifierExtended));
export { RangeWorksheetCellFormatBase };
/**
 * @hidden
 */
var Spreadsheet_SelectionWorksheetCellFormat = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_SelectionWorksheetCellFormat, _super);
    function Spreadsheet_SelectionWorksheetCellFormat(a) {
        var _this = _super.call(this) || this;
        _this._ao = null;
        CoreUtilities.y(a);
        _this._ao = a;
        return _this;
    }
    Spreadsheet_SelectionWorksheetCellFormat.prototype._q = function () {
        var a = this._ao.activeSelection;
        if (a != null) {
            var b = a.activeCell;
            var c = this._ao._a7;
            if (c != null) {
                var d = c._bc._rows$i._aj(b.row);
                return new ReadOnlyResolvedWorksheetCellFormatData(c._bc._b4(d, b.column));
            }
        }
        return null;
    };
    Spreadsheet_SelectionWorksheetCellFormat.prototype._ak = function (a, b, c) {
        var d = this._ao._a7;
        if (d == null || d.activePane == null) {
            return;
        }
        var e = d.activePane.selection;
        this._ao._gi(21, function () { return d._im(e.cellRanges, a, b, c); });
    };
    Spreadsheet_SelectionWorksheetCellFormat.prototype._al = function ($t, a, b, c) {
        var d = 10;
        switch (c) {
            case 536870912:
                d = 9;
                break;
            case 128:
                d = 6;
                break;
            case 1024:
                d = 7;
                break;
            case 4096:
                d = 8;
                break;
            case 16384:
                d = 19;
                break;
            case 256:
            case 512:
            case 2048:
            case 8192:
            case 32640:
                d = 19;
                break;
            default:
                if (c != 0) {
                    if ((c & ~32640) == 0) {
                        d = 19;
                    }
                }
                break;
        }
        this._ao._ic($t, b, a, d, c);
    };
    Spreadsheet_SelectionWorksheetCellFormat.prototype.get__s = function () {
        return this._ao.workbook;
    };
    Object.defineProperty(Spreadsheet_SelectionWorksheetCellFormat.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_SelectionWorksheetCellFormat.$t = markType(Spreadsheet_SelectionWorksheetCellFormat, 'Spreadsheet_SelectionWorksheetCellFormat', RangeWorksheetCellFormatBase.$);
    return Spreadsheet_SelectionWorksheetCellFormat;
}(RangeWorksheetCellFormatBase));
export { Spreadsheet_SelectionWorksheetCellFormat };
/**
 * @hidden
 */
var Spreadsheet_NameBoxList = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_NameBoxList, _super);
    function Spreadsheet_NameBoxList(a) {
        var _this = _super.call(this, String_$type) || this;
        _this._p = null;
        _this._p = a;
        return _this;
    }
    Spreadsheet_NameBoxList.prototype._o = function (a) {
        var e_58, _0, e_59, _1, e_60, _2, e_61, _3;
        a.clear();
        var b = this._p.workbook;
        if (b != null) {
            var c = this._p.activeWorksheet;
            try {
                for (var _4 = tslib_1.__values(fromEnum(b._namedReferences$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var d = _5.value;
                    if (d.scope != b && d.scope != c) {
                        continue;
                    }
                    if (d._p) {
                        continue;
                    }
                    if (d._bo(false) == null) {
                        continue;
                    }
                    a.add(d.name);
                }
            }
            catch (e_58_1) { e_58 = { error: e_58_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_0 = _4.return)) _0.call(_4);
                }
                finally { if (e_58) throw e_58.error; }
            }
            try {
                for (var _6 = tslib_1.__values(fromEnum(b._worksheets$i)), _7 = _6.next(); !_7.done; _7 = _6.next()) {
                    var e = _7.value;
                    try {
                        for (var _8 = tslib_1.__values(fromEnum(e._tables$i)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                            var f = _9.value;
                            a.add(f.name);
                        }
                    }
                    catch (e_60_1) { e_60 = { error: e_60_1 }; }
                    finally {
                        try {
                            if (_9 && !_9.done && (_2 = _8.return)) _2.call(_8);
                        }
                        finally { if (e_60) throw e_60.error; }
                    }
                }
            }
            catch (e_59_1) { e_59 = { error: e_59_1 }; }
            finally {
                try {
                    if (_7 && !_7.done && (_1 = _6.return)) _1.call(_6);
                }
                finally { if (e_59) throw e_59.error; }
            }
            if (a.count > 1) {
                var g = typeCast(List$1.$.specialize(String_$type), a) || new List$1(String_$type, 1, a);
                g.z(StringComparer.c);
                if (g != a) {
                    a.clear();
                    try {
                        for (var _10 = tslib_1.__values(fromEnum(g)), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                            var h = _11.value;
                            a.add(h);
                        }
                    }
                    catch (e_61_1) { e_61 = { error: e_61_1 }; }
                    finally {
                        try {
                            if (_11 && !_11.done && (_3 = _10.return)) _3.call(_10);
                        }
                        finally { if (e_61) throw e_61.error; }
                    }
                }
            }
        }
    };
    Spreadsheet_NameBoxList.prototype._q = function () {
        this._h();
    };
    Spreadsheet_NameBoxList.$t = markType(Spreadsheet_NameBoxList, 'Spreadsheet_NameBoxList', LazyReadOnlyNotifyCollection$1.$.specialize(String_$type));
    return Spreadsheet_NameBoxList;
}(LazyReadOnlyNotifyCollection$1));
export { Spreadsheet_NameBoxList };
/**
 * @hidden
 */
var Spreadsheet_SynchronizationSuspender = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_SynchronizationSuspender, _super);
    function Spreadsheet_SynchronizationSuspender(a) {
        var _this = _super.call(this) || this;
        _this._a = null;
        _this._a = a;
        a._ir();
        return _this;
    }
    Spreadsheet_SynchronizationSuspender.prototype.dispose = function () {
        if (this._a != null) {
            var a = this._a;
            this._a = null;
            a._ia();
        }
    };
    Spreadsheet_SynchronizationSuspender.$t = markType(Spreadsheet_SynchronizationSuspender, 'Spreadsheet_SynchronizationSuspender', Base.$, [IDisposable_$type]);
    return Spreadsheet_SynchronizationSuspender;
}(Base));
export { Spreadsheet_SynchronizationSuspender };
/**
 * @hidden
 */
var Spreadsheet_CustomEditValueParser = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_CustomEditValueParser, _super);
    function Spreadsheet_CustomEditValueParser(a, b) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.b = null;
        _this.c = null;
        _this.e = null;
        _this.b = a;
        _this.c = b;
        return _this;
    }
    Spreadsheet_CustomEditValueParser.prototype.d = function (a) {
        var _this = this;
        if (this.a == null) {
            this.a = new ParseEditValueCache(this);
        }
        this.e = a;
        var b;
        var c = ((function () { var d = SpreadsheetEditHelper.ad(_this.a, _this, false, true, b); b = d.p4; return d.ret; })());
        if (c != this) {
            if (b != -1 || (c != null && !(typeof c === 'string'))) {
                var d = new Spreadsheet_CustomEditValue();
                d.c = a;
                d.b = c;
                d.a = b;
                return d;
            }
        }
        return null;
    };
    Object.defineProperty(Spreadsheet_CustomEditValueParser.prototype, "unformattedText", {
        get: function () {
            return this.e;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_CustomEditValueParser.prototype, "editCellFormat", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_CustomEditValueParser.prototype.createDocument = function () {
        return null;
    };
    Object.defineProperty(Spreadsheet_CustomEditValueParser.prototype, "workbook", {
        get: function () {
            return this.b.workbook;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_CustomEditValueParser.prototype, "isFixedDecimalEnabled", {
        get: function () {
            return this.b.isFixedDecimalEnabled;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_CustomEditValueParser.prototype, "fixedDecimalPlaceCount", {
        get: function () {
            return this.b.fixedDecimalPlaceCount;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_CustomEditValueParser.$t = markType(Spreadsheet_CustomEditValueParser, 'Spreadsheet_CustomEditValueParser', Base.$, [ISpreadsheetEditorValue_$type, ISpreadsheetEditInfo_$type]);
    return Spreadsheet_CustomEditValueParser;
}(Base));
export { Spreadsheet_CustomEditValueParser };
/**
 * @hidden
 */
var Spreadsheet_NullView = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_NullView, _super);
    function Spreadsheet_NullView(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.a = a;
        return _this;
    }
    Spreadsheet_NullView.prototype.beforeExecuteCommand = function (command, commandParameter, sourceElement) {
        return unwrapNullable(this._beforeExecuteCommand$i.apply(this, arguments));
    };
    Spreadsheet_NullView.prototype._beforeExecuteCommand$i = function (a, b, c) {
        return SpreadsheetUtilities.cz;
    };
    Spreadsheet_NullView.prototype.createRenderCache = function () {
        return new Spreadsheet_NullRenderCache();
    };
    Object.defineProperty(Spreadsheet_NullView.prototype, "isCellDropDownOpen", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_NullView.prototype, "isInNameBox", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_NullView.prototype, "isScrollLockToggled", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(Spreadsheet_NullView.prototype, "updateEditorValueMode", {
        get: function () {
            return 1;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullView.prototype.addCellTextLocations = function (a, b) {
    };
    Spreadsheet_NullView.prototype.closeMenu = function () {
    };
    Spreadsheet_NullView.prototype.getLayoutManager = function () {
        return null;
    };
    Spreadsheet_NullView.prototype.onSheetManagerChanged = function (a, b) {
    };
    Spreadsheet_NullView.prototype.remeasureRootPanel = function () {
    };
    Spreadsheet_NullView.prototype.onNameBoxValueChanged = function () {
    };
    Spreadsheet_NullView.prototype.onNameBoxWidthChanged = function () {
    };
    Object.defineProperty(Spreadsheet_NullView.prototype, "hasKeyboardFocusWithin", {
        get: function () {
            return false;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullView.prototype.focus = function () {
        return false;
    };
    Spreadsheet_NullView.prototype.onHasPendingChangeNotification = function () {
    };
    Spreadsheet_NullView.prototype.onDataObjectPasting = function (a) {
    };
    Spreadsheet_NullView.prototype.notifyCanExecuteChanged = function () {
    };
    Spreadsheet_NullView.prototype.onStateVerified = function () {
    };
    Spreadsheet_NullView.prototype.shouldIncludeClipboardFormat = function (a, b) {
        return true;
    };
    Spreadsheet_NullView.prototype.shouldCopyToClipboard = function (a, b) {
        return true;
    };
    Spreadsheet_NullView.prototype.showCellDropDown = function (pane, cellRect, dropdownItems, initialSelectedIndex, onSelected) {
        arguments[1] = rectFromLiteral(arguments[1]);
        return this._showCellDropDown$i.apply(this, arguments);
    };
    Spreadsheet_NullView.prototype._showCellDropDown$i = function (a, b, c, d, e) {
        return false;
    };
    Spreadsheet_NullView.prototype.showSelectAllContextMenu = function (context, relativePoint) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._showSelectAllContextMenu$i.apply(this, arguments);
    };
    Spreadsheet_NullView.prototype._showSelectAllContextMenu$i = function (a, b) {
    };
    Spreadsheet_NullView.prototype.ShowPaneContextMenu = function (pane, area, relativePoint) {
        arguments[2] = pointFromLiteral(arguments[2]);
        return this._ShowPaneContextMenu$i.apply(this, arguments);
    };
    Spreadsheet_NullView.prototype._ShowPaneContextMenu$i = function (a, b, c) {
    };
    Spreadsheet_NullView.prototype.ShowHeaderContextMenu = function (scrollRegion, relativePoint) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._ShowHeaderContextMenu$i.apply(this, arguments);
    };
    Spreadsheet_NullView.prototype._ShowHeaderContextMenu$i = function (a, b) {
    };
    Spreadsheet_NullView.prototype.ShowTabContextMenu = function (tab, relativePoint) {
        arguments[1] = pointFromLiteral(arguments[1]);
        return this._ShowTabContextMenu$i.apply(this, arguments);
    };
    Spreadsheet_NullView.prototype._ShowTabContextMenu$i = function (a, b) {
    };
    Spreadsheet_NullView.prototype.showFilterMenu = function (a, b) {
        return false;
    };
    Spreadsheet_NullView.prototype.createCellEditManager = function () {
        return new Spreadsheet_NullCellEditManager(this.a);
    };
    Spreadsheet_NullView.prototype.createTabEditManager = function () {
        return new Spreadsheet_NullTabEditManager(this.a);
    };
    Spreadsheet_NullView.prototype.showMessageBox = function (a, b, c, d, e) {
        return e;
    };
    Object.defineProperty(Spreadsheet_NullView.prototype, "usesLogicalPixels", {
        get: function () {
            return true;
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullView.prototype.verifyLayout = function () {
    };
    Spreadsheet_NullView.prototype.showFilterDialog = function (a) {
        throw new NotImplementedException(0);
    };
    Spreadsheet_NullView.prototype.showTopOrBottomDialog = function (a) {
        throw new NotImplementedException(0);
    };
    Spreadsheet_NullView.prototype.showCustomSortDialog = function (a, b) {
        throw new NotImplementedException(0);
    };
    Spreadsheet_NullView.prototype.showFormatCellsDialog = function (a, b) {
        throw new NotImplementedException(0);
    };
    Object.defineProperty(Spreadsheet_NullView.prototype, "spreadsheetDialogServicesManager", {
        get: function () {
            throw new NotImplementedException(0);
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullView.prototype.getRect = function (scrollRegion) {
        return rectToLiteral(this._getRect$i.apply(this, arguments));
    };
    Spreadsheet_NullView.prototype._getRect$i = function (a) {
        return Rect.empty;
    };
    Spreadsheet_NullView.prototype.getPaneRect = function (pane) {
        return rectToLiteral(this._getPaneRect$i.apply(this, arguments));
    };
    Spreadsheet_NullView.prototype._getPaneRect$i = function (a) {
        return Rect.empty;
    };
    Spreadsheet_NullView.prototype.initializeEditFont = function (a, b) {
    };
    Spreadsheet_NullView.prototype.createChartTitleElement = function (a, b) {
        return null;
    };
    Spreadsheet_NullView.$t = markType(Spreadsheet_NullView, 'Spreadsheet_NullView', Base.$, [ISpreadsheetView_$type]);
    return Spreadsheet_NullView;
}(Base));
export { Spreadsheet_NullView };
/**
 * @hidden
 */
var Spreadsheet_NullCellEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_NullCellEditManager, _super);
    function Spreadsheet_NullCellEditManager(a) {
        return _super.call(this, a) || this;
    }
    Spreadsheet_NullCellEditManager.prototype.get_ac = function () {
        return false;
    };
    Object.defineProperty(Spreadsheet_NullCellEditManager.prototype, "ac", {
        get: function () {
            return this.get_ac();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullCellEditManager.prototype.get_ad = function () {
        return false;
    };
    Object.defineProperty(Spreadsheet_NullCellEditManager.prototype, "ad", {
        get: function () {
            return this.get_ad();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullCellEditManager.prototype.get_ah = function () {
        return false;
    };
    Object.defineProperty(Spreadsheet_NullCellEditManager.prototype, "ah", {
        get: function () {
            return this.get_ah();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullCellEditManager.prototype.as = function (a, b, c, d) {
    };
    Spreadsheet_NullCellEditManager.prototype.ap = function () {
    };
    Spreadsheet_NullCellEditManager.prototype.aa = function (a) {
        return false;
    };
    Spreadsheet_NullCellEditManager.prototype.ak = function () {
        return 0;
    };
    Spreadsheet_NullCellEditManager.prototype.b = function () {
        return null;
    };
    Spreadsheet_NullCellEditManager.prototype.ab = function (a) {
        return false;
    };
    Spreadsheet_NullCellEditManager.prototype.at = function () {
    };
    Spreadsheet_NullCellEditManager.prototype.e = function () {
        return null;
    };
    Spreadsheet_NullCellEditManager.prototype.ag = function (a, b) {
        if (b === void 0) { b = true; }
        return false;
    };
    Spreadsheet_NullCellEditManager.prototype.ao = function () {
    };
    Spreadsheet_NullCellEditManager.prototype.aq = function () {
    };
    Spreadsheet_NullCellEditManager.prototype.av = function (a, b) {
    };
    Spreadsheet_NullCellEditManager.prototype.az = function () {
    };
    Spreadsheet_NullCellEditManager.$t = markType(Spreadsheet_NullCellEditManager, 'Spreadsheet_NullCellEditManager', SpreadsheetCellEditManager.$);
    return Spreadsheet_NullCellEditManager;
}(SpreadsheetCellEditManager));
export { Spreadsheet_NullCellEditManager };
/**
 * @hidden
 */
var Spreadsheet_NullTabEditManager = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_NullTabEditManager, _super);
    function Spreadsheet_NullTabEditManager(a) {
        return _super.call(this, a) || this;
    }
    Spreadsheet_NullTabEditManager.prototype.get_i = function () {
        return false;
    };
    Object.defineProperty(Spreadsheet_NullTabEditManager.prototype, "i", {
        get: function () {
            return this.get_i();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullTabEditManager.prototype.f = function (a) {
        return false;
    };
    Spreadsheet_NullTabEditManager.prototype.l = function () {
        return null;
    };
    Spreadsheet_NullTabEditManager.prototype.m = function (a, b, c) {
    };
    Spreadsheet_NullTabEditManager.prototype.n = function (a, b) {
    };
    Spreadsheet_NullTabEditManager.prototype.k = function (a) {
        return true;
    };
    Spreadsheet_NullTabEditManager.prototype.o = function () {
    };
    Spreadsheet_NullTabEditManager.$t = markType(Spreadsheet_NullTabEditManager, 'Spreadsheet_NullTabEditManager', SpreadsheetTabEditManager.$);
    return Spreadsheet_NullTabEditManager;
}(SpreadsheetTabEditManager));
export { Spreadsheet_NullTabEditManager };
/**
 * @hidden
 */
var SpreadsheetRenderCache = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetRenderCache, _super);
    function SpreadsheetRenderCache(a) {
        var _this = _super.call(this) || this;
        _this.af = 0;
        _this.r = null;
        _this.q = null;
        _this.f = null;
        _this.e = null;
        _this.p = false;
        _this.m = null;
        _this.i = 0;
        _this.v = 0;
        _this.s = 0;
        _this.t = 0;
        _this.ae = 0;
        _this.u = 0;
        _this.p = a;
        _this.r = new Dictionary$2(Base.$, Base.$, 0);
        _this.q = new Dictionary$2(Base.$, Base.$, 0);
        return _this;
    }
    Object.defineProperty(SpreadsheetRenderCache.prototype, "n", {
        get: function () {
            return this.af > 0;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetRenderCache.prototype.ak = function () {
        this.af++;
    };
    SpreadsheetRenderCache.prototype.a = function ($t, a, b, c) {
        if (c === void 0) { c = null; }
        return this.b($t, a ? this.r : this.q, b, c != null ? c : $t);
    };
    SpreadsheetRenderCache.prototype.b = function ($t, a, b, c) {
        a.item(c, b);
        return b;
    };
    SpreadsheetRenderCache.prototype.x = function (a, b) {
        if (a == null) {
            return 0;
        }
        return this.w(a.workbook, a.displayOptions.magnificationInNormalView, b);
    };
    SpreadsheetRenderCache.prototype.w = function (a, b, c) {
        if (a == null) {
            return 0;
        }
        var d = b / 100;
        var e = a.cellReferenceMode;
        var f = a._styles$i.normalStyle._i;
        var g = this.m == null ? new WorkbookFontSnapshot(f) : this.m._d(f);
        if (this.m != g || this.i != e || this.v != d || this.t != c) {
            this.m = g;
            this.i = e;
            this.v = d;
            this.ae = -1;
            this.t = c;
            var h = e == 1 ? SpreadsheetPaneManager._fn(0) : SpreadsheetPaneManager._fo(0);
            var i = this.y(this.m, this.v, h) * this.v;
            i += 3 * c;
            i += c;
            this.s = i;
        }
        return this.s;
    };
    SpreadsheetRenderCache.prototype.ab = function (a, b, c) {
        if (a < 100) {
            a = 100;
        }
        if (this.ae != a) {
            this.ae = a;
            var d = SpreadsheetPaneManager._fo(a);
            var e = this.aa(this.m, this.v, d) * this.v;
            e += 3 * c;
            e += c;
            this.u = e;
        }
        return this.u;
    };
    SpreadsheetRenderCache.prototype.al = function () {
        this.m = null;
        this.v = 0;
        this.ae = -1;
        this.t = -2147483648;
        this.q.clear();
        this.aq();
        this.am();
    };
    SpreadsheetRenderCache.prototype.an = function () {
        this.af--;
        if (this.af == 0) {
            this.ao();
        }
    };
    SpreadsheetRenderCache.prototype.ag = function () {
        return new MemoryStream(2, Convert.fromBase64String(SpreadsheetRenderCache.ai));
    };
    SpreadsheetRenderCache.prototype.k = function () {
        if (this.n) {
            if (this.f == null) {
                this.f = new SpreadsheetRenderCache_MeasureTextMetricsProvider(this.j(), this.l);
            }
            return this.f;
        }
        else {
            return this.j();
        }
    };
    SpreadsheetRenderCache.prototype.ad = function () {
        return this.e || (this.e = new SpreadsheetRenderCache_DisposableCache(this));
    };
    SpreadsheetRenderCache.prototype.c = function ($t, a, b) {
        if (b === void 0) { b = null; }
        return this.d($t, a ? this.r : this.q, b != null ? b : $t);
    };
    SpreadsheetRenderCache.prototype.d = function ($t, a, b) {
        var c;
        var d = a.tryGetValue(b, c);
        c = d.p1;
        return typeCastObjTo$t($t, c);
    };
    SpreadsheetRenderCache.prototype.ah = function () {
        return new MemoryStream(2, Convert.fromBase64String(SpreadsheetRenderCache.aj));
    };
    SpreadsheetRenderCache.prototype.ao = function () {
        this.aq();
        if (this.f != null) {
            var a = this.f;
            this.f = null;
            a._h.dispose();
        }
    };
    SpreadsheetRenderCache.prototype.ap = function (a) {
        var _this = this;
        var b;
        if (((function () { var c = _this.r.tryGetValue(a, b); b = c.p1; return c.ret; })())) {
            if (typeCast(IDisposable_$type, b) !== null) {
                b.dispose();
            }
            this.r.removeItem(a);
        }
    };
    SpreadsheetRenderCache.prototype.aq = function () {
        var a = Enumerable.a(Base.$, this.r.values);
        this.r.clear();
        for (var c = 0; c < a.length; c++) {
            var b = a[c];
            var d = typeCast(IDisposable_$type, b);
            if (d != null) {
                d.dispose();
            }
        }
    };
    SpreadsheetRenderCache.$t = markType(SpreadsheetRenderCache, 'SpreadsheetRenderCache');
    SpreadsheetRenderCache.ar = Color.u(255, 243, 243, 243);
    SpreadsheetRenderCache.ai = "iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAJkSURBVFhH7ZdbbuMwDEXtPGYnCdBk9r+SSQoEyEby8ugoPi7r2pZbDOYrFxBEXVK8FJ3Kbt00TTUXxNZ1Xd3v92q5XFaPxyPzi8Wi44yZi0U7T8IiTYwgYD3EgbkHm9WBGIONGHMUw6YjciDaYygWYNJ+MlouRw7aHwHHsDNjKD4CEiBEIbfbLScV/cLwEWPRJXFQjCBZPA2JEdFWCE7bePaW8K2/AkDS0+nUXJJgUnmSSfjXalVtt9t6zqkjZkd7GgQQp/F2ABtO8TknF58KsBv8wACJhpJ9/jk+sWxbD3wMPJb4u2GO+VjnAgzgNMCTuAbRLuFyueT4VXosDGw5hgfLa8QtAOSq2hMQIOcM9+dw+NjQgj373a6+Xq/V+Xxu7knATrKHDm02m3q9XmfOXAtbkquBaE9vlbFafDFmCAgg7h4GuKV1FGcQk3KV/85Ngo+YMVjsIFpBBnnQzUNCEjFEtB1w2mMw6RDYp98caH+5ByAPx2OPTQnS2L291Vy5+ImLIDF+7OP7+xc/+L3fd3oW2pXrBhyEkCkOODeNYapD8rEDoMs4tjFiTswYOPnQ/ukj/Qe8CngV8CqgK6B/I/5rxOxRqyvAWy7fz2kmJI7MpY0MXq3Ex+EHSfRz8WQu7eWTLd62ovbzOgunGScvHu581v7HA8fHBdD2fT/lx0cR2HDosEannT/eejpjoFWbHGjjK/nNAaetXta2A4wIeYKiDUzM6cCUvx8r4BjFTzKS50qTbZw2ycGU30cAx5pZYHcFRIfrPv8TjOVynXumAxJ4MtbagLUxAF/J7zrmBE/NqvoLHktNAmgD4tsAAAAASUVORK5CYIIbbIIH6cxJOwAAAABJRU5ErkJggg==";
    SpreadsheetRenderCache.aj = "iVBORw0KGgoAAAANSUhEUgAAA0AAAAAQCAMAAAAI2+8aAAACOlBMVEUAAADLOC1DQ0NDQ0PUfwDWOy84gjvQOi7ghgBGRkbcPTHjiADliQBISEhqampycnJzc3M7iT5ISEhERETNOS09jUDXgADWOy/SfQDbggDdhABGRkY8iz/bPDCoqKjPOS7ZgQC2trZycnI8jEA5gzzihwCjo6M5hTw6hj2dnZ2Wlpb1YldtbW2cnJxwcHD2a2DZPDDkiACfn5/2b2Q6hz7VOi+8vLxwcHDBwcHYPDDDw8PbPDDHx8fmiQA7ij+Xl5fVjiSYmJj1Zlo8ij88jEBISEj1ZFivr6+0tLS+vr48i0DGxsbVihnWlTXWnEbWoE7hhgDXpl31ZFnWmD47iD7XpFjMzMz/mABQUFAunKb0Qzb///8lfYWZmZlDnEdAQECAgIDMegBmZmatra33g3k2fTlERETNegDENitOTk7DNivZgQA3fzrPfABMTExoaGhCQkL5lADGNyt9fX05hj2RkZHvQTXtQTQ4gjvPOS5wcHBtbW31XVFCmkZBmEXTOi7VgAJISEjpPzPHNyypqan229jSfgH7lgDFxcXfPTHqjAA9kEHyQjXbgwBKSkpAlkQ/k0PhPjHujgDLOC32kgCkpKSTk5P2ZlvykABqamrbPDDJNyzXOy/URDrlPzL3fnQ7ij7ehgTliQD09vSXl5d3d3f3e3DVRjve3t5Gi0lDkUdDcEacQz3fQziibiLojgjq7erV1dX2dWr6+vp0dHTutrHd5t23t7eoxqnN3851pne0z7WbvpxclV48RNjqAAAAVnRSTlMA9vbv9pv23JybHVYfHvZWHpsf5u8d75z72sCcVh/v5ubAVR/vb/bn3P729tybm5tWOx4ewrScnG9vVjseHYbv7+bmbzod79vOhjw7+Nmuj4Y578avaLVyPOgAAA0MSURBVGje1ZuJXxNHFMcnJRwCPWgBgVJarVjUWm+tVVt733crNjGEhS4bkg2YmJCAIUTAIAQaCJcKIir1vlrt3f5vfTM7k5lMoBEsfNrfxzb8Pv2s+/qY7763bybIUKVeif5BTiwk6PHWx9E/qAELLVlFL6igF4qYz3tOAz2Xx3z2sw7Qs9nMr3rKDnpqFQI9mmUXlPVoJo+oCpGo1U7n6qXGs/KS77/ljRDojS3Mb37dD3p9s5yvh/eibKCH8UdA6H+qSj0oE2Q+IAJksVicKfy0tq5FKXrsCRGg+vr6JED19ShI1h73ZXmpvme14J/P0X3D4fCwT895nixts3so4fEkhtxmssqfMfV0zQQCM11e0zPYP/mIvem75ubvmuyPPIlQ1tGWw0m1HM3K5BFRgdtdIK5Ix9kuR/YS4+F6S2f/3woIUeWa8hFRvimXfJYrikalED4hFlEvNnBh/5L49Eq//45Nockfz5//cTK0aQf22zdO2MZ7e8dtExu3y/kyfMcpq9X+IP7RpAed6gAvAnHokO1h/JFvvuEA5eWhFH28O9XvBr8kHUlV0tsMIZuozJ7x4+v0SQQp5kIJIJGfjmMdUg1qEAmSAVLVnDdFYBTNXC16p8O0l9kS3ReuIwoH9RJYr26Xp5bIE3FDTPne9jYLUWDUmw8l52hTs4FD89GjjyJ7C/xwogl0ohkIsWfyiKhsyFUm1B/HiGXwLBC0YDwuEI+nO0DCmcHxiMoJ6jU0m7W1DKDinikgiPDT01NsEKQlag1p4PK0aBpB39eDaFL3NAhPr/R87AhNnv+W6PxkaAfwMzHX20jUOzGxXc4X9o1WkD2zb+HeUCP4ZQLIbEYpiq5P9evBL0VwFyL2kfSHiAAQ+sMDerZEOutkgpQoJ0gC6InW48fqjx1PrUENrZygdIDCs+q6SgEgzwWttEAAqK3LUbyVrjoIxhDElAOpdPXVUnlckFZT+6CFqq3dhNAjsB6ompseQXb8ceN6Xd31G/g/2Im/fae29s5t7m/eslhu3SQeYVW4+zxahVB/LKB+x+qUeMKdPB6X1eri8Ux3AUGBri4SD9dOPR7MSQMot6ff4KZ4dKQnFxkEuQcYQMDPxb4hRlAeJ4gB9FJDB+SePr32pOdj0ySwwwjahNBGG/BDCZrbKOcLvMGDfVGeEQSe92MciMz+CEjyIkDVmlaNBH2iTLws+pf94EXV1KD5ZXI6BDlNywBQCSwRY7WWiAB5XJQgGaAnHjsOv0ogKLVrE3w6QHV1cZ9a8wHzsJ5Ou7TybczD39/d7sjdB65IDdclFVeL8jRPbVJjWt5qR5slqYBj9dP2ZqElsz9th1/zNePqa7BU7NhfMK6+wPw54+pz2CPQNrx+B9zbKD/efgsR1CAhnrAe7KTxUIBYPP0/nbwSCFw5+dN0N2aO6VV9eFZ/SwCIEzSVCx/efsIP7eIGGEDuqIfWNuBH4TWIAdR6Bp5eZ1oh1xgmJOdjSwjqD9Pl0JbNfswPI8i/Wc7X0x1WA5AF/KpUvwq8oI5VvJwIgGT2mBbJiwCVuyLlSNBHSu+7on+3MdUXqWoRmlf7vNMWpsEu775/HSBo8X1h2qGIBCnwfHUXiABxfo7VE4LOpHZt+Lm4IECg4aC6s4QBBEpElIpCBhBoZtS5Kx+t89UJ8q0rHaoV5Cot7rIIai/OajosqCnLfvjEDXb1jRMYmBO32dW3DX+TXX0TPAI9F6kFRZ6j/Rvhx6hB2cl4OoM//6HHSTwUIBZPW9dJ68krV+Bf7W3txcIL0GxMfRUJAHGCRqZyc0cFflABB6jAjUtcxFyIi5HCmuaG+xQg6J9x/knu98A7kZyPdya/FTT5zmu2RkFzr8n5yjpFAVmE5zqVtSwAFSqJhCa8QnyuKVf9+7nf77+a4ivVWEytNDItCe3lv8+zjr3/fgtXkqMDP5wghUqrre0DgmSAgJ9Wwg8jqIEKM8MISgeIdmRqDgMIyzOkmRlAWNDHmZA6LAIUU5XTIkADirPbImjECe80gr4DQJqus6uvNx3G/g67+o7hb7Grb4HH/YKb3OO0Vi3UH1aDcDwx+Cf4q/VnNU7iYQCxeAIYHvhzrhvi4S9AvmF9JxIB4gSNjngBIoEf91AfBYgSNAb1H5o57BGDhiZ1LRhS/19quN+A5HyELosA/Rjyj4sAjfvT8mWlgCzGc9l5f8YBkf0RkOQpQNwzgCoqyktLzZG+voi5tLS8ouLgwY8ikahLu9e7vqrqvTWg96qq1o/fY56MefTZzjqfXkIzzUWyvssxYyGa8e5ahnegHBWkw2rTVVBOSgAe6MVlgB5jtJDPx4AVLjxZWBigWFBPqUADUXfFAQGgkSkvVCC1UwQorCp9tWJEinPQIqjNCR2JoGYMCL/cAIZfbnh+uQFQGW3xhsrAOAV+YJLghHjCujo7+7v10rWYEQ8DiMVDCCL8QDyoSCdlZ6ca19chGSBGkMMy6EjhB/6qiwMYIIMg6OKiZdBYaowfnNzvIanUAkGtZ1q/By/nI/StqPMho4PjPZyULw5IJk8lA8TLCwdE9hgN2cMfyRsA5SnRCxcTkGTPwMULUSXvY+I9mvXSD6d+sfl37/bbfjl19Z6VeWNYYzz+5wcInlfGkAcq/jIAhEUWuIpQWgCeqNvkBHnh/l78gwnJgIgAwW+1VQaMAQQNXE2J+A4UUcoLxXegUWduPkISQJ0rAFCFm0358BzBeVa8wTQGyPfr3b+uXbL+PsvikQHqNgCawfG8qUKnitCbaswXLFkYoME2AIjzQ4DRGDBAEAYqAUCJwDTcp0lfS4C6j4HKDFBjBoCoMgDEtMwAsQJMNEY6oE/drjFIBNzrbu/cKwi9Ymu8BIZ5UE0wbryk1swPUL5pFKdm1JS/0Biba5Fj7gwA4WkQDFvJWyoLQQZIrkBSi0cBivv0dR8IU7ixIa10G/fO7i5v8T5sMrRwiX+9hSMTBKqL7m1kBMc0OI1buLD+s/XSXeufQRYPA4jF031OaOFg1BDTX/hAn2VNOevMU1s4h6N/NFfo3zwR3rLRGoSlUVxoy9bRILV0D9/CZWjpMgNkA4nAHAHJngMk9mvciwChAnPEQ/iJmoEfICgKXgNextcTXl5ZPw4EcV/ElsywXpQOEB0kDFpggLDwGDuzf+AKxN+B6BThGVN7m8iPDBBTPZlsy0MGCpAu7QO5pX0gL9sHWuQQoevhhwgwQSBic4Rs/tI5bQwR4td+s1p/0zuFeFygZDzTeIiAIYJ5QjHsSYeHddUXSx8LCWO4UTxE8OYm+YGO/wAZGshDBVZ/2NAgbagg5UMeInyROkSwpQ0RJJ9xaCB7Wm44MJwW7kWAOC2yZ0OEwrIEafHLCukIIZrAAP2wYb/h92+4agWBpwOEOqpZtTJ9iADCg4R+5160IgClT+HyjZ2GtnbgRwZInsJJY+4HPomQLQwk45yfYTw2HuML/DQeGwcsSXU7sp9mj1A6Zl3sGLtaE0pcQqtm20B8jB2HCdyvd6/FeTy0ArF4BvEYG8rQTwGIB6aaweHO+DDuJ6QKxPnxFiNU7B0hNcgd6YNUS2PrciVhAETH1sfZ2DptrC3nY4tYguQx9rh/s5wv2fMxNvdcHWl+GQBCmjHUUZLZG8MAXfUz7weAmC/RZ3nD79OfR/Nql8OxC60wQNBUFAh73YPt3q3onwCCh+RaeaOVAcKU2fONS/ZeaIZuhgpCQggK4oIbqUfljdRmaSO1WdxIJZ5NENgcgQ+yof6weGB+GBPiMQDi8QSmA7B4+wdJPKikRo9Jm2ryRqopHz+XpmCQbWycuqSN03I38EMBgsaN53IP5aeVb6zK+dg0eT51I3VO3EiV8yV7vnEqeqbGdL8MAFW7+wbc0YE+tpf6ieYZUDb8cIntnb5su3fIxnyOmqKchap+LlppgCJ8H3WrF5oTg5+FAYImQz7qsySASvQgrUFxenQmSmvQWNR9AOM8Rdv+7injKA873QZHTd5e9FEeTRqT06MIg6T+8HhiqfG4QAvEA/pKDcIOKpd0lKdHOMojH92Rj/bIR3fkoz3p998RCl1m9cc4yjMhHOWR8yV7fnTH8PLRHdkvB0AVEdghrNBcUXo25CBMsQ+u8ffa1hh+zfi4f43hF6EVBwjzwwmaovwsDBDwIx02XTRA/PBmLB6O8cObmmtgbGzApbHDm972kUBgpF04THqipWWew6TNLfasTN6spMiMDIKmof4sJR52CIHtoGY+TCofHpUPl8qHR+XDpfz+4mHSy5eFw6T+OXyYdM6/cbucL9nLh0mlw6PpfjkAKiUDpm2lSikiiiiRrxH6sMpfZfiqiaoPDf/fAQgr/TS2SNDWDF9XAH6krzssCqDMX2dQpK8POB/o6wxPZvJoXmU7ndlLiGflJd9/5b/OYBPEpmqyB8keJHuQcbL3M0T0GT3fG/3S+Hx/g/G54X3uF6dlGGP/DSf/N2tvm8O4AAAAAElFTkSuQmCC";
    return SpreadsheetRenderCache;
}(Base));
export { SpreadsheetRenderCache };
/**
 * @hidden
 */
var Spreadsheet_NullRenderCache = /** @class */ (function (_super) {
    tslib_1.__extends(Spreadsheet_NullRenderCache, _super);
    function Spreadsheet_NullRenderCache() {
        var _this = _super.call(this, false) || this;
        _this.as = null;
        _this.as = new Workbook();
        return _this;
    }
    Spreadsheet_NullRenderCache.prototype.z = function (a, b) {
        return 0;
    };
    Spreadsheet_NullRenderCache.prototype.y = function (a, b, c) {
        return 0;
    };
    Spreadsheet_NullRenderCache.prototype.aa = function (a, b, c) {
        return 0;
    };
    Spreadsheet_NullRenderCache.prototype.am = function () {
    };
    Spreadsheet_NullRenderCache.prototype.o = function (a) {
        return false;
    };
    Spreadsheet_NullRenderCache.prototype.j = function () {
        return Workbook._br(this.as);
    };
    Spreadsheet_NullRenderCache.prototype.g = function (a, b, c, d, e, f, g, h) {
        return new Spreadsheet_NullSpreadsheetText();
    };
    Spreadsheet_NullRenderCache.prototype.h = function (a, b, c, d, e, f, g, h) {
        return new Spreadsheet_NullSpreadsheetText();
    };
    Spreadsheet_NullRenderCache.prototype.ac = function (a, b) {
        return 0;
    };
    Spreadsheet_NullRenderCache.prototype.get_l = function () {
        return this.as;
    };
    Object.defineProperty(Spreadsheet_NullRenderCache.prototype, "l", {
        get: function () {
            return this.get_l();
        },
        enumerable: true,
        configurable: true
    });
    Spreadsheet_NullRenderCache.$t = markType(Spreadsheet_NullRenderCache, 'Spreadsheet_NullRenderCache', SpreadsheetRenderCache.$);
    return Spreadsheet_NullRenderCache;
}(SpreadsheetRenderCache));
export { Spreadsheet_NullRenderCache };
/**
 * @hidden
 */
var SpreadsheetDOMEventProxy = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetDOMEventProxy, _super);
    function SpreadsheetDOMEventProxy(a, b, c) {
        var _this = _super.call(this, b, c, false) || this;
        _this._d0 = null;
        _this._d0 = a;
        _this._dz = function (d) {
            _this._d5(d);
            return true;
        };
        _this.ai = function (d) {
            var e = SpreadsheetUtilities.c1(_this.am);
            if (_this._d1(e)) {
                return false;
            }
            if (_this._d0._di()) {
                return false;
            }
            var f = (e.target);
            if (f != null && _this._d0._at.g(f)) {
                return false;
            }
            if (f != null && SpreadsheetUtilities.a5(_this._d0._bh.dp.cg, f)) {
                return false;
            }
            return true;
        };
        return _this;
    }
    SpreadsheetDOMEventProxy.prototype.dl = function (a, b, c) {
        if (a == this.bv) {
            c.add(this.bv.listen("contextmenu", runOn(this, this._d4)));
        }
        _super.prototype.dl.call(this, a, b, c);
    };
    SpreadsheetDOMEventProxy.prototype._d1 = function (a) {
        var b = (a.target);
        if (b != null) {
            var c = b.nodeName;
            switch (c) {
                case "TEXTAREA":
                    if (!this._d0.isInEditMode && this._d0._ay != null && this._d0._ay.a7 != null && this._d0._ay.a7.rootWrapper.getNativeElement() == b) {
                        break;
                    }
                    return true;
                case "INPUT":
                case "SELECT":
                case "OPTION":
                case "LI":
                case "UL": return true;
            }
        }
        return false;
    };
    SpreadsheetDOMEventProxy._d2 = function (a) {
        var b = a.type;
        return typeof b === 'string' && startsWith1(b, "key", 3);
    };
    SpreadsheetDOMEventProxy.prototype._d4 = function (a) {
        if (this.ab) {
            return;
        }
        var b = (a.originalEvent.target);
        if (this._d0.isInEditMode) {
            if (SpreadsheetUtilities.a5(this._d0._ay, b) || SpreadsheetUtilities.a5(this._d0._bh.dp.ci.cf, b)) {
                return;
            }
        }
        if (this._d0.isRenamingWorksheet) {
            var c = this._d0._bf._p;
            var d = c != null ? typeCast(SpreadsheetTabItemElement.$, c._ac) : null;
            if (d != null && d.cm != null) {
                var e = d.cm.getNativeElement();
                if (e != null && e.contains(b)) {
                    return;
                }
            }
        }
        var f;
        if ((a.originalEvent.pointerType === undefined)) {
            f = a.button == 0;
        }
        else if ((a.originalEvent.pointerType == "")) {
            f = true;
        }
        else {
            f = false;
        }
        if (f) {
            var g = this._d0.activePane;
            var h = Spreadsheet._i7(g, this._d0.isInEditMode);
            if (this._d0.isInEditMode) {
                var i = this._d0._bh.dp.ci.cf;
                if (SpreadsheetUtilities.a5(i, document.activeElement)) {
                    this._d0._at.j(5, i, { $type: Point_$type, x: 0, y: i.av });
                }
                else {
                    this._d0._at.j(4, this._d0._n(g), h);
                }
            }
            else {
                this._d0._v._ShowPaneContextMenu$i(this._d0.activePane, SpreadsheetUtilities.aa(this._d0.activeSelection), h);
            }
        }
        else if (this._d0._at.h()) {
        }
        else {
            if (this.bj(a)) {
                this.cp(a);
            }
            else {
                this.co(a);
            }
            var j = a.offsetX;
            var k = a.offsetY;
            this._d0._bh.c9(this.cu);
        }
        a.preventDefault();
        a.stopPropagation();
    };
    SpreadsheetDOMEventProxy.prototype._d5 = function (a) {
        if (a.originalEvent != null && this._d1(a.originalEvent)) {
            return;
        }
        if (this._d0._di()) {
            return;
        }
        if (this._d0._at.h()) {
            return;
        }
        if (this.ab) {
            return;
        }
        if (this._d0._v.hasKeyboardFocusWithin) {
            SpreadsheetUtilities.d7(document.activeElement);
        }
        else {
            this._d0._v.focus();
        }
    };
    SpreadsheetDOMEventProxy.$t = markType(SpreadsheetDOMEventProxy, 'SpreadsheetDOMEventProxy', CustomDOMEventProxy.$);
    SpreadsheetDOMEventProxy._d3 = 0;
    return SpreadsheetDOMEventProxy;
}(CustomDOMEventProxy));
export { SpreadsheetDOMEventProxy };
/**
 * @hidden
 */
var SpreadsheetLayerContainerElement$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetLayerContainerElement$1, _super);
    function SpreadsheetLayerContainerElement$1($t, a, b) {
        var _this = _super.call(this, a, b) || this;
        _this.$t = null;
        _this.cf = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        return _this;
    }
    Object.defineProperty(SpreadsheetLayerContainerElement$1.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (a != this.cf) {
                this.cf = a;
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetLayerContainerElement$1.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        for (var e = 0, f = this.a9; e < f; e++) {
            var g = this.b(e);
            g.al(a, b, c, d);
        }
    };
    SpreadsheetLayerContainerElement$1.prototype.ae = function (a) {
        this.cf.q(a);
        return true;
    };
    SpreadsheetLayerContainerElement$1.prototype.af = function (a) {
        this.cf.r(a);
        return true;
    };
    SpreadsheetLayerContainerElement$1.prototype.ag = function (a) {
        this.cf.s(a);
        return true;
    };
    SpreadsheetLayerContainerElement$1.prototype.ad = function (a) {
        return this.cf.l(a);
    };
    SpreadsheetLayerContainerElement$1.prototype.ah = function (a) {
        this.cf.t(a);
        return true;
    };
    SpreadsheetLayerContainerElement$1.$t = markType(SpreadsheetLayerContainerElement$1, 'SpreadsheetLayerContainerElement$1', VisualElement.$);
    return SpreadsheetLayerContainerElement$1;
}(VisualElement));
export { SpreadsheetLayerContainerElement$1 };
/**
 * @hidden
 */
var CanvasSpreadsheetGraphics = /** @class */ (function (_super) {
    tslib_1.__extends(CanvasSpreadsheetGraphics, _super);
    function CanvasSpreadsheetGraphics(ctx_, a) {
        var _this = _super.call(this) || this;
        _this.e = null;
        _this.a = null;
        _this.b = false;
        _this.h = Nullable$1.toNullable(Color.$, null);
        _this.j = null;
        _this.d = null;
        _this.b = ((ctx_.setLineDash != null && ctx_.getLineDash != null));
        _this.e = ctx_;
        _this.a = a;
        return _this;
    }
    CanvasSpreadsheetGraphics.prototype.c = function (a, b, c, d, e, f, g, h, i) {
        var j = false;
        if (b != f || c != g || d != h || e != i) {
            var k = this.e;
            j = true;
            if (a) {
                k.save();
            }
            k.beginPath();
            k.moveTo(f, g);
            k.lineTo(f + h, g);
            k.lineTo(f + h, g + i);
            k.lineTo(f, g + i);
            k.lineTo(f, g);
            k.lineTo(b, c);
            k.lineTo(b, c + e);
            k.lineTo(b + d, c + e);
            k.lineTo(b + d, c);
            k.lineTo(b, c);
            k.clip();
        }
        return j;
    };
    CanvasSpreadsheetGraphics.prototype.drawIcon = function (a, b, c, d, e, f, g, h, i) {
        var j = this.c(true, b, c, d, e, f, g, h, i);
        var k = this.a.a2();
        this.e.drawImage(k, (a - 1) * 16, 0, 16, 16, b, c, d, e);
        if (j) {
            this.e.restore();
        }
    };
    CanvasSpreadsheetGraphics.prototype.getFarPixelAdjustment = function (a) {
        return a.d / 2;
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle3 = function (a, b, c, d, e) {
        if (a != CellFill.noColor) {
            var f = a._c(this.a.l);
            var g = typeCast(CellFillPattern.$, f);
            if (g != null) {
                var h = g.patternStyle;
                var i = g.patternColorInfo._getResolvedColor();
                var j = g.backgroundColorInfo._getResolvedColor();
                switch (g.patternStyle) {
                    case 0: break;
                    case 1:
                        this.fillRectangle7(j.colorString, b, c, d, e);
                        break;
                    default:
                        var k = this.i(g.patternStyle, i, j);
                        if (k != null) {
                            this.fillRectangle7(k, b, c, d, e);
                        }
                        break;
                }
            }
            else {
                var l = typeCast(CellFillLinearGradient.$, f);
                if (l != null) {
                    var m = this.f(b, c, d, e, l);
                    this.fillRectangle7(m, b, c, d, e);
                }
                else {
                    var n = typeCast(CellFillRectangularGradient.$, f);
                    if (n != null) {
                        this.fillRectangle6(n, b, c, d, e);
                    }
                }
            }
        }
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle1 = function (a, b, c, d, e) {
        var f = this.a.ba(a);
        this.fillRectangle7(f, b, c, d, e);
    };
    CanvasSpreadsheetGraphics.prototype.drawLine = function (a, b, c, d, e, f, g) {
        this.drawLine5(a, this.a.ba(b), c, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawLine2 = function (pen, color, dpiFactor, x1, y1, x2, y2) {
        arguments[1] = Color.create(arguments[1]);
        return this._drawLine2$i.apply(this, arguments);
    };
    CanvasSpreadsheetGraphics.prototype._drawLine2$i = function (a, b, c, d, e, f, g) {
        this.drawLine5(a, b.colorString, c, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawLine1 = function (a, b, c, d, e, f, g) {
        this.drawLine5(a, b._getResolvedColor1(this.a.l).colorString, c, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawLine4 = function (penWidth, color, dpiFactor, x1, y1, x2, y2) {
        arguments[1] = Color.create(arguments[1]);
        return this._drawLine4$i.apply(this, arguments);
    };
    CanvasSpreadsheetGraphics.prototype._drawLine4$i = function (a, b, c, d, e, f, g) {
        this.drawLine5(6, b.colorString, c * a, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawLine3 = function (a, b, c, d, e, f) {
        if (this.j == null || Color.e(this.h, a.b)) {
            this.h = a.b;
            this.j = Color.c(a.b, Nullable$1.toNullable(Color.$, null)) ? this.a.ba(38) : a.b.value.colorString;
        }
        var g = Color.c(a.b, Nullable$1.toNullable(Color.$, null)) ? 6 : 1;
        this.drawLine5(g, this.j, b, c, d, e, f);
    };
    CanvasSpreadsheetGraphics.prototype.drawRectangle = function (a, b, c, d, e, f, g) {
        this.drawRectangle2(a, this.a.ba(b), c, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawRectangle1 = function (a, b, c, d, e, f, g) {
        this.drawRectangle2(a, b._getResolvedColor1(this.a.l).colorString, c, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.drawRectangle2 = function (a, b, c, d, e, f, g) {
        var h = null;
        var i = 0;
        if (this.b) {
            h = this.e.getLineDash();
            var j = SpreadsheetUtilities.c(a) || new Array(0);
            this.e.setLineDash(j);
            i = this.e.lineDashOffset;
            this.e.lineDashOffset = a == 8 ? 1 : 0;
        }
        this.e.lineWidth = SpreadsheetUtilities.b8(a, c);
        this.e.strokeStyle = b;
        this.e.strokeRect(d, e, f, g);
        if (this.b) {
            this.e.setLineDash(h);
            this.e.lineDashOffset = i;
        }
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle2 = function (a, b, c, d, e, f, g, h, i) {
        var j = b + d;
        var k = f + h;
        var l = c + e;
        var m = g + i;
        var n = this.a.ba(a);
        if (b < f) {
            this.fillRectangle7(n, b, c, f - b, e);
        }
        if (j > k) {
            this.fillRectangle7(n, k, c, j - k, e);
        }
        if (c < g) {
            this.fillRectangle7(n, f, c, h, g - c);
        }
        if (l > m) {
            this.fillRectangle7(n, f, m, h, l - m);
        }
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle5 = function (a, b, c, d, e) {
        var f = a._getResolvedColor1(this.a.l).colorString;
        this.fillRectangle7(f, b, c, d, e);
    };
    CanvasSpreadsheetGraphics.prototype.drawEllipse = function (a, b, c, d, e, f, g) {
        this.e.beginPath();
        this.e.lineWidth = (a * c);
        this.e.strokeStyle = this.a.ba(b);
        var h = 0.5522848;
        var i = (d + f / 2);
        var j = (e + g / 2);
        var k = (f / 2 * h);
        var l = (g / 2 * h);
        var m = (d + f);
        var n = (e + g);
        this.e.moveTo(d, j);
        this.e.bezierCurveTo(d, j - l, i - k, e, i, e);
        this.e.bezierCurveTo(i + k, e, m, j - l, m, j);
        this.e.bezierCurveTo(m, j + l, i + k, n, i, n);
        this.e.bezierCurveTo(i - k, n, d, j + l, d, j);
        this.e.closePath();
        this.e.stroke();
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle = function (a, b, c, d, e, f, g) {
    };
    CanvasSpreadsheetGraphics.prototype.drawHeaderText = function (a, b, c, d, e, f) {
        if (f === void 0) { f = 1; }
        var g = this.a.ba(e);
        this.e.font = this.a.a5(a, f);
        this.e.textAlign = "center";
        this.e.textBaseline = "middle";
        this.e.fillStyle = g;
        this.e.fillText(b, c, d);
    };
    CanvasSpreadsheetGraphics.prototype.drawDropDownGlyph = function (a, b, c, d, e) {
        var f = ((a & 2) == 0) ? 67 : 70;
        var g = this.a.ba(f);
        var h = this.e;
        h.save();
        h.translate(b, c);
        h.scale(Math.min(1, d / 15), Math.min(1, e / 15));
        h.fillStyle = g;
        h.strokeStyle = g;
        h.beginPath();
        var i = (a & 16) != 0;
        var j = (a & 4) != 0;
        var k = (a & 8) != 0;
        var l = j || k;
        if (i) {
            h.moveTo(5, 3);
            h.lineTo(14, 3);
            h.lineTo(11, 6);
            h.lineTo(11, 11);
            h.lineTo(8, 11);
            h.lineTo(8, 6);
            if (l) {
                h.fill();
                h.beginPath();
                h.moveTo(3.5, 4);
                h.lineTo(3.5, 12);
                h.stroke();
                h.beginPath();
                h.moveTo(2, j ? 5.5 : 10.5);
                h.lineTo(5, j ? 5.5 : 10.5);
                h.stroke();
            }
            else {
                h.moveTo(2, 9);
                h.lineTo(7, 9);
                h.lineTo(4.5, 12);
                h.fill();
            }
        }
        else if (l) {
            h.moveTo(3, 9);
            h.lineTo(8, 9);
            h.lineTo(5.5, 12);
            h.fill();
            h.beginPath();
            h.moveTo(10.5, 3);
            h.lineTo(10.5, 11);
            h.stroke();
            h.beginPath();
            h.moveTo(9, j ? 4.5 : 9.5);
            h.lineTo(12, j ? 4.5 : 9.5);
            h.stroke();
        }
        else {
            h.moveTo(4, 6);
            h.lineTo(11, 6);
            h.lineTo(7.5, 10);
            h.fill();
        }
        h.restore();
    };
    CanvasSpreadsheetGraphics.prototype.i = function (a, b, c) {
        var d = SpreadsheetUtilities.bq.item(a);
        if (d == null) {
            return null;
        }
        var e = arrayGetLength(d, 0);
        var f = arrayGetLength(d, 1);
        if (this.d == null) {
            this.d = document.createElement("canvas");
        }
        var g = this.d.getContext("2d");
        this.d.width = f;
        this.d.height = e;
        var h = g.createImageData(f, e);
        ;
        var i = h.data;
        var j = 0;
        for (var k = 0; k < e; k++) {
            for (var l = 0; l < f; l++) {
                var m = d[k][l] == 1 ? b : c;
                i[j++] = m.o;
                i[j++] = m.n;
                i[j++] = m.m;
                i[j++] = m.l;
            }
        }
        g.putImageData(h, 0, 0);
        ;
        return this.e.createPattern(this.d, "repeat");
        ;
    };
    CanvasSpreadsheetGraphics.prototype.f = function (a, b, c, d, e) {
        var f = SpreadsheetUtilities.cc(e.angle);
        var g = SpreadsheetUtilities.cb(f, c, d);
        var h = SpreadsheetUtilities.b7(g, c, d);
        var i = c / 2 + Math.sin(g) * h;
        var j = d / 2 + Math.cos(g) * h;
        var k = c / 2 + Math.sin(g + Math.PI) * h;
        var l = d / 2 + Math.cos(g + Math.PI) * h;
        var m = e.stops;
        return this.g(a, b, 1, 1, i, j, k, l, m);
    };
    CanvasSpreadsheetGraphics.prototype.g = function (a, b, c, d, e, f, g, h, i) {
        var j = a + (g * c);
        var k = b + (h * d);
        var l = a + (e * c);
        var m = b + (f * d);
        var n = this.e.createLinearGradient(j, k, l, m);
        for (var o = 0; o < i.count; o++) {
            var p = i.item(o);
            n.addColorStop(p.offset, p.colorInfo._color$i.value.colorString);
        }
        return n;
    };
    CanvasSpreadsheetGraphics.prototype.drawLine5 = function (a, b, c, d, e, f, g) {
        this.e.beginPath();
        var h = null;
        var i = 0;
        if (this.b) {
            h = this.e.getLineDash();
            var j = SpreadsheetUtilities.c(a) || new Array(0);
            this.e.setLineDash(j);
            i = this.e.lineDashOffset;
            this.e.lineDashOffset = a == 8 ? 1 : 0;
        }
        this.e.lineWidth = SpreadsheetUtilities.b8(a, c);
        this.e.strokeStyle = b;
        this.e.moveTo(d, e);
        this.e.lineTo(f, g);
        this.e.stroke();
        if (this.b) {
            this.e.setLineDash(h);
            this.e.lineDashOffset = i;
        }
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle7 = function (a, b, c, d, e) {
        this.e.fillStyle = a;
        this.e.fillRect(b, c, d, e);
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle4 = function (a, b, c, d, e, f, g) {
        var h = a._getResolvedColor1(this.a.l).colorString;
        var i;
        if (WorkbookColorInfo.l_op_Equality(a, b)) {
            i = h;
        }
        else {
            var j = void 0, k = void 0, l = void 0, m = void 0;
            if (c) {
                j = d;
                l = d + f;
                k = m = e + g / 2;
            }
            else {
                k = e;
                m = e + g;
                j = l = d + f / 2;
            }
            var n = this.e.createLinearGradient(j, k, l, m);
            n.addColorStop(0, h);
            n.addColorStop(1, b._getResolvedColor1(this.a.l).colorString);
            i = n;
        }
        this.fillRectangle7(i, d, e, f, g);
    };
    CanvasSpreadsheetGraphics.prototype.fillRectangle6 = function (a, b, c, d, e) {
        var f = Math.abs(a.bottom - a.top);
        var g = Math.abs(a.right - a.left);
        var h = a.top;
        var i = Math.max(h, a.bottom);
        var j = a.left;
        var k = Math.max(j, a.right);
        var l = 0.01;
        if (g > 0 && f > 0) {
            var m = Enumerable.a(CellFillGradientStop.$, Enumerable.x(CellFillGradientStop.$, Number_$type, a.stops, function (n) { return n.offset; }));
            var n = m[0];
            var o = new Color();
            if (m[1].offset != n.offset) {
                o = Enumerable.ad(CellFillGradientStop.$, Enumerable.x(CellFillGradientStop.$, Number_$type, a.stops, function (p) { return p.offset; })).colorInfo._getResolvedColor();
            }
            else {
                var p = new List$1(Color.$, 0);
                for (var q = 0, r = m.length; q < r; q++) {
                    var s = m[q];
                    if (s.offset != n.offset) {
                        break;
                    }
                    p.add(s.colorInfo._getResolvedColor());
                }
                var t = truncate((Enumerable.ab(Color.$, p, function (u) { return u.o; }) / p.count));
                var u = truncate((Enumerable.ab(Color.$, p, function (v) { return v.n; }) / p.count));
                var v = truncate((Enumerable.ab(Color.$, p, function (w) { return w.m; }) / p.count));
                o = Color.u(255, t, u, v);
            }
            this.fillRectangle7(o.colorString, b + (j * d), c + (h * e), g * d, f * e);
        }
        if (j > 0) {
            this.e.beginPath();
            this.e.moveTo((b), (c));
            this.e.lineTo((b + (j + l) * d), (c + h * e));
            this.e.lineTo((b + (j + l) * d), (c + i * e));
            this.e.lineTo((b), (c + e));
            this.e.closePath();
            this.e.fillStyle = this.g(b, c, d, e, 0, 0.5, j, 0.5, a.stops);
            this.e.fill();
        }
        if (h > 0) {
            this.e.beginPath();
            this.e.moveTo((b), (c));
            this.e.lineTo((b + j * d), (c + (h + l) * e));
            this.e.lineTo((b + k * d), (c + (h + l) * e));
            this.e.lineTo((b + d), (c));
            this.e.closePath();
            this.e.fillStyle = this.g(b, c, d, e, 0.5, 0, 0.5, h, a.stops);
            this.e.fill();
        }
        if (k < 1) {
            this.e.beginPath();
            this.e.moveTo((b + d), (c));
            this.e.lineTo((b + (k - l) * d), (c + h * e));
            this.e.lineTo((b + (k - l) * d), (c + i * e));
            this.e.lineTo((b + d), (c + e));
            this.e.closePath();
            this.e.fillStyle = this.g(b, c, d, e, 1, 0.5, k, 0.5, a.stops);
            this.e.fill();
        }
        if (i < 1) {
            this.e.beginPath();
            this.e.moveTo((b), (c + e));
            this.e.lineTo((b + j * d), (c + (i - l) * e));
            this.e.lineTo((b + k * d), (c + (i - l) * e));
            this.e.lineTo((b + d), (c + e));
            this.e.closePath();
            this.e.fillStyle = this.g(b, c, d, e, 0.5, 1, 0.5, i, a.stops);
            this.e.fill();
        }
    };
    CanvasSpreadsheetGraphics.$t = markType(CanvasSpreadsheetGraphics, 'CanvasSpreadsheetGraphics', Base.$, [ISpreadsheetGraphics_$type]);
    return CanvasSpreadsheetGraphics;
}(Base));
export { CanvasSpreadsheetGraphics };
/**
 * @hidden
 */
var SpreadsheetVisualElementDomBuilder = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetVisualElementDomBuilder, _super);
    function SpreadsheetVisualElementDomBuilder(a) {
        var _this = _super.call(this) || this;
        _this.ab = null;
        _this.ac = null;
        _this.ak = new Stack$1(String_$type);
        _this.aj = null;
        _this.ab = a;
        return _this;
    }
    SpreadsheetVisualElementDomBuilder.prototype.r = function (a) {
        var _this = this;
        switch (a.bx) {
            case "TextBox":
                if (a._parent != null && a._parent.bx == "FormulaBarTextAreaContainer") {
                    _super.prototype.r.call(this, a);
                    this.bc(a, "ToolTip_FormulaBarTextEditor");
                    SpreadsheetVisualElementDomBuilder.a5(a.a7.rootWrapper);
                    this.at(a.a7.rootWrapper);
                    a.a7.rootWrapper.listen("focus", function (b) { return _this.ab._ai.au(); });
                }
                break;
            case "ToggleButton":
                if (a._parent != null && a._parent.bx == "FormulaBarTextAreaContainer") {
                    VisualElementDomBuilder.p(a, this.ac.formulaBarExpandButton);
                }
                break;
            case "ComboBox":
                if (this.ag(a)) {
                    this.aq(a);
                }
                break;
            case "FormulaBarButtonContainer":
                VisualElementDomBuilder.p(a, this.ac.formulaBarButtonContainer);
                break;
            case "FormulaBarNameBoxContainer":
                this.ar(a);
                break;
            case "FormulaBarTextAreaContainer":
                VisualElementDomBuilder.p(a, this.ac.formulaBarTextAreaContainer);
                break;
            case "FormulaBarTextBoxSplitter":
                VisualElementDomBuilder.p(a, this.ac.formulaBarTextAreaSplitter);
                break;
            case "FormulaBarNameBoxSplitter":
                VisualElementDomBuilder.p(a, this.ac.nameBoxSplitter);
                break;
            case "FormulaBarEnterButton":
                VisualElementDomBuilder.p(a, this.ac.formulaBarEnterButton);
                this.bc(a, "ToolTip_FormulaBarEnterButton");
                break;
            case "FormulaBarCancelButton":
                VisualElementDomBuilder.p(a, this.ac.formulaBarCancelButton);
                this.bc(a, "ToolTip_FormulaBarCancelButton");
                break;
            case "FormulaBar":
                VisualElementDomBuilder.q(a, "div", this.ac.formulaBar, true, false);
                break;
            case "InputMessage":
                VisualElementDomBuilder.p(a, this.ac.inputMessage);
                break;
            case "InputMessageBody":
                VisualElementDomBuilder.q(a, "div", this.ac.inputMessageContent, false, false);
                break;
            case "InputMessageTitle":
                VisualElementDomBuilder.q(a, "div", this.ac.inputMessageTitle, false, false);
                break;
            case "SelectAllButton":
                VisualElementDomBuilder.p(a, this.ac.selectAll);
                break;
            case "PaneSplitter":
                {
                    var b = a.cf;
                    var c = b == 2 ? this.ac.splitterIntersection : b == 0 ? this.ac.rowSplitter : this.ac.columnSplitter;
                    VisualElementDomBuilder.p(a, c);
                    break;
                }
            case "ColSplitterPreview":
                VisualElementDomBuilder.p(a, this.ac.columnSplitterPreview);
                break;
            case "RowSplitterPreview":
                VisualElementDomBuilder.p(a, this.ac.rowSplitterPreview);
                break;
            case "TabItemArea":
                VisualElementDomBuilder.p(a, this.ac.tabItemArea);
                break;
            case "TabScrollFirst":
                VisualElementDomBuilder.p(a, this.ac.scrollFirstTabButton);
                break;
            case "TabScrollPrev":
                VisualElementDomBuilder.p(a, this.ac.scrollPreviousTabButton);
                break;
            case "TabScrollNext":
                VisualElementDomBuilder.p(a, this.ac.scrollNextTabButton);
                break;
            case "TabScrollLast":
                VisualElementDomBuilder.p(a, this.ac.scrollLastTabButton);
                break;
            case "TabActivatePrev":
                VisualElementDomBuilder.p(a, this.ac.activatePreviousHiddenTabButton);
                break;
            case "TabItemPanel":
                VisualElementDomBuilder.p(a, null);
                break;
            case "TabActivateNext":
                VisualElementDomBuilder.p(a, this.ac.activateNextHiddenTabButton);
                break;
            case "AddWorksheetButton":
                VisualElementDomBuilder.p(a, this.ac.addNewWorksheetButton);
                break;
            case "TabAreaSplitter":
                VisualElementDomBuilder.p(a, this.ac.tabAreaSplitter);
                break;
            case "TabAreaBackground":
                VisualElementDomBuilder.p(a, this.ac.tabAreaBackground);
                break;
            case "TabAreaBorder":
                VisualElementDomBuilder.p(a, this.ac.tabAreaBorder);
                break;
            case "TabDropIndicator":
                VisualElementDomBuilder.q(a, "div", this.ac.tabDropIndicator, true, false);
                break;
            case "SheetTabItem":
                VisualElementDomBuilder.p(a, this.ac.tabItem);
                a.cm = SpreadsheetVisualElementDomBuilder.al(a.a7, this.ac);
                break;
            case "SpreadsheetColumnHeaderContainer":
                VisualElementDomBuilder.p(a, this.ac.columnHeaderArea);
                break;
            case "SpreadsheetRowHeaderContainer":
                VisualElementDomBuilder.p(a, this.ac.rowHeaderArea);
                break;
            case "SpreadsheetPaneContainer":
                VisualElementDomBuilder.p(a, this.ac.paneArea);
                break;
            case "SpreadsheetArea":
                VisualElementDomBuilder.p(a);
                break;
            case "Icon":
            case "SpreadsheetRenderer":
                {
                    VisualElementDomBuilder.q(a, "canvas", null, true, false);
                    var d = new SpreadsheetVisualElementDomBuilder_CanvasCache();
                    d.d = a.a7.get2DCanvasContext(a.a7.rootWrapper);
                    if (a.bx == "Icon") {
                        a.cj = d;
                    }
                    else {
                        a.ci = d;
                    }
                    break;
                }
            case "SpreadsheetCellValue":
                VisualElementDomBuilder.q(a, "div", null, true, false);
                break;
            case "SpreadsheetCellValueLayer":
                VisualElementDomBuilder.q(a, "div", null, true, true);
                break;
            case "CellContainer":
                VisualElementDomBuilder.q(a, "div", null, true, false);
                break;
            case "InplaceEditor":
                VisualElementDomBuilder.q(a, "textarea", null, true, true);
                this.a6(a);
                break;
            case "InplaceBackground":
                VisualElementDomBuilder.q(a, "div", null, true, true);
                break;
            case "InvalidData":
                VisualElementDomBuilder.q(a, "img", null, true, false);
                break;
            case "SpreadsheetDrawingLayer":
            case "Layer":
                VisualElementDomBuilder.q(a, "div", null, true, true);
                break;
            case "ShapeContainer":
            case "Shape":
            case "Chart":
                VisualElementDomBuilder.q(a, "div", null, true, false);
                break;
        }
        _super.prototype.r.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.g = function (a) {
        var b;
        if (a.bx == "ScrollBar") {
            b = a.cn;
        }
        else {
            b = a.g(ScrollBarVisualElement.$).cn;
        }
        switch (a.bx) {
            case "ScrollBar": return b ? this.ac.scrollBarVertical : this.ac.scrollBarHorizontal;
            case "ScrollBarFarButton": return b ? this.ac.scrollBarArrowDown : this.ac.scrollBarArrowRight;
            case "ScrollBarFarTrack": return b ? this.ac.scrollBarTrackDown : this.ac.scrollBarTrackRight;
            case "ScrollBarNearButton": return b ? this.ac.scrollBarArrowUp : this.ac.scrollBarArrowLeft;
            case "ScrollBarNearTrack": return b ? this.ac.scrollBarTrackUp : this.ac.scrollBarTrackLeft;
            case "ScrollBarThumb": return b ? this.ac.scrollBarThumbVertical : this.ac.scrollBarThumbHorizontal;
        }
        return _super.prototype.g.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.s = function (a) {
        if (this.ag(a)) {
            var b = a;
            var c = b.cr;
            var d = false;
            if (a.ch) {
                a.ch = false;
                var e = null;
                if (a.ck != null) {
                    e = new Array(a.ck.count);
                    a.ck.copyTo(e, 0);
                }
                if (e.length != c.g.count) {
                    d = true;
                }
                else {
                    for (var f = 0; f < e.length; f++) {
                        if (e[f] != c.g.item(f).p) {
                            d = true;
                            break;
                        }
                    }
                }
                if (d) {
                    c.g.clear();
                    for (var g = 0; g < e.length; g++) {
                        var h = new DropDownItem();
                        h.m = h.p = e[g];
                        c.g.add(h);
                    }
                }
            }
            if (a.ci || d) {
                a.ci = false;
                c.z = a.co;
            }
            c.p.setRawSize(a.a3, a.av);
        }
        _super.prototype.s.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.v = function (a) {
        if (a._parent != null && a._parent.bx == "FormulaBarTextAreaContainer") {
            if (a.ck) {
                if (a.cl) {
                    a.a7.rootWrapper.addClass(this.ac.formulaBarExpandButtonOpen);
                }
                else {
                    a.a7.rootWrapper.removeClass(this.ac.formulaBarExpandButtonOpen);
                }
            }
        }
        _super.prototype.v.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.bb = function (a, b) {
        var c = a;
        if (c.cr != null) {
            var d = c.cr;
            c.cr = null;
            SpreadsheetVisualElementDomBuilder.as(d);
        }
        c.disposed = delegateRemove(c.disposed, runOn(this, this.bb));
    };
    SpreadsheetVisualElementDomBuilder.prototype.x = function (a) {
        if (this.ag(a)) {
            var b = a;
            var c = b.cr;
            c.f = a.u;
        }
        else if (a.bx == "Spreadsheet") {
            return;
        }
        _super.prototype.x.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.z = function (a) {
        if (this.ag(a)) {
            var b = a;
            var c = b.cr;
            b.cr = null;
            SpreadsheetVisualElementDomBuilder.as(c);
            a.disposed = delegateRemove(a.disposed, runOn(this, this.bb));
        }
        _super.prototype.z.call(this, a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.get_n = function () {
        return this.ac.tooltip;
    };
    SpreadsheetVisualElementDomBuilder.prototype.get_m = function () {
        return this.ac.tooltipBody;
    };
    SpreadsheetVisualElementDomBuilder.prototype.get_o = function () {
        return this.ac.tooltipTitle;
    };
    SpreadsheetVisualElementDomBuilder.prototype.visitElement = function (a) {
        var b = a.j;
        var c = _super.prototype.visitElement.call(this, a);
        if (b && a.a7 != null) {
            switch (a.bx) {
                case "InputMessage":
                    this.a0(a);
                    break;
                case "SheetTabItem":
                    this.a4(a);
                    break;
                case "SpreadsheetRenderer":
                    this.au(a);
                    break;
                case "SpreadsheetCellValue":
                    this.av(a);
                    break;
                case "InplaceEditor":
                    this.az(a);
                    break;
                case "InplaceBackground":
                    this.ay(a);
                    break;
                case "Icon":
                    this.ax(a);
                    break;
                case "InvalidData":
                    this.a1(a);
                    break;
                case "ShapeContainer":
                    this.a2(a);
                    break;
                case "Shape":
                    this.a3(a);
                    break;
                case "Chart":
                    this.aw(a);
                    break;
            }
        }
        return c;
    };
    Object.defineProperty(SpreadsheetVisualElementDomBuilder.prototype, "ad", {
        get: function () {
            return this.ac;
        },
        set: function (a) {
            this.ac = a;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetVisualElementDomBuilder.prototype.ap = function (a) {
        try {
            var b = JSDataObject._a(a);
            if (b != null && b.getDataPresent(DataFormats.d)) {
                var c = ClipboardHelper.e();
                if (c == null || !c.getDataPresent(DataFormats.d) || c.getData(DataFormats.d) != b.getData(DataFormats.d)) {
                    var d = ClipboardHelper.d();
                    ClipboardHelper.b(b, d);
                    ClipboardHelper.c(d, false);
                }
            }
        }
        catch (e) {
        }
    };
    SpreadsheetVisualElementDomBuilder.am = function (a) {
        var b = new EditableComboBox();
        b.ak(a);
        return b;
    };
    SpreadsheetVisualElementDomBuilder.prototype.aq = function (a) {
        var _this = this;
        VisualElementDomBuilder.q(a, "div", null, true, false);
        a.cr = SpreadsheetVisualElementDomBuilder.am(a.a7);
        var b = a.cr;
        b.itemClick = delegateCombine(b.itemClick, function (c, d) {
            a.co = d.p;
            a.cq();
        });
        b.j = function (c, d, e) {
            if (c == 3) {
                a.co = b.z;
                a.cq();
                e.stopPropagation();
                e.preventDefault();
                return true;
            }
            else if (c == 8) {
                _this.ab._v.focus();
                e.stopPropagation();
                e.preventDefault();
                return true;
            }
            return false;
        };
        a.disposed = delegateCombine(a.disposed, runOn(this, this.bb));
    };
    SpreadsheetVisualElementDomBuilder.prototype.ar = function (a) {
        VisualElementDomBuilder.q(a, "div", this.ac.nameBoxContainer, true, false);
        var b = a.a7.rootWrapper;
        this.bc(a, "ToolTip_FormulaBarNameBox");
        b.listen("focusout", function (c) {
            var d = a.g(SpreadsheetVisualElement.$);
            var e = (c.originalEvent.relatedTarget);
            if (d != null && !b.getNativeElement().contains(e)) {
                a.cf.co = d.dq._ft;
                a.cf.ci = true;
            }
        });
        b.listen("focusin", function (c) {
            var d = (c.originalEvent.relatedTarget);
            if (!b.getNativeElement().contains(d)) {
                var e = a.cf;
                var f = e.cr;
                f.al();
            }
        });
    };
    SpreadsheetVisualElementDomBuilder.al = function (a, b) {
        var c = a.createElement("div");
        c.addClass(b.tabItemContent);
        a.append(c);
        var d = a.createElement("span");
        c.append(d);
        return d;
    };
    SpreadsheetVisualElementDomBuilder.as = function (a) {
        var b = a;
        if (b != null) {
            b.ak(null);
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.at = function (a) {
        var _this = this;
        a.listen("keydown", function (b) {
            var c = false;
            var d = BaseDOMEventProxy.cr(b);
            if (_this.ab.isInEditMode && d == 3 && b.altKey) {
                var e = (b.originalEvent.target);
                _this.ah(e, "\n");
                var f = _this.ab._ay;
                if (f != null) {
                    f.c9 = e.value;
                    f.cv = true;
                    f.da();
                }
                c = true;
            }
            else if (!_this.ab.isInEditMode) {
                switch (d) {
                    case 55:
                    case 54:
                        if (b.ctrlKey) {
                            if (!_this.ab._cw(d == 55, true)) {
                                c = true;
                            }
                        }
                        break;
                    case 1:
                        if (!b.ctrlKey && !b.altKey && !b.shiftKey) {
                            var g = b.originalEvent.target;
                            var h = (g && g.value);
                            if (stringIsNullOrEmpty(h)) {
                                _this.ab._cz(74, null, null);
                                c = true;
                            }
                        }
                        break;
                }
            }
            if (c) {
                b.preventDefault();
                b.stopPropagation();
            }
        });
        var b = function (c) {
            var d = (c.originalEvent.type);
            _this.ak.h(d);
            if (_this.aj != null) {
                _this.aj.add(d);
            }
            try {
                if (_this.ab.isInEditMode) {
                    switch (d) {
                        case "cut":
                        case "copy":
                            _this.ab._ga();
                            break;
                        case "paste":
                            _this.ap(c);
                            break;
                    }
                }
                else {
                    switch (d) {
                        case "cut":
                        case "copy":
                            var e = _this.ab._i5;
                            _this.ab._i5 = JSDataObject._a(c);
                            try {
                                _this.ab._cz(d == "cut" ? 148 : 149, c, null);
                                c.preventDefault();
                            }
                            finally {
                                _this.ab._i5 = e;
                            }
                            break;
                        case "paste":
                            _this.ap(c);
                            _this.ab._cz(150, c, null);
                            c.preventDefault();
                            break;
                    }
                }
            }
            finally {
                _this.ak.e();
            }
        };
        a.listen("copy", b);
        a.listen("cut", b);
        a.listen("paste", b);
    };
    SpreadsheetVisualElementDomBuilder.prototype.au = function (a) {
        if (a.ch) {
            var b = a.ci;
            var c = this.ab._ek;
            var d = truncate(Math.ceil(a.a3 * c));
            var e = truncate(Math.ceil(a.av * c));
            if (d != b.c) {
                a.a7.rootWrapper.setAttribute("width", d);
            }
            if (e != b.a) {
                a.a7.rootWrapper.setAttribute("height", e);
            }
            if (c != b.b) {
                b.b = c;
                b.d = a.a7.get2DCanvasContext(a.a7.rootWrapper);
            }
            if (c != 1) {
                b.d.save();
                b.d.scale(c, c);
            }
            var f = a.co;
            b.d.clearRect(f.x, f.y, f.width, f.height);
            var g = new CanvasSpreadsheetGraphics(b.d, this.ab._a8._al._j);
            a.cl(g, SpreadsheetVisualElementDomBuilder.ae, PointUtil.create());
            if (c != 1) {
                b.d.restore();
            }
            b.a = e;
            b.c = d;
            b.b = c;
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.a1 = function (a) {
        if (a.ch || a.ci) {
            a.ch = false;
            a.ci = false;
            var b = a.ck;
            var c = b / 2;
            var d = b / 2;
            var e = a.a3 - b;
            var f = a.av - b;
            var g = 0.5522848;
            var h = (c + e / 2);
            var i = (d + f / 2);
            var j = (e / 2 * g);
            var k = (f / 2 * g);
            var l = (c + e);
            var m = (d + f);
            var n = new StringBuilder(0);
            n.l("<svg xmlns=\"http://www.w3.org/2000/svg\">");
            n.l("<path");
            n.l(" fill=\"none\"");
            n.l(" stroke=\"");
            n.l(a.cm);
            n.l("\"");
            n.l(" stroke-width=\"");
            n.k(b);
            n.l("\"");
            n.l(" d=\"");
            n.l(" M " + c + " " + i);
            n.l(" C " + c + " " + (i - k) + ", " + (h - j) + " " + d + ", " + h + " " + d);
            n.l(" C " + (h + j) + " " + d + ", " + l + " " + (i - k) + ", " + l + " " + i);
            n.l(" C " + l + " " + (i + k) + ", " + (h + j) + " " + m + ", " + h + " " + m);
            n.l(" C " + (h - j) + " " + m + ", " + c + " " + (i + k) + ", " + c + " " + i);
            n.l("\" />");
            n.l("</svg>");
            a.a7.rootWrapper.setAttribute("src", SpreadsheetUtilities.c6("image/svg+xml", n.toString(), true));
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.a4 = function (a) {
        var b = a.a7.rootWrapper;
        if (a.ch) {
            a.ch = false;
            a.cm.setText(a.cf._ae != null ? a.cf._ae : "");
        }
        if (a.ck) {
            a.ck = false;
            if (a.cf._u) {
                b.addClass(this.ac.tabItemSelected);
            }
            else {
                b.removeClass(this.ac.tabItemSelected);
            }
        }
        if (a.ci) {
            a.ci = false;
            if (a.cf._r) {
                b.addClass(this.ac.tabItemActive);
            }
            else {
                b.removeClass(this.ac.tabItemActive);
            }
        }
        if (a.cj) {
            a.cj = false;
            if (a.cf._t) {
                b.addClass(this.ac.tabItemProtected);
            }
            else {
                b.removeClass(this.ac.tabItemProtected);
            }
        }
        if (a.cg) {
            a.cg = false;
            var c = "";
            if (WorkbookColorInfo.l_op_Equality(a.cf._h, null)) {
                b.removeClass(this.ac.tabItemLight);
                b.removeClass(this.ac.tabItemDark);
            }
            else {
                var d = a.cf._ak;
                c = d.colorString;
                var e = SpreadsheetUtilities.b2(d);
                var f = 1.05 / (e + 0.05);
                var g = (e + 0.05) / 0.05;
                var h = g > f ? this.ac.tabItemLight : this.ac.tabItemDark;
                b.addClass(h);
            }
            b.setRawStyleProperty("color", c);
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.a0 = function (a) {
        if (a.ch) {
            a.ch = false;
            a.cg.a7.rootWrapper.setText(a.cl != null ? a.cl : "");
            a.cf.a7.rootWrapper.setText(a.ck != null ? a.ck : "");
            var b = a.cj;
            var c = a.ci;
            var d = a.a7.rootWrapper;
            d.setRawStyleProperty("width", "auto");
            d.setRawStyleProperty("height", "auto");
            a.cj = d.getProperty("clientWidth");
            a.ci = d.getProperty("clientHeight");
            if ((b != a.cj || c != a.ci)) {
                a.a3 = a.cj;
                a.av = a.ci;
                if (PointUtil.equals(this.ab.validationInputMessagePosition, null)) {
                    this.ab.scheduleArrange();
                }
            }
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.av = function (a) {
        if (a.cj) {
            a.cj = false;
            var b = a.cg;
            var c = a.ch.columnScrollRegion;
            var d = c._bx;
            var e = b.c;
            var f = a.a3;
            var g = a.av;
            var h = e.b * d;
            var i = e.a * d;
            var j = 1;
            var k = void 0;
            var l = "0% 0%";
            if (b.s && (h > f || i > g)) {
                var m = f / h;
                var n = g / i;
                j = Math.min(m, n);
                k = "scale(" + j + "," + j + ")";
            }
            else {
                k = "none";
            }
            if (j < 1) {
                h *= j;
                i *= j;
            }
            var o = void 0, p = void 0;
            var q = 0;
            switch (b.f) {
                default:
                case 0:
                    o = 0;
                    p = g;
                    break;
                case 2:
                    q = (g - i);
                    o = Math.max(0, i - g);
                    p = Math.max(g, i);
                    break;
                case 3:
                case 4:
                case 1:
                    q = (g / 2 - i / 2);
                    var r = Math.max(0, i / 2 - g / 2);
                    o = r;
                    p = Math.max(g, i - r);
                    break;
            }
            var s = 0;
            var t = h;
            var u = false;
            switch (b.e) {
                case 0:
                case 1: break;
                case 5:
                case 7:
                    t = f;
                    break;
                case 3:
                    s = f - h;
                    break;
                case 2:
                case 6:
                    s = (f / 2 - h / 2);
                    break;
                case 4:
                    u = true;
                    break;
            }
            var v = void 0;
            if (b.i || nullableNotEquals(b.al, null) || nullableNotEquals(b.am, null) || h > f) {
                var w = !nullableIsNull(b.am) ? b.am.value : b.ae;
                var x = !nullableIsNull(b.al) ? b.al.value : b.ad;
                if (w == x && o == 0 && p == g && s == 0) {
                    v = "rect(auto, auto, auto, auto)";
                }
                else {
                    var y = w == b.ab ? 0 : c._bn(w, true) - c._bn(b.ab, true);
                    var z = c._bn(x, false) - c._bn(b.ab, true);
                    var aa = a.ch.rowScrollRegion;
                    p = aa._bn(b.ag, false) - aa._bn(b.ak, true);
                    v = "rect(" + 0 + "px, " + (z * d) + "px, " + ((p * d) - b.v) + "px, " + y * d + "px)";
                }
            }
            else {
                v = "auto";
            }
            var ab = f - h;
            var ac = e.e != a.cv || u != a.ck || (u && (ab != a.cr || q != a.cp));
            a.ck = u;
            a.cr = ab;
            var ad = a.a7.rootWrapper;
            if (ac) {
                ad.setProperty("innerHTML", e.e);
                a.cv = e.e;
            }
            var ae = b.ar.colorString;
            var af = t;
            var ag = i;
            var ah = ac || a.cu != k || a.cp != q || a.co != s || a.ct != ae || a.cq != af || a.cn != ag;
            if (ah) {
                var ai = ad.getChildAt(0);
                if (ac || a.cu != k) {
                    ai.setRawStyleProperty("transform", k);
                    a.cu = k;
                    ai.setRawStyleProperty("transformOrigin", l);
                }
                if (ac || q != a.cp) {
                    a.cp = q;
                    ai.setRawStyleProperty("top", a.cp + "px");
                }
                if (ac || s != a.co) {
                    a.co = s;
                    ai.setRawStyleProperty("left", s + "px");
                }
                if (u && ac) {
                    var aj = h;
                    var ak = f - h;
                    while (ak > h) {
                        var al = ai.clone();
                        al.setRawStyleProperty("left", aj + "px");
                        al.setRawStyleProperty("top", q + "px");
                        ad.append(al);
                        aj += h;
                        ak -= h;
                    }
                }
                if (ac || ae != a.ct) {
                    a.ct = ae;
                    ai.setRawStyleProperty("color", ae);
                }
                if (ac || af != a.cq) {
                    a.cq = af;
                    ai.setRawStyleProperty("width", af + "px");
                }
                if (ac || ag != a.cn) {
                    a.cn = ag;
                    ai.setRawStyleProperty("height", ag + "px");
                }
            }
            if (v != a.cs) {
                a.cs = v;
                ad.setRawStyleProperty("clip", v);
            }
            if (f != a.cm) {
                a.cm = f;
                ad.setRawStyleProperty("width", f + "px");
            }
            if (g != a.cl) {
                a.cl = g;
                ad.setRawStyleProperty("height", g + "px");
            }
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.ax = function (a) {
        if (a.ci) {
            a.ci = false;
            var b = a.cj;
            var c = truncate(Math.ceil(a.a3));
            var d = truncate(Math.ceil(a.av));
            if (c != b.c) {
                a.a7.rootWrapper.setAttribute("width", c);
            }
            if (d != b.a) {
                a.a7.rootWrapper.setAttribute("height", d);
            }
            b.d.clearRect(0, 0, b.c, b.a);
            var e = this.ab._a0.t();
            b.d.drawImage(e, (a.cg - 1) * 16, 0, 16, 16, 0, 0, c, d);
            b.a = d;
            b.c = c;
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.ay = function (a) {
        var e_62, _0;
        var b = a.a7.rootWrapper;
        if (a.ck) {
            a.ck = false;
            var c = void 0;
            if (Rect.l_op_Equality(a.cn, null)) {
                c = "auto";
            }
            else if (a.cn.isEmpty) {
                c = "rect(0px, 0px, 0px, 0px)";
            }
            else {
                var d = a.cn;
                c = "rect(" + (d.top - a.a2) + "px, " + (d.right - a.ax) + "px, " + (d.bottom - a.a2) + "px, " + (d.left - a.ax) + "px)";
            }
            b.setRawStyleProperty("clip", c);
        }
        if (a.cj) {
            a.cj = false;
            var e = "transparent";
            var f = a.cg;
            var g = true;
            if (SpreadsheetUtilities.bc(f)) {
            }
            else if (typeCast(CellFillPattern.$, f) !== null && f.patternStyle == 1) {
                e = f.backgroundColorInfo._getResolvedColor().colorString;
            }
            else if (typeCast(CellFillLinearGradient.$, f) !== null) {
                var h = f;
                var i = SpreadsheetUtilities.cc(h.angle);
                var j = SpreadsheetUtilities.cb(i, a.a3, a.av);
                e = "linear-gradient(" + (180 - MathUtilities.g(j * 180 / Math.PI, 2)) + "deg";
                try {
                    for (var _1 = tslib_1.__values(fromEnum(h.stops)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var k = _2.value;
                        e += ", " + k.colorInfo._color$i.value.colorString + " " + (k.offset * 100) + "%";
                    }
                }
                catch (e_62_1) { e_62 = { error: e_62_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_62) throw e_62.error; }
                }
                e += ")";
            }
            else {
                if (a.cl == null) {
                    var l = a.a7;
                    var m = a.cl = l.createElement("canvas");
                    m.setRawStyleProperty("position", "absolute");
                    l.append(m);
                }
                var n = this.ab._ek;
                var o = truncate(Math.ceil(a.a3 * n));
                var p = truncate(Math.ceil(a.av * n));
                a.cl.setAttribute("width", o);
                a.cl.setAttribute("height", p);
                a.cl.setRawStyleProperty("width", a.a3 + "px");
                a.cl.setRawStyleProperty("height", a.av + "px");
                var q = a.a7.get2DCanvasContext(a.cl);
                if (n != 1) {
                    q.save();
                    q.scale(n, n);
                }
                q.clearRect(0, 0, a.a3, a.av);
                var r = new CanvasSpreadsheetGraphics(q, this.ab._a8._al._j);
                r.fillRectangle3(f, 0, 0, a.a3, a.av);
                if (n != 1) {
                    q.restore();
                }
                g = false;
            }
            if (g && a.cl != null) {
                var s = a.cl;
                a.cl = null;
                s.remove();
            }
            b.setRawStyleProperty("background", e);
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.az = function (a) {
        var b = a.a7.rootWrapper;
        if (a.cw) {
            a.cw = false;
            var c = void 0;
            if (!a.c3) {
                c = "rect(0px, 0px, 0px, 0px)";
            }
            else if (Rect.l_op_Equality(a.de, null)) {
                c = "auto";
            }
            else if (a.de.isEmpty) {
                c = "rect(0px, 0px, 0px, 0px)";
            }
            else {
                var d = a.de;
                c = "rect(" + (d.top - a.a2) + "px, " + (d.right - a.ax) + "px, " + (d.bottom - a.a2) + "px, " + (d.left - a.ax) + "px)";
            }
            b.setRawStyleProperty("clip", c);
        }
        if (a.cv) {
            a.cv = false;
            var e = a.c9 != null ? a.c9 : "";
            if (b.getProperty("value") != e) {
                if (a.c3) {
                    b.setProperty(VisualElementDomBuilder.l, e);
                }
                else {
                    b.setProperty("value", e);
                }
            }
            if (!a.c3) {
                var f = b.getNativeElement();
                var g = f.selectionStart;
                var h = f.selectionEnd;
                if (g != 0 || h != e.length) {
                    SpreadsheetUtilities.bk(f, 0, e.length);
                }
            }
        }
        if (a.c4) {
            a.c4 = false;
            b.setRawStyleProperty("opacity", (a.c3 ? 1 : 0));
            if (!a.c3) {
                b.setRawStyleProperty("clip", "rect(0px, 0px, 0px, 0px)");
                SpreadsheetUtilities.bk(b.getNativeElement(), 0, a.c9 == null ? 0 : a.c9.length);
            }
        }
        if (a.cy) {
            a.cy = false;
            b.setRawStyleProperty("color", a.dc.colorString);
        }
        if (a.cx || a.c2) {
            a.cx = false;
            a.c2 = false;
            SpreadsheetVisualElementDomBuilder.a8(b, a.ci, a.c6);
        }
        if (a.cz) {
            a.cz = false;
            var i = void 0;
            switch (a.cg) {
                case 3:
                    i = "right";
                    break;
                default:
                case 1:
                case 4:
                case 5:
                    i = "left";
                    break;
                case 2:
                case 6:
                case 7:
                    i = "center";
                    break;
            }
            b.setRawStyleProperty("text-align", i);
        }
        if (a.c0) {
            a.c0 = false;
            SpreadsheetVisualElementDomBuilder.a9(b, a.dg);
        }
    };
    SpreadsheetVisualElementDomBuilder.a9 = function (a, b) {
        if (b != null) {
            a.setRawStyleProperty("padding-left", b.c + "px");
            a.setRawStyleProperty("padding-top", b.e + "px");
            a.setRawStyleProperty("padding-right", b.d + "px");
            a.setRawStyleProperty("padding-bottom", b.b + "px");
        }
    };
    SpreadsheetVisualElementDomBuilder.a8 = function (a, b, c) {
        if (b != null) {
            var d = (b.height / 20) * c;
            switch (b.superscriptSubscriptStyle) {
                case 2:
                case 1:
                    d *= 0.66;
                    break;
            }
            a.setRawStyleProperty("font-family", "\"" + b.name + "\", sans-serif");
            a.setRawStyleProperty("font-size", d + "pt");
            a.setRawStyleProperty("font-weight", nullableEquals(b._bold$i, true) ? "bold" : "normal");
            a.setRawStyleProperty("font-style", nullableEquals(b._italic$i, true) ? "italic" : "normal");
            var e = nullableEquals(b._strikeout$i, true);
            var f = "none";
            switch (b.underlineStyle) {
                case 2:
                case 1:
                    if (e) {
                        f = "line-through underline";
                    }
                    else {
                        f = "underline";
                    }
                    break;
                default:
                    if (e) {
                        f = "line-through";
                    }
                    break;
            }
            a.setRawStyleProperty("text-decoration", f);
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.aw = function (a, b) {
        var _this = this;
        if (b === void 0) { b = true; }
        var c = a.cg;
        var d = false;
        if (a.ci) {
            a.ci = false;
        }
        if (c.m == null) {
            if (c.a == null || c.g || c.h) {
                if (b) {
                    c.m = a.cn.queueExpensiveOperation(function () {
                        c.m = null;
                        if (!a.ab) {
                            _this.aw(a, false);
                        }
                    });
                }
                else {
                    d = true;
                    if (c.a == null) {
                        a.cs();
                        var e = a.cn.spreadsheetOwnerState._h;
                        c.a = a.cp._a(c.d, e);
                        c.g = c.h = false;
                    }
                    else {
                        c.q();
                    }
                }
            }
            if (!b && c.a != null && c.a.g != null && a.cq == null) {
                a.cq = VisualElementDomBuilder.d(a.a7, "div", null, true, true);
                var f = a.cq.rootWrapper;
                f.setRawStyleProperty("height", "100%");
                f.setRawStyleProperty("width", "100%");
                var g = a.cq.getWrapper(c.a.g);
                SpreadsheetUtilities.eg(g);
                f.append(g);
                var h = a.cq.createElement("div");
                SpreadsheetUtilities.eg(h);
                f.append(h);
                d = true;
            }
            if (d && a.cq != null) {
                var i = c.d;
                var j = i.chartArea != null && i.chartArea.roundedCorners;
                var k = j ? 12 : 0;
                var l = a.ck;
                var m = SpreadsheetUtilities.aj(i);
                var n = SpreadsheetUtilities.ai(i);
                var o = a.cq.rootWrapper;
                var p = this.ab.workbook;
                var q = o.getChildAt(0);
                q.setRawStyleProperty("margin", l + "px");
                q.setRawStyleProperty("border-radius", k + "px");
                q.setRawStyleProperty("background", SpreadsheetUtilities.c5(m, p));
                var r = o.getChildAt(1);
                SpreadsheetUtilities.d8(r, l, n, k, p);
            }
        }
        var s = c.a == null;
        var t = a.cr != null;
        if (s != t) {
            if (s) {
                a.cr = VisualElementDomBuilder.d(a.a7, "div", null, false, true);
                var u = a.cr.rootWrapper;
                u.setRawStyleProperty("background-color", SpreadsheetRenderCache.ar.colorString);
                u.setRawStyleProperty("background-image", "url('data:image/png;base64," + SpreadsheetRenderCache.ai + "')");
                u.setRawStyleProperty("background-size", "contain");
                u.setRawStyleProperty("background-position", "center");
                u.setRawStyleProperty("background-repeat", "no-repeat");
                u.setRawStyleProperty("-ms-interpolation-mode", "nearest-neighbor");
                u.setRawStyleProperty("image-rendering", "pixelated");
                u.setRawStyleProperty("height", "100%");
                u.setRawStyleProperty("width", "100%");
            }
            else {
                var v = a.cr;
                a.cr = null;
                v.rootWrapper.remove();
            }
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.a2 = function (a) {
        if (a.ci) {
            var b = a.a7.rootWrapper;
            b.setRawStyleProperty("transform", "scale(" + a.ck + ", " + a.ck + ")");
            b.setRawStyleProperty("transform-origin", "0 0");
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.a3 = function (a) {
        if (a.ci) {
            a.ci = false;
            if (a.cn == null) {
                var b = a.a7;
                a.cn = VisualElementDomBuilder.d(a.a7, "div", null, true, false);
            }
            var c = a.cg;
            var d = c.t;
            var e = c.u;
            var f = a.ck;
            var g = new StringBuilder(0);
            g.l("<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" style=\"overflow:visible;width:100%;height:100%;\">");
            var h = ShapeGeometry.t(g, Math.max(e.width, f * 2 + 1), Math.max(e.height, f * 2 + 1), f, f, 1, c.d);
            g.l("</svg>");
            a.cn.rootWrapper.setProperty("innerHTML", g.toString());
            var i = (d.width - e.width) / 2;
            var j = (d.height - e.height) / 2;
            a.cn.rootWrapper.setRawStyleProperty("left", (i - 0) + "px");
            a.cn.rootWrapper.setRawStyleProperty("top", (j - 0) + "px");
            a.cn.rootWrapper.setRawStyleProperty("width", (e.width + f * 2) + "px");
            a.cn.rootWrapper.setRawStyleProperty("height", (e.height + f * 2) + "px");
            var k = "";
            if (c.k % 360 != 0) {
                k += "rotate(" + c.k + "deg) ";
            }
            if (c.f || c.e) {
                k += "scale(" + (c.e ? -1 : 1) + ", " + (c.f ? -1 : 1) + ") ";
            }
            if (k.length == 0) {
                k = "none";
            }
            a.a7.rootWrapper.setRawStyleProperty("transform", c.k % 360 != 0 ? "rotate(" + c.k + "deg)" : "none");
            a.cn.rootWrapper.setRawStyleProperty("transform", c.f || c.e ? "scale(" + (c.e ? -1 : 1) + ", " + (c.f ? -1 : 1) + ")" : "none");
            var l = null;
            if (h.width > 0 && h.height > 0) {
                var m = typeCast(WorksheetShapeWithText.$, c.d);
                if (m != null && m._d0) {
                    var n = "position:absolute;";
                    n += "width:" + h.width + "px;";
                    switch (m.text.verticalAlignment) {
                        default:
                        case 2:
                            n += "top:0;";
                            break;
                        case 0:
                            n += "bottom:0;";
                            break;
                        case 1:
                            n += "top:50%;transform:translateY(-50%);";
                            break;
                    }
                    var o = SpreadsheetUtilities.s(m.text, false);
                    l = JsSpreadsheetRenderCache.a6(o, this.ab.workbook, 1, true, h.width, n);
                }
            }
            if (stringIsNullOrEmpty(l)) {
                if (a.co != null) {
                    a.co.rootWrapper.remove();
                    a.co = null;
                }
            }
            else {
                if (a.co == null) {
                    a.co = VisualElementDomBuilder.d(a.a7, "div", null, true, false);
                }
                if (c.f || c.e) {
                    h = ShapeVisualManager.q(h, new Rect(0, 0, 0, e.width, e.height), c.e, c.f);
                }
                var p = "";
                if (c.f) {
                    p += "scale(-1, -1) ";
                }
                if (p.length == 0) {
                    p = "none";
                }
                var q = a.co.rootWrapper;
                q.setProperty("innerHTML", l);
                q.setRawStyleProperty("transform", p);
                q.setRawStyleProperty("left", (i + h.left) + "px");
                q.setRawStyleProperty("top", (j + h.top) + "px");
                q.setRawStyleProperty("width", h.width + "px");
                q.setRawStyleProperty("height", h.height + "px");
                var r = !SpreadsheetUtilities.a1(c.d.text);
                q.setRawStyleProperty("clip", r ? "rect(auto, auto, auto, auto)" : "auto");
                q.setRawStyleProperty("clip-path", r ? "inset(0 0 0 0)" : "none");
            }
        }
    };
    SpreadsheetVisualElementDomBuilder.a5 = function (a) {
        a.setAttribute("spellcheck", false);
    };
    SpreadsheetVisualElementDomBuilder.a7 = function (a) {
        a.setAttribute("spellcheck", false);
        a.setRawStyleProperty("resize", "none");
        a.setRawStyleProperty("border", "none");
        a.setRawStyleProperty("outline", "none");
        a.setRawStyleProperty("max-width", "none");
        a.setRawStyleProperty("max-height", "none");
        a.setRawStyleProperty("background-color", "transparent");
        a.setRawStyleProperty("box-sizing", "border-box");
        a.setRawStyleProperty("margin", 0);
        a.setRawStyleProperty("padding", 0);
    };
    SpreadsheetVisualElementDomBuilder.prototype.a6 = function (a) {
        var _this = this;
        var b = a.a7.rootWrapper;
        SpreadsheetVisualElementDomBuilder.a7(b);
        b.setAttribute("id", "SpreadsheetInplaceEditor");
        this.at(b);
        b.listen("input", function (c) {
            var d = c.originalEvent;
            var e = d.inputType;
            if (e != null && !_this.ab.isInEditMode && (e == "historyUndo" || e == "historyRedo")) {
                a.cv = true;
                return;
            }
            var f = (c.originalEvent.target);
            var g = f.value;
            a.c9 = g;
            if (!SpreadsheetUtilities.a5(a, document.activeElement)) {
                return;
            }
            _this.ab._ds = true;
            if (!a.c3) {
                if (!_this.ab._d2(g, stringIsNullOrEmpty(g)) || !_this.ab.isInEditMode) {
                    a.cv = true;
                }
            }
            a.da();
        });
    };
    SpreadsheetVisualElementDomBuilder.ba = function (a, b) {
        if (a != null) {
            a.setText(b != null ? b : "");
        }
    };
    SpreadsheetVisualElementDomBuilder.prototype.af = function (a) {
        var b = SpreadsheetUtilities.de(a);
        return b != null && this.ak.b(b);
    };
    SpreadsheetVisualElementDomBuilder.prototype.ag = function (a) {
        return a != null && a.bx == "ComboBox" && a._parent != null && a._parent.bx == "FormulaBarNameBoxContainer";
    };
    SpreadsheetVisualElementDomBuilder.prototype.bc = function (a, b) {
        var c = a.a7.rootWrapper;
        c.setAttribute("title", this.ab._fs(b));
        c.setAttribute("data-localeid", b);
        c.setAttribute("data-localeattr", "title");
    };
    SpreadsheetVisualElementDomBuilder.prototype.ai = function (a) {
        var b = this.ab._m();
        return b != null && this.ah(b.a7.rootWrapper.getNativeElement(), a);
    };
    SpreadsheetVisualElementDomBuilder.prototype.ah = function (a, b) {
        if (a != null) {
            var c = b == null ? "" : b;
            var d = !VisualElementDomBuilder.b && a == document.activeElement && (document.queryCommandSupported('insertText'));
            if (d && c.length > 0 && c.charAt(c.length - 1) == '\n') {
                d = false;
            }
            if (d) {
                document.execCommand('insertText', false, c);
            }
            else {
                var e = a.value;
                var f = a.selectionStart;
                var g = a.selectionEnd;
                var h = (e.substring(0, f)) + c + e.substr(g);
                a[VisualElementDomBuilder.l] = h;
                SpreadsheetUtilities.bk(a, g + c.length, g + c.length);
            }
            return true;
        }
        return false;
    };
    SpreadsheetVisualElementDomBuilder.$t = markType(SpreadsheetVisualElementDomBuilder, 'SpreadsheetVisualElementDomBuilder', VisualElementDomBuilder.$);
    SpreadsheetVisualElementDomBuilder.ae = new PixelConverter();
    return SpreadsheetVisualElementDomBuilder;
}(VisualElementDomBuilder));
export { SpreadsheetVisualElementDomBuilder };
/**
 * @hidden
 */
var JsSpreadsheetRenderCache = /** @class */ (function (_super) {
    tslib_1.__extends(JsSpreadsheetRenderCache, _super);
    function JsSpreadsheetRenderCache(a) {
        var _this = _super.call(this, true) || this;
        _this.au = null;
        _this.a1 = null;
        _this.a3 = null;
        _this.as = null;
        _this.ay = null;
        _this.ax = null;
        _this.aw = null;
        _this.az = null;
        _this.au = a;
        _this.ay = new WorksheetCellFormatData(null, 0);
        _this.ay._dk();
        _this.ax = new ResolvedWorksheetCellFormatDataFont(_this.ay);
        _this.aw = new FormattedStringFontResolved(null, _this.ay);
        _this.az = new LRUCache$2(String_$type, JsSpreadsheetText.$, 0, 250);
        return _this;
    }
    JsSpreadsheetRenderCache.prototype.get_l = function () {
        return this.au.workbook;
    };
    Object.defineProperty(JsSpreadsheetRenderCache.prototype, "l", {
        get: function () {
            return this.get_l();
        },
        enumerable: true,
        configurable: true
    });
    JsSpreadsheetRenderCache.prototype.y = function (a, b, c) {
        var d = this.a5(a, b);
        return this.au._a0.h("font:" + d, d) / b;
    };
    JsSpreadsheetRenderCache.prototype.aa = function (a, b, c) {
        var d = b;
        var e = this.a4();
        e.font = this.a5(a, d);
        var f = e.measureText(c);
        return Math.ceil(f.width / d);
    };
    JsSpreadsheetRenderCache.prototype.z = function (a, b) {
        return this.aa(a._af, a._bx, b);
    };
    JsSpreadsheetRenderCache.prototype.am = function () {
        this.as = null;
        this.az.i();
    };
    JsSpreadsheetRenderCache.prototype.o = function (a) {
        if (this.au._a0 == null) {
            return false;
        }
        if (this.as == null) {
            this.as = this.at();
        }
        return BrushUtilCore.a(this.as[a]);
    };
    JsSpreadsheetRenderCache.prototype.j = function () {
        return Workbook._br(this.au.workbook);
    };
    JsSpreadsheetRenderCache.prototype.ac = function (a, b) {
        var c = this.c(TextMetricsProviderBase.$, true) || this.a(TextMetricsProviderBase.$, true, this.j());
        return c._e(a);
    };
    JsSpreadsheetRenderCache.prototype.g = function (a, b, c, d, e, f, g, h) {
        var e_63, _0;
        var i = a.unformattedString;
        var j = "";
        try {
            for (var _1 = tslib_1.__values(fromEnum(a.getFormattingRuns())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var k = _2.value;
                this.aw._c(k, b);
                var l = i.substr(k.startIndex, k.length);
                if (!e) {
                    l = stringReplace(l, "\r\n", " ");
                }
                j += JsSpreadsheetRenderCache.bb(this.aw, l, g, true, this.l);
            }
        }
        catch (e_63_1) { e_63 = { error: e_63_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_63) throw e_63.error; }
        }
        this.aw._c(null, this.ay);
        this.ax._b(b);
        var m = JsSpreadsheetRenderCache.a7(this.ax, g);
        this.ax._b(this.ay);
        return this.av(c, d, e, j, g, null, i, m);
    };
    JsSpreadsheetRenderCache.prototype.h = function (a, b, c, d, e, f, g, h) {
        if (a != null && a.length > 0 && a.charCodeAt(a.length - 1) == 10) {
            a += " ";
        }
        this.ax._b(b);
        var i = JsSpreadsheetRenderCache.a7(this.ax, g);
        var j = JsSpreadsheetRenderCache.bb(this.ax, a, g, false, this.l);
        var k = this.av(c, d, e, j, g, this.ax, a, i);
        this.ax._b(this.ay);
        return k;
    };
    JsSpreadsheetRenderCache.a9 = function (a, b, c, d, e) {
        if (!stringIsNullOrEmpty(e)) {
            a += "font:" + e + ";";
        }
        switch (b) {
            case 0:
            case 5:
                a += "text-align: left;";
                break;
            case 1:
                a += "text-align: right;";
                break;
            case 2:
                a += "text-align: center;";
                break;
            case 3:
                a += "text-align: justify;";
                break;
            case 4:
                a += "text-align: justify;";
                break;
        }
        if (c) {
            if (!isNaN_(d)) {
                a += "max-width:" + d + "px;";
            }
            a += "overflow-wrap:break-word;word-wrap:break-word;";
            if (b == 3 || b == 4) {
                a += "white-space:pre-line;";
            }
            else {
                a += "white-space:pre-wrap;";
            }
        }
        else {
            a += "white-space:pre;";
        }
        return a;
    };
    JsSpreadsheetRenderCache.prototype.av = function (a, b, c, d, e, f, g, h) {
        a *= e;
        var i = JsSpreadsheetRenderCache.a9("position:absolute;", b, c, a, h);
        var j = "<div style='" + i + "'>" + d + "</div>";
        var k = this.az.item(j);
        if (k != null) {
            return k;
        }
        var l, m;
        if (f != null && !c && g.indexOf('\n') < 0) {
            var n = this.a4();
            var o = JsSpreadsheetRenderCache.a7(f, e);
            n.font = o;
            var p = n.measureText(g);
            l = p.width;
            m = this.au._a0.h(JsSpreadsheetRenderCache.a8(f, e), o);
        }
        else {
            var q = this.au._a0.s;
            var r = q.getStyleProperty("width");
            q.setRawStyleProperty("width", Math.ceil(a) + "px");
            q.setProperty("innerHTML", j);
            var s = q.getChildAt(0);
            var t = s.getNativeElement().getBoundingClientRect();
            l = Math.ceil((t.width));
            m = Math.ceil((t.height));
            q.setProperty("innerHTML", "");
            q.setRawStyleProperty("width", r);
        }
        var u = new JsSpreadsheetText();
        u.e = j;
        u.d = l / e;
        u.c = m / e;
        this.az.item(j, u);
        return u;
    };
    JsSpreadsheetRenderCache.prototype.a5 = function (a, b) {
        if (b === void 0) { b = 1; }
        return "" + (a.height / 20) * b + "pt \"" + a.name + "\", sans-serif";
    };
    JsSpreadsheetRenderCache.a7 = function (a, b) {
        var c = "";
        var d = (a.height / 20) * b;
        switch (a.superscriptSubscriptStyle) {
            case 2:
            case 1:
                d *= 0.66;
                break;
        }
        if (nullableEquals(a._italic$i, true)) {
            c += "italic ";
        }
        if (nullableEquals(a._bold$i, true)) {
            c += "bold ";
        }
        c += d + "pt \"" + a.name + "\", sans-serif";
        return c;
    };
    JsSpreadsheetRenderCache.a8 = function (a, b) {
        var c = "";
        var d = (a.height / 20) * b;
        switch (a.superscriptSubscriptStyle) {
            case 2:
                d *= 0.66;
                c += "vertical-align: sub;";
                break;
            case 1:
                d *= 0.66;
                c += "vertical-align: super;";
                break;
        }
        c += "font-family:\"" + a.name + "\", sans-serif;";
        c += "font-size:" + d + "pt;";
        if (nullableEquals(a._bold$i, true)) {
            c += "font-weight:bold;";
        }
        if (nullableEquals(a._italic$i, true)) {
            c += "font-style:italic;";
        }
        var e = nullableEquals(a._strikeout$i, true);
        switch (a.underlineStyle) {
            case 2:
                if (e) {
                    c += "text-decoration:line-through underline;";
                }
                else {
                    c += "text-decoration:underline;";
                }
                c += "border-bottom: solid " + Math.max(1, MathUtilities.f(b)) + "px;";
                break;
            case 1:
                if (e) {
                    c += "text-decoration:line-through underline;";
                }
                else {
                    c += "text-decoration:underline;";
                }
                break;
            default:
                if (e) {
                    c += "text-decoration:line-through;";
                }
                break;
        }
        return c;
    };
    JsSpreadsheetRenderCache.prototype.a4 = function () {
        if (this.a3 == null) {
            var a = this.au._fa;
            this.a1 = a.getSubRenderer(a.createElement("canvas"));
            this.a3 = this.a1.get2DCanvasContext(this.a1.rootWrapper);
        }
        return this.a3;
    };
    JsSpreadsheetRenderCache.prototype.at = function () {
        var e_64, _0;
        var a = this.au._a0.a;
        var b = this.au.brushes;
        var c = new Array(a.length);
        arrayCopyTo(a, c, 0);
        if (b != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    var e = d.value;
                    if (e == null) {
                        e = JsSpreadsheetRenderCache.bc;
                    }
                    var f = d.key;
                    c[f] = e;
                }
            }
            catch (e_64_1) { e_64 = { error: e_64_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_64) throw e_64.error; }
            }
        }
        return c;
    };
    JsSpreadsheetRenderCache.a6 = function (a, b, c, d, e, f) {
        a.p();
        var g = new StringBuilder(0);
        var h = new IGFormattedTextFont();
        h._a = a.a;
        g.l("<div style='");
        if (!stringIsNullOrEmpty(f)) {
            g.l(f);
        }
        g.l("font:");
        g.l(JsSpreadsheetRenderCache.a7(h, c));
        g.l(";");
        g.l("'>");
        for (var i = 0; i < a.h.count; i++) {
            var j = a.h._inner[i];
            h._a = j.a;
            var k = JsSpreadsheetRenderCache.a7(h, c);
            var l = SpreadsheetUtilities.ad(!nullableIsNull(j.k) ? j.k.value : 4);
            var m = JsSpreadsheetRenderCache.a9("", l, d, e, k);
            g.l("<p style='margin:0;padding:0;");
            g.l(m);
            g.l("'>");
            a.j(j.f, j.e, function (n) {
                var o = a.i.f(n.f, n.e);
                h._a = n.a;
                g.l(JsSpreadsheetRenderCache.bb(h, o, c, true, b));
            });
            if (j.e == 0) {
                g.l(" ");
            }
            g.l("</p>");
        }
        g.l("</div>");
        return g.toString();
    };
    JsSpreadsheetRenderCache.prototype.a2 = function () {
        return this.au._a0.t();
    };
    JsSpreadsheetRenderCache.prototype.ba = function (a) {
        if (this.as == null) {
            this.as = this.at();
        }
        return this.as[a]._fill;
    };
    JsSpreadsheetRenderCache.bb = function (a, b, c, d, e) {
        b = stringReplace(stringReplace(stringReplace(b, "&", "&amp;"), "'", "&apos;"), "\"", "&quot;");
        var f = JsSpreadsheetRenderCache.a8(a, c);
        if (d) {
            var g = a.colorInfo._g(e, false)._color$i.value;
            f += "color:" + g.colorString + ";";
        }
        return "<span style='" + f + "'>" + b + "</span>";
    };
    JsSpreadsheetRenderCache.$t = markType(JsSpreadsheetRenderCache, 'JsSpreadsheetRenderCache', SpreadsheetRenderCache.$);
    JsSpreadsheetRenderCache.bc = Brush.create("rgba(0,0,0,0)");
    return JsSpreadsheetRenderCache;
}(SpreadsheetRenderCache));
export { JsSpreadsheetRenderCache };
/**
 * @hidden
 */
var SpreadsheetUtilities = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetUtilities, _super);
    function SpreadsheetUtilities() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetUtilities.b2 = function (a) {
        var b = 2.2;
        var c = (Math.pow(a.o / 255, b) * 0.2126) + (Math.pow(a.n / 255, b) * 0.7152) + (Math.pow(a.m / 255, b) * 0.0722);
        return c;
    };
    SpreadsheetUtilities.b3 = function (a, b) {
        if (!stringIsNullOrEmpty(a) && a != "auto") {
            if (stringContains(a, "px")) {
                a = stringReplace(a, "px", "");
            }
            var c = parseFloat(a);
            if (!isNaN(c)) {
                return c;
            }
        }
        return b;
    };
    SpreadsheetUtilities.a5 = function (a, b) {
        if (b == null || a == null || a.a7 == null) {
            return false;
        }
        var c = a.a7.rootWrapper.getNativeElement();
        return c.contains(b);
    };
    SpreadsheetUtilities.ch = function (a, b, c, d) {
        var e = a._fa.createElement("canvas");
        e.setProperty("width", c);
        e.setProperty("height", d);
        var f = a._a8._al._j;
        var g = a._fa.get2DCanvasContext(e);
        var h = new CanvasSpreadsheetGraphics(g, f);
        b(h);
        return e;
    };
    SpreadsheetUtilities.cf = function (a, b, c, d) {
        return b == -1 ? null : SpreadsheetUtilities.ch(a, function (e) { return e.drawIcon(b, 0, 0, c, d, 0, 0, c, d); }, c, d);
    };
    SpreadsheetUtilities.ce = function (a, b, c, d, e) {
        if (e === void 0) { e = null; }
        return SpreadsheetUtilities.bc(b) ? null : SpreadsheetUtilities.ch(a, function (f) {
            if (WorkbookColorInfo.l_op_Inequality(e, null)) {
                f.drawRectangle1(6, e, 1, 0.5, 0.5, c - 1, d - 1);
                f.fillRectangle3(b, 1, 1, c - 2, d - 2);
            }
            else {
                f.fillRectangle3(b, 0, 0, c, d);
            }
        }, c, d);
    };
    SpreadsheetUtilities.cg = function (a, b, c, d, e) {
        if (e === void 0) { e = null; }
        return WorkbookColorInfo.l_op_Equality(b, null) ? null : SpreadsheetUtilities.ch(a, function (f) {
            if (WorkbookColorInfo.l_op_Inequality(e, null)) {
                f.drawRectangle1(6, e, 1, 0.5, 0.5, c - 1, d - 1);
                f.fillRectangle5(b, 1, 1, c - 2, d - 2);
            }
            else {
                f.fillRectangle5(b, 0, 0, c, d);
            }
        }, c, d);
    };
    SpreadsheetUtilities.c6 = function (a, b, c) {
        var d = "data:" + a + ";";
        if (c) {
            d += "charset=utf-8;base64,";
            var e = Encoding.uTF8.getBytes1(b);
            d += Convert.toBase64String(e);
        }
        else {
            d += "utf8," + b;
        }
        return d;
    };
    SpreadsheetUtilities.c5 = function (a, b) {
        var e_65, _0;
        if (a == null || typeCast(ChartEmptyFill.$, a) !== null) {
            return "";
        }
        if (typeCast(ChartSolidFill.$, a) !== null) {
            var c = a;
            return SpreadsheetUtilities.e2(c.color, b, false).colorString;
        }
        else if (typeCast(ChartGradientFill.$, a) !== null) {
            var d = a;
            var e = "linear-gradient(" + ((d.angle + 90) % 360) + "deg";
            try {
                for (var _1 = tslib_1.__values(fromEnum(d.getStops())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    e += ", " + SpreadsheetUtilities.e2(f.color, b, false).colorString + " " + (f.position * 100) + "%";
                }
            }
            catch (e_65_1) { e_65 = { error: e_65_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_65) throw e_65.error; }
            }
            e += ")";
            return e;
        }
        return "";
    };
    SpreadsheetUtilities.c4 = function (a, b) {
        if (a == null) {
            return "";
        }
        var c = a.lineStyle;
        if (c == 7) {
            return "";
        }
        var d = SpreadsheetUtilities.c5(a._ap, b);
        if (stringIsNullOrEmpty(d)) {
            return "";
        }
        var e = Workbook._eq(a.widthInPoints);
        e = Math.max(Workbook._er(b, e, false, true), 1);
        return d + " " + e + "px solid";
    };
    SpreadsheetUtilities.c9 = function (a) {
        var b = "";
        var c = a;
        while (c != null) {
            if (b.length > 0) {
                b = "->" + b;
            }
            var d = c;
            var e = (d.className);
            if (!stringIsNullOrEmpty(e)) {
                b = "{" + e + "}" + b;
            }
            var f = (d.id);
            if (!stringIsNullOrEmpty(f)) {
                b = "(" + f + ")" + b;
            }
            b = c.nodeName + b;
            c = (d.parentNode);
        }
        return b;
    };
    SpreadsheetUtilities.bv = function (a) {
        var b = new List$1(DomWrapper_$type, 0);
        var c = a.getChildCount();
        for (var d = 0; d < c; d++) {
            b.add(a.getChildAt(d));
        }
        return b;
    };
    SpreadsheetUtilities.dd = function (a) {
        switch (a) {
            case 148: return "cut";
            case 149: return "copy";
            case 150: return "paste";
            case 86: return "undo";
            case 85: return "redo";
            default: return null;
        }
    };
    SpreadsheetUtilities.de = function (a) {
        switch (a) {
            case 149: return "copy";
            case 148: return "cut";
            case 150: return "paste";
            default: return null;
        }
    };
    SpreadsheetUtilities.d7 = function (a) {
        if (a != null) {
            var b = a;
            if ((b.focus != null)) {
                b.focus();
            }
        }
    };
    SpreadsheetUtilities.c1 = function (a) {
        if (a != null && a.originalEvent != null) {
            a = a.originalEvent;
        }
        return a;
    };
    SpreadsheetUtilities.d8 = function (a, b, c, d, e) {
        var f = b == 0 || c == null ? 7 : c.lineStyle;
        var g = SpreadsheetUtilities.d(f);
        var h = f == 0 ? SpreadsheetUtilities.c4(c, e) : "";
        var i = f == 0 ? d + "px" : "";
        a.setRawStyleProperty("border", h);
        a.setRawStyleProperty("border-radius", i);
        if (a.getChildCount() > 0) {
            a.removeChildren();
        }
        if (g == null) {
            a.setRawStyleProperty("margin", "0px");
        }
        else {
            a.setRawStyleProperty("margin", b + "px");
            var j = Workbook._eq(c.widthInPoints);
            j = Math.max(Workbook._er(e, j, false, true), 1);
            var k = new StringBuilder(0);
            var l = "<svg xmlns=\"http://www.w3.org/2000/svg\" style=\"overflow:visible\" width='100%' height='100%'>" + "<rect width='100%' height='100%' fill='none' stroke='" + SpreadsheetUtilities.c5(c._ap, e) + "' stroke-width='" + j + "px' stroke-dasharray='";
            for (var m = 0; m < g.length; m++) {
                l += (j * g[m]) + " ";
            }
            l += "' rx='" + d + "' ry='" + d + "'></path></svg>";
            a.setProperty("innerHTML", l);
        }
    };
    SpreadsheetUtilities.eg = function (a) {
        a.setRawStyleProperty("left", "0");
        a.setRawStyleProperty("top", "0");
        a.setRawStyleProperty("right", "0");
        a.setRawStyleProperty("bottom", "0");
        a.setRawStyleProperty("position", "absolute");
    };
    SpreadsheetUtilities.bf = function (a) {
        switch (a) {
            case 21:
            case 18:
            case 19:
            case 23:
            case 22:
            case 20:
            case 24: return true;
            default: return false;
        }
    };
    SpreadsheetUtilities.bg = function (a) {
        switch (a) {
            case 26:
            case 25:
            case 27:
            case 28: return true;
            default: return false;
        }
    };
    SpreadsheetUtilities.bi = function (a) {
        if (a == null) {
            return false;
        }
        return SpreadsheetUtilities.bh(a.getNativeElement());
    };
    SpreadsheetUtilities.bh = function (a) {
        if (a == null) {
            return false;
        }
        if (a.offsetWidth > 0 || a.offsetHeight > 0) {
            return true;
        }
        return (a.getClientRects().length > 0);
    };
    SpreadsheetUtilities.bj = function (a, b) {
        return SpreadsheetUtilities.cd != null && (SpreadsheetUtilities.cd.call(a, b));
    };
    SpreadsheetUtilities.ez = function (a) {
        var b = a.originalEvent;
        if ((b.stopPropagation)) {
            b.stopPropagation();
        }
    };
    SpreadsheetUtilities.b7 = function (a, b, c) {
        return Math.abs(b / 2 * Math.sin(a)) + Math.abs(c / 2 * Math.cos(a));
    };
    SpreadsheetUtilities.bk = function (a, b, c) {
        var d = document.activeElement;
        var e;
        try {
            var f = a;
            f.setSelectionRange(b, c);
            e = true;
        }
        catch (g) {
            e = false;
        }
        if (d != document.activeElement && d != null) {
            try {
                SpreadsheetUtilities.d7(d);
            }
            catch (h) {
            }
        }
        return e;
    };
    SpreadsheetUtilities.cb = function (a, b, c) {
        var d = Math.max(b, c);
        var e = Math.sin(a) * d;
        var f = Math.cos(a) * d;
        var g = b / d;
        var h = c / d;
        return Math.atan2(f * h, e * g);
    };
    SpreadsheetUtilities.d6 = function (a, b, c) {
        a.addListener(b, c);
    };
    SpreadsheetUtilities.ci = function (a, b, c, d, e) {
        if (d > b) {
            var f = new IGFormattedTextRun();
            f.f = b;
            f.e = d - b;
            a.h.add(f);
        }
        var g = new IGFormattedTextRun();
        g.f = d;
        g.e = e;
        SpreadsheetUtilities.d9(g.a, c);
        a.h.add(g);
        b = d + e;
        return b;
    };
    SpreadsheetUtilities.c2 = function (a) {
        a = SpreadsheetUtilities.du.g(a, "");
        a = stringReplace(stringReplace(stringReplace(a, "__", "ZZQQQ"), "_", ""), "ZZQQQ", "_");
        return a;
    };
    SpreadsheetUtilities.c3 = function (a, b) {
        b = stringEmpty();
        a = SpreadsheetUtilities.du.g(a, "");
        var c = "";
        a = stringReplace(a, "__", "ZZQQQ");
        var d = a.indexOf("_");
        var e = d + 1;
        if (e < a.length) {
            b = a.charAt(e).toString();
        }
        a = stringReplace(stringReplace(a, "_", c), "ZZQQQ", "_");
        return {
            ret: a,
            p1: b
        };
    };
    SpreadsheetUtilities.a1 = function (a) {
        var b = false;
        if (a != null && typeCast(CT_TextBodyProperties.$, a._o) !== null) {
            var c = a._o.q;
            if (nullableEquals(c, null) || c.value == 0) {
                b = true;
            }
        }
        return b;
    };
    SpreadsheetUtilities.a2 = function (a) {
        if (stringIsNullOrEmpty(a)) {
            return false;
        }
        for (var b = 0, c = a.length; b < c; b++) {
            if ('#' != a.charAt(b)) {
                return false;
            }
        }
        return true;
    };
    SpreadsheetUtilities.a3 = function (a) {
        var e_66, _0;
        if (a != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(a._worksheets$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var b = _2.value;
                    var c = b.displayOptions;
                    if (!b._w && c.visibility == 0) {
                        return false;
                    }
                }
            }
            catch (e_66_1) { e_66 = { error: e_66_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_66) throw e_66.error; }
            }
        }
        return true;
    };
    SpreadsheetUtilities.j = function (a) {
        var b = 1;
        var c = new List$1(CellContentType_$type, 1, a.keys);
        c.aa(function (d, e) { return Base.compareSimple(a.item(e), a.item(d)); });
        var d = a.item(c._inner[0]);
        if (d == 0) {
            b = 1;
        }
        else {
            var e = new List$1(CellContentType_$type, 0);
            for (var f = 0; f < c.count; f++) {
                var g = c._inner[f];
                if (a.item(g) == d) {
                    e.add(g);
                }
            }
            e.aa(function (h, i) { return Base.compareSimple((SpreadsheetUtilities.co(h)), SpreadsheetUtilities.co(i)); });
            b = e._inner[0];
        }
        return b;
    };
    SpreadsheetUtilities.a4 = function (a, b) {
        if (b === void 0) { b = false; }
        if (typeCast(WorksheetChart.$, a) !== null) {
            return b;
        }
        if (typeCast(WorksheetImage.$, a) !== null) {
            return true;
        }
        if (typeCast(WorksheetShapeGroup.$, a) !== null) {
            return true;
        }
        if (nullableNotEquals(a._b1, null)) {
            return PredefinedShapes.b.d(EnumUtil.getName(ST_ShapeType_$type, a._b1.value)) != null;
        }
        if (typeCast(UnknownShape.$, a) !== null) {
            return a._en != null;
        }
        return false;
    };
    SpreadsheetUtilities.cj = function (a, b) {
        var c = SpreadsheetUtilities.bw;
        var d = c.f(a);
        var e = a;
        if (d < 0) {
            d = ~d;
            if (d == 0) {
                e = b ? c._inner[0] : a;
            }
            else if (d == c.count) {
                e = b ? a : c._inner[d - 1];
            }
            else if (b) {
                e = c._inner[d];
            }
            else {
                e = c._inner[d - 1];
            }
        }
        else if (!b && d > 0) {
            e = c._inner[d - 1];
        }
        else if (b && d < c.count - 1) {
            e = c._inner[d + 1];
        }
        return e;
    };
    SpreadsheetUtilities.a6 = function (a, b) {
        for (var c = 0; c < a.count; c++) {
            if (a.item(c)._c(b)) {
                return true;
            }
        }
        return false;
    };
    SpreadsheetUtilities.a7 = function (a, b, c) {
        return !stringIsNullOrEmpty(c) && b.toLowerCase().indexOf(c.toLowerCase()) >= 0;
    };
    SpreadsheetUtilities.ck = function (a) {
        return truncate(MathUtilities.f(a)) * 15;
    };
    SpreadsheetUtilities.b5 = function (a) {
        return a / 15;
    };
    SpreadsheetUtilities.b4 = function (a) {
        return a / 15;
    };
    SpreadsheetUtilities.e4 = function (a) {
        return new Rect(0, a.x, a.y, a.width, a.height);
    };
    SpreadsheetUtilities.br = function () {
        var a = new Dictionary$2(Number_$type, ExcelCellFormatCategory_$type, 0);
        a.item(0, 0);
        a.item(49, 9);
        var d = [1, 2, 3, 4, 37, 38, 39, 40];
        for (var c = 0; c < d.length; c++) {
            var b = d[c];
            a.item(b, 1);
        }
        var g = [5, 6, 7, 8];
        for (var f = 0; f < g.length; f++) {
            var e = g[f];
            a.item(e, 2);
        }
        var j = [41, 42, 43, 44];
        for (var i = 0; i < j.length; i++) {
            var h = j[i];
            a.item(h, 3);
        }
        var m = [9, 10];
        for (var l = 0; l < m.length; l++) {
            var k = m[l];
            a.item(k, 6);
        }
        var p = [11, 48];
        for (var o = 0; o < p.length; o++) {
            var n = p[o];
            a.item(n, 8);
        }
        var s = [12, 13];
        for (var r = 0; r < s.length; r++) {
            var q = s[r];
            a.item(q, 7);
        }
        var v = [18, 19, 20, 21, 45, 46, 47];
        for (var u = 0; u < v.length; u++) {
            var t = v[u];
            a.item(t, 5);
        }
        var y = [14, 15, 16, 17, 22];
        for (var x = 0; x < y.length; x++) {
            var w = y[x];
            a.item(w, 4);
        }
        return a;
    };
    SpreadsheetUtilities.b = function () {
        var a = new Array(14);
        a[0] = 0;
        a[7] = 1;
        a[11] = 2;
        a[9] = 3;
        a[4] = 4;
        a[3] = 5;
        a[1] = 6;
        a[12] = 7;
        a[13] = 8;
        a[10] = 9;
        a[8] = 10;
        a[2] = 11;
        a[5] = 12;
        a[6] = 13;
        return a;
    };
    SpreadsheetUtilities.bs = function () {
        var e_67, _0;
        var a = new Dictionary$2(FillPatternStyle_$type, Array_$type, 0);
        try {
            for (var _1 = tslib_1.__values(EnumUtil.getValues(FillPatternStyle_$type)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = null;
                switch (b) {
                    case 3:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 1, 1, 0]);
                            $ret.push([1, 0, 1, 1]);
                            return $ret;
                        })());
                        break;
                    case 2:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 0]);
                            $ret.push([0, 1]);
                            return $ret;
                        })());
                        break;
                    case 4:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 0, 0, 0]);
                            $ret.push([0, 0, 1, 0]);
                            return $ret;
                        })());
                        break;
                    case 17:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 0, 0, 0]);
                            $ret.push([0, 0, 0, 0]);
                            $ret.push([0, 0, 1, 0]);
                            $ret.push([0, 0, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 18:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 0, 0, 0, 0, 0, 0, 0]);
                            $ret.push([0, 0, 0, 0, 0, 0, 0, 0]);
                            $ret.push([0, 0, 0, 0, 1, 0, 0, 0]);
                            $ret.push([0, 0, 0, 0, 0, 0, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 6:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 1, 1, 0]);
                            return $ret;
                        })());
                        break;
                    case 5:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1]);
                            $ret.push([0]);
                            $ret.push([0]);
                            $ret.push([1]);
                            return $ret;
                        })());
                        break;
                    case 7:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 1, 1]);
                            $ret.push([1, 0, 0, 1]);
                            $ret.push([1, 1, 0, 0]);
                            $ret.push([0, 1, 1, 0]);
                            return $ret;
                        })());
                        break;
                    case 8:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 1, 1]);
                            $ret.push([0, 1, 1, 0]);
                            $ret.push([1, 1, 0, 0]);
                            $ret.push([1, 0, 0, 1]);
                            return $ret;
                        })());
                        break;
                    case 9:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 1, 1]);
                            $ret.push([0, 0, 1, 1]);
                            $ret.push([1, 1, 0, 0]);
                            $ret.push([1, 1, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 10:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 1, 1]);
                            $ret.push([1, 1, 1, 1]);
                            $ret.push([1, 1, 0, 0]);
                            $ret.push([1, 1, 1, 1]);
                            return $ret;
                        })());
                        break;
                    case 11:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0]);
                            $ret.push([0]);
                            $ret.push([0]);
                            $ret.push([1]);
                            return $ret;
                        })());
                        break;
                    case 12:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 1, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 13:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 1, 0]);
                            $ret.push([0, 0, 0, 1]);
                            $ret.push([1, 0, 0, 0]);
                            $ret.push([0, 1, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 14:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 0, 0, 1]);
                            $ret.push([0, 0, 1, 0]);
                            $ret.push([0, 1, 0, 0]);
                            $ret.push([1, 0, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case 15:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([0, 1, 0, 0]);
                            $ret.push([0, 1, 0, 0]);
                            $ret.push([0, 1, 0, 0]);
                            $ret.push([1, 1, 1, 1]);
                            return $ret;
                        })());
                        break;
                    case 16:
                        c = ((function () {
                            var $ret = new Array();
                            $ret.push([1, 0, 1, 0]);
                            $ret.push([0, 0, 0, 1]);
                            $ret.push([1, 0, 1, 0]);
                            $ret.push([0, 1, 0, 0]);
                            return $ret;
                        })());
                        break;
                    case -1:
                    case 1:
                    case 0: break;
                    default: break;
                }
                a.item(b, c);
            }
        }
        catch (e_67_1) { e_67 = { error: e_67_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_67) throw e_67.error; }
        }
        return a;
    };
    SpreadsheetUtilities.c = function (a) {
        switch (a) {
            case 1: return [1, 1];
            case 2: return [9, 3, 3, 3, 3, 3];
            case 3: return [9, 3, 3, 3];
            case 4: return [2, 2];
            case 5: return [3, 1];
            case 7: return [3, 3, 9, 3, 3, 3];
            case 9: return [5, 1, 11, 1];
            case 8: return [4, 2, 10, 2];
            case 10: return [5, 1, 2, 1];
            case 11: return [3, 3, 9, 3];
            case 12: return [9, 3];
            case 13:
            case 14:
            case 6:
            case 0: return null;
            default: return null;
        }
    };
    SpreadsheetUtilities.d = function (a) {
        switch (a) {
            case 1: return [4, 3];
            case 2: return [4, 3, 1, 3];
            case 3: return [1, 3];
            case 4: return [8, 3];
            case 5: return [8, 3, 1, 3];
            case 6: return [8, 3, 1, 3, 1, 3];
            case 8: return [3, 1];
            case 9: return [3, 1, 1, 1];
            case 10: return [3, 1, 1, 1, 1, 1];
            case 11: return [1, 1];
            case 7:
            case 0: return null;
            default: return null;
        }
    };
    SpreadsheetUtilities.bt = function () {
        var a = new Dictionary$2(String_$type, Color.$, 2, StringComparer.e);
        a.item("black", Colors.a);
        a.item("green", Color.u(255, 0, 255, 0));
        a.item("white", Colors.t);
        a.item("blue", Colors.b);
        a.item("magenta", Colors.k);
        a.item("yellow", Colors.u);
        a.item("cyan", Colors.d);
        a.item("red", Colors.o);
        return a;
    };
    SpreadsheetUtilities.bu = function () {
        var a = new Dictionary$2(Color.$, String_$type, 0);
        a.item(Color.u(255, 0, 0, 0), "Black");
        a.item(Color.u(255, 255, 255, 255), "White");
        a.item(Color.u(255, 255, 0, 0), "Red");
        a.item(Color.u(255, 0, 255, 0), "Bright Green");
        a.item(Color.u(255, 0, 0, 255), "Blue");
        a.item(Color.u(255, 255, 255, 0), "Yellow");
        a.item(Color.u(255, 255, 0, 255), "Pink");
        a.item(Color.u(255, 0, 255, 255), "Turquoise");
        a.item(Color.u(255, 128, 0, 0), "Dark Red");
        a.item(Color.u(255, 0, 128, 0), "Green");
        a.item(Color.u(255, 0, 0, 128), "Dark Blue");
        a.item(Color.u(255, 128, 128, 0), "Dark Yellow");
        a.item(Color.u(255, 128, 0, 128), "Violet");
        a.item(Color.u(255, 0, 128, 128), "Teal");
        a.item(Color.u(255, 192, 192, 192), "Gray-25%");
        a.item(Color.u(255, 128, 128, 128), "Gray-50%");
        a.item(Color.u(255, 153, 153, 255), "Periwinkle");
        a.item(Color.u(255, 153, 51, 102), "Plum");
        a.item(Color.u(255, 255, 255, 204), "Ivory");
        a.item(Color.u(255, 204, 255, 255), "Light Turquoise");
        a.item(Color.u(255, 102, 0, 102), "Dark Purple");
        a.item(Color.u(255, 255, 128, 128), "Coral");
        a.item(Color.u(255, 0, 102, 204), "Ocean Blue");
        a.item(Color.u(255, 204, 204, 255), "Ice Blue");
        a.item(Color.u(255, 0, 204, 255), "Sky Blue");
        a.item(Color.u(255, 204, 255, 204), "Light Green");
        a.item(Color.u(255, 255, 255, 153), "Light Yellow");
        a.item(Color.u(255, 153, 204, 255), "Pale Blue");
        a.item(Color.u(255, 255, 153, 204), "Rose");
        a.item(Color.u(255, 204, 153, 255), "Lavender");
        a.item(Color.u(255, 255, 204, 153), "Tan");
        a.item(Color.u(255, 51, 102, 255), "Light Blue");
        a.item(Color.u(255, 51, 204, 204), "Aqua");
        a.item(Color.u(255, 153, 204, 0), "Lime");
        a.item(Color.u(255, 255, 204, 0), "Gold");
        a.item(Color.u(255, 255, 153, 0), "Light Orange");
        a.item(Color.u(255, 255, 102, 0), "Orange");
        a.item(Color.u(255, 102, 102, 153), "Blue-Gray");
        a.item(Color.u(255, 150, 150, 150), "Gray-40%");
        a.item(Color.u(255, 0, 51, 102), "Dark Teal");
        a.item(Color.u(255, 51, 153, 102), "Sea Green");
        a.item(Color.u(255, 0, 51, 0), "Dark Green");
        a.item(Color.u(255, 51, 51, 0), "Olive Green");
        a.item(Color.u(255, 153, 51, 0), "Brown");
        a.item(Color.u(255, 51, 51, 153), "Indigo");
        a.item(Color.u(255, 51, 51, 51), "Gray-80%");
        return a;
    };
    SpreadsheetUtilities.dc = function (a) {
        if (SpreadsheetUtilities.bp == null) {
            SpreadsheetUtilities.bp = SpreadsheetUtilities.bu();
        }
        var b;
        if (!((function () { var c = SpreadsheetUtilities.bp.tryGetValue(a, b); b = c.p1; return c.ret; })())) {
            return null;
        }
        return b;
    };
    SpreadsheetUtilities.s = function (a, b) {
        var e_68, _0;
        var c = a._getFont(0);
        var d = a._workbook;
        var e = d._styles$i.normalStyle.styleFormat.font;
        var f = SpreadsheetUtilities.v(null, new ResolvedWorkbookFont(c, e, d), d, b);
        var g = 0;
        var h = 0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._paragraphs$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var i = _2.value;
                var j = new IGFormattedTextParagraph();
                j.k = Nullable$1.toNullable(HorizontalTextAlignment_$type, i.alignment);
                j.f = f.i.c;
                f.i.l(i.unformattedString);
                j.e = f.i.c - j.f;
                f.h.add(j);
                var k = i._getFormattingRuns(d);
                for (var l = 0; l < k.count; l++) {
                    var m = k._inner[l];
                    var n = l == k.count - 1 ? (j.f + j.e) : k._inner[l + 1].i - h;
                    g = SpreadsheetUtilities.ci(j, g, m.d(d), m.i - h, n - (m.i - h));
                }
                h += i._n - j.e;
                g = SpreadsheetUtilities.cx(j, g);
            }
        }
        catch (e_68_1) { e_68 = { error: e_68_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_68) throw e_68.error; }
        }
        f.e = f.i.c;
        return f;
    };
    SpreadsheetUtilities.r = function (a, b, c, d) {
        var e = new FormattedStringFontResolved(a._getFont(0), c);
        return SpreadsheetUtilities.q(a, b, e, d);
    };
    SpreadsheetUtilities.q = function (a, b, c, d) {
        var e_69, _0;
        var e = c;
        var f = SpreadsheetUtilities.v(a.unformattedString, e, a._workbook, d);
        var g = new IGFormattedTextParagraph();
        g.k = Nullable$1.toNullable(HorizontalTextAlignment_$type, SpreadsheetUtilities.ar(b));
        g.e = a._t;
        f.h.add(g);
        var h = 0;
        var i = a._owner != null && a._owner.allowDefaultValues ? new ResolvedWorkbookFont(null, c, a._workbook) : null;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a.getFormattingRuns())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var j = _2.value;
                var k = j;
                if (i != null) {
                    i._d(k);
                    k = i;
                }
                h = SpreadsheetUtilities.ci(g, h, k, j.startIndex, j.length);
            }
        }
        catch (e_69_1) { e_69 = { error: e_69_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_69) throw e_69.error; }
        }
        h = SpreadsheetUtilities.cx(g, h);
        return f;
    };
    SpreadsheetUtilities.u = function (a, b, c, d, e) {
        var f = new ResolvedWorksheetCellFormatDataFont(d);
        return SpreadsheetUtilities.t(a, b, c, f, e);
    };
    SpreadsheetUtilities.t = function (a, b, c, d, e) {
        if (a == null) {
            a = stringEmpty();
        }
        var f = SpreadsheetUtilities.v(a, d, b, e);
        var g = new IGFormattedTextParagraph();
        g.k = Nullable$1.toNullable(HorizontalTextAlignment_$type, SpreadsheetUtilities.ar(c));
        g.e = f.e;
        f.h.add(g);
        var h = new IGFormattedTextRun();
        h.e = f.e;
        h.a._aa(f.a);
        g.h.add(h);
        return f;
    };
    SpreadsheetUtilities.v = function (a, b, c, d) {
        if (a == null) {
            a = stringEmpty();
        }
        var e = new IGFormattedTextDocument();
        e.i.l(a);
        e.e = a.length;
        SpreadsheetUtilities.d9(e.a, b);
        if (d && c != null) {
            SpreadsheetUtilities.ed(c, e, 8, 9);
        }
        return e;
    };
    SpreadsheetUtilities.e3 = function (a, b) {
        return { $type: Point_$type, x: a, y: b };
    };
    Object.defineProperty(SpreadsheetUtilities, "cl", {
        get: function () {
            return 500;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetUtilities.n = function (a) {
        switch (a) {
            case 1: return 0;
            case 0: return 1;
            case 2: return 3;
            case 3: return 2;
            default: return a;
        }
    };
    SpreadsheetUtilities.c7 = function (a, b, c) {
        var d = ExcelCalcValue._dateTimeToExcelDate(c, b);
        var e = null;
        if (d.hasValue) {
            var f = a.v(d.value, "", e);
            e = f.p2;
        }
        return e;
    };
    SpreadsheetUtilities.c8 = function (a, b) {
        var c = dateFromValues(2000, 1, 1, b ? 0 : 12, 0, 0, 0);
        return dateToStringFormat(c, "tt", a);
    };
    SpreadsheetUtilities.bm = function (a, b) {
        if (a == -1) {
            a = 0;
        }
        else if (a >= SpreadsheetUtilities.a.length) {
            a = 1;
        }
        if (b == -1) {
            b = 0;
        }
        else if (b >= SpreadsheetUtilities.a.length) {
            b = 1;
        }
        var c = SpreadsheetUtilities.a[a];
        var d = SpreadsheetUtilities.a[b];
        return d > c;
    };
    SpreadsheetUtilities.cm = function (a) {
        switch (a) {
            case 6:
            case 5: return 3;
            case 2:
            case 10:
            case 12:
            case 8:
            case 13: return 2;
            case 0: return 0;
            default: return 1;
        }
    };
    SpreadsheetUtilities.cn = function (a) {
        if (a == -1) {
            a = 0;
        }
        else if (a >= SpreadsheetUtilities.a.length) {
            a = 1;
        }
        return SpreadsheetUtilities.a[a];
    };
    SpreadsheetUtilities.p = function (a) {
        var b;
        if (!((function () { var c = SpreadsheetUtilities.bn.tryGetValue(a, b); b = c.p1; return c.ret; })())) {
            b = 10;
        }
        return b;
    };
    SpreadsheetUtilities.aa = function (a) {
        var b;
        if (a.cellRanges.count > 1) {
            b = 2;
        }
        if (a._bj.count > 0) {
            b = 1;
        }
        else if (a._bi.count > 0) {
            b = 0;
        }
        else {
            b = 2;
        }
        if (b == 2) {
            var c = a._m.activeTable;
            if (c != null) {
                b = 7;
            }
        }
        return b;
    };
    SpreadsheetUtilities.k = function (a, b, c) {
        var d = a._getCellValue1(b);
        var e = new GetCellTextParameters(b);
        e.b = 1;
        var f = a._av(e);
        c = f.g;
        if (typeCast(Boolean_$type, d) !== null || typeCast(ErrorValue.$, d) !== null || d == null) {
            return {
                ret: 0,
                p2: c
            };
        }
        if (ExcelUtils.ba(d) || typeCast(Date_$type, d) !== null) {
            if (f.c && (f.b & 1) != 0) {
                return {
                    ret: 2,
                    p2: c
                };
            }
            else {
                return {
                    ret: 3,
                    p2: c
                };
            }
        }
        else {
            return {
                ret: 1,
                p2: c
            };
        }
    };
    SpreadsheetUtilities.co = function (a) {
        switch (a) {
            case 1: return 3;
            case 3: return 2;
            case 2: return 1;
            case 0: return 0;
            default: return 0;
        }
    };
    SpreadsheetUtilities.da = function (a, b, c) {
        var d = null;
        switch (b) {
            case 93:
                d = "Undo_InsertCells";
                break;
            case 95:
                d = "Undo_InsertColumns";
                break;
            case 97:
                d = "Undo_InsertRows";
                break;
            case 94:
            case 96:
            case 98:
                d = "Undo_Delete";
                break;
            case 28:
                d = "Undo_ConditionalFormat";
                break;
            case 4:
            case 61:
            case 85:
                d = "Undo_FormatCells";
                break;
            case 18:
            case 50:
            case 51:
                d = "Undo_MergeCells";
                break;
            case 16:
            case 47:
            case 48:
            case 49:
                d = "Undo_Hyperlink";
                break;
            case 99:
                d = "Undo_Zoom";
                break;
            case 53:
            case 54:
            case 17:
                d = "Undo_CreateNamedReference";
                break;
            case 62:
                d = "Undo_Shape";
                break;
            case 63:
                d = "Undo_ShapeAdd";
                break;
            case 64:
                d = "Undo_ShapeRemove";
                break;
            case 21:
                d = "Undo_ClearShapes";
                break;
            case 6:
                d = "Undo_ChartAdd";
                break;
            case 7:
                d = "Undo_ChartModify";
                break;
            case 8:
                d = "Undo_ChartRemove";
                break;
            case 66:
                d = "Undo_SparklineAdd";
                break;
            case 68:
                d = "Undo_SparklineColorChange";
                break;
            case 69:
                d = "Undo_SparklineDataChange";
                break;
            case 67:
                d = "Undo_SparklineRemove";
                break;
            case 70:
                d = "Undo_SparklineStyleChange";
                break;
            case 71:
                d = "Undo_SparklineTypeChange";
                break;
            case 73:
                d = "Undo_CreateTable";
                break;
            case 84:
                d = "Undo_RemoveTable";
                break;
            case 25:
                d = "Undo_ClearTables";
                break;
            case 35:
                {
                    switch (c) {
                        case "Reset":
                            d = "Undo_ResetOptions";
                            break;
                        case "TabColorInfo":
                            d = "Undo_TabColor";
                            break;
                        case "View":
                            d = "Undo_View";
                            break;
                    }
                    break;
                }
            case 1:
            case 38:
            case 39:
            case 40:
            case 15:
                d = "Undo_Filter";
                break;
            case 80:
            case 2:
            case 22:
                d = "Undo_Sort";
                break;
            case 24:
            case 81:
            case 82:
            case 83:
                d = "Undo_Style";
                break;
            case 26:
                {
                    switch (c) {
                        case "Width":
                        case "Hidden":
                            d = "Undo_ResizeColumn";
                            break;
                        case "OutlineLevel":
                            d = "Undo_Group";
                            break;
                    }
                    break;
                }
            case 60:
                {
                    switch (c) {
                        case "Height":
                        case "Hidden":
                            d = "Undo_ResizeRow";
                            break;
                        case "OutlineLevel":
                            d = "Undo_Group";
                            break;
                    }
                    break;
                }
            case 65:
                {
                    switch (c) {
                        case "TabColorInfo":
                            d = "Undo_TabColor";
                            break;
                    }
                    break;
                }
            case 90:
                {
                    switch (c) {
                        case "ResizeColumns":
                            d = "Undo_ResizeColumn";
                            break;
                        case "ResizeRows":
                            d = "Undo_ResizeRow";
                            break;
                    }
                    break;
                }
        }
        if (d == null) {
            return EnumUtil.getName(ExcelChangeAction_$type, b);
        }
        return SpreadsheetUtilities.di(a, d);
    };
    SpreadsheetUtilities.db = function (a, b) {
        var c = a._fs("MenuItem_ClearFilterEmpty");
        if (a._a8 != null) {
            var d = a._a8._fp(b);
            if (!stringIsNullOrEmpty(d)) {
                c = a._fs("MenuItem_ClearFilterForColumn", d);
            }
        }
        return c;
    };
    SpreadsheetUtilities.cp = function (a) {
        var b = a.numberFormat.currencySymbol;
        if (stringIsNullOrEmpty(b)) {
            return 0;
        }
        var c = (111.11.toLocaleString(a.name, { style: 'currency', currency: 'USD', currencyDisplay: 'symbol' }));
        var d = c.indexOf(b);
        var e = c.indexOf("1");
        if (d < 0 || e < 0) {
            return 0;
        }
        if (d < e) {
            return /\s/i.test(c.charAt(d + b.length)) ? 2 : 0;
        }
        else {
            return /\s/i.test(c.charAt(d - 1)) ? 3 : 1;
        }
    };
    SpreadsheetUtilities.df = function (a, b, c) {
        var d = stringEmpty();
        var e = b.workbook;
        if (a == null) {
        }
        else if (typeof a === 'string') {
            d = a;
        }
        else if (typeCast(Formula.$, a) !== null) {
            d = a._toString1(e.cellReferenceMode);
        }
        else if (typeCast(ErrorValue.$, a) !== null) {
            d = a.toString();
        }
        else if (typeCast(Boolean_$type, a) !== null) {
            d = a ? "TRUE" : "FALSE";
        }
        else if (typeCast(FormattedString.$, a) !== null) {
            d = a.unformattedString;
        }
        else if (a != null) {
            var f_6;
            if (((function () { var g = ExcelUtils.b0(e, a, f_6); f_6 = g.p2; return g.ret; })())) {
                var g = e._b2.a(c._cs);
                if (g.o) {
                    var h = -1;
                    h = g.aa(f_6);
                    if (h >= 0) {
                        var i = g.c(h);
                        var j = Nullable$1.toNullable(Date_$type, null);
                        var k = Nullable$1.toNullable(Number_$type, null);
                        if (i.isDateSection && f_6 >= 0) {
                            if (i.hasAnyDateParts) {
                                j = ExcelCalcValue._be(e, f_6, true, true);
                            }
                            else if (i.hasAnyTimeParts) {
                                var l = ExcelCalcValue._be(e, f_6, true, true);
                                if (nullableNotEquals(l, null)) {
                                    k = Nullable$1.toNullable(Number_$type, ExcelCalcValue._bq(f_6, true));
                                    if (nullableNotEquals(k, null) && timeSpanTotalDays(k.value) >= 1) {
                                        j = l;
                                    }
                                }
                            }
                        }
                        if (nullableNotEquals(j, null)) {
                            if (i.hasAnyTimeParts || dateGetTimeOfDay(j.value) != (0)) {
                                d = SpreadsheetUtilities.dn(j.value, b);
                            }
                            else {
                                d = SpreadsheetUtilities.dt(j.value, b);
                            }
                        }
                        else if (nullableNotEquals(k, null)) {
                            d = SpreadsheetUtilities.dq(k.value, b);
                        }
                        else if (i.isNumberSection) {
                            var m = i.percentCount;
                            if (m == 1) {
                                d = SpreadsheetUtilities.dr(f_6, b._y);
                            }
                        }
                    }
                }
                if (stringIsNullOrEmpty(d)) {
                    d = numberToString2(f_6, "r", b._y);
                }
            }
            else {
            }
        }
        return d;
    };
    SpreadsheetUtilities.au = function (a) {
        return a._styles$i._i(9)._i._bh;
    };
    SpreadsheetUtilities.av = function (a, b) {
        if (stringIsNullOrEmpty(a)) {
            return null;
        }
        if (SpreadsheetUtilities.bo == null) {
            SpreadsheetUtilities.bo = SpreadsheetUtilities.bt();
        }
        var c = new Color();
        if (!((function () { var d = SpreadsheetUtilities.bo.tryGetValue(a, c); c = d.p1; return d.ret; })())) {
            if (startsWith1(a, "Color", 3) && a.length > 5) {
                a = a.substr(5);
            }
            if (isDigit(a.charAt(0))) {
                var d_4;
                if (((function () { var e = tryParseInt32_1(a, d_4); d_4 = e.p1; return e.ret; })()) && d_4 >= 1 && d_4 <= 56) {
                    c = b._item$i(d_4 - 1);
                }
            }
            else {
                if (!((function () { var e = SpreadsheetUtilities.bo.tryGetValue(a, c); c = e.p1; return e.ret; })())) {
                    return null;
                }
            }
        }
        return new WorkbookColorInfo(c);
    };
    SpreadsheetUtilities.ap = function (a, b, c, d, e) {
        if (a != null) {
            if (typeCast(Boolean_$type, a) !== null || typeCast(ErrorValue.$, a) !== null) {
                return 2;
            }
            if (ExcelUtils.ba(a) || typeCast(Date_$type, a) !== null) {
                var f = c != null ? c.workbook : null;
                if (f != null) {
                    var g = SpreadsheetUtilities.ag(b, c, d, e, true);
                    if (g != null && g.o && g.n(0) && !g.l(0)) {
                        return 1;
                    }
                }
                return 3;
            }
        }
        return 1;
    };
    SpreadsheetUtilities.dg = function (a, b) {
        var c = a._getCellText(b);
        c = stringReplace(stringReplace(c.trim(), Environment.newLine, " "), '\n', ' ');
        return c;
    };
    SpreadsheetUtilities.am = function (a, b) {
        if (nullableEquals(b, null) || a == -1) {
            return -1;
        }
        return SpreadsheetUtilities.an(ExcelUtils.ak(a), Nullable$1.toNullable(Number_$type, intSToU(b.value)));
    };
    SpreadsheetUtilities.ao = function (a) {
        if (a == null || a.c == -1 || !a.d.hasValue) {
            return -1;
        }
        return SpreadsheetUtilities.an(ExcelUtils.ak(a.c), Nullable$1.toNullable(Number_$type, intSToU(a.d.value)));
    };
    SpreadsheetUtilities.an = function (a, b) {
        if (!b.hasValue) {
            return -1;
        }
        var c = b.value;
        switch (a) {
            default:
            case 0: switch (c) {
                case 2: return 1;
                case 1: return 2;
                default:
                case 0: return 3;
            }
            case 1: switch (c) {
                case 2: return 4;
                case 1: return 5;
                default:
                case 0: return 6;
            }
            case 18: switch (c) {
                case 2: return 45;
                case 1: return 46;
                default:
                case 0: return 47;
            }
            case 9: switch (c) {
                case 3: return 4;
                case 2: return 27;
                case 1: return 28;
                default:
                case 0: return 6;
            }
            case 8: switch (c) {
                case 3: return 1;
                case 2: return 25;
                case 1: return 26;
                default:
                case 0: return 3;
            }
            case 14: switch (c) {
                case 4: return 4;
                case 3: return 27;
                case 2: return 5;
                case 1: return 28;
                default:
                case 0: return 6;
            }
            case 13: switch (c) {
                case 4: return 1;
                case 3: return 25;
                case 2: return 2;
                case 1: return 26;
                default:
                case 0: return 3;
            }
            case 3: switch (c) {
                case 2: return 10;
                case 1: return 11;
                default:
                case 0: return 29;
            }
            case 4: switch (c) {
                case 2: return 14;
                case 1: return 15;
                default:
                case 0: return 16;
            }
            case 5: switch (c) {
                case 2: return 10;
                case 1: return 17;
                default:
                case 0: return 18;
            }
            case 12: switch (c) {
                case 3: return 10;
                case 2: return 17;
                case 1: return 12;
                default:
                case 0: return 13;
            }
            case 10: switch (c) {
                case 3: return 29;
                case 2: return 30;
                case 1: return 31;
                default:
                case 0: return 32;
            }
            case 6: switch (c) {
                case 2: return 19;
                case 1: return 20;
                default:
                case 0: return 21;
            }
            case 7: switch (c) {
                case 2: return 22;
                case 1: return 23;
                default:
                case 0: return 24;
            }
            case 2: switch (c) {
                case 2: return 7;
                case 1: return 8;
                default:
                case 0: return 9;
            }
            case 17: switch (c) {
                case 2: return 42;
                case 1: return 43;
                default:
                case 0: return 44;
            }
            case 11: switch (c) {
                default:
                case 0: return 38;
                case 1: return 39;
                case 2: return 40;
                case 3: return 41;
            }
            case 16: switch (c) {
                case 4: return 32;
                case 3: return 33;
                case 2: return 34;
                case 1: return 35;
                default:
                case 0: return 36;
            }
            case 15: switch (c) {
                default:
                case 0: return 37;
                case 1: return 38;
                case 2: return 39;
                case 3: return 40;
                case 4: return 41;
            }
            case 19: switch (c) {
                case 4: return 48;
                case 3: return 49;
                case 2: return 50;
                case 1: return 51;
                default:
                case 0: return 52;
            }
        }
    };
    SpreadsheetUtilities.dx = function (a) {
        if (a == null) {
            return null;
        }
        if (a.iconSet == -1 || a.iconIndex < 0) {
            return SpreadsheetUtilities.d1;
        }
        return Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), a.iconSet, Nullable$1.toNullable(Number_$type, a.iconIndex));
    };
    SpreadsheetUtilities.dy = function (a) {
        if (a == null) {
            return null;
        }
        if (a.iconSet == -1 || nullableEquals(a._iconIndex$i, null)) {
            return SpreadsheetUtilities.d1;
        }
        return Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), a.iconSet, a._iconIndex$i);
    };
    SpreadsheetUtilities.dz = function (a) {
        if (a == null) {
            return null;
        }
        if (a.iconSet == -1 || nullableEquals(a._iconIndex$i, null)) {
            return SpreadsheetUtilities.d1;
        }
        return Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), a.iconSet, a._iconIndex$i);
    };
    SpreadsheetUtilities.dh = function (a, b) {
        return dateToStringFormat(dateFromValues(2017, a, 1, 0, 0, 0, 0), "MMMM", b);
    };
    SpreadsheetUtilities.l = function (a, b, c, d) {
        var e_70, _0;
        var e = new Dictionary$2(CellContentType_$type, Number_$type, 0);
        e.item(2, 0);
        e.item(3, 0);
        e.item(1, 0);
        var f;
        var g;
        var h;
        var i;
        if (d) {
            f = b._ac;
            g = b._ae;
            h = b._w + c;
            i = h;
        }
        else {
            f = b._ac + c;
            g = f;
            h = b._w;
            i = b._x;
        }
        var _loop_12 = function (j) {
            var e_71, _0;
            var _loop_13 = function (k) {
                var l = k.r;
                var m;
                var n = ((function () { var o = SpreadsheetUtilities.k(j, l, m); m = o.p2; return o.ret; })());
                if (n != 0) {
                    e.item(n, e.item(n) + 1);
                }
            };
            try {
                for (var _1 = tslib_1.__values(fromEnum(j._ch(h, i))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var k = _2.value;
                    _loop_13(k);
                }
            }
            catch (e_71_1) { e_71 = { error: e_71_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_71) throw e_71.error; }
            }
        };
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._rows$i._m(f, g))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var j = _2.value;
                _loop_12(j);
            }
        }
        catch (e_70_1) { e_70 = { error: e_70_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_70) throw e_70.error; }
        }
        var o = SpreadsheetUtilities.j(e);
        return o;
    };
    SpreadsheetUtilities.by = function (a) {
        var b = a.table;
        var c = b.wholeTableRegion;
        var d = a.index + c.firstColumn;
        var e = c.firstColumn;
        var f = c.lastColumn;
        var g = new List$1(IFilterable_$type, 0);
        for (var h = e; h <= f; h++) {
            if (h == d) {
                continue;
            }
            var i = b._columns$i._item(h - e);
            if (null != i.filter) {
                g.add(i);
            }
        }
        return g;
    };
    SpreadsheetUtilities.bx = function (a, b) {
        var c = new List$1(IFilterable_$type, 0);
        var d = a.filterSettings;
        var e = d.sortAndFilterAreaRegion;
        if (e != null) {
            var f = e.firstColumn + b;
            var g = e.firstColumn;
            var h = e.lastColumn;
            for (var i = g; i <= h; i++) {
                if (i == f) {
                    continue;
                }
                var j = d.getFilter(i - g);
                if (null != j) {
                    c.add(j._b);
                }
            }
        }
        return c;
    };
    SpreadsheetUtilities.b8 = function (a, b) {
        switch (a) {
            case 7:
            case 10:
            case 11:
            case 12:
            case 13:
                b *= 2;
                break;
            case 14:
                b *= 3;
                break;
        }
        return b;
    };
    SpreadsheetUtilities.cq = function (a) {
        var b = numberToString2(a, "r", CultureInfo.invariantCulture);
        var c = b.indexOf(".");
        return c < 0 ? 0 : b.length - (c + 1);
    };
    SpreadsheetUtilities.cy = function (a, b) {
        for (var c = 0; c < a.count; c++) {
            if (a.item(c)._c(b)) {
                return Nullable$1.toNullable(IntRange.$, a.item(c));
            }
        }
        return Nullable$1.toNullable(IntRange.$, null);
    };
    SpreadsheetUtilities.e2 = function (a, b, c) {
        if (c === void 0) { c = true; }
        if (WorkbookColorInfo.l_op_Equality(a, null)) {
            return ExcelUtils.gv;
        }
        return ExcelUtils.g1(a._aj(b, c, true));
    };
    SpreadsheetUtilities.di = function (a, b) {
        var c = [];
        for (var _0 = 2; _0 < arguments.length; _0++) {
            c[_0 - 2] = arguments[_0];
        }
        if (a != null) {
            return a._fs.apply(a, tslib_1.__spread([b], c));
        }
        return Localization.c.apply(Localization, tslib_1.__spread(["spreadsheet", b], c));
    };
    SpreadsheetUtilities.e = function (a) {
        var e_72, _0;
        var b = null;
        var c = null;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._worksheets$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                if (d._w) {
                    if (b == null) {
                        b = d;
                    }
                    else {
                        if (c == null) {
                            c = new List$1(Worksheet.$, 0);
                            c.add(b);
                        }
                        c.add(d);
                    }
                }
            }
        }
        catch (e_72_1) { e_72 = { error: e_72_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_72) throw e_72.error; }
        }
        if (c != null) {
            return c.toArray();
        }
        else if (b != null) {
            return [b];
        }
        else {
            return new Array(0);
        }
    };
    SpreadsheetUtilities.a0 = function (a) {
        var b = null;
        if (a != null) {
            var c = typeCast(ICT_ShapePropertiesOwner_$type, a._b3);
            if (c != null && c.spPr != null) {
                var d = typeCast(CT_PresetGeometry2D.$, c.spPr.e);
                if (d != null && d.a != null) {
                    b = d.a;
                }
            }
        }
        return b;
    };
    SpreadsheetUtilities.as = function (a) {
        var b = null;
        if (a._ar) {
            b = a._k;
            if (b == ShapeFillNoFill._e) {
                b = null;
            }
        }
        return b;
    };
    SpreadsheetUtilities.aj = function (a) {
        var b = null;
        if (a != null && a.chartArea != null) {
            b = a.chartArea._ap;
            if (typeCast(ChartEmptyFill.$, b) !== null) {
                b = null;
            }
        }
        return b;
    };
    SpreadsheetUtilities.at = function (a) {
        var b = null;
        if (a._as) {
            b = a._n;
            if (b == ShapeOutlineNoOutline._i) {
                b = null;
            }
        }
        return b;
    };
    SpreadsheetUtilities.ai = function (a) {
        var b = null;
        if (a != null && a.chartArea != null) {
            b = a.chartArea.border;
            if (b != null && b.lineStyle == 7) {
                b = null;
            }
        }
        return b;
    };
    SpreadsheetUtilities.b9 = function (a) {
        if (typeCast(WorksheetChart.$, a) !== null) {
            var b = SpreadsheetUtilities.ai(a);
            if (b == null || b.lineStyle == 7 || b.widthInPoints <= 0) {
                return 0;
            }
            return Workbook._eq(b.widthInPoints) / 2;
        }
        if (a == null || !a._as) {
            return 0;
        }
        var c = a.outline;
        if (c == null || c == ShapeOutlineNoOutline._i) {
            return 0;
        }
        var d = ExcelUtils.c1(c._d);
        if (typeCast(WorksheetImage.$, a) !== null == false) {
            d /= 2;
        }
        return d;
    };
    SpreadsheetUtilities.w = function (a, b, c) {
        var d = a._de(b, c);
        if (d != null) {
            return new TableSortFilterArea(d._columns$i._item(c - d._by._w));
        }
        else if (a.filterSettings.region != null && a.filterSettings.region._q(b, c)) {
            return new WorksheetSortFilterArea(a, c - a.filterSettings.region._v);
        }
        else {
            return null;
        }
    };
    SpreadsheetUtilities.cr = function (a, b, c) {
        var e_73, _0, e_74, _1;
        if (b._aa > 1) {
            var d = new Array(b._ad);
            var e = a ? new Array(b._ad) : null;
            for (var f = 0; f < d.length; f++) {
                d[f] = 0;
            }
            var g_5;
            var h_6 = c._rows$i._aj(b.firstRow);
            if (h_6 != null) {
                var _loop_14 = function (i) {
                    d[i.r - b.firstColumn] = ((function () { var j = SpreadsheetUtilities.k(h_6, i.r, g_5); g_5 = j.p2; return j.ret; })());
                    if (e != null) {
                        e[i.r - b.firstColumn] = c._b4(h_6, i.r).fill;
                    }
                };
                try {
                    for (var _2 = tslib_1.__values(fromEnum(h_6._ch(b.firstColumn, b.lastColumn, true))), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var i = _3.value;
                        _loop_14(i);
                    }
                }
                catch (e_73_1) { e_73 = { error: e_73_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_73) throw e_73.error; }
                }
            }
            var j = a ? b.firstRow + 1 : Math.min(b.lastRow, b.firstRow + 2);
            var _loop_15 = function (k) {
                var e_75, _0;
                var l = void 0;
                var m = b.firstColumn;
                try {
                    for (var _1 = tslib_1.__values(fromEnum(k._ch(b.firstColumn, b.lastColumn, true))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var n = _2.value;
                        for (; m <= n.r; m++) {
                            l = ((function () { var o = SpreadsheetUtilities.k(k, m, g_5); g_5 = o.p2; return o.ret; })());
                            if (d[m - b.firstColumn] == 0) {
                                d[m - b.firstColumn] = l;
                            }
                            else if (d[m - b.firstColumn] != l) {
                                return { value: k.index - b.firstRow };
                            }
                            else if (e != null && e[m - b.firstColumn] != c._b4(k, m).fill) {
                                return { value: k.index - b.firstRow };
                            }
                        }
                    }
                }
                catch (e_75_1) { e_75 = { error: e_75_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_75) throw e_75.error; }
                }
                for (; m <= b.lastColumn; m++) {
                    l = ((function () { var o = SpreadsheetUtilities.k(k, m, g_5); g_5 = o.p2; return o.ret; })());
                    if (d[m - b.firstColumn] == 0) {
                        d[m - b.firstColumn] = l;
                    }
                    else if (d[m - b.firstColumn] != l) {
                        return { value: k.index - b.firstRow };
                    }
                    else if (e != null && e[m - b.firstColumn] != c._b4(k, m).fill) {
                        return { value: k.index - b.firstRow };
                    }
                }
            };
            try {
                for (var _4 = tslib_1.__values(fromEnum(c._rows$i._m(b.firstRow + 1, j))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var k = _5.value;
                    var state_7 = _loop_15(k);
                    if (typeof state_7 === "object")
                        return state_7.value;
                }
            }
            catch (e_74_1) { e_74 = { error: e_74_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_74) throw e_74.error; }
            }
        }
        return 0;
    };
    SpreadsheetUtilities.dk = function (a, b, c) {
        var d = 1;
        if (b._a8 != null) {
            var e = b._a8._bc._rows$i._aj(c.row);
            if (e != null) {
                var f = new GetCellTextParameters(c.column);
                f.b = 1;
                var g = e._av(f);
                if (!isNaN_(g.e)) {
                    if (g.c && (g.b & 1) != 0) {
                        d = 2;
                    }
                    else {
                        d = 3;
                    }
                }
            }
        }
        return SpreadsheetUtilities.dj(a, b, d);
    };
    SpreadsheetUtilities.dj = function (a, b, c) {
        var d;
        switch (c) {
            case 2:
                d = a ? "MenuItem_SortAscending_Date" : "MenuItem_SortDescending_Date";
                break;
            case 3:
                d = a ? "MenuItem_SortAscending_Number" : "MenuItem_SortDescending_Number";
                break;
            default:
            case 1:
                d = a ? "MenuItem_SortAscending_Text" : "MenuItem_SortDescending_Text";
                break;
        }
        return SpreadsheetUtilities.di(b, d);
    };
    SpreadsheetUtilities.x = function (a) {
        if (a != null && a._cx) {
            var b = a._a0;
            if (typeCast(WeakWorkbookOwner.$, b) !== null) {
                b = b.a;
            }
            return typeCast(Spreadsheet.$, b);
        }
        return null;
    };
    SpreadsheetUtilities.ah = function (a) {
        return typeCast(RowColumnBase.$, a._s) !== null ? 32 : 0;
    };
    SpreadsheetUtilities.ag = function (a, b, c, d, e) {
        var f = c != null && b != null ? b._be(c.index, d, true) : null;
        var g;
        if (f != null && f._h != null && f._h.formatString != null) {
            g = f._h._cs;
        }
        else {
            g = a._cs;
        }
        if (!e || g != 0) {
            var h = b.workbook;
            if (h != null) {
                return h._b2.a(g);
            }
        }
        return null;
    };
    SpreadsheetUtilities.bz = function (a, b, c) {
        var d = a.filterSettings;
        var e = d != null ? d.sortAndFilterAreaRegion : null;
        if (null == d || null == e) {
            c = 0;
            return {
                ret: null,
                p2: c
            };
        }
        var f = e.firstRow;
        var g = e.lastRow;
        var h = e.firstColumn + b;
        var i = SpreadsheetUtilities.bx(a, b);
        return {
            ret: ((function () { var j = SpreadsheetUtilities.b0(a, f, g, h, i, c); c = j.p5; return j.ret; })()),
            p2: c
        };
    };
    SpreadsheetUtilities.b1 = function (a, b) {
        var c = a._worksheet;
        var d = a.table;
        var e = a.table.dataAreaRegion;
        var f = e.firstRow;
        var g = e.lastRow;
        var h = SpreadsheetUtilities.by(a);
        return {
            ret: ((function () { var i = SpreadsheetUtilities.b0(c, f, g, a._at, h, b); b = i.p5; return i.ret; })()),
            p1: b
        };
    };
    SpreadsheetUtilities.b0 = function (a, b, c, d, e, f) {
        var e_76, _0;
        var g = new HashSet$1(String_$type, 0);
        var h = new Dictionary$2(CellContentType_$type, Number_$type, 0);
        h.item(2, 0);
        h.item(3, 0);
        h.item(1, 0);
        var _loop_16 = function (i) {
            var e_77, _0;
            var j = false;
            try {
                for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var k = _2.value;
                    if (false == k.filter._e(k.worksheet, i, i.index, k.columnIndex)) {
                        j = true;
                        break;
                    }
                }
            }
            catch (e_77_1) { e_77 = { error: e_77_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_77) throw e_77.error; }
            }
            if (j) {
                return "continue";
            }
            var l;
            var m = ((function () { var n = SpreadsheetUtilities.k(i, d, l); l = n.p2; return n.ret; })());
            if (m != 0) {
                g.add_1(l);
                h.item(m, h.item(m) + 1);
            }
        };
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._rows$i._m(b, c))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var i = _2.value;
                _loop_16(i);
            }
        }
        catch (e_76_1) { e_76 = { error: e_76_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_76) throw e_76.error; }
        }
        f = SpreadsheetUtilities.j(h);
        var n = new List$1(Base.$, 1, g);
        n.y();
        return {
            ret: n,
            p5: f
        };
    };
    SpreadsheetUtilities.f = function (a, b) {
        var c = new Array(b.count);
        for (var d = 0; d < c.length; d++) {
            var e = b.item(d);
            c[d] = a._cx(e.firstRow, e.firstColumn, e.lastRow, e.lastColumn);
        }
        return c;
    };
    SpreadsheetUtilities.a8 = function (a, b, c) {
        if (a != null) {
            for (var d = b, e = Math.min(a.length, b + c); d < e; d++) {
                if (/\s/i.test(a.charAt(d))) {
                    return true;
                }
            }
        }
        return false;
    };
    SpreadsheetUtilities.cs = function (a, b) {
        var c = a.indexOf('\r', b);
        if (c < 0) {
            c = a.indexOf('\n', b);
        }
        return c;
    };
    SpreadsheetUtilities.ct = function (a, b, c) {
        var d = a.indexOf('\r', b);
        if (d < 0 || d >= b + c - 1) {
            d = a.indexOf('\n', b);
            if (d >= b + c - 1) {
                d = -1;
            }
        }
        return d;
    };
    SpreadsheetUtilities.d9 = function (a, b) {
        var c = b._bold$i;
        if (nullableNotEquals(c, null)) {
            a._o = Nullable$1.toNullable(Boolean_$type, nullableEquals(c, true));
        }
        var d = b.colorInfo;
        if (WorkbookColorInfo.l_op_Inequality(d, null)) {
            a._d = d;
        }
        var e = b.height;
        if (e >= 0) {
            a._p = Nullable$1.toNullable(Number_$type, e);
        }
        var f = b._italic$i;
        if (nullableNotEquals(f, null)) {
            a._q = Nullable$1.toNullable(Boolean_$type, nullableEquals(f, true));
        }
        var g = b.name;
        if (!stringIsNullOrEmpty(g)) {
            a._v = g;
        }
        var h = b._strikeout$i;
        if (nullableNotEquals(h, null)) {
            a._r = Nullable$1.toNullable(Boolean_$type, nullableEquals(h, true));
        }
        var i = b.superscriptSubscriptStyle;
        if (i != -1) {
            a._s = Nullable$1.toNullable(FontSuperscriptSubscriptStyle_$type, i);
        }
        var j = b.underlineStyle;
        if (j != -1) {
            a._t = Nullable$1.toNullable(FontUnderlineStyle_$type, j);
        }
    };
    SpreadsheetUtilities.a9 = function (a, b) {
        return b._ac <= a.lastRow && b._ae >= a.firstRow && b._w <= a.lastColumn && b._x >= a.firstColumn;
    };
    SpreadsheetUtilities.ba = function (a) {
        return a == 2 || a == 34;
    };
    SpreadsheetUtilities.bc = function (a) {
        if (a == null || Base.referenceEquals(a, CellFill.noColor)) {
            return true;
        }
        return typeCast(CellFillPattern.$, a) !== null && a.patternStyle == 0;
    };
    SpreadsheetUtilities.bb = function (a) {
        if (stringStartsWith(a, "\\\\")) {
            return false;
        }
        var b;
        if (a.length > 1 && (b = a.indexOf('@', 1)) > 0 && (b == a.length - 1 || a.charAt(b + 1) != '@') && !SpreadsheetUtilities.a8(a, 0, b)) {
            return true;
        }
        return false;
    };
    SpreadsheetUtilities.bd = function (a) {
        if (stringIsNullOrEmpty(a) || /\s/i.test(a.charAt(0))) {
            return false;
        }
        var b = false;
        var c;
        if (stringStartsWith(a, "\\\\")) {
            var d = a.length == 2 ? stringEmpty() : a.substr(2);
            b = stringIsNullOrWhiteSpace(d) || Uri.isWellFormedUriString(d, 0);
        }
        else if (SpreadsheetUtilities.bb(a)) {
            b = true;
        }
        else if (((function () { var e = Uri.tryCreate(a, 0, c); c = e.p2; return e.ret; })())) {
            if (c.isAbsoluteUri) {
                if (a.length > c.scheme.length + 1) {
                    try {
                        if (!stringIsNullOrEmpty(c.localPath) && /\s/i.test(c.localPath.charAt(0))) {
                        }
                        else if (UriParser.a(c.scheme)) {
                            b = true;
                        }
                    }
                    catch (e) {
                        b = false;
                    }
                }
            }
            else {
                var f = trimEnd(a);
                if (f != a) {
                    var g = Uri.tryCreate(f, 0, c);
                    c = g.p2;
                }
                if (f.length > 4) {
                    if (c.isWellFormedOriginalString()) {
                        if (startsWith1(a, "www.", 3) || startsWith1(a, "ftp", 3)) {
                            b = true;
                        }
                    }
                    else if (stringStartsWith(f, "ftp.")) {
                        var h = f.substr(4);
                        if (!/\s/i.test(h.charAt(0))) {
                            b = true;
                        }
                    }
                }
                else if (f.length == 0) {
                    b = false;
                }
            }
        }
        else {
            var i = a.indexOf(Uri.schemeDelimiter);
            if (i > 0) {
                var j = a.substr(0, i);
                if (UriParser.a(j)) {
                    var k = stringEmpty();
                    if (i + Uri.schemeDelimiter.length < a.length) {
                        k = a.substr(i + Uri.schemeDelimiter.length).trim();
                    }
                    if (k.length == 0 || stringEquals1("ftp", j, 1)) {
                        b = true;
                    }
                }
            }
            else if (startsWith1(a, "mailto:", 3)) {
                if (a.length > 7 && !/\s/i.test(a.charAt(7))) {
                    b = true;
                }
            }
        }
        return b;
    };
    SpreadsheetUtilities.be = function (a) {
        return a == 3 || a == 2;
    };
    SpreadsheetUtilities.ea = function (a, b, c) {
        if (b === void 0) { b = null; }
        if (c === void 0) { c = null; }
        if (performance !== undefined && performance.measure !== undefined)
            performance.measure(a, b, c);
        ;
    };
    SpreadsheetUtilities.cx = function (a, b) {
        if (b < (a.f + a.e)) {
            var c = new IGFormattedTextRun();
            c.f = b;
            c.e = (a.f + a.e) - b;
            a.h.add(c);
            b = c.f + c.e;
        }
        return b;
    };
    SpreadsheetUtilities.eb = function (a, b) {
        var e_78, _0;
        var c = a._conditionalFormats$i;
        var d = new WorksheetReferenceCollection(a);
        var e = FormulaParser.bx(a._y).toString();
        for (var f = c.count - 1; f >= 0; f--) {
            var g = c.item(f);
            if (g._ab(b)) {
                d.clear();
                try {
                    for (var _1 = tslib_1.__values(fromEnum(g.regions)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var h = _2.value;
                        d._add(h);
                    }
                }
                catch (e_78_1) { e_78 = { error: e_78_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_78) throw e_78.error; }
                }
                var i = false;
                for (var k = 0; k < b.length; k++) {
                    var j = b[k];
                    i = d._remove2(j) || i;
                }
                if (i) {
                    if (d._t.count == 0) {
                        a._conditionalFormats$i.removeAt(f);
                    }
                    else {
                        var l = WorksheetReferenceCollection._ab(1, a, d._t, e);
                        g._setRegions$i(l, Nullable$1.toNullable(CellReferenceMode_$type, 1));
                    }
                }
            }
        }
    };
    SpreadsheetUtilities.ec = function (a, b) {
        a.removeListener(b);
    };
    SpreadsheetUtilities.ed = function (a, b, c, d) {
        var e = a._styles$i._i(c)._i._bh._getResolvedColor1(a);
        var f = null;
        b.l(function (g) {
            var h = g._d;
            if (WorkbookColorInfo.l_op_Inequality(h, null)) {
                if (Color.b(h._getResolvedColor1(a), e)) {
                    if (WorkbookColorInfo.l_op_Equality(f, null)) {
                        f = a._styles$i._i(d)._i._bh;
                    }
                    g._d = f;
                }
            }
        });
    };
    SpreadsheetUtilities.ee = function (a, b) {
        a._au(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ef = function (a, b) {
        a._u._b(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.eh = function (a, b) {
        a._ay(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ei = function (a, b) {
        a._a0(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ej = function (a, b) {
        a._u._c(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ek = function (a, b) {
        a._u._h(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.el = function (a, b) {
        a._u._f(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.em = function (a, b) {
        a._a5(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.en = function (a, b) {
        a._a8(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.eo = function (a, b) {
        a._u._g(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ep = function (a, b) {
        a._bb(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.eq = function (a) {
        if (performance !== undefined && performance.mark !== undefined)
            performance.mark(a);
        ;
    };
    SpreadsheetUtilities.er = function (a, b) {
        a._bf(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.es = function (a, b) {
        a._bg(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.et = function (a, b) {
        a._u._i(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.eu = function (a, b) {
        a._bh(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ev = function (a, b) {
        a._u._j(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ew = function (a, b) {
        a._u._k(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ex = function (a, b) {
        a._bm(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.ey = function (a, b) {
        a._bn(b, true, SpreadsheetUtilities.ah(a));
    };
    SpreadsheetUtilities.bl = function (a) {
        var b = a._ao;
        if (typeCast(WorksheetShapeGroup.$, b._f) !== null) {
            return false;
        }
        return ExcelUtils.bd(a._b6);
    };
    SpreadsheetUtilities.dl = function (a) {
        if (!stringIsNullOrEmpty(a)) {
            var b = 0;
            var c = a.length;
            var d = void 0;
            var e = null;
            while (b < c && (d = SpreadsheetUtilities.cs(a, b)) >= 0) {
                if (e == null) {
                    e = new StringBuilder(0);
                }
                if (d > b) {
                    e.m(a, b, d - b);
                }
                if (a.charAt(d) == '\r' && d < c - 1 && a.charAt(d + 1) == '\n') {
                    d++;
                }
                b = d + 1;
            }
            if (e != null) {
                if (b < c) {
                    e.m(a, b, c - b);
                }
                a = e.toString();
            }
        }
        return a;
    };
    SpreadsheetUtilities.i = function (a) {
        switch (a) {
            case 0: return 0;
            case 7: return 1;
            case 9: return 3;
            case 11: return 2;
            case 3: return 5;
            case 4: return 4;
            case 2: return 13;
            case 10: return 11;
            case 12: return 7;
            case 8: return 12;
            case 5: return 14;
            case 1: return 6;
            default:
            case 6:
            case 13:
            case -1: return 0;
        }
    };
    SpreadsheetUtilities.m = function (a) {
        switch (a) {
            case 7: return 3;
            case 3: return 1;
            case 5: return 2;
            default:
            case 1: return 0;
        }
    };
    SpreadsheetUtilities.dn = function (a, b) {
        return SpreadsheetUtilities.dt(a, b) + " " + SpreadsheetUtilities.dp(a, b);
    };
    SpreadsheetUtilities.dq = function (a, b) {
        var c = dateToday();
        c = dateAddHours(c, timeSpanTotalHours(a));
        return SpreadsheetUtilities.dp(c, b);
    };
    SpreadsheetUtilities.dp = function (a, b) {
        var c = (a.toLocaleTimeString(b._y.name));
        if (VisualElementDomBuilder.c) {
            c = SpreadsheetUtilities.dv.g(c, "");
        }
        return c;
    };
    SpreadsheetUtilities.dr = function (a, b) {
        var c = a * 100;
        return (c.toLocaleString(b.name, { maximumFractionDigits: 20, maximumSignificantDigits: 15 })) + b.numberFormat.percentSymbol;
    };
    SpreadsheetUtilities.d0 = function (a) {
        if (SpreadsheetUtilities.dw == null || SpreadsheetUtilities.dw.d != a) {
            var b = WorkbookFormatCollection.af(a);
            SpreadsheetUtilities.dw = new Tuple$2(ValueFormatter.$, CultureInfo.$, new ValueFormatter(1, b, a, null), a);
        }
        return SpreadsheetUtilities.dw;
    };
    SpreadsheetUtilities.dt = function (a, b) {
        return SpreadsheetUtilities.c7(SpreadsheetUtilities.d0(b._y).c, a, b.workbook);
    };
    SpreadsheetUtilities.ds = function (a, b) {
        return SpreadsheetUtilities.c7(SpreadsheetUtilities.d0(b._e6).c, a, b);
    };
    SpreadsheetUtilities.c0 = function (a) {
        return Nullable$1.toNullable(Boolean_$type, nullableEquals(a, true) ? false : true);
    };
    SpreadsheetUtilities.aq = function (a, b) {
        return a == b ? 0 : b;
    };
    SpreadsheetUtilities.al = function (a, b) {
        return a == 1 || a == 33 ? 0 : b ? 33 : 1;
    };
    SpreadsheetUtilities.ak = function (a, b) {
        return a == 2 || a == 34 ? 0 : b ? 34 : 2;
    };
    SpreadsheetUtilities.o = function (a) {
        switch (a) {
            case 3: return 0;
            case 1: return 1;
            default:
            case 0: return 3;
            case 2: return 2;
        }
    };
    SpreadsheetUtilities.ac = function (a) {
        var b;
        switch (a) {
            default:
            case 1:
                b = 0;
                break;
            case 4:
                b = 5;
                break;
            case 2:
            case 6:
                b = 2;
                break;
            case 3:
                b = 1;
                break;
            case 5:
                b = 3;
                break;
            case 7:
                b = 4;
                break;
        }
        return b;
    };
    SpreadsheetUtilities.af = function (a) {
        switch (a) {
            case 0: return 0;
            case 1: return 1;
            default:
            case 2: return 2;
            case 4: return 4;
            case 3: return 3;
        }
    };
    SpreadsheetUtilities.cc = function (a) {
        return a * Math.PI / 180;
    };
    SpreadsheetUtilities.y = function (a) {
        return new SpreadsheetCell(a.o, a.m);
    };
    SpreadsheetUtilities.z = function (a) {
        return new SpreadsheetCellRange(a._ac, a._w, a._ae, a._x);
    };
    SpreadsheetUtilities.g = function (a) {
        var b = new Array(a.count);
        for (var c = 0; c < b.length; c++) {
            b[c] = SpreadsheetUtilities.z(a.item(c));
        }
        return b;
    };
    SpreadsheetUtilities.ar = function (a) {
        switch (a) {
            case 3: return 2;
            case 4: return 1;
            case 0:
            case 5: return 4;
            case 1: return 5;
            case 2: return 0;
            default: return 4;
        }
    };
    SpreadsheetUtilities.ab = function (a) {
        switch (a) {
            case -4130: return 3;
            case -4117: return 4;
            case -4131: return 0;
            case -4152: return 1;
            default:
            case -4108: return 2;
        }
    };
    SpreadsheetUtilities.ad = function (a) {
        switch (a) {
            case 2:
            case 3: return 3;
            case 1:
            case 6: return 4;
            case 4: return 0;
            case 5: return 1;
            default:
            case 0: return 2;
        }
    };
    SpreadsheetUtilities.ae = function (a) {
        switch (a) {
            case -4130: return 3;
            case -4117: return 4;
            case -4160: return 0;
            case -4107: return 2;
            default:
            case -4108: return 1;
        }
    };
    SpreadsheetUtilities.aw = function (a) {
        return new WorksheetCellAddress(1, a.row, a.column);
    };
    SpreadsheetUtilities.ay = function (a) {
        return new WorksheetRegionAddress(1, a.firstRow, a.lastRow, a.firstColumn, a.lastColumn);
    };
    SpreadsheetUtilities.ax = function (a) {
        return SpreadsheetUtilities.az(a.row, a.column);
    };
    SpreadsheetUtilities.az = function (a, b) {
        return new WorksheetRegionAddress(1, a, a, b, b);
    };
    SpreadsheetUtilities.h = function (a) {
        var b = new Array(a.count);
        for (var c = 0; c < b.length; c++) {
            b[c] = SpreadsheetUtilities.ay(a.item(c));
        }
        return b;
    };
    SpreadsheetUtilities.e1 = function (a, b) {
        var e_79, _0;
        if (b === void 0) { b = null; }
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = c.key;
                var e = new Array(c.value.length);
                for (var f = 0; f < e.length; f++) {
                    e[f] = c.value[f]._h;
                }
                SpreadsheetUtilities.e0(c.key, e, b);
            }
        }
        catch (e_79_1) { e_79 = { error: e_79_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_79) throw e_79.error; }
        }
    };
    SpreadsheetUtilities.e0 = function (a, b, c) {
        var e_80, _0, e_81, _1, e_82, _2;
        if (c === void 0) { c = null; }
        var d = null;
        try {
            for (var _3 = tslib_1.__values(fromEnum(a._tables$i)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                var e = _4.value;
                if (c != null && c.contains(e.name)) {
                    continue;
                }
                var f = e.dataAreaRegion._h;
                for (var g = 0; g < b.length; g++) {
                    var h = b[g];
                    if (h._j(f)) {
                        try {
                            for (var _5 = tslib_1.__values(fromEnum(e._columns$i)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                var i = _6.value;
                                if (h._h(i.dataAreaRegion._h)) {
                                    if (d == null) {
                                        d = new HashSet$1(WorksheetTableColumn.$, 0);
                                    }
                                    d.add_1(i);
                                }
                            }
                        }
                        catch (e_81_1) { e_81 = { error: e_81_1 }; }
                        finally {
                            try {
                                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                            }
                            finally { if (e_81) throw e_81.error; }
                        }
                    }
                }
            }
        }
        catch (e_80_1) { e_80 = { error: e_80_1 }; }
        finally {
            try {
                if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
            }
            finally { if (e_80) throw e_80.error; }
        }
        if (d != null) {
            try {
                for (var _7 = tslib_1.__values(fromEnum(d)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                    var j = _8.value;
                    var k = null;
                    var l = j.dataAreaRegion;
                    var m = l.firstRow;
                    for (var n = m; n <= l.lastRow; n++) {
                        var o = a._rows$i._aj(n);
                        if (o == null) {
                            k = null;
                            break;
                        }
                        else {
                            var p = o._ar(j._at);
                            if (n == m && p != null) {
                                k = p;
                            }
                            else if (p == null || !p._ao(k)) {
                                k = null;
                                break;
                            }
                        }
                    }
                    if (k != null) {
                        k = k._g();
                    }
                    j._setColumnFormula1(k, false);
                }
            }
            catch (e_82_1) { e_82 = { error: e_82_1 }; }
            finally {
                try {
                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                }
                finally { if (e_82) throw e_82.error; }
            }
        }
    };
    SpreadsheetUtilities.$t = markType(SpreadsheetUtilities, 'SpreadsheetUtilities');
    SpreadsheetUtilities.cd = (Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector || Element.prototype.webkitMatchesSelector);
    SpreadsheetUtilities.a = SpreadsheetUtilities.b();
    SpreadsheetUtilities.bq = SpreadsheetUtilities.bs();
    SpreadsheetUtilities.d3 = ObservableCollectionExtended$1.$.specialize(SpreadsheetCellRange.$);
    SpreadsheetUtilities.d2 = AdapterIntRangeSet$1.$.specialize(SpreadsheetCellRange.$);
    SpreadsheetUtilities.d5 = ObservableCollectionExtended$1.$.specialize(WorksheetItemPosition.$);
    SpreadsheetUtilities.d4 = ObservableCollectionExtended$1.$.specialize(SpreadsheetDropDownButton.$);
    SpreadsheetUtilities.cz = Nullable$1.toNullable(Boolean_$type, null);
    SpreadsheetUtilities.du = new Regex(0, "\\(_\\w\\)");
    SpreadsheetUtilities.bw = new List$1(Number_$type, 1, [160, 180, 200, 220, 240, 280, 320, 360, 400, 440, 480, 520, 560, 720, 960, 1440]);
    SpreadsheetUtilities.bo = null;
    SpreadsheetUtilities.bp = null;
    SpreadsheetUtilities.bn = SpreadsheetUtilities.br();
    SpreadsheetUtilities.d1 = Tuple.a(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type), -1, Nullable$1.toNullable(Number_$type, null));
    SpreadsheetUtilities.dv = new Regex(0, "");
    SpreadsheetUtilities.dw = null;
    return SpreadsheetUtilities;
}(Base));
export { SpreadsheetUtilities };
/**
 * @hidden
 */
var SpreadsheetCellEditInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellEditInfo, _super);
    function SpreadsheetCellEditInfo(a, b, c) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.b = null;
        _this.c = false;
        _this.a = a;
        _this.b = b;
        _this.c = c;
        return _this;
    }
    SpreadsheetCellEditInfo.$t = markType(SpreadsheetCellEditInfo, 'SpreadsheetCellEditInfo');
    return SpreadsheetCellEditInfo;
}(Base));
export { SpreadsheetCellEditInfo };
/**
 * @hidden
 */
var AccountingUnderlineInfo = /** @class */ (function (_super) {
    tslib_1.__extends(AccountingUnderlineInfo, _super);
    function AccountingUnderlineInfo() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.b = false;
        _this.c = 0;
        _this.a = false;
        return _this;
    }
    AccountingUnderlineInfo.d = function (a, b, c, d, e) {
        var f = d.a;
        if (f == null) {
            d.a = f = new AccountingUnderlineInfo();
        }
        f.c = a;
        f.b = b;
        var g = false;
        if (c != null && !c.displayOptions.showFormulasInCells) {
            if (d.l) {
                g = true;
            }
            else {
                var h = d.ap;
                if (h != null && ExcelUtils.ba(h)) {
                    var i = c.workbook;
                    if (d.p) {
                        g = true;
                    }
                    else if (i != null) {
                        g = true;
                        var j = SpreadsheetUtilities.ag(e, c, d.h, d.ab, true);
                        if (j != null && j.o && j.k(0)) {
                            g = false;
                        }
                    }
                }
            }
        }
        f.a = g;
    };
    AccountingUnderlineInfo.$t = markType(AccountingUnderlineInfo, 'AccountingUnderlineInfo');
    return AccountingUnderlineInfo;
}(Base));
export { AccountingUnderlineInfo };
/**
 * An object that represents the selected items within a [[Spreadsheet]]
 */
var SpreadsheetSelection = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSelection, _super);
    function SpreadsheetSelection(a, b, c) {
        var _this = _super.call(this) || this;
        _this._l = null;
        _this._y = null;
        _this._k = null;
        _this._be = null;
        _this._g = null;
        _this._h = null;
        _this._i = null;
        _this._j = null;
        _this._n = new SpreadsheetCell();
        _this._p = new SpreadsheetCellRange();
        _this._bl = 0;
        _this._aa = new IntRange(1, 0, 0);
        _this._ab = new IntRange(1, 0, 0);
        _this._w = 0;
        _this._bo = Nullable$1.toNullable(Boolean_$type, null);
        _this._bn = Nullable$1.toNullable(Boolean_$type, null);
        _this._bp = null;
        _this._q = SpreadsheetCellRange.empty;
        _this._ag = false;
        /**
         * @hidden
         */
        _this._av = false;
        CoreUtilities.y(a);
        CoreUtilities.y(b);
        var d = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetCellRange.$), _this._k, new ObservableCollectionExtended$1(SpreadsheetCellRange.$, 0), _this, false);
        _this._k = d.p0;
        var e = PropertyChangeListenerList.e(AdapterIntRangeSet$1.$.specialize(SpreadsheetCellRange.$), _this._g, new AdapterIntRangeSet$1(SpreadsheetCellRange.$, _this._k, runOn(_this, _this._ae), null, runOn(_this, _this._ar)), _this, false);
        _this._g = e.p0;
        var f = PropertyChangeListenerList.e(AdapterIntRangeSet$1.$.specialize(SpreadsheetCellRange.$), _this._h, new AdapterIntRangeSet$1(SpreadsheetCellRange.$, _this._k, runOn(_this, _this._af), null, runOn(_this, _this._ar)), _this, false);
        _this._h = f.p0;
        var g = PropertyChangeListenerList.e(AdapterIntRangeSet$1.$.specialize(SpreadsheetCellRange.$), _this._i, new AdapterIntRangeSet$1(SpreadsheetCellRange.$, _this._k, runOn(_this, _this._ae), runOn(_this, _this._az), runOn(_this, _this._ar)), _this, false);
        _this._i = g.p0;
        var h = PropertyChangeListenerList.e(AdapterIntRangeSet$1.$.specialize(SpreadsheetCellRange.$), _this._j, new AdapterIntRangeSet$1(SpreadsheetCellRange.$, _this._k, runOn(_this, _this._af), runOn(_this, _this._a0), runOn(_this, _this._ar)), _this, false);
        _this._j = h.p0;
        _this._ag = c;
        _this._l = a;
        _this._y = b;
        _this._be = new ReadOnlyNotifyCollection$1(SpreadsheetCellRange.$, _this._k);
        _this._k.add(new SpreadsheetCellRange(_this._n.row, _this._n.column));
        return _this;
    }
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype.e = function (sender, property, extraInfo) {
        if (sender == this) {
            switch (property) {
                case "AvailableColumnRange":
                    this._i._t();
                    break;
                case "AvailableRowRange":
                    this._j._t();
                    break;
            }
        }
        else if (sender == this._k) {
            this._bp = null;
        }
        _super.prototype.e.call(this, sender, property, extraInfo);
    };
    Object.defineProperty(SpreadsheetSelection.prototype, "activeCell", {
        /**
         * Returns the cell that represents the active cell.
         */
        get: function () {
            return this._n;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_r", {
        /**
         * @hidden
         */
        get: function () {
            return this._p;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "activeCellRangeIndex", {
        /**
         * Returns the index of the selection group that contains the active cell.
         */
        get: function () {
            return this._bl;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "cellRanges", {
        /**
         * Returns a read-only collection of the ranges of cells that are selected.
         */
        get: function () {
            return this._be;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "cellRangesAddress", {
        /**
         * Returns or sets a string containing the cell ranges in A1 cell reference mode.
         * <p class="note">
         * If there are multiple ranges then they are separated by the default union operator (',').
         * </p>
         */
        get: function () {
            if (this._bp == null) {
                this._bp = SpreadsheetCellRange._ag(this._be, 1);
            }
            return this._bp;
        },
        /**
         * Returns or sets a string containing the cell ranges in A1 cell reference mode.
         * <p class="note">
         * If there are multiple ranges then they are separated by the default union operator (',').
         * </p>
         */
        set: function (a) {
            if (stringIsNullOrEmpty(a)) {
                throw new ArgumentNullException(1);
            }
            var b = SpreadsheetCellRange._a(a);
            this._resetSelection(b, b[0]._c, 0, true);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_bf", {
        /**
         * @hidden
         */
        get: function () {
            return this._g;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_bg", {
        /**
         * @hidden
         */
        get: function () {
            return this._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_al", {
        /**
         * @hidden
         */
        get: function () {
            var a = this._bf;
            return a.count == 1 && a.item(0)._i <= this._ac._i && a.item(0)._h >= this._ac._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_am", {
        /**
         * @hidden
         */
        get: function () {
            var a = this._bg;
            return a.count == 1 && a.item(0)._i <= this._ad._i && a.item(0)._h >= this._ad._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_ac", {
        /**
         * @hidden
         */
        get: function () {
            return this._aa;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (!this._aa.equals(a)) {
                this._aa = a;
                this.a("AvailableColumnRange");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_ad", {
        /**
         * @hidden
         */
        get: function () {
            return this._ab;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (!this._ab.equals(a)) {
                this._ab = a;
                this.a("AvailableRowRange");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_x", {
        /**
         * @hidden
         */
        get: function () {
            return this._w;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (this._w != a) {
                this._w = a;
                this.a("CellSelectionMode");
                if (a == 2) {
                    this._av = false;
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_ax", {
        /**
         * @hidden
         */
        get: function () {
            if (nullableEquals(this._bo, null)) {
                this._bo = Nullable$1.toNullable(Boolean_$type, SpreadsheetCellRange._j(this._be));
            }
            return this._bo.value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_aw", {
        /**
         * @hidden
         */
        get: function () {
            if (nullableEquals(this._bn, null)) {
                this._bn = Nullable$1.toNullable(Boolean_$type, this._au());
            }
            return this._bn.value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_z", {
        /**
         * @hidden
         */
        get: function () {
            return this._y;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_v", {
        /**
         * @hidden
         */
        get: function () {
            return this._q;
        },
        /**
         * @hidden
         */
        set: function (a) {
            if (SpreadsheetCellRange.l_op_Inequality(this._q, a)) {
                this._q = a;
                this.a("RangeToUnselect");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_bi", {
        /**
         * @hidden
         */
        get: function () {
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_bj", {
        /**
         * @hidden
         */
        get: function () {
            return this._j;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetSelection.prototype, "_m", {
        /**
         * @hidden
         */
        get: function () {
            return this._l;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetSelection.prototype.addActiveCellRange = function () {
        var n;
        if (arguments.length === 2) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        else if (arguments.length === 3) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0: return this._addActiveCellRange1.apply(this, arguments);
            case 1: return this._addActiveCellRange2.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._addActiveCellRange2 = function (a, b, c) {
        if (c === void 0) { c = true; }
        return this._addActiveCellRange1(new SpreadsheetCellRange(a), new SpreadsheetCell(b), c);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._addActiveCellRange1 = function (a, b, c) {
        if (c === void 0) { c = true; }
        if (!a._contains(b)) {
            throw new ArgumentException(0);
        }
        if (c) {
            var d = this._bt(a);
            a = d.p0;
        }
        return this._ak(a, b, this._t(b));
    };
    SpreadsheetSelection.prototype.addCellRange = function () {
        var n;
        if (arguments.length === 1) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        else if (arguments.length === 2) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0: return this._addCellRange.apply(this, arguments);
            case 1: return this._addCellRange1.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._addCellRange1 = function (a, b) {
        if (b === void 0) { b = true; }
        this._addCellRange(new SpreadsheetCellRange(a), b);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._addCellRange = function (a, b) {
        if (b === void 0) { b = true; }
        if (b) {
            var c = this._bt(a);
            a = c.p0;
        }
        {
            var d = this._bk();
            try {
                try {
                    this._k.beginUpdate();
                    this._k.add(a);
                }
                finally {
                    this._k.endUpdate();
                }
            }
            finally {
                if (d != null) {
                    d.dispose();
                }
            }
        }
        this._bu();
    };
    /**
     * Resets the [[cellRanges]] to a single range containing only the [[activeCell]]
     */
    SpreadsheetSelection.prototype.clearCellRanges = function () {
        return this._a9(this.activeCell);
    };
    SpreadsheetSelection.prototype.replaceActiveCellRange = function () {
        var n;
        if (arguments.length === 2) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        else if (arguments.length === 3) {
            if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0: return this._replaceActiveCellRange1.apply(this, arguments);
            case 1: return this._replaceActiveCellRange2.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._replaceActiveCellRange2 = function (a, b, c) {
        if (c === void 0) { c = true; }
        return this._replaceActiveCellRange1(new SpreadsheetCellRange(a), new SpreadsheetCell(b), c);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._replaceActiveCellRange1 = function (a, b, c) {
        if (c === void 0) { c = true; }
        if (c) {
            var d = this._bt(a);
            a = d.p0;
        }
        if (!a._contains(b)) {
            throw new ArgumentException(0);
        }
        return this._a7(a, b);
    };
    SpreadsheetSelection.prototype.resetSelection = function () {
        var n;
        if (arguments.length === 2) {
            n = 1;
        }
        else if (arguments.length === 3) {
            if (arguments[0] instanceof Array) {
                n = 0;
            }
            else if (typeCast(SpreadsheetCellRange.$, arguments[0]) !== null) {
                n = 1;
            }
            else if (typeof arguments[0] === 'string') {
                n = 2;
            }
            else if (arguments[0] == null) {
                if (typeCast(SpreadsheetCell.$, arguments[1]) !== null) {
                    n = 0;
                }
                else if (typeof arguments[1] === 'string') {
                    n = 2;
                }
                else if (arguments[1] == null) {
                    n = 2;
                }
            }
        }
        else if (arguments.length === 4) {
            if (arguments[0] instanceof Array) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 2;
            }
            else if (arguments[0] == null) {
                if (typeCast(SpreadsheetCell.$, arguments[1]) !== null) {
                    n = 0;
                }
                else if (typeof arguments[1] === 'string') {
                    n = 2;
                }
                else if (arguments[1] == null) {
                    n = 2;
                }
            }
        }
        switch (n) {
            case 0: return this._resetSelection.apply(this, arguments);
            case 1: return this._resetSelection2.apply(this, arguments);
            case 2: return this._resetSelection3.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._resetSelection2 = function (a, b, c) {
        if (c === void 0) { c = true; }
        if (!a._contains(b)) {
            throw new ArgumentException(0);
        }
        return this._resetSelection([a], b, 0, c);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._resetSelection3 = function (a, b, c, d) {
        if (d === void 0) { d = true; }
        return this._resetSelection(SpreadsheetCellRange._a(a), new SpreadsheetCell(b), c, d);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._resetSelection = function (a, b, c, d) {
        if (d === void 0) { d = true; }
        CoreUtilities.z(a, "ranges");
        if (a.length == 0) {
            throw new ArgumentException(0);
        }
        if (c < 0 || c >= a.length) {
            throw new ArgumentOutOfRangeException(0);
        }
        if (!a[c]._contains(b)) {
            throw new ArgumentException(0);
        }
        var e = SpreadsheetCell.l_op_Inequality(b, this.activeCell);
        var f = this.cellRanges.count != a.length;
        if (!f) {
            for (var g = 0; g < a.length; g++) {
                if (!a[g]._equals(this._be.item(g))) {
                    f = true;
                    break;
                }
            }
        }
        if (e && !this._a2(b)) {
            return false;
        }
        var h = d ? this._t(b) : new SpreadsheetCellRange(b.row, b.column);
        if (d) {
            if (a.length != 1 || SpreadsheetCellRange.l_op_Inequality(a[c], h)) {
                for (var i = 0; i < a.length; i++) {
                    var j = this._bt(a[i]);
                    a[i] = j.p0;
                }
            }
        }
        {
            var k = this._bk();
            try {
                try {
                    if (f) {
                        this._k.beginUpdate();
                        this._k.clear();
                        this._k._a3(a);
                    }
                    this._bv(b, c, h);
                }
                finally {
                    if (f) {
                        this._k.endUpdate();
                    }
                }
            }
            finally {
                if (k != null) {
                    k.dispose();
                }
            }
        }
        if (f) {
            this._bu();
        }
        return true;
    };
    SpreadsheetSelection.prototype.setActiveCell = function () {
        var n;
        if (arguments.length === 1) {
            if (typeCast(SpreadsheetCell.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        else if (arguments.length === 2) {
            if (typeCast(SpreadsheetCell.$, arguments[0]) !== null) {
                n = 0;
            }
            else if (typeof arguments[0] === 'string') {
                n = 1;
            }
            else if (arguments[0] == null) {
                n = 1;
            }
        }
        switch (n) {
            case 0:
                if (arguments[1] !== void 0) {
                    arguments[1] = wrapNullable(Number_$type, arguments[1]);
                }
                return this._setActiveCell.apply(this, arguments);
            case 1:
                if (arguments[1] !== void 0) {
                    arguments[1] = wrapNullable(Number_$type, arguments[1]);
                }
                return this._setActiveCell1.apply(this, arguments);
            default: throw new Error('Invalid arguments');
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._setActiveCell1 = function (a, b) {
        if (b === void 0) { b = Nullable$1.toNullable(Number_$type, null); }
        return this._setActiveCell(new SpreadsheetCell(a), b);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._setActiveCell = function (a, b) {
        if (b === void 0) { b = Nullable$1.toNullable(Number_$type, null); }
        var c = !nullableIsNull(b) ? b.value : this.activeCellRangeIndex;
        var d = this._be.count;
        var e = d;
        for (var f = c, g = c + this._be.count; f < g; f++) {
            if (this._be.item(f % d)._contains(a)) {
                e = f % d;
                break;
            }
        }
        if (e == d) {
            return this._a9(a);
        }
        else {
            if (SpreadsheetCell.l_op_Inequality(a, this.activeCell) && !this._a2(a)) {
                return false;
            }
            this._bv(a, e, this._t(a));
            return true;
        }
    };
    /**
     * Deselect the cells in the specified range.
     * <p class="note"><b>Note:</b> if the specified range encompasses all the cells in the selection, the selection will be changed to only include the current [[activeCell]].</p>
     * @param range The range whose cells should be removed from the selection.
     */
    SpreadsheetSelection.prototype.unselectRange = function (range) {
        var a = null;
        var b = -1;
        var c = this._n;
        for (var d = 0; d < this._be.count; d++) {
            var e = this._be.item(d);
            if (e.intersectsWith(range)) {
                if (a == null) {
                    a = new List$1(SpreadsheetCellRange.$, 0);
                    for (var f = 0; f < d; f++) {
                        a.add(this._be.item(f));
                    }
                }
                if (range._contains1(e)) {
                    continue;
                }
                var g = a.count;
                if (range.firstRow > e.firstRow) {
                    a.add(new SpreadsheetCellRange(e.firstRow, e.firstColumn, range.firstRow - 1, e.lastColumn));
                }
                if (range.firstColumn > e.firstColumn) {
                    a.add(new SpreadsheetCellRange(Math.max(range.firstRow, e.firstRow), e.firstColumn, Math.min(range.lastRow, e.lastRow), range.firstColumn - 1));
                }
                if (range.lastColumn < e.lastColumn) {
                    a.add(new SpreadsheetCellRange(Math.max(range.firstRow, e.firstRow), range.lastColumn + 1, Math.min(range.lastRow, e.lastRow), e.lastColumn));
                }
                if (range.lastRow < e.lastRow) {
                    a.add(new SpreadsheetCellRange(range.lastRow + 1, e.firstColumn, e.lastRow, e.lastColumn));
                }
                if (b < 0 && d >= this._bl) {
                    if (d > this._bl || range._contains(this._n)) {
                        b = g;
                        c = a._inner[b]._c;
                    }
                    else {
                        for (var h = g; h < a.count; h++) {
                            if (a._inner[h]._contains(this._n)) {
                                b = h;
                                break;
                            }
                        }
                    }
                }
            }
            else {
                if (b < 0 && d >= this._bl) {
                    b = a == null ? d : a.count;
                    c = d == this._bl ? this._n : e._c;
                }
                if (a != null) {
                    a.add(e);
                }
            }
        }
        if (a != null) {
            if (a.count == 0) {
                a.add(new SpreadsheetCellRange(c.row, c.column));
            }
            if (b < 0) {
                b = 0;
                c = a._inner[0]._c;
            }
            this._resetSelection(a.toArray(), c, b, false);
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ah = function (a) {
        var b = this._t(a);
        return this._ak(b, a, b);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ao = function (a) {
        for (var b = 0; b < this._be.count; b++) {
            if (this._be.item(b)._contains(a)) {
                return true;
            }
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ap = function (a) {
        for (var b = 0; b < this._be.count; b++) {
            if (this._be.item(b)._contains1(a)) {
                return true;
            }
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bk = function () {
        return new Spreadsheet_SynchronizationSuspender(this._l);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._as = function (a, b) {
        if (b === void 0) { b = true; }
        var c = b ? this._t(a) : new SpreadsheetCellRange(a.row, a.column);
        return this._at(c, b);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._at = function (a, b) {
        if (b === void 0) { b = true; }
        a = a.union(this._r);
        if (b) {
            var c = this._bt(a);
            a = c.p0;
        }
        return this._a7(a, this.activeCell);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bt = function (a) {
        a = this._y._s.extendRangeForMergedCells(a);
        return {
            p0: a
        };
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._s = function () {
        this._by();
        return this.cellRanges.item(this.activeCellRangeIndex);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._t = function (a) {
        return this._y._s.getCellRange(a);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._u = function (a) {
        var e_83, _0, e_84, _1, e_85, _2;
        var b = SpreadsheetCellRange.empty;
        var c = this.activeCell;
        try {
            for (var _3 = tslib_1.__values(fromEnum(this.cellRanges)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                var d = _4.value;
                var e = this._a0(d);
                var f = this._az(d);
                if (e == f || a == false) {
                    b = b.union(d);
                }
                else if (f) {
                    if (this._bj.count > 0) {
                        try {
                            for (var _5 = tslib_1.__values(fromEnum(this._bj)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                var g = _6.value;
                                b = b.union(new SpreadsheetCellRange(g._i, d.firstColumn, g._h, d.lastColumn));
                            }
                        }
                        catch (e_84_1) { e_84 = { error: e_84_1 }; }
                        finally {
                            try {
                                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                            }
                            finally { if (e_84) throw e_84.error; }
                        }
                    }
                    else {
                        b = b.union(new SpreadsheetCellRange(c.row, d.firstColumn, c.row, d.lastColumn));
                    }
                }
                else {
                    if (this._bi.count > 0) {
                        try {
                            for (var _7 = tslib_1.__values(fromEnum(this._bi)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                var h = _8.value;
                                b = b.union(new SpreadsheetCellRange(d.firstRow, h._i, d.lastRow, h._h));
                            }
                        }
                        catch (e_85_1) { e_85 = { error: e_85_1 }; }
                        finally {
                            try {
                                if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                            }
                            finally { if (e_85) throw e_85.error; }
                        }
                    }
                    else {
                        b = b.union(new SpreadsheetCellRange(d.firstRow, c.column, d.lastRow, c.column));
                    }
                }
            }
        }
        catch (e_83_1) { e_83 = { error: e_83_1 }; }
        finally {
            try {
                if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
            }
            finally { if (e_83) throw e_83.error; }
        }
        return b;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ay = function (a) {
        for (var b = 0; b < this._be.count; b++) {
            if (this._be.item(b).intersectsWith(a)) {
                return true;
            }
        }
        return false;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._az = function (a) {
        return a.firstRow <= this._ab._i && a.lastRow >= this._ab._h;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a0 = function (a) {
        return a.firstColumn <= this._aa._i && a.lastColumn >= this._aa._h;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a1 = function (a) {
        return a == this._k || a == this._be;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a2 = function (a) {
        if (this._ag) {
            return true;
        }
        return this._l._dt(a);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a3 = function () {
        return this._l._d7(true);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bu = function () {
        this._bn = Nullable$1.toNullable(Boolean_$type, null);
        this._bo = Nullable$1.toNullable(Boolean_$type, null);
        if (!this._y._am && !this._ag) {
            this._l._h5(new SpreadsheetSelectionChangedEventArgs(this._y));
        }
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a4 = function (a) {
        return this._a7(this._t(a), a);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a9 = function (a) {
        var b = this._t(a);
        return this._resetSelection2(b, a, true);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bw = function (a, b) {
        var c = new Array(this.cellRanges.count);
        for (var d = 0; d < c.length; d++) {
            var e = this.cellRanges.item(d);
            c[d] = new SpreadsheetCellRange(e.firstRow + a, e.firstColumn + b, e.lastRow + a, e.lastColumn + b);
        }
        var f = new SpreadsheetCell(this.activeCell.row + a, this.activeCell.column + b);
        this._resetSelection(c, f, this.activeCellRangeIndex, false);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._by = function () {
        for (var a = this._bl; a < this._k.count; a++) {
            if (this._k._inner[a]._contains(this._n)) {
                this._bl = a;
                return;
            }
        }
        if (this._bl > 0) {
            for (var b = this._bl - 1; b >= 0; b--) {
                if (this._k._inner[b]._contains(this._n)) {
                    this._bl = b;
                    return;
                }
            }
        }
        this._a9(this._n);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bz = function () {
        this._bv(this.activeCell, this.activeCellRangeIndex, this._t(this.activeCell));
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ak = function (a, b, c) {
        if (SpreadsheetCell.l_op_Inequality(b, this.activeCell) && !this._a2(b)) {
            return false;
        }
        {
            var d = this._bk();
            try {
                try {
                    this._k.beginUpdate();
                    this._k.add(a);
                    this._bv(b, this._k.count - 1, c);
                }
                finally {
                    this._k.endUpdate();
                }
            }
            finally {
                if (d != null) {
                    d.dispose();
                }
            }
        }
        this._bu();
        return true;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ar = function (a, b) {
        return a + 1 >= b;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._ae = function (a) {
        return new IntRange(1, a.firstColumn, a.lastColumn);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._au = function () {
        var e_86, _0;
        if (this._be.count < 2) {
            return false;
        }
        var a = false;
        var b = false;
        var c = false;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._be)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                var e = true;
                if (this._az(d)) {
                    a = true;
                    e = false;
                }
                if (this._a0(d)) {
                    b = true;
                    e = false;
                }
                if (e) {
                    c = true;
                }
            }
        }
        catch (e_86_1) { e_86 = { error: e_86_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_86) throw e_86.error; }
        }
        return c && (b || a);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._af = function (a) {
        return new IntRange(1, a.firstRow, a.lastRow);
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._aq = function (a) {
        return this._be.count == 1 && a._equals(this._be.item(0));
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._a7 = function (a, b) {
        var c = !this._k._inner[this.activeCellRangeIndex]._equals(a);
        var d = SpreadsheetCell.l_op_Inequality(b, this.activeCell);
        if (d && !this._a2(b)) {
            return false;
        }
        {
            var e = this._bk();
            try {
                try {
                    if (c) {
                        this._k.beginUpdate();
                        this._k.item(this.activeCellRangeIndex, a);
                    }
                    if (d) {
                        this._bv(b, this.activeCellRangeIndex, this._t(b));
                    }
                }
                finally {
                    if (c) {
                        this._k.endUpdate();
                    }
                }
            }
            finally {
                if (e != null) {
                    e.dispose();
                }
            }
        }
        if (c) {
            this._bu();
        }
        return true;
    };
    /**
     * @hidden
     */
    SpreadsheetSelection.prototype._bv = function (a, b, c) {
        var d = this.activeCellRangeIndex;
        var e = this._r;
        var f = this.activeCell;
        this._bl = b;
        this._p = c;
        this._n = a;
        if (d != b) {
            this.a("ActiveCellRangeIndex");
        }
        if (SpreadsheetCellRange.l_op_Inequality(e, c)) {
            this.a("ActiveCellAsRange");
        }
        if (SpreadsheetCell.l_op_Inequality(f, a)) {
            this.a("ActiveCell");
        }
    };
    SpreadsheetSelection.$t = markType(SpreadsheetSelection, 'SpreadsheetSelection', PropertyChangeNotifierExtended.$);
    return SpreadsheetSelection;
}(PropertyChangeNotifierExtended));
export { SpreadsheetSelection };
/**
 * @hidden
 */
var SelectionSnapshot = /** @class */ (function (_super) {
    tslib_1.__extends(SelectionSnapshot, _super);
    function SelectionSnapshot(a, b, c, d) {
        var _this = _super.call(this) || this;
        _this._a = null;
        _this._j = 0;
        _this._g = new SpreadsheetCell();
        _this._k = null;
        _this._k = new WeakReference(a);
        _this._g = c;
        _this._a = b;
        _this._j = d;
        return _this;
    }
    Object.defineProperty(SelectionSnapshot.prototype, "_h", {
        get: function () {
            return typeCast(Worksheet.$, CoreUtilities.p(this._k));
        },
        enumerable: true,
        configurable: true
    });
    SelectionSnapshot._d = function (a, b) {
        return new SelectionSnapshot(a, Enumerable.a(SpreadsheetCellRange.$, b.cellRanges), b.activeCell, b.activeCellRangeIndex);
    };
    SelectionSnapshot._b = function (a, b) {
        return SelectionSnapshot._c(a, b, b._c);
    };
    SelectionSnapshot._c = function (a, b, c) {
        return new SelectionSnapshot(a, [b], c, 0);
    };
    SelectionSnapshot.prototype.equals = function (a) {
        return a != null && this._g._equals(a._g) && this._j == a._j && CoreUtilities.d(SpreadsheetCellRange.$, boxArray$1(this._a), boxArray$1(a._a)) && a._h == this._h;
    };
    SelectionSnapshot.prototype._i = function (a, b) {
        return this._g._equals(b.activeCell) && this._j == b.activeCellRangeIndex && CoreUtilities.d(SpreadsheetCellRange.$, boxArray$1(this._a), b.cellRanges) && a == this._h;
    };
    SelectionSnapshot.prototype._f = function (a, b, c, d) {
        if (d != 0 && a != this._h) {
            return this;
        }
        switch (d) {
            default:
            case 0: return SelectionSnapshot._c(a, b, c);
            case 1:
                var e = SpreadsheetPaneManager._getCellRange2(c.row, c.column, a);
                var f = Enumerable.z(SpreadsheetCellRange.$, this._a);
                var g = b.union(e);
                g = SpreadsheetPaneManager._extendRangeForMergedCells1(a, g, null);
                f._inner[this._j] = g;
                return new SelectionSnapshot(a, f.toArray(), this._g, this._j);
            case 2:
                var h = Enumerable.z(SpreadsheetCellRange.$, this._a);
                h.add(SpreadsheetPaneManager._extendRangeForMergedCells1(a, b, null));
                return new SelectionSnapshot(a, h.toArray(), c, h.count - 1);
        }
    };
    SelectionSnapshot.prototype._e = function (a, b, c) {
        return this._f(a, b, b._c, c);
    };
    SelectionSnapshot.$t = markType(SelectionSnapshot, 'SelectionSnapshot', Base.$, [IEquatable$1_$type.specialize(-1)]).initSelfReferences();
    return SelectionSnapshot;
}(Base));
export { SelectionSnapshot };
/**
 * @hidden
 */
var EditModeWorkbookFont = /** @class */ (function (_super) {
    tslib_1.__extends(EditModeWorkbookFont, _super);
    function EditModeWorkbookFont(a) {
        var _this = _super.call(this) || this;
        _this._k = true;
        _this._g = null;
        _this._h = null;
        _this._i = null;
        CoreUtilities.y(a);
        _this._i = a;
        _this._g = new EditModeWorkbookFontInfo();
        _this._h = new EditModeWorkbookFontInfo();
        return _this;
    }
    Object.defineProperty(EditModeWorkbookFont.prototype, "bold", {
        get: function () {
            return unwrapNullable(this._bold$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._bold$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "_bold$i", {
        get: function () {
            this._x();
            return this._g.e;
        },
        set: function (a) {
            this._p(nullableEquals(a, true));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "_j", {
        get: function () {
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "colorInfo", {
        get: function () {
            this._x();
            return this._g.c;
        },
        set: function (a) {
            this._q(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "_l", {
        get: function () {
            return WorksheetCellFormatData._c8(2048);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "height", {
        get: function () {
            this._x();
            return this._g.d;
        },
        set: function (a) {
            this._r(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "italic", {
        get: function () {
            return unwrapNullable(this._italic$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._italic$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "_italic$i", {
        get: function () {
            this._x();
            return this._g.f;
        },
        set: function (a) {
            this._s(nullableEquals(a, true));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "name", {
        get: function () {
            this._x();
            return this._g.i;
        },
        set: function (a) {
            this._t(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "strikeout", {
        get: function () {
            return unwrapNullable(this._strikeout$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._strikeout$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "_strikeout$i", {
        get: function () {
            this._x();
            return this._g.g;
        },
        set: function (a) {
            this._u(nullableEquals(a, true));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "superscriptSubscriptStyle", {
        get: function () {
            this._x();
            return this._g.a;
        },
        set: function (a) {
            if (a == -1) {
                a = 0;
            }
            this._v(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EditModeWorkbookFont.prototype, "underlineStyle", {
        get: function () {
            this._x();
            return this._g.b;
        },
        set: function (a) {
            if (a == -1) {
                a = 0;
            }
            this._w(a);
        },
        enumerable: true,
        configurable: true
    });
    EditModeWorkbookFont.prototype._m = function (a) {
        if (a === void 0) { a = true; }
        if (this._k == false) {
            this._k = true;
            if (a) {
                this._o();
            }
        }
    };
    EditModeWorkbookFont.prototype._o = function () {
        this.a(stringEmpty());
    };
    EditModeWorkbookFont.prototype._x = function () {
        if (this._k) {
            this._k = false;
            this._y();
        }
    };
    EditModeWorkbookFont.prototype._y = function () {
        this._n(this._h);
        var a = this._g.h(this._h);
    };
    EditModeWorkbookFont.$t = markType(EditModeWorkbookFont, 'EditModeWorkbookFont', PropertyChangeNotifierExtended.$, [IWorkbookFont_$type]);
    return EditModeWorkbookFont;
}(PropertyChangeNotifierExtended));
export { EditModeWorkbookFont };
/**
 * @hidden
 */
var LockedEditRangeInfoForCellRange = /** @class */ (function (_super) {
    tslib_1.__extends(LockedEditRangeInfoForCellRange, _super);
    function LockedEditRangeInfoForCellRange() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    LockedEditRangeInfoForCellRange.prototype.f = function (a, b) {
    };
    LockedEditRangeInfoForCellRange.prototype.b = function (a, b, c) {
        var d = a.index;
        for (var e = b; e <= c; e++) {
            if (!this.c(d, e)) {
                return false;
            }
        }
        return true;
    };
    LockedEditRangeInfoForCellRange.a = function (a, b, c, d, e) {
        var e_87, _0, e_88, _1;
        if (a != null && a.b.protection._allowedEditRanges$i.count > 0) {
            var f = new SpreadsheetCellRange(b, c, d, e);
            var g = new List$1(WorksheetProtectedRange.$, 0);
            var h = new List$1(WorksheetProtectedRange.$, 0);
            var i = SpreadsheetUtilities.ay(f);
            try {
                for (var _2 = tslib_1.__values(fromEnum(a.b.protection._allowedEditRanges$i)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var j = _3.value;
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(j.ranges)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var k = _5.value;
                            if (k._h._j(i)) {
                                var l = j.isProtected && j.hasPassword ? g : h;
                                l.add(j);
                                break;
                            }
                        }
                    }
                    catch (e_88_1) { e_88 = { error: e_88_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_88) throw e_88.error; }
                    }
                }
            }
            catch (e_87_1) { e_87 = { error: e_87_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_87) throw e_87.error; }
            }
            if (h.count > 0 || g.count > 0) {
                var m = new LockedEditRangeInfoForCellRange_WithRanges(a, g, h);
                return m;
            }
        }
        return a == null ? LockedEditRangeInfoForCellRange_WithoutRanges.g : new LockedEditRangeInfoForCellRange_WithoutRanges(a);
    };
    LockedEditRangeInfoForCellRange.prototype.e = function (a, b) {
        return false;
    };
    LockedEditRangeInfoForCellRange.$t = markType(LockedEditRangeInfoForCellRange, 'LockedEditRangeInfoForCellRange');
    return LockedEditRangeInfoForCellRange;
}(Base));
export { LockedEditRangeInfoForCellRange };
/**
 * @hidden
 */
var LockedEditRangeInfoForCellRange_WithRanges = /** @class */ (function (_super) {
    tslib_1.__extends(LockedEditRangeInfoForCellRange_WithRanges, _super);
    function LockedEditRangeInfoForCellRange_WithRanges(a, b, c) {
        var _this = _super.call(this) || this;
        _this.h = null;
        _this.j = null;
        _this.g = null;
        _this.i = null;
        a.j(b);
        a.j(c);
        _this.g = a;
        _this.j = LockedEditRangeInfoForCellRange_WithRanges.k(c);
        _this.h = LockedEditRangeInfoForCellRange_WithRanges.k(b);
        return _this;
    }
    LockedEditRangeInfoForCellRange_WithRanges.prototype.f = function (a, b) {
        if (this.i == null) {
            this.i = new List$1(IntRange.$, 0);
        }
        this.i.add(new IntRange(1, a, b));
    };
    LockedEditRangeInfoForCellRange_WithRanges.prototype.c = function (a, b) {
        var e_89, _0, e_90, _1;
        if (this.j != null) {
            try {
                for (var _2 = tslib_1.__values(fromEnum(this.j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var c = _3.value;
                    if (c._contains2(a, b)) {
                        return true;
                    }
                }
            }
            catch (e_89_1) { e_89 = { error: e_89_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_89) throw e_89.error; }
            }
        }
        if (this.h != null) {
            try {
                for (var _4 = tslib_1.__values(fromEnum(this.h)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var d = _5.value;
                    if (d._contains2(a, b)) {
                        return this.g.e(a, b);
                    }
                }
            }
            catch (e_90_1) { e_90 = { error: e_90_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_90) throw e_90.error; }
            }
        }
        this.g.k();
        return false;
    };
    LockedEditRangeInfoForCellRange_WithRanges.prototype.d = function (a, b) {
        var e_91, _0;
        if (this.i != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this.i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    for (var d = c._i; d <= c._h; d++) {
                        for (var e = a; e <= b; e++) {
                            if (!this.c(d, e)) {
                                return false;
                            }
                        }
                    }
                }
            }
            catch (e_91_1) { e_91 = { error: e_91_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_91) throw e_91.error; }
            }
        }
        return true;
    };
    LockedEditRangeInfoForCellRange_WithRanges.k = function (a) {
        var e_92, _0, e_93, _1;
        if (a != null && a.count != 0) {
            var b = new List$1(SpreadsheetCellRange.$, 0);
            try {
                for (var _2 = tslib_1.__values(fromEnum(a)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var c = _3.value;
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(c.ranges)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var d = _5.value;
                            b.add(SpreadsheetUtilities.z(d._h));
                        }
                    }
                    catch (e_93_1) { e_93 = { error: e_93_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_93) throw e_93.error; }
                    }
                }
            }
            catch (e_92_1) { e_92 = { error: e_92_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_92) throw e_92.error; }
            }
            for (var e = b.count - 1; e >= 1; e--) {
                var f = b._inner[e];
                for (var g = e - 1; g >= 0; g--) {
                    var h = b._inner[g];
                    if (h._contains1(f) || SpreadsheetCellRange.l_op_Equality(h, f)) {
                        b.removeAt(e);
                        break;
                    }
                    else if (f._contains1(h)) {
                        b.removeAt(g);
                        e--;
                    }
                }
            }
            if (b.count > 0) {
                return b;
            }
        }
        return null;
    };
    LockedEditRangeInfoForCellRange_WithRanges.prototype.e = function (a, b) {
        var e_94, _0;
        if (this.j != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this.j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    if (c._contains2(a, b)) {
                        return true;
                    }
                }
            }
            catch (e_94_1) { e_94 = { error: e_94_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_94) throw e_94.error; }
            }
        }
        return false;
    };
    LockedEditRangeInfoForCellRange_WithRanges.$t = markType(LockedEditRangeInfoForCellRange_WithRanges, 'LockedEditRangeInfoForCellRange_WithRanges', LockedEditRangeInfoForCellRange.$);
    return LockedEditRangeInfoForCellRange_WithRanges;
}(LockedEditRangeInfoForCellRange));
export { LockedEditRangeInfoForCellRange_WithRanges };
/**
 * @hidden
 */
var LockedEditRangeInfoForCellRange_WithoutRanges = /** @class */ (function (_super) {
    tslib_1.__extends(LockedEditRangeInfoForCellRange_WithoutRanges, _super);
    function LockedEditRangeInfoForCellRange_WithoutRanges(a) {
        var _this = _super.call(this) || this;
        _this.h = null;
        _this.h = a;
        return _this;
    }
    LockedEditRangeInfoForCellRange_WithoutRanges.prototype.c = function (a, b) {
        if (this.h != null) {
            this.h.k();
        }
        return false;
    };
    LockedEditRangeInfoForCellRange_WithoutRanges.prototype.d = function (a, b) {
        if (this.h != null) {
            this.h.k();
        }
        return false;
    };
    LockedEditRangeInfoForCellRange_WithoutRanges.prototype.b = function (a, b, c) {
        if (this.h != null) {
            this.h.k();
        }
        return false;
    };
    LockedEditRangeInfoForCellRange_WithoutRanges.$t = markType(LockedEditRangeInfoForCellRange_WithoutRanges, 'LockedEditRangeInfoForCellRange_WithoutRanges', LockedEditRangeInfoForCellRange.$);
    LockedEditRangeInfoForCellRange_WithoutRanges.g = new LockedEditRangeInfoForCellRange_WithoutRanges(null);
    return LockedEditRangeInfoForCellRange_WithoutRanges;
}(LockedEditRangeInfoForCellRange));
export { LockedEditRangeInfoForCellRange_WithoutRanges };
/**
 * @hidden
 */
var SpreadsheetEditHelper = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetEditHelper, _super);
    function SpreadsheetEditHelper(a, b, c, d, e, f, g) {
        var _this = _super.call(this) || this;
        _this.m = false;
        _this.z = 0;
        _this.j = null;
        _this.i = null;
        _this.k = null;
        _this.a = null;
        _this.c = new SpreadsheetCell();
        _this.y = null;
        _this.x = null;
        CoreUtilities.z(a, "sheetManager");
        CoreUtilities.z(b, "editPane");
        CoreUtilities.z(f, "promptCallback");
        CoreUtilities.z(g, "executeInUndo");
        _this.j = a;
        _this.i = b;
        _this.a = Enumerable.a(Worksheet.$, Enumerable.o(SpreadsheetTabInfo.$, Worksheet.$, _this.j._a3._j, function (h) { return h._j; }));
        _this.c = c;
        _this.k = a._bc.workbook;
        _this.y = f;
        _this.m = d;
        _this.z = e;
        _this.x = g;
        return _this;
    }
    SpreadsheetEditHelper.ad = function (a, b, c, d, e) {
        e = -1;
        var f = b.unformattedText;
        var g = a.g;
        var h = b.editCellFormat._dg;
        var i = new ValueFormatter(1, h, g, null);
        var j = false;
        var k = false;
        if (i.o) {
            k = i.k(0);
            for (var l = 0; l < 4; l++) {
                if (i.m(l)) {
                    j = true;
                    break;
                }
            }
        }
        var m = WorksheetCellBlock.q(h);
        if (stringIsNullOrEmpty(f)) {
            return {
                ret: null,
                p4: e
            };
        }
        else if (stringIsNullOrWhiteSpace(f) || (j == false && m == false && i.j())) {
        }
        else if (f.length > 1 && stringStartsWith(f, "=")) {
            var n = SpreadsheetEditHelper.ac(a, c, f);
            if (typeCast(Formula.$, n) !== null || d == false) {
                return {
                    ret: n,
                    p4: e
                };
            }
        }
        else if (f.indexOf('\r') >= 0 || f.indexOf('\n') >= 0) {
        }
        else if (stringCompare1("true", f, 3) == 0) {
            return {
                ret: SpreadsheetEditHelper.ae,
                p4: e
            };
        }
        else if (stringCompare1("false", f, 3) == 0) {
            return {
                ret: SpreadsheetEditHelper.ab,
                p4: e
            };
        }
        else {
            if (stringStartsWith(f, "#")) {
                var o = FormulaParser.b(f, g);
                if (o != null) {
                    if (ErrorValue.circularity != o) {
                        return {
                            ret: o,
                            p4: e
                        };
                    }
                    return {
                        ret: b,
                        p4: e
                    };
                }
            }
            var p_1;
            var q_2;
            var r_2 = false;
            if (m || k) {
                if (!r_2 && ((function () { var s = SpreadsheetEditHelper.t(f, true, a, p_1, e, r_2); p_1 = s.p3; e = s.p4; r_2 = s.p5; return s.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
                if (!r_2 && ((function () { var s = SpreadsheetEditHelper.r(f, a, q_2, e); q_2 = s.p2; e = s.p3; return s.ret; })())) {
                    return {
                        ret: q_2,
                        p4: e
                    };
                }
            }
            else {
                if (!r_2 && ((function () { var s = SpreadsheetEditHelper.t(f, false, a, p_1, e, r_2); p_1 = s.p3; e = s.p4; r_2 = s.p5; return s.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
                if (!r_2 && ((function () { var s = SpreadsheetEditHelper.r(f, a, q_2, e); q_2 = s.p2; e = s.p3; return s.ret; })())) {
                    return {
                        ret: q_2,
                        p4: e
                    };
                }
            }
            var s_2 = 0;
            if (!r_2 && ((function () { var t = SpreadsheetEditHelper.w(f, a, s_2, e); s_2 = t.p2; e = t.p3; return t.ret; })())) {
                return {
                    ret: ExcelCalcValue._ay(s_2, true),
                    p4: e
                };
            }
            if (!r_2) {
                if (((function () { var t = SpreadsheetEditHelper.v(f, a, p_1, e); p_1 = t.p2; e = t.p3; return t.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
                if (((function () { var t = SpreadsheetEditHelper.s(f, a, p_1, e); p_1 = t.p2; e = t.p3; return t.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
                if (((function () { var t = SpreadsheetEditHelper.q(f, a, p_1, e, r_2); p_1 = t.p2; e = t.p3; r_2 = t.p4; return t.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
                var t_3 = a.f ? a.j : 0;
                if (!r_2 && ((function () { var u = SpreadsheetEditHelper.u(f, a, t_3, p_1, e); p_1 = u.p3; e = u.p4; return u.ret; })())) {
                    return {
                        ret: p_1,
                        p4: e
                    };
                }
            }
            if (f.length > 1 && (stringStartsWith(f, "-") || stringStartsWith(f, "+"))) {
                var u = SpreadsheetEditHelper.ac(a, c, "=" + f);
                if (typeCast(Formula.$, u) !== null || d == false) {
                    return {
                        ret: u,
                        p4: e
                    };
                }
            }
        }
        return {
            ret: b,
            p4: e
        };
    };
    SpreadsheetEditHelper.prototype.e = function (a, b, c, d, e) {
        var _this = this;
        var e_95, _0, e_96, _1;
        if (a == 0) {
            return 0;
        }
        var f;
        var g = ((function () { var h = SpreadsheetEditHelper.ad(new ParseEditValueCache(_this), b, a == 3, false, f); f = h.p4; return h.ret; })());
        var h = false;
        if (g == b) {
            var i = SpreadsheetEditHelper.d(b, this.k, e);
            if (i != null && stringContains(i.c, "\n")) {
                h = true;
            }
            g = i;
        }
        var j = b.editCellFormat;
        var k = this.c;
        if (typeCast(SpreadsheetUserPromptInfo.$, g) !== null) {
            var l = typeCast(SpreadsheetUserPromptInfo.$, g);
            this.y(l);
            return 1;
        }
        var m = this.i._ag;
        var n = this.j;
        var o = Enumerable.a(SpreadsheetCellRange.$, m.cellRanges);
        var p = o;
        var q;
        var r = nullableNotEquals(n._en(), false);
        var s = r ? new LockedEditRangeInfoForOperation() : null;
        var t = new HashSet$1(IRegionBlockingValue_$type, 0);
        if (typeCast(ArrayFormula.$, g) !== null) {
            var u_2 = m._s();
            var v_2 = typeCast(ArrayFormula.$, g);
            var w_2 = new List$1(WorksheetRegion.$, 0);
            if (n._bq(u_2) == false) {
                q = 1;
            }
            else {
                if (s != null && !((function () { var x = n._c7(s, boxArray$1([u_2]), c, q); q = x.p3; return x.ret; })())) {
                    return q;
                }
                try {
                    for (var _2 = tslib_1.__values(fromEnum(n._a3._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var x = _3.value;
                        w_2.add(x._j._cx(u_2.firstRow, u_2.firstColumn, u_2.lastRow, u_2.lastColumn));
                    }
                }
                catch (e_95_1) { e_95 = { error: e_95_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_95) throw e_95.error; }
                }
                q = this.g(w_2.toArray(), c, t);
            }
            if (q == 2) {
                q = this.h([u_2]);
            }
            if (q != 2) {
                return q;
            }
            var y = false;
            var z = this.aj(s, t, y);
            y = z.p2;
            return this.f(p, d, function () {
                for (var aa_1 = 0; aa_1 < w_2.count; aa_1++) {
                    var ab_1 = aa_1 == 0 ? v_2 : v_2._g();
                    ab_1._applyTo3(w_2._inner[aa_1]);
                }
                return 2;
            });
        }
        var aa = a == 1;
        var ab;
        switch (a) {
            case 3:
                ab = [m._s()];
                break;
            case 1:
                ab = [new SpreadsheetCellRange(k.row, k.column)];
                break;
            default:
                ab = o;
                break;
        }
        if (s != null && !((function () { var ac = n._c7(s, boxArray$1(ab), c, q); q = ac.p3; return ac.ret; })())) {
            return q;
        }
        q = this.h(ab);
        if (q != 2) {
            return q;
        }
        if (g == null) {
            var ac = function () { return n._ak(2, c, ab, s); };
            return this.x(0, ac, stringEmpty(), p);
        }
        var ad = new List$1(WorksheetRegion.$, 0);
        var ae = new Dictionary$2(Worksheet.$, Array_$type, 0);
        try {
            for (var _4 = tslib_1.__values(fromEnum(n._a3._j)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var af = _5.value;
                ad.o(ae.item(af._j, SpreadsheetUtilities.f(af._j, boxArray$1(ab))));
            }
        }
        catch (e_96_1) { e_96 = { error: e_96_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_96) throw e_96.error; }
        }
        var ag = ad.toArray();
        q = this.g(Enumerable.a(WorksheetRegion.$, ag), c, t);
        if (q != 2) {
            return q;
        }
        var ah = false;
        var ai = Enumerable.a(Worksheet.$, Enumerable.o(SpreadsheetTabInfo.$, Worksheet.$, n._a3._j, function (aj) { return aj._j; }));
        var aj;
        if (a == 1) {
            aj = [new WorksheetRegionAddress(1, k.row, k.row, k.column, k.column)];
        }
        else {
            aj = SpreadsheetUtilities.h(boxArray$1(p));
        }
        var ak = null;
        if (typeCast(Formula.$, g) !== null) {
            var al = this.aj(s, t, ah);
            ah = al.p2;
            var am_1 = typeCast(Formula.$, g);
            var an_1 = k.column;
            if (f == -1) {
                f = SpreadsheetEditHelper.aa(am_1, this.j._bc, k.row, k.column);
            }
            q = this.f(p, d, function () {
                var e_97, _0, e_98, _1;
                TableExpansionInfo.f(ai, aj, SpreadsheetUtilities.aw(k));
                ak = TableExpansionInfo.a(ai, aj);
                try {
                    for (var _2 = tslib_1.__values(fromEnum(ae)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var ao = _3.value;
                        var ap = ao.key;
                        var aq_1 = ap._rows$i.item(k.row);
                        var ar_1 = a == 2;
                        if (s != null && ap.isProtected && ap == n._bc) {
                            var au = ao.value;
                            for (var at = 0; at < au.length; at++) {
                                var as = au[at];
                                var av = s.a(ap);
                                var aw = as._h;
                                if (SpreadsheetPaneManager._cp(ap, aw._ac, aw._w, aw._ae, aw._x, av)) {
                                    SpreadsheetEditHelper.ag(am_1, ar_1 ? [as] : null, aq_1, an_1, f);
                                }
                                else {
                                    ah = true;
                                    var ax = LockedEditRangeInfoForCellRange.a(av, aw._ac, aw._w, aw._ae, aw._x);
                                    try {
                                        for (var _4 = tslib_1.__values(fromEnum(SpreadsheetPaneManager._dd(ao.key, [SpreadsheetUtilities.z(aw)]))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                                            var ay = _5.value;
                                            var az = ap._rows$i.item(ay.row);
                                            var a0 = ap._b4(az, ay.column);
                                            if (nullableEquals(a0._c5, false) || ax.e(ay.row, ay.column)) {
                                                SpreadsheetEditHelper.ah(am_1, az, ay.column, aq_1, an_1, f);
                                            }
                                        }
                                    }
                                    catch (e_98_1) { e_98 = { error: e_98_1 }; }
                                    finally {
                                        try {
                                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                                        }
                                        finally { if (e_98) throw e_98.error; }
                                    }
                                }
                            }
                        }
                        else {
                            SpreadsheetEditHelper.ag(am_1, ar_1 ? ao.value : null, aq_1, an_1, f);
                        }
                    }
                }
                catch (e_97_1) { e_97 = { error: e_97_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_97) throw e_97.error; }
                }
                SpreadsheetUtilities.e1(ae);
                return 2;
            });
            if (q == 2) {
                if (ak != null) {
                    this.x(46, function () {
                        ak.g();
                        return 2;
                    }, null, null);
                }
                if (a == 1) {
                }
                if (ah) {
                    this.y(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                }
            }
            return q;
        }
        try {
            WorksheetCellBlock.ax(g);
            WorksheetCellBlock.a0(g);
        }
        catch (ao) {
            var ap = new SpreadsheetUserPromptInfo(2, null, ao, null, c);
            if (this.y(ap) == false) {
                return 1;
            }
            return 0;
        }
        var aq = this.aj(s, t, ah);
        ah = aq.p2;
        var ar = null;
        if (n._a3._j.count == 1) {
            var as = n._a3._j.item(0)._j;
            if (as.isProtected == false || as.protection.allowInsertingHyperlinks) {
                ar = as;
            }
        }
        q = this.f(p, d, function () {
            var e_99, _0;
            TableExpansionInfo.f(ai, aj, SpreadsheetUtilities.aw(k));
            ak = TableExpansionInfo.a(ai, aj);
            var _loop_17 = function (at) {
                var e_100, _0;
                var au = at._j;
                if (a == 1) {
                    var av = au._rows$i.item(k.row);
                    var aw = av._getCellValue1(k.column);
                    SpreadsheetEditHelper.ak(av, k.column, j, g, f, h);
                    if (aw == null && n._a3._j.count == 1 && f == -1 && WorksheetCellBlock.q(j._dg)) {
                        var ax = ExcelUtils.ba(g);
                        if (ax || typeof g === 'string') {
                            var ay = new List$1(ConditionBase.$, 0);
                            au._conditionalFormats$i._ad(ay, k.row, k.column, ax);
                        }
                    }
                }
                else {
                    var az_1 = s != null && au.isProtected && au == n._bc ? s.a(au) : null;
                    var a0 = -1;
                    var a1 = null;
                    var a2_1 = null;
                    var a3 = az_1 != null ? function (a4) { return a2_1 = LockedEditRangeInfoForCellRange.a(az_1, a4.firstRow, a4.firstColumn, a4.lastRow, a4.lastColumn); } : null;
                    var a4 = SpreadsheetPaneManager._dd(au, ab, a3);
                    var a5 = null;
                    var a6 = typeCast(SpreadsheetEditHelper_TextChangeWithOptions.$, g);
                    var a7 = null;
                    var a8 = null;
                    var a9 = null;
                    var ba = false;
                    var bb = null;
                    var bc = null;
                    SpreadsheetEditHelper.ak(au._rows$i.item(k.row), k.column, j, g, f, h);
                    if (a6 != null) {
                        a1 = au._rows$i.item(k.row);
                        var bd = a1._getResolvedCellFormat1(k.column);
                        a8 = au._b4(a1, k.column);
                        ba = (a8.formatOptions & 4) != 0;
                        bb = bd.style;
                        bc = new ResolvedWorksheetCellFormatDataFont(a8);
                        a7 = new WorkbookFontData(0, au.workbook);
                        a7.setFontFormatting(bd.font);
                        a9 = typeCast(FormattedString.$, a1._getCellValue1(k.column));
                    }
                    var be = SpreadsheetUtilities.p(f);
                    var bf = f != -1 ? au.workbook._b2.item(f) : null;
                    var bg = SpreadsheetEditHelper.p(be);
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(a4)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var bh = _2.value;
                            if (bh.row != a0) {
                                a0 = bh.row;
                                a1 = au._rows$i.item(a0);
                            }
                            if (bg || a2_1 != null) {
                                a5 = au._b4(a1, bh.column);
                                if (a2_1 != null && nullableEquals(a5._c5, true) && a2_1.e(a0, bh.column) == false) {
                                    ah = true;
                                    continue;
                                }
                                var bi = SpreadsheetUtilities.p(a5._cs);
                                if (bi != be && !SpreadsheetEditHelper.o(bi)) {
                                    a1.getCellFormat(bh.column).formatString = bf;
                                }
                            }
                            if (a7 != null) {
                                if (bg == false) {
                                    a5 = au._b4(a1, bh.column);
                                }
                                if (Base.referenceEquals(a5, a8) == false) {
                                    var bj = void 0;
                                    if (ba == false && (a5.formatOptions & 4) == 0) {
                                        bj = bb != a5.style && Base.referenceEquals(bb._i._bp.d, a5.style._i._bp.d) == false;
                                    }
                                    else {
                                        if (ba == false && (bb == a5.style || Base.referenceEquals(bb._i._bp.d, a5.style._i._bp.d))) {
                                            a1._bc(bh.column).formatOptions &= ~4;
                                            bj = false;
                                        }
                                        else {
                                            bc._b(a5);
                                            bj = WorkbookFontProxy._l(a7, bc) != 0;
                                        }
                                    }
                                    if (bj) {
                                        a1._bc(bh.column).font.setFontFormatting(a7);
                                    }
                                }
                            }
                            var bk = void 0;
                            if (a6 == null) {
                                bk = g;
                            }
                            else if (a9 == null) {
                                bk = a6.c;
                            }
                            else {
                                bk = a9.clone();
                            }
                            a1.setCellValue(bh.column, bk);
                            if (h) {
                                a1.getCellFormat(bh.column)._wrapText$i = Nullable$1.toNullable(Boolean_$type, true);
                            }
                        }
                    }
                    catch (e_100_1) { e_100 = { error: e_100_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_100) throw e_100.error; }
                    }
                }
            };
            try {
                for (var _1 = tslib_1.__values(fromEnum(n._a3._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var at = _2.value;
                    _loop_17(at);
                }
            }
            catch (e_99_1) { e_99 = { error: e_99_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_99) throw e_99.error; }
            }
            SpreadsheetUtilities.e1(ae);
            return 2;
        });
        if (q == 2) {
            if (ak != null) {
                this.x(46, function () {
                    ak.g();
                    return 2;
                }, null, null);
            }
            if (ah) {
                this.y(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            }
            else if (ar != null) {
                var at_1 = ar._rows$i.item(k.row);
                var au_1 = at_1._c6(k.column);
                if (typeCast(StringElement.$, au_1) !== null || typeCast(FormattedString.$, au_1) !== null) {
                    var av_1 = typeCast(FormattedString.$, au_1) !== null ? au_1.unformattedString : au_1._y;
                    var aw_1 = null;
                    var ax_1 = null;
                    if (SpreadsheetUtilities.bd(av_1)) {
                        var ay = SpreadsheetEditHelper.l(at_1, k.column);
                        if (ay == null || ay.isSealed) {
                            var az = at_1.getCellAssociatedMergedCellsRegion(k.column);
                            if (az != null) {
                                aw_1 = new WorksheetHyperlink(ar._cw(az._h), av_1, null, null);
                            }
                            else {
                                aw_1 = new WorksheetHyperlink(at_1._cells$i.item(k.column), av_1, null, null);
                            }
                        }
                        else {
                            ax_1 = ay;
                        }
                        this.x(31, function () {
                            if (aw_1 != null) {
                                ar._hyperlinks$i.add(aw_1);
                            }
                            else if (ax_1 != null) {
                                ax_1.targetAddress = av_1;
                            }
                            if (typeCast(FormattedStringElement.$, au_1) !== null || typeCast(FormattedString.$, au_1) !== null) {
                                at_1.setCellValue(k.column, av_1);
                            }
                            return 2;
                        }, null, null);
                    }
                }
            }
        }
        return q;
    };
    SpreadsheetEditHelper.ak = function (a, b, c, d, e, f) {
        var g = typeCast(SpreadsheetEditHelper_TextChangeWithOptions.$, d);
        if (g != null) {
            g.e(a, b);
        }
        if (e != -1) {
            SpreadsheetEditHelper.ai(a, b, e, c);
        }
        if (g != null) {
            if (g.a == null) {
                d = g.c;
            }
            else {
                d = new FormattedString(g.c);
            }
        }
        a.setCellValue(b, d);
        if (g != null && g.a != null) {
            g.f(typeCast(FormattedString.$, d));
        }
        if (f) {
            a.getCellFormat(b)._wrapText$i = Nullable$1.toNullable(Boolean_$type, true);
        }
    };
    SpreadsheetEditHelper.ag = function (a, b, c, d, e) {
        var f = a._ab == null ? a : a._g();
        if (b != null) {
            f._bm(b, c, d, 1);
            if (e != -1) {
                for (var g = 0; g < b.length; g++) {
                    var h = b[g]._h;
                    var i = b[g].worksheet;
                    for (var j = h._ac; j <= h._ae; j++) {
                        var k = i._rows$i.item(j);
                        for (var l = h._w; l <= h._x; l++) {
                            SpreadsheetEditHelper.ai(k, l, e, i._b4(k, l));
                        }
                    }
                }
            }
        }
        else {
            f._bp(c, d, 1);
            if (e != -1) {
                SpreadsheetEditHelper.ai(c, d, e, c.worksheet._b4(c, d));
            }
        }
    };
    SpreadsheetEditHelper.ah = function (a, b, c, d, e, f) {
        var g = a._ab == null ? a : a._g();
        g._bq(d, e, b, c, 1);
        if (f != -1) {
            SpreadsheetEditHelper.ai(b, c, f, d.worksheet._b4(b, c));
        }
    };
    SpreadsheetEditHelper.ai = function (a, b, c, d) {
        var e = WorksheetCellBlock.q(d._dg);
        var f = a.worksheet.workbook._b2.item(c);
        if (!e) {
            var g = SpreadsheetUtilities.p(c);
            var h = SpreadsheetUtilities.p(d._cs);
            if (SpreadsheetEditHelper.p(g) && !SpreadsheetEditHelper.o(h) && g != h) {
                e = true;
            }
        }
        if (e) {
            var i = a.getCellFormat(b);
            i.formatString = f;
        }
    };
    SpreadsheetEditHelper.n = function (a, b, c) {
        var d = c == 0 || c == 2;
        var e = a.indexOf(b);
        var f = indexOfAny(a, SpreadsheetEditHelper.b);
        if (f >= 0 && e >= 0) {
            if (d && e > f) {
                return false;
            }
            else if (!d && e < f) {
                return false;
            }
        }
        return true;
    };
    SpreadsheetEditHelper.l = function (a, b) {
        var e_101, _0;
        var c = a._bi(b);
        if (c == null) {
            var d = a.worksheet;
            var e = d._cr(a.index, b);
            var f = e != null;
            var g = e != null ? e._h : new WorksheetRegionAddress(1, a.index, a.index, b, b);
            try {
                for (var _1 = tslib_1.__values(fromEnum(d._hyperlinks$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var h = _2.value;
                    var i = h.sourceRegion._h;
                    if (WorksheetRegionAddress._o(g, i) || (f && g._h(i))) {
                        c = h;
                        break;
                    }
                }
            }
            catch (e_101_1) { e_101 = { error: e_101_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_101) throw e_101.error; }
            }
        }
        return c;
    };
    SpreadsheetEditHelper.ac = function (a, b, c, d) {
        if (d === void 0) { d = true; }
        var e = a.a;
        var f = a.g;
        var g;
        if (b) {
            var h_7;
            if (((function () { var i = ArrayFormula._cs(c, e.cellReferenceMode, e.currentFormat, f, h_7, g); h_7 = i.p4; g = i.p5; return i.ret; })())) {
                return h_7;
            }
        }
        else {
            var i_4;
            if (((function () { var j = Formula._a4(c, e.cellReferenceMode, e.currentFormat, f, i_4, g); i_4 = j.p4; g = j.p5; return j.ret; })())) {
                return i_4;
            }
        }
        if (d && c.indexOf(')') < 0) {
            var j = typeCast(Formula.$, SpreadsheetEditHelper.ac(a, b, c + ")", false));
            if (j != null) {
                return j;
            }
        }
        return new SpreadsheetUserPromptInfo(1, null, g, null, false);
    };
    SpreadsheetEditHelper.aa = function (a, b, c, d) {
        var e = 14;
        var f = 0;
        var g = new Stack$1(Number_$type);
        var h = new FormulaContext(4, b, c, d, b._o, a, b._y, b._c);
        var k = a._e;
        for (var j = 0; j < k.length; j++) {
            var i = k[j];
            var l = -1;
            var m = 0;
            var n = null;
            var o = typeCast(IFunctionToken_$type, i);
            if (o != null) {
                n = o.$function;
                m = o.argumentCount;
            }
            else if (typeCast(UnaryOperatorToken.$, i) !== null) {
                m = 1;
            }
            else if (typeCast(BinaryOperatorToken.$, i) !== null) {
                m = 2;
            }
            if (m > 0) {
                for (var p = 0; p < m; p++) {
                    var q = g.e();
                    if (q != -1) {
                        l = q;
                    }
                }
                if (n != null) {
                    var r = n._alx;
                    if (stringEquals1("DATE", r, 1)) {
                        f++;
                        l = e;
                    }
                    else if (stringEquals1("TIME", r, 1)) {
                        l = 18;
                    }
                    else if (n._qp) {
                        l = -1;
                    }
                }
            }
            else {
                var s = typeCast(RefToken.$, i);
                var t = -1;
                var u = -1;
                if (s != null) {
                    var v = s.y.e(h, s.v);
                    t = v.o;
                    u = v.m;
                }
                else {
                    var w = typeCast(AreaToken.$, i);
                    if (w != null) {
                        var x = w.x.k(h, w.v);
                        t = x._ac;
                        u = x._w;
                    }
                }
                if (t >= 0) {
                    var y = b._rows$i._aj(t);
                    var z = b._b4(y, u);
                    if (z._cs != 0) {
                        l = z._cs;
                        if (l == e) {
                            f++;
                        }
                    }
                }
                else if (i.h == 255) {
                    continue;
                }
            }
            g.h(l);
        }
        if (g.f > 0) {
            var aa = g.e();
            if (aa != e || f < 2) {
                return aa;
            }
        }
        return -1;
    };
    SpreadsheetEditHelper.d = function (a, b, c) {
        var d = a.createDocument();
        if (d != null) {
            var e = new ResolvedWorksheetCellFormatDataFont(a.editCellFormat);
            var f = new IGFormattedTextSettings();
            SpreadsheetUtilities.d9(f, e);
            d.a._aa(f);
            d.p();
        }
        if (d != null && d.c()) {
            if (c) {
                SpreadsheetUtilities.ed(b, d, 9, 8);
            }
            var g = d.a;
            var h = d.g();
            if (h == null || h.equals(g)) {
            }
            else {
                var i = g._b;
                var j = h._b;
                h._z(g);
                d.o();
                var k = d.i.toString();
                if (i != j) {
                    return new SpreadsheetEditHelper_TextChangeWithOptions(k, h, d);
                }
                return new SpreadsheetEditHelper_TextChangeWithOptions(k, h, null);
            }
        }
        return new SpreadsheetEditHelper_TextChangeWithOptions(a.unformattedText, new IGFormattedTextSettings(), null);
    };
    SpreadsheetEditHelper.prototype.aj = function (a, b, c) {
        var e_102, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                if (a != null) {
                    var e = d.blockedRegion.worksheet;
                    if (e.isProtected) {
                        var f = a.a(e);
                        var g = d.blockedRegion._h;
                        if (SpreadsheetPaneManager._cp(e, g._ac, g._w, g._ae, g._x, f) == false) {
                            c = true;
                            continue;
                        }
                    }
                }
                d.removeFromRegion();
            }
        }
        catch (e_102_1) { e_102 = { error: e_102_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_102) throw e_102.error; }
        }
        return {
            p2: c
        };
    };
    SpreadsheetEditHelper.o = function (a) {
        switch (a) {
            case 3:
            case 2:
            case 4:
            case 7:
            case 6:
            case 8:
            case 5:
            case 0:
            case 9: return false;
            case 10:
            case 1: return true;
            default: return true;
        }
    };
    SpreadsheetEditHelper.p = function (a) {
        switch (a) {
            case 3:
            case 2:
            case 4:
            case 7:
            case 6:
            case 8:
            case 5:
            case 0: return true;
            case 10:
            case 1:
            case 9: return false;
            default: return false;
        }
    };
    SpreadsheetEditHelper.q = function (a, b, c, d, e) {
        var f = b.g;
        if (f == null) {
            f = CultureInfo.currentCulture;
        }
        e = false;
        var g = typeCast(NumberFormatInfo.$, f.getFormat(NumberFormatInfo.$));
        var h = g.currencySymbol;
        if (stringContains(a, h)) {
            var i_5 = 4 | 1 | 16 | 64 | 2 | 256;
            if (((function () { var j = tryParseNumber1(a, i_5, f, c); c = j.p3; return j.ret; })())) {
                if (SpreadsheetEditHelper.n(a, h, b.i) && !b.e(a)) {
                    d = 6;
                    return {
                        ret: true,
                        p2: c,
                        p3: d,
                        p4: e
                    };
                }
                else {
                    e = true;
                }
            }
            else {
                var j_3 = i_5 | 32;
                if (SpreadsheetEditHelper.n(a, h, b.i) && !b.e(a)) {
                    if (((function () { var k = tryParseNumber1(a, j_3, f, c); c = k.p3; return k.ret; })())) {
                        d = 8;
                        return {
                            ret: true,
                            p2: c,
                            p3: d,
                            p4: e
                        };
                    }
                }
                else {
                    e = true;
                }
            }
        }
        c = NaN;
        d = -1;
        return {
            ret: false,
            p2: c,
            p3: d,
            p4: e
        };
    };
    SpreadsheetEditHelper.r = function (a, b, c, d) {
        d = -1;
        if (a != null && a.length > 0 && !/\s/i.test(a.charAt(0))) {
            var e = b.g;
            var f = b.a;
            if (e == null) {
                e = CultureInfo.currentCulture;
            }
            var g = void 0;
            var h_8;
            if (((function () { var i = dateTryParse(a, h_8); h_8 = i.p1; return i.ret; })())) {
                g = true;
            }
            else if (a != null && a.length < 3) {
                g = false;
            }
            else {
                var i_6;
                var j_4;
                var k_4 = b.f ? b.j : 0;
                if (((function () { var l = SpreadsheetEditHelper.u(a, b, k_4, i_6, j_4); i_6 = l.p3; j_4 = l.p4; return l.ret; })())) {
                    g = false;
                }
                else {
                    var l_3 = SpreadsheetUtilities.ds(dateMinValue(), f) + " " + a;
                    g = ((function () { var m = dateTryParse(l_3, h_8); h_8 = m.p1; return m.ret; })());
                }
            }
            if (g) {
                var m = typeCast(DateTimeFormat.$, e.getFormat(DateTimeFormat.$));
                var n = true;
                if (+(dateGetDate(h_8)) == +(dateMinValue())) {
                    c = ExcelCalcValue._ay(dateGetTimeOfDay(h_8));
                }
                else if (h_8 > dateMaxValue()) {
                    c = null;
                }
                else {
                    c = unwrapNullable(ExcelCalcValue._dateTimeToExcelDate(f, h_8));
                }
                if (c == null) {
                    n = false;
                }
                else if (m != null) {
                    var o = m.dateSeparator;
                    var p = m.timeSeparator;
                    var q = stringIsNullOrWhiteSpace(o) || stringContains(a, o);
                    var r = stringIsNullOrWhiteSpace(p) || stringContains(a, p);
                    if ((r || q) && !b.c(a)) {
                        var s = b.n;
                        var t = b.o;
                        var u = (!stringIsNullOrWhiteSpace(s) && SpreadsheetUtilities.a7(e, a, s)) || (!stringIsNullOrWhiteSpace(t) && SpreadsheetUtilities.a7(e, a, t));
                        var v = 0;
                        var w = a.indexOf(p, 0);
                        while (w >= 0) {
                            v++;
                            w = w < a.length ? a.indexOf(p, w + 1) : -1;
                        }
                        if (+(dateGetDate(h_8)) == +(dateMinValue())) {
                            if (u) {
                                d = v > 1 ? 19 : 18;
                            }
                            else {
                                d = v > 1 ? 21 : 20;
                            }
                        }
                        else {
                            if (u || v > 0) {
                                d = 22;
                            }
                            else {
                                d = 14;
                            }
                        }
                    }
                    else {
                        n = false;
                    }
                }
                if (n) {
                    return {
                        ret: true,
                        p2: c,
                        p3: d
                    };
                }
            }
        }
        c = null;
        return {
            ret: false,
            p2: c,
            p3: d
        };
    };
    SpreadsheetEditHelper.s = function (a, b, c, d) {
        var e = b.g;
        var f;
        f = a.indexOf('E');
        if (f < 0) {
            f = a.indexOf('e');
        }
        if (f >= 0) {
            if (e == null) {
                e = CultureInfo.currentCulture;
            }
            var g_6 = 128 | 16 | 64 | 32 | 4 | 1 | 2;
            if (((function () { var h = tryParseNumber1(a, g_6, e, c); c = h.p3; return h.ret; })()) && !b.e(a)) {
                d = 11;
                return {
                    ret: true,
                    p2: c,
                    p3: d
                };
            }
        }
        d = -1;
        c = NaN;
        return {
            ret: false,
            p2: c,
            p3: d
        };
    };
    SpreadsheetEditHelper.t = function (a, b, c, d, e, f) {
        f = false;
        if (a != null) {
            var g = 1;
            var h_9 = 2;
            var i_7 = 3;
            var j_5 = 4;
            if (SpreadsheetEditHelper.af == null) {
                SpreadsheetEditHelper.af = new Regex(0, "^(\\+|-)?\\s*(\\S+\\s+)?(\\d+)/(\\d+)\\s*$");
            }
            var k_5 = SpreadsheetEditHelper.af.i(a);
            if (k_5.i) {
                if (b == false || k_5.m.item(h_9).d > 0) {
                    var l_4 = c.g;
                    if (l_4 == null) {
                        l_4 = CultureInfo.currentCulture;
                    }
                    var m = k_5.m.item(h_9).g != null ? k_5.m.item(h_9).g : stringEmpty();
                    var n_2 = 0;
                    if (stringIsNullOrEmpty(m) || (((function () { var o = tryParseInt32_2(k_5.m.item(h_9).g, 64 | 2, l_4, n_2); n_2 = o.p3; return o.ret; })()) && !c.e(k_5.m.item(h_9).g))) {
                        var o_1, p_2;
                        if (((function () { var q = tryParseInt32_2(k_5.m.item(i_7).g, 1, l_4, o_1); o_1 = q.p3; return q.ret; })()) && ((function () { var q = tryParseInt32_2(k_5.m.item(j_5).g, 1, l_4, p_2); p_2 = q.p3; return q.ret; })()) && o_1 <= 32767 && p_2 <= 32767 && p_2 != 0) {
                            d = n_2 + o_1 / p_2;
                            if (k_5.m.item(g).g == "-") {
                                d = -d;
                            }
                            var q = 0;
                            for (var r = m.length - 1; r >= 0; r--) {
                                if (/\s/i.test(m.charAt(r))) {
                                    q++;
                                }
                                else {
                                    break;
                                }
                            }
                            if (q > 1) {
                                f = true;
                            }
                            else {
                                e = p_2 < 10 ? 12 : 13;
                                return {
                                    ret: true,
                                    p3: d,
                                    p4: e,
                                    p5: f
                                };
                            }
                        }
                    }
                }
            }
        }
        e = -1;
        d = NaN;
        return {
            ret: false,
            p3: d,
            p4: e,
            p5: f
        };
    };
    SpreadsheetEditHelper.u = function (a, b, c, d, e) {
        var f = b.g;
        e = -1;
        if (f == null) {
            f = CultureInfo.currentCulture;
        }
        var g = 4 | 1 | 16 | 64 | 2;
        if (c != 0) {
            if (((function () { var h = tryParseNumber1(a, g, f, d); d = h.p3; return h.ret; })())) {
                if (b.e(a)) {
                    return {
                        ret: false,
                        p3: d,
                        p4: e
                    };
                }
                d *= Math.pow(10, -c);
                return {
                    ret: true,
                    p3: d,
                    p4: e
                };
            }
        }
        var h = g | 32;
        if (((function () { var i = tryParseNumber1(a, h, f, d); d = i.p3; return i.ret; })())) {
            if (b.e(a)) {
                return {
                    ret: false,
                    p3: d,
                    p4: e
                };
            }
            return {
                ret: true,
                p3: d,
                p4: e
            };
        }
        return {
            ret: false,
            p3: d,
            p4: e
        };
    };
    SpreadsheetEditHelper.v = function (a, b, c, d) {
        var e = b.g;
        if (e == null) {
            e = CultureInfo.currentCulture;
        }
        var f = typeCast(NumberFormatInfo.$, e.getFormat(NumberFormatInfo.$));
        var g = f.percentSymbol;
        if (!stringIsNullOrWhiteSpace(g)) {
            a = a.trim();
            var h = a.indexOf(g);
            var i = void 0;
            if (h < 0 || a.length == 1) {
                i = false;
            }
            else if (h == a.length - 1) {
                i = true;
            }
            else if (a.indexOf(g, h + 1) != -1) {
                i = false;
            }
            else if (h == 0) {
                i = true;
            }
            else {
                if (!stringIsNullOrWhiteSpace(f.currencySymbol) && a.indexOf(f.currencySymbol) >= 0) {
                    i = false;
                }
                else {
                    var j = false;
                    var k = false;
                    for (var l = 0; l < h; l++) {
                        var m = a.charAt(l);
                        if (m != '(' && !/\s/i.test(m)) {
                            j = true;
                            break;
                        }
                    }
                    for (var n = h + g.length; n < a.length; n++) {
                        var o = a.charAt(n);
                        if (o != ')' && !/\s/i.test(o)) {
                            k = true;
                            break;
                        }
                    }
                    i = j != k;
                }
            }
            if (i) {
                var p_3 = stringReplace(a, g, "");
                var q_3 = 16 | 64 | 4 | 1 | 2;
                if (((function () { var r = tryParseNumber1(p_3, q_3, e, c); c = r.p3; return r.ret; })()) && !b.e(p_3)) {
                    d = 9;
                    c = c / 100;
                    return {
                        ret: true,
                        p2: c,
                        p3: d
                    };
                }
                var r_3 = q_3 | 32;
                if (((function () { var s = tryParseNumber1(p_3, r_3, e, c); c = s.p3; return s.ret; })()) && !b.e(p_3)) {
                    d = 10;
                    c = c / 100;
                    return {
                        ret: true,
                        p2: c,
                        p3: d
                    };
                }
            }
        }
        d = -1;
        c = NaN;
        return {
            ret: false,
            p2: c,
            p3: d
        };
    };
    SpreadsheetEditHelper.w = function (a, b, c, d) {
        var e = b.g;
        if (e == null) {
            e = CultureInfo.currentCulture;
        }
        var f = typeCast(DateTimeFormat.$, e.getFormat(DateTimeFormat.$));
        if (f != null) {
            var g = f.timeSeparator;
            if (stringContains(a, g)) {
                var h_10 = stringSplit(a, [g], 1);
                if (h_10 != null && h_10.length > 1 && h_10.length <= 3) {
                    var i_8, j_6, k_6;
                    i_8 = j_6 = k_6 = 0;
                    var l_5 = 2;
                    var m = 1 | 2;
                    var n_3 = 1 | 2 | 32;
                    if (((function () { var o = tryParseNumber1(h_10[0], l_5, e, i_8); i_8 = o.p3; return o.ret; })()) && i_8 >= 0 && i_8 <= 9999) {
                        var o_2 = h_10.length == 2 ? n_3 : m;
                        if (((function () { var p = tryParseNumber1(h_10[1], o_2, e, j_6); j_6 = p.p3; return p.ret; })()) && j_6 >= 0 && j_6 < 60) {
                            if (h_10.length == 2 || (((function () { var p = tryParseNumber1(h_10[2], n_3, e, k_6); k_6 = p.p3; return p.ret; })()) && k_6 >= 0 && k_6 < 60)) {
                                d = 46;
                                c = timeSpanFromHours(i_8 + (j_6 / 60) + (k_6 / 3600));
                                return {
                                    ret: true,
                                    p2: c,
                                    p3: d
                                };
                            }
                        }
                    }
                }
            }
        }
        d = -1;
        c = (-9007199254740991);
        return {
            ret: false,
            p2: c,
            p3: d
        };
    };
    SpreadsheetEditHelper.prototype.f = function (a, b, c) {
        var d = b == null || b.length < 30 ? b : b.substr(0, 30);
        return this.x(0, c, d, a);
    };
    SpreadsheetEditHelper.prototype.g = function (a, b, c) {
        try {
            ExcelUtils.gf(a, c);
        }
        catch (d) {
            var e = new SpreadsheetUserPromptInfo(2, null, d, null, true);
            if (this.y(e) == false) {
                return 1;
            }
            return 0;
        }
        return 2;
    };
    SpreadsheetEditHelper.prototype.h = function (a) {
        var e_103, _0;
        if (this.j._a3._j.count > 1) {
            var b = SpreadsheetUtilities.h(boxArray$1(a));
            try {
                for (var _1 = tslib_1.__values(fromEnum(this.j._a3._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    if (SpreadsheetPaneManager._cf(c._j, b)) {
                        var d = new SpreadsheetUserPromptInfo(20, null, null, null, false);
                        if (this.y(d)) {
                            return 1;
                        }
                        return 0;
                    }
                }
            }
            catch (e_103_1) { e_103 = { error: e_103_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_103) throw e_103.error; }
            }
        }
        return 2;
    };
    Object.defineProperty(SpreadsheetEditHelper.prototype, "workbook", {
        get: function () {
            return this.k;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetEditHelper.prototype, "isFixedDecimalEnabled", {
        get: function () {
            return this.m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetEditHelper.prototype, "fixedDecimalPlaceCount", {
        get: function () {
            return this.z;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetEditHelper.$t = markType(SpreadsheetEditHelper, 'SpreadsheetEditHelper', Base.$, [ISpreadsheetEditInfo_$type]);
    SpreadsheetEditHelper.ae = true;
    SpreadsheetEditHelper.ab = false;
    SpreadsheetEditHelper.b = ['0', '1', '2', '3', '4', '5', '6', '7', '8', '9'];
    SpreadsheetEditHelper.af = null;
    return SpreadsheetEditHelper;
}(Base));
export { SpreadsheetEditHelper };
/**
 * @hidden
 */
var ParseEditValueCache = /** @class */ (function (_super) {
    tslib_1.__extends(ParseEditValueCache, _super);
    function ParseEditValueCache(a) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.f = false;
        _this.j = 0;
        _this.g = null;
        _this.h = -1;
        _this.k = null;
        _this.m = null;
        _this.q = null;
        _this.p = null;
        _this.l = null;
        _this.b = false;
        _this.a = a.workbook;
        _this.g = _this.a._e6;
        _this.f = a.isFixedDecimalEnabled;
        _this.j = a.fixedDecimalPlaceCount;
        return _this;
    }
    Object.defineProperty(ParseEditValueCache.prototype, "n", {
        get: function () {
            if (this.k == null) {
                this.k = ((function (a) { return a != null ? a : ""; })(SpreadsheetUtilities.c8(this.g, true)));
            }
            return this.k;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParseEditValueCache.prototype, "i", {
        get: function () {
            if (this.h < 0) {
                this.h = SpreadsheetUtilities.cp(this.g);
            }
            return this.h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(ParseEditValueCache.prototype, "o", {
        get: function () {
            if (this.m == null) {
                this.m = ((function (a) { return a != null ? a : ""; })(SpreadsheetUtilities.c8(this.g, false)));
            }
            return this.m;
        },
        enumerable: true,
        configurable: true
    });
    ParseEditValueCache.prototype.c = function (a) {
        if (this.p == null) {
            var b = ExcelUtils.ec(this.g.dateTimeFormat);
            var c = ExcelUtils.ec(this.g.dateTimeFormat);
            var d = !stringIsNullOrEmpty(b);
            var e = !stringIsNullOrEmpty(c);
            var f = "";
            if (d || e) {
                f = d && e ? Regex.f(b) + "|" + Regex.f(c) : d ? Regex.f(b) : Regex.f(c);
                f = stringFormat("({0})\\s*({0})", f);
            }
            var g = !stringIsNullOrEmpty(f) ? "(\\+|(" + f + "))" : "(\\+)";
            this.p = new Regex(0, g);
        }
        var h = this.p.i(a);
        if (h.i) {
            return true;
        }
        return false;
    };
    ParseEditValueCache.prototype.e = function (a) {
        if (this.l != a) {
            this.l = a;
            this.b = this.d(a);
        }
        return this.b;
    };
    ParseEditValueCache.prototype.d = function (a) {
        var b = this.g;
        var c = b.numberFormat;
        if (a != null) {
            a = stringReplace(stringReplace(stringReplace(a, c.positiveSign, ""), c.negativeSign, ""), c.currencySymbol, "").trim();
            if (!stringIsNullOrEmpty(c.numberDecimalSeparator)) {
                var d = a.indexOf(c.numberDecimalSeparator);
                if (d >= 0) {
                    var e = c.numberDecimalSeparator.length;
                    if (e == a.length) {
                        return true;
                    }
                    if (d < a.length - e && /\s/i.test(a.charAt(d + e))) {
                        return true;
                    }
                    if (d > 0 && /\s/i.test(a.charAt(d = 1))) {
                        return true;
                    }
                }
            }
            if (!stringIsNullOrEmpty(c.numberGroupSeparator)) {
                var f = a.indexOf(c.numberGroupSeparator);
                if (f >= 0) {
                    var g = c.numberGroupSeparator.length;
                    if (g == a.length) {
                        return true;
                    }
                    if (f == 0 || f == a.length - g) {
                        return true;
                    }
                    if (f < a.length - g && /\s/i.test(a.charAt(f + g))) {
                        return true;
                    }
                    if (f > 0 && /\s/i.test(a.charAt(f - 1))) {
                        return true;
                    }
                    if (this.q == null) {
                        var h = Regex.f(c.numberGroupSeparator);
                        var i = Regex.f(c.numberDecimalSeparator);
                        var j = stringIsNullOrEmpty(c.currencySymbol) ? "" : "|" + Regex.f(c.currencySymbol);
                        this.q = new Regex(0, "^(?:(?:\\+|-" + j + "|\\(|\\s)*)((?:\\d+" + h + "?)+)(?:" + i + "\\d*)?(?:(?:e|E)(?:-|\\+|\\d)+)?(?:(?:\\+|-" + j + "|\\)|\\s)*)$");
                    }
                    var k = this.q.i(a);
                    var l = c.numberGroupSizes || [3];
                    if (k.i) {
                        var m = stringSplit(k.m.item(1).g, [c.numberGroupSeparator], 0);
                        for (var n = m.length - 1, o = n; o >= 0; o--) {
                            var p = l[Math.min(o, l.length - 1)];
                            if (p == 0) {
                                continue;
                            }
                            else if (m[o].length > p) {
                                return true;
                            }
                            else if (m[o].length < p && o != 0) {
                                return true;
                            }
                        }
                    }
                }
            }
        }
        return false;
    };
    ParseEditValueCache.$t = markType(ParseEditValueCache, 'ParseEditValueCache');
    return ParseEditValueCache;
}(Base));
export { ParseEditValueCache };
/**
 * @hidden
 */
var SpreadsheetActivePaneChangedEventArgs = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetActivePaneChangedEventArgs, _super);
    function SpreadsheetActivePaneChangedEventArgs(a, b) {
        var _this = _super.call(this) || this;
        _this._c = null;
        _this._b = null;
        _this._c = a;
        _this._b = b;
        return _this;
    }
    Object.defineProperty(SpreadsheetActivePaneChangedEventArgs.prototype, "newValue", {
        get: function () {
            return this._b;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetActivePaneChangedEventArgs.prototype, "oldValue", {
        get: function () {
            return this._c;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetActivePaneChangedEventArgs.$t = markType(SpreadsheetActivePaneChangedEventArgs, 'SpreadsheetActivePaneChangedEventArgs', EventArgs.$);
    return SpreadsheetActivePaneChangedEventArgs;
}(EventArgs));
export { SpreadsheetActivePaneChangedEventArgs };
/**
 * @hidden
 */
var SpreadsheetSelectionChangedEventArgs = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSelectionChangedEventArgs, _super);
    function SpreadsheetSelectionChangedEventArgs(a) {
        var _this = _super.call(this) || this;
        _this._b = null;
        _this._b = a;
        return _this;
    }
    Object.defineProperty(SpreadsheetSelectionChangedEventArgs.prototype, "pane", {
        get: function () {
            return this._b;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetSelectionChangedEventArgs.$t = markType(SpreadsheetSelectionChangedEventArgs, 'SpreadsheetSelectionChangedEventArgs', EventArgs.$);
    return SpreadsheetSelectionChangedEventArgs;
}(EventArgs));
export { SpreadsheetSelectionChangedEventArgs };
/**
 * @hidden
 */
var SpreadsheetUserPromptDisplayingEventArgs = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetUserPromptDisplayingEventArgs, _super);
    function SpreadsheetUserPromptDisplayingEventArgs(a) {
        var _this = _super.call(this) || this;
        _this._b = null;
        CoreUtilities.y(a);
        _this._b = a;
        return _this;
    }
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "canCancel", {
        get: function () {
            return this._b.b;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "cancel", {
        get: function () {
            return this._b.c;
        },
        set: function (a) {
            this._b.c = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "caption", {
        get: function () {
            return this._b.h;
        },
        set: function (a) {
            this._b.h = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "displayMessage", {
        get: function () {
            return this._b.d;
        },
        set: function (a) {
            this._b.d = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "exception", {
        get: function () {
            return this._b.f;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "message", {
        get: function () {
            return this._b.i;
        },
        set: function (a) {
            this._b.i = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetUserPromptDisplayingEventArgs.prototype, "trigger", {
        get: function () {
            return this._b.a;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetUserPromptDisplayingEventArgs.$t = markType(SpreadsheetUserPromptDisplayingEventArgs, 'SpreadsheetUserPromptDisplayingEventArgs', EventArgs.$);
    return SpreadsheetUserPromptDisplayingEventArgs;
}(EventArgs));
export { SpreadsheetUserPromptDisplayingEventArgs };
/**
 * @hidden
 */
var SortFilterAreaBase = /** @class */ (function (_super) {
    tslib_1.__extends(SortFilterAreaBase, _super);
    function SortFilterAreaBase() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.r = Nullable$1.toNullable(CellContentType_$type, null);
        return _this;
    }
    Object.defineProperty(SortFilterAreaBase.prototype, "a", {
        get: function () {
            if (!this.r.hasValue) {
                this.aa();
            }
            return this.r.value;
        },
        enumerable: true,
        configurable: true
    });
    SortFilterAreaBase.prototype.ab = function (a) {
        this.r = Nullable$1.toNullable(CellContentType_$type, a);
    };
    SortFilterAreaBase.prototype.ac = function (a) {
        var _this = this;
        var b = new HashSet$1(CellFill.$, 0);
        this.ae(function (c, d) {
            var e = d._h != null ? d._h.fill : null;
            if (e == null) {
                e = c._ar;
            }
            if (e == null || SpreadsheetUtilities.bc(e)) {
                e = CellFill.noColor;
            }
            else {
                e = e._c(_this.c.workbook);
            }
            if (b.add_1(e)) {
                a(e);
            }
        });
    };
    SortFilterAreaBase.prototype.ad = function (a) {
        var _this = this;
        var b = new HashSet$1(WorkbookColorInfo.$, 0);
        this.ae(function (c, d) {
            var e = d._h != null && d._h.font != null ? d._h.font.colorInfo : null;
            if (WorkbookColorInfo.l_op_Equality(e, null)) {
                e = c._bh;
            }
            if (WorkbookColorInfo.l_op_Equality(e, null) || e.isAutomatic || e.equals(_this.c.workbook._styles$i.normalStyle._i.font.colorInfo)) {
                e = WorkbookColorInfo.automatic;
            }
            else {
                e = WorkbookColorInfo._l_op_Implicit_WorkbookColorInfo_Color$i(e._getResolvedColor1(_this.c.workbook));
            }
            if (b.add_1(e)) {
                a(e);
            }
        });
    };
    SortFilterAreaBase.prototype.af = function (a) {
        var b = new HashSet$1(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), 0);
        this.ae(function (c, d) {
            var e = SpreadsheetUtilities.dx(d.iconInfo) || SpreadsheetUtilities.d1;
            if (b.add_1(e)) {
                a(e);
            }
        });
    };
    SortFilterAreaBase.prototype.ae = function (a) {
        var e_104, _0;
        var b = this.d;
        if (b != null) {
            var c = this.c;
            var d = this.q;
            var e = b.firstRow;
            var f = b.lastRow;
            var g = false;
            try {
                for (var _1 = tslib_1.__values(fromEnum(c._conditionalFormats$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var h = _2.value;
                    for (var i = 0; i < h.regions.count; i++) {
                        if (h.regions.item(i)._s(b)) {
                            g = true;
                        }
                    }
                    if (g) {
                        break;
                    }
                }
            }
            catch (e_104_1) { e_104 = { error: e_104_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_104) throw e_104.error; }
            }
            var j = new List$1(IFilterable_$type, 1, this.o());
            for (var k = e; k <= f; k++) {
                var l = c._rows$i._aj(k);
                var m = false;
                for (var n = 0; n < j.count; n++) {
                    if (!j._inner[n].filter._e(c, l, k, j._inner[n].columnIndex)) {
                        m = true;
                        break;
                    }
                }
                if (!m) {
                    var o = c._b4(l, d);
                    var p = g ? c._getCellConditionalFormat1(k, d) || CellConditionalFormat._a : CellConditionalFormat._a;
                    a(o, p);
                }
            }
        }
    };
    SortFilterAreaBase.prototype.m = function (a) {
        var e_105, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.p())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = typeCast(IconSortCondition.$, b);
                if (c != null) {
                    if (c.iconSet == -1 || !c._n.hasValue) {
                        if (SpreadsheetUtilities.ao(a) == -1) {
                            return true;
                        }
                    }
                    else if (c.iconSet == a.c && nullableEquals(c._iconIndex$i, a.d)) {
                        return true;
                    }
                }
            }
        }
        catch (e_105_1) { e_105 = { error: e_105_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_105) throw e_105.error; }
        }
        return false;
    };
    SortFilterAreaBase.prototype.j = function (a) {
        var b = typeCast(IconFilter.$, this.b);
        if (b == null) {
            return false;
        }
        if (b.iconSet == -1 || !b._p.hasValue) {
            return SpreadsheetUtilities.ao(a) == -1;
        }
        return a != null && b.iconSet == a.c && nullableEquals(b._iconIndex$i, a.d);
    };
    SortFilterAreaBase.prototype.l = function (a) {
        var e_106, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.p())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = typeCast(FontColorSortCondition.$, b);
                if (c != null) {
                    if (this.f(a, c.fontColorInfo)) {
                        return true;
                    }
                }
            }
        }
        catch (e_106_1) { e_106 = { error: e_106_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_106) throw e_106.error; }
        }
        return false;
    };
    SortFilterAreaBase.prototype.i = function (a) {
        var b = typeCast(FontColorFilter.$, this.b);
        return b != null && this.f(a, b.fontColorInfo);
    };
    SortFilterAreaBase.prototype.f = function (a, b) {
        var c = WorkbookColorInfo.l_op_Equality(a, null) || a.isAutomatic;
        var d = WorkbookColorInfo.l_op_Equality(b, null) || b.isAutomatic;
        if (c != d) {
            return false;
        }
        if (c) {
            return true;
        }
        var e = a._getResolvedColor1(this.c.workbook);
        var f = b._getResolvedColor1(this.c.workbook);
        return e.equals(f);
    };
    SortFilterAreaBase.prototype.k = function (a) {
        var e_107, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.p())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = typeCast(FillSortCondition.$, b);
                if (c != null) {
                    if (this.e(a, c.fill)) {
                        return true;
                    }
                }
            }
        }
        catch (e_107_1) { e_107 = { error: e_107_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_107) throw e_107.error; }
        }
        return false;
    };
    SortFilterAreaBase.prototype.h = function (a) {
        var b = typeCast(FillFilter.$, this.b);
        return b != null && this.e(a, b.fill);
    };
    SortFilterAreaBase.prototype.e = function (a, b) {
        var c = SpreadsheetUtilities.bc(a);
        var d = SpreadsheetUtilities.bc(b);
        if (c != d) {
            return false;
        }
        if (c) {
            return true;
        }
        var e = a._c(this.c.workbook);
        var f = b._c(this.c.workbook);
        return Base.equalsStatic(e, f);
    };
    SortFilterAreaBase.$t = markType(SortFilterAreaBase, 'SortFilterAreaBase');
    return SortFilterAreaBase;
}(Base));
export { SortFilterAreaBase };
/**
 * @hidden
 */
var WorksheetSortFilterArea = /** @class */ (function (_super) {
    tslib_1.__extends(WorksheetSortFilterArea, _super);
    function WorksheetSortFilterArea(a, b) {
        var _this = _super.call(this) || this;
        _this.ah = null;
        _this.ai = 0;
        _this.ah = a;
        _this.ai = b;
        return _this;
    }
    WorksheetSortFilterArea.prototype.t = function (a) {
        this.c.filterSettings.applyFillFilter(this.ai, a);
    };
    WorksheetSortFilterArea.prototype.v = function (a) {
        this.c.filterSettings._applyFontColorFilter(this.ai, a);
    };
    WorksheetSortFilterArea.prototype.w = function (a, b) {
        this.c.filterSettings._applyIconFilter$i(this.ai, a, b);
    };
    WorksheetSortFilterArea.prototype.s = function (a) {
        this.c.filterSettings.applyAverageFilter(this.ai, a);
    };
    WorksheetSortFilterArea.prototype.u = function (a, b) {
        this.c.filterSettings.applyDatePeriodFilter(this.ai, a, b);
    };
    WorksheetSortFilterArea.prototype.x = function (a, b) {
        this.c.filterSettings.applyRelativeDateRangeFilter(this.ai, a, b);
    };
    WorksheetSortFilterArea.prototype.y = function (a, b) {
        this.c.filterSettings._applyTopOrBottomFilter1(this.ai, a, b);
    };
    WorksheetSortFilterArea.prototype.z = function () {
        this.c.filterSettings.applyYearToDateFilter(this.ai);
    };
    WorksheetSortFilterArea.prototype.get_q = function () {
        return this.c.filterSettings.region.firstColumn + this.ai;
    };
    Object.defineProperty(WorksheetSortFilterArea.prototype, "q", {
        get: function () {
            return this.get_q();
        },
        enumerable: true,
        configurable: true
    });
    WorksheetSortFilterArea.prototype.get_d = function () {
        return this.c.filterSettings._ad(new RelativeIndex(this.ai));
    };
    Object.defineProperty(WorksheetSortFilterArea.prototype, "d", {
        get: function () {
            return this.get_d();
        },
        enumerable: true,
        configurable: true
    });
    WorksheetSortFilterArea.prototype.aa = function () {
        var a;
        var b = SpreadsheetUtilities.bz(this.c, this.ai, a);
        a = b.p2;
        this.ab(a);
    };
    WorksheetSortFilterArea.prototype.get_g = function () {
        return this.c.filterSettings.getFilter(this.ai) != null;
    };
    Object.defineProperty(WorksheetSortFilterArea.prototype, "g", {
        get: function () {
            return this.get_g();
        },
        enumerable: true,
        configurable: true
    });
    WorksheetSortFilterArea.prototype.get_b = function () {
        return this.c.filterSettings.getFilter(this.ai);
    };
    Object.defineProperty(WorksheetSortFilterArea.prototype, "b", {
        get: function () {
            return this.get_b();
        },
        enumerable: true,
        configurable: true
    });
    WorksheetSortFilterArea.prototype.o = function () {
        return SpreadsheetUtilities.bx(this.c, this.ai);
    };
    WorksheetSortFilterArea.prototype._p = function () {
        var e_108, _0, _1, _2, a, e_108_1;
        return tslib_1.__generator(this, function (_3) {
            switch (_3.label) {
                case 0:
                    _3.trys.push([0, 5, 6, 7]);
                    _1 = tslib_1.__values(fromEnum(this.c.filterSettings.sortSettings._sortConditions$i)), _2 = _1.next();
                    _3.label = 1;
                case 1:
                    if (!!_2.done) return [3 /*break*/, 4];
                    a = _2.value;
                    if (!(a.key.index == this.ai)) return [3 /*break*/, 3];
                    return [4 /*yield*/, a.value];
                case 2:
                    _3.sent();
                    _3.label = 3;
                case 3:
                    _2 = _1.next();
                    return [3 /*break*/, 1];
                case 4: return [3 /*break*/, 7];
                case 5:
                    e_108_1 = _3.sent();
                    e_108 = { error: e_108_1 };
                    return [3 /*break*/, 7];
                case 6:
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_108) throw e_108.error; }
                    return [7 /*endfinally*/];
                case 7: return [2 /*return*/];
            }
        });
    };
    WorksheetSortFilterArea.prototype.p = function () {
        var _this = this;
        return toEnum(function () { return _this._p(); });
    };
    WorksheetSortFilterArea.prototype.n = function () {
        var a = this.g;
        if (a) {
            this.c.filterSettings.clearFilter(this.ai);
        }
        return a;
    };
    WorksheetSortFilterArea.prototype.ag = function (a) {
        var b = this.c.filterSettings.sortSettings._sortConditions$i;
        b.clear();
        b._addItem$i(new RelativeIndex(this.ai), a);
    };
    WorksheetSortFilterArea.prototype.get_c = function () {
        return this.ah;
    };
    Object.defineProperty(WorksheetSortFilterArea.prototype, "c", {
        get: function () {
            return this.get_c();
        },
        enumerable: true,
        configurable: true
    });
    WorksheetSortFilterArea.$t = markType(WorksheetSortFilterArea, 'WorksheetSortFilterArea', SortFilterAreaBase.$);
    return WorksheetSortFilterArea;
}(SortFilterAreaBase));
export { WorksheetSortFilterArea };
/**
 * @hidden
 */
var TableSortFilterArea = /** @class */ (function (_super) {
    tslib_1.__extends(TableSortFilterArea, _super);
    function TableSortFilterArea(a) {
        var _this = _super.call(this) || this;
        _this.ah = null;
        _this.ah = a;
        return _this;
    }
    TableSortFilterArea.prototype.t = function (a) {
        this.ah.applyFillFilter(a);
    };
    TableSortFilterArea.prototype.v = function (a) {
        this.ah._applyFontColorFilter(a);
    };
    TableSortFilterArea.prototype.w = function (a, b) {
        this.ah._applyIconFilter$i(a, b);
    };
    TableSortFilterArea.prototype.s = function (a) {
        this.ah.applyAverageFilter(a);
    };
    TableSortFilterArea.prototype.u = function (a, b) {
        this.ah.applyDatePeriodFilter(a, b);
    };
    TableSortFilterArea.prototype.x = function (a, b) {
        this.ah.applyRelativeDateRangeFilter(a, b);
    };
    TableSortFilterArea.prototype.y = function (a, b) {
        this.ah._applyTopOrBottomFilter1(a, b);
    };
    TableSortFilterArea.prototype.z = function () {
        this.ah.applyYearToDateFilter();
    };
    TableSortFilterArea.prototype.get_q = function () {
        return this.ah._at;
    };
    Object.defineProperty(TableSortFilterArea.prototype, "q", {
        get: function () {
            return this.get_q();
        },
        enumerable: true,
        configurable: true
    });
    TableSortFilterArea.prototype.get_d = function () {
        return this.ah.dataAreaRegion;
    };
    Object.defineProperty(TableSortFilterArea.prototype, "d", {
        get: function () {
            return this.get_d();
        },
        enumerable: true,
        configurable: true
    });
    TableSortFilterArea.prototype.aa = function () {
        var a;
        var b = SpreadsheetUtilities.b1(this.ah, a);
        a = b.p1;
        this.ab(a);
    };
    TableSortFilterArea.prototype.get_g = function () {
        return this.ah.filter != null;
    };
    Object.defineProperty(TableSortFilterArea.prototype, "g", {
        get: function () {
            return this.get_g();
        },
        enumerable: true,
        configurable: true
    });
    TableSortFilterArea.prototype.get_b = function () {
        return this.ah.filter;
    };
    Object.defineProperty(TableSortFilterArea.prototype, "b", {
        get: function () {
            return this.get_b();
        },
        enumerable: true,
        configurable: true
    });
    TableSortFilterArea.prototype.o = function () {
        return SpreadsheetUtilities.by(this.ah);
    };
    TableSortFilterArea.prototype._p = function () {
        var e_109, _0, _1, _2, a, e_109_1;
        return tslib_1.__generator(this, function (_3) {
            switch (_3.label) {
                case 0:
                    _3.trys.push([0, 5, 6, 7]);
                    _1 = tslib_1.__values(fromEnum(this.ah.table.sortSettings._sortConditions$i)), _2 = _1.next();
                    _3.label = 1;
                case 1:
                    if (!!_2.done) return [3 /*break*/, 4];
                    a = _2.value;
                    if (!(a.key == this.ah)) return [3 /*break*/, 3];
                    return [4 /*yield*/, a.value];
                case 2:
                    _3.sent();
                    _3.label = 3;
                case 3:
                    _2 = _1.next();
                    return [3 /*break*/, 1];
                case 4: return [3 /*break*/, 7];
                case 5:
                    e_109_1 = _3.sent();
                    e_109 = { error: e_109_1 };
                    return [3 /*break*/, 7];
                case 6:
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_109) throw e_109.error; }
                    return [7 /*endfinally*/];
                case 7: return [2 /*return*/];
            }
        });
    };
    TableSortFilterArea.prototype.p = function () {
        var _this = this;
        return toEnum(function () { return _this._p(); });
    };
    TableSortFilterArea.prototype.ag = function (a) {
        var b = this.ah.table.sortSettings._sortConditions$i;
        b.clear();
        b._addItem$i(this.ah, a);
    };
    TableSortFilterArea.prototype.n = function () {
        var a = this.g;
        if (a) {
            this.ah.clearFilter();
        }
        return a;
    };
    TableSortFilterArea.prototype.get_c = function () {
        return this.ah._worksheet;
    };
    Object.defineProperty(TableSortFilterArea.prototype, "c", {
        get: function () {
            return this.get_c();
        },
        enumerable: true,
        configurable: true
    });
    TableSortFilterArea.$t = markType(TableSortFilterArea, 'TableSortFilterArea', SortFilterAreaBase.$);
    return TableSortFilterArea;
}(SortFilterAreaBase));
export { TableSortFilterArea };
/**
 * @hidden
 */
var PredefinedShapes = /** @class */ (function (_super) {
    tslib_1.__extends(PredefinedShapes, _super);
    function PredefinedShapes() {
        var _this = _super.call(this) || this;
        _this.f = null;
        _this.f = new Dictionary$2(String_$type, ShapeGeometry.$, 0);
        return _this;
    }
    Object.defineProperty(PredefinedShapes, "b", {
        get: function () {
            if (PredefinedShapes.a == null) {
                {
                    if (PredefinedShapes.a == null) {
                        var a = new PredefinedShapes();
                        PredefinedShapes.a = a;
                    }
                }
            }
            return PredefinedShapes.a;
        },
        enumerable: true,
        configurable: true
    });
    PredefinedShapes.prototype.c = function (a) {
        if (a.a == null && a.c == null) {
            var b = a.g;
            var c = new StringReader(b);
            var d = new XmlTextReader(3, c);
            if (!d.i) {
                d.a6();
                this.j(a, d);
            }
        }
        return new ShapeGeometry(null, a);
    };
    PredefinedShapes.prototype.d = function (a) {
        var _this = this;
        if (!this.f.containsKey(a)) {
            this.k(null);
        }
        var b;
        if (((function () { var c = _this.f.tryGetValue(a, b); b = c.p1; return c.ret; })())) {
            return b;
        }
        return null;
    };
    PredefinedShapes.h = function () {
        var a = new MemoryStream(0);
        {
            var b = new MemoryStream(2, Convert.fromBase64String(PredefinedShapes.i));
            try {
                if (b == null) {
                    return null;
                }
                try {
                    {
                        var c = new GZipStream(b, 0);
                        try {
                            var d = new Array(4096);
                            while (true) {
                                var e = c.read(d, 0, d.length);
                                if (e == 0) {
                                    break;
                                }
                                a.write(d, 0, e);
                            }
                        }
                        finally {
                            if (c != null) {
                                c.dispose();
                            }
                        }
                    }
                }
                catch (f) {
                }
            }
            finally {
                if (b != null) {
                    b.dispose();
                }
            }
        }
        a.position = 0;
        return a;
    };
    PredefinedShapes.prototype.j = function (a, b) {
        var _this = this;
        this.l(CT_CustomGeometry2D.$, a, b, function (c) {
            switch (b.ag) {
                case "avLst":
                    a.c = new CT_GeomGuideList();
                    _this.o(b, a.c);
                    return true;
                case "gdLst":
                    a.d = new CT_GeomGuideList();
                    _this.o(b, a.d);
                    return true;
                case "pathLst":
                    a.f = new CT_Path2DList();
                    _this.n(b, a.f);
                    return true;
                default:
                case "ahLst":
                case "cxnLst": return b.i;
                case "rect":
                    a.e = ((function () {
                        var $ret = new CT_GeomRect();
                        $ret.b = ST_AdjCoordinate.a(b.ab("l"));
                        $ret.d = ST_AdjCoordinate.a(b.ab("t"));
                        $ret.c = ST_AdjCoordinate.a(b.ab("r"));
                        $ret.a = ST_AdjCoordinate.a(b.ab("b"));
                        return $ret;
                    })());
                    return b.i;
            }
        });
    };
    PredefinedShapes.prototype.k = function (a) {
        {
            var b = PredefinedShapes.h();
            try {
                var c = new XmlTextReader(1, b);
                c.a6();
                var d = false;
                while (d || c.t()) {
                    d = false;
                    if (c.a7 == 1 && !c.i) {
                        var e = c.ai;
                        if (a != null && !a.contains(e)) {
                            d = true;
                            c.a2();
                            continue;
                        }
                        var f = new CT_CustomGeometry2D();
                        this.j(f, c);
                        this.f.item(e, new ShapeGeometry(e, f));
                    }
                }
            }
            finally {
                if (b != null) {
                    b.dispose();
                }
            }
        }
    };
    PredefinedShapes.prototype.l = function ($t, a, b, c) {
        if (b.i) {
            return;
        }
        b.q();
        var d = b.x;
        var e = false;
        while (d <= b.x && (e || b.t())) {
            e = false;
            if (b.a7 == 1) {
                if (!c(a)) {
                    e = true;
                    b.a2();
                }
            }
            if (b.a7 == 15) {
                if (b.x == d) {
                    break;
                }
            }
        }
    };
    PredefinedShapes.prototype.m = function (a, b) {
        var _this = this;
        this.l(List$1.$.specialize(IPath2DCommand_$type), b, a, function (c) {
            switch (a.ag) {
                case "close":
                    c.add(new CT_Path2DClose());
                    return true;
                case "arcTo":
                    var d = new CT_Path2DArcTo();
                    d.d = ST_AdjCoordinate.a(a.ab("wR"));
                    d.c = ST_AdjCoordinate.a(a.ab("hR"));
                    d.a = ST_AdjAngle.a(a.ab("stAng"));
                    d.b = ST_AdjAngle.a(a.ab("swAng"));
                    c.add(d);
                    return a.i;
            }
            var e = new List$1(CT_AdjPoint2D.$, 0);
            _this.p(a, e);
            switch (a.ag) {
                case "moveTo":
                    var f = new CT_Path2DMoveTo();
                    f.a = e._inner[0];
                    c.add(f);
                    return true;
                case "lnTo":
                    var g = new CT_Path2DLineTo();
                    g.a = e._inner[0];
                    c.add(g);
                    return true;
                case "quadBezTo":
                    var h = new CT_Path2DQuadBezierTo();
                    h.a = e._inner[0];
                    h.b = e._inner[1];
                    c.add(h);
                    return true;
                case "cubicBezTo":
                    var i = new CT_Path2DCubicBezierTo();
                    i.a = e._inner[0];
                    i.b = e._inner[1];
                    i.c = e._inner[2];
                    c.add(i);
                    return true;
                default: return a.i;
            }
        });
    };
    PredefinedShapes.prototype.n = function (a, b) {
        var _this = this;
        this.l(CT_Path2DList.$, b, a, function (c) {
            if (a.ag == "path") {
                var d = new CT_Path2D();
                d.c = Nullable$1.toNullable(Boolean_$type, PredefinedShapes.e(a, "extrusionOk", true));
                d.d = Nullable$1.toNullable(ST_PathFillMode_$type, EnumUtil.getEnumValue(ST_PathFillMode_$type, EnumUtil.parse(ST_PathFillMode_$type, ((function (e) { return e != null ? e : "norm"; })(a.ab("fill"))), false)));
                d.f = Nullable$1.toNullable(Boolean_$type, PredefinedShapes.e(a, "stroke", true));
                var e = a.ab("w");
                if (!stringIsNullOrEmpty(e)) {
                    d.g = Nullable$1.toNullable(ST_PositiveCoordinate.$, new ST_PositiveCoordinate(1, XmlConvert.n(e)));
                }
                var f = a.ab("h");
                if (!stringIsNullOrEmpty(f)) {
                    d.e = Nullable$1.toNullable(ST_PositiveCoordinate.$, new ST_PositiveCoordinate(1, XmlConvert.n(f)));
                }
                _this.m(a, d.b);
                c.b.add(d);
                return true;
            }
            return false;
        });
    };
    PredefinedShapes.prototype.p = function (a, b) {
        this.l(List$1.$.specialize(CT_AdjPoint2D.$), b, a, function (c) {
            if (a.ag == "pt") {
                var d = new CT_AdjPoint2D();
                d.a = ST_AdjCoordinate.a(a.ab("x"));
                d.b = ST_AdjCoordinate.a(a.ab("y"));
                c.add(d);
                return true;
            }
            else {
                return a.i;
            }
        });
    };
    PredefinedShapes.prototype.o = function (a, b) {
        this.l(CT_GeomGuideList.$, b, a, function (c) {
            if (a.ag == "gd") {
                var d = new CT_GeomGuide();
                d.b = a.ab("name");
                d.a = a.ab("fmla");
                c.b.add(d);
                return true;
            }
            return a.i;
        });
    };
    PredefinedShapes.e = function (a, b, c) {
        var d = a.ab(b);
        return d != null ? XmlConvert.d(d) : c;
    };
    PredefinedShapes.g = function (a, b, c) {
        var d = a.ab(b);
        return d != null ? XmlConvert.o(d) : c;
    };
    PredefinedShapes.$t = markType(PredefinedShapes, 'PredefinedShapes');
    PredefinedShapes.a = null;
    PredefinedShapes.i = "H4sICDIS/lMCAHByZXNldFNoYXBlRGVmaW5pdGlvbnMueG1sAOxd2W7jNhR9HyD/wPqxhWORWl0kLbqiBbqhC9A+FYotx+7IkiHJWb6tD/2k/kIpWYptyTQvRTqLewczGS+XR5eX5OXhIaX8+/c/V58+LGNyF2X5Ik2uB/TSGpAomaTTRXJ7PVgXs2Ew+PSTi3dXHwyH5OLdz9HdorQk80VepNnjxbvr1p+Ld8GI+SNmUYd8vXiIpqSYR+SRktv1YhqRWZqROJoVn2VZen9JfuU4ZJHn64jkxSKOSfTAgflHSVVsss6yKCmIU8xJNF0U5ZXzebiKcnKzLggvO0m5xaQoC6SriP+YzRaT6PLiHXn683O0TO+4H9P1Kl5MwiIi69WX6X1SuUDCZErC6TSa8k/rT3IyjWaLhH80j7LoYzIvitXHo1GeThZhfLnMp8nlcjHJ0jydFZeTdDn6Os3Wy3wUJcPffhn5tmUHY2YPXSugQ8cd0+F45lpDKwgc15mE44iHZ5WlN+FNHA1v1rfD+0UxH65XU+5TWHqwXlX/fTorYa/T/M+bBf/icbaIo4t3w2HZGqssyqPilzIUX5a+Loo0yT8pa30VTiY8ZJ+n2TTKvgjjOF0XlH9Tfld+e/ddXhDe5kl+PWgqNplHyzC/LAPIv+GXXYYFf5vdjqZZeM97wjLmDWp5o2W4SAY1WAV3OyVJuIyuB+H0Lzogs2UcXg/uwpjQwHd5VxqJjNmu8TCwbfuIsb2HTJlrHYN29qDtNvbVqIoBf1+XNBGQthuPT8H4cETmpIwOoRb/UznetX/Ytb8v7dlR+0fWxreP47M2vtOxvxpVsWjehXODgQnnv/9Bbqc/R7Pfm+ZfLhL+esio4zuB7Tk+/yh84B/tfLIp8seme1VF/ugW+WO3yOaa9VVXaU4eNsF9LNtkLzaj0iexh466h3Z/D9nGQ3bQw+bNTuNMHhKDrcPRSFjme+uQc1nl291k3zde5gDAZOocgphPKowbGAQ7BBEreGEfd6M4hPH0eifK1cwSV9cuqmJZFY2bsiZ6sd8OulVYmBxoJRyfRItsXU7TP76/HszCOI/2olFOh7+m9SdNueIpyNv4NBHqFLiKk8MA2WGAOFEpftO3eAwrPonTPNrrAmXUWjHksy1v+SRNokH/eD5QaEBrnyC1fKCAap68To9UXilBDbbpDl6FzZvN2OSf8PeHeI6QAbGzYkAcGU6AqOd5/hFrV4lceXvYTomN5ApArvbw7Ta+exzfbuN7SN7eEnk74KGn7qHb30N746GN9BLpZQ84pJdIL8+OXooBtvkSHgMQP2VCfmojP4XxU056FPipDNtvcd+xd6ySwR426oqvhPru4TttfP84vtPGD5BaI7VW8FBKrQ94GKh76Pf30Nl46CD5R/LfAw7JP5J/JP8qAE3ChQcRtHqwd1cPuLOPO/tgBo4M9hUzWGRfCl7839lXXmTp+2gzqepMtEjGTkJcAAFFMtaPCh3a4sfNfaoknlLc3D8Jvzq1won87RXzt9evQCLDVPACGSYyTGSYZ8YwteU+FYq6t8uP+/tqFBX395H94v4+suu3w65xfx/5P/J/5P/Pw5UBAUX+r9LQMP7/PNv97Y3+8nkHn6+Lgv8MJ+9/yvjDF9J1floGOt2jfHlObBIc5la348bwoyG5mxCL8LICU2rt2ZaWxBLZ0h3buQSX7dlucbfUDmc+oBc48+HM13/mOxKSakzXHbF/VKqx/lilnZ412yBsspFi7TYZ+2iHqafEaZi9jxKN7nOesTLCF84+NLAw/D8TjJBBle+EXKnLpKLbRZLwqYB/hUQKSqT2be12xRyR5a78xssRKowBddumYlRvx1deS/7PETvrd4zdwxQRSSIAwgBJfB6aiEQRWFyaiA3ncckM78tmeIBnLzrHS+rn1Z7p1Y9q149C6yeG8KAQIBp0KjaNHQri3Rl2KENLDuw/EO/ATXfSDgTtxar9BxbLej7XCeSbnNGl2vah1Vd3YRaHyXuk4TAvkIbPzYxJ6Zg4+xFZDrvuaPwynayXfEvq7FWS6QPdd2BMbKYgqFCwoEIVBBXqSRWVSs7g1eI/bammUhqPS0uUPjDnqgCi9GEwLYM2N27H/aPC0wOQAcvXGa4+hD6Tl0OAqPwRbeG7KM9FHflNtZtjrt0MQEjb7RU0vUb+KsNtYtn8nI0GCpch0eR1DAlwaOQQ0s54gv7cxFi1dj2CrBMiUDtdocKiQRwU1nPNwq27pPsqmZ79au417nlzU+n6rDb1SYB73rjw6xF9XPipFJcmYMP5G7QFo7vFBN38kCIYZyr+wARXfsYtNDGED4UAse1TLU6wQ0G8O8MOZWj5ZrT/yKsmhZA2EfYfKYRq/4HFMsYVmXBFtl13dRdj/FfG3ofZ9Ifo4cRPFDirJRnez6XghYFly3MsWnDJAiouzVCGExxIfNS7EQc6uUsRDE1+p2Lj5xgrQ0TTYGjkFZNCSKOrGhpYGP6fCQZ8P9cOVeryqG+iePVGVW0VWtRffabEh6rP3Fh+y1Vty8Sw4zas0JRZLVNHbErb9fIJC0TGdttbesS4EzEqjgPz2yeqPCHvZeOWLROfALOttq0ttqVtW0dsa3d3AsTG3T2Gsdi4s8fALKGx0269IyF2WKf/sAD3Ll5uEfA8ywBcCACLSydaw/P0kZDUCeaxSowQCSjMJr+m5P7nekaZNy/y4rO6v/PX983rJ8RuYacp7D4VtnaKOuKiDq2LOqwq2gySp9JD19k8IBD2CKUqET6W//fnn7ZnDIJJOawojNs26B9IQBwPXt450IpDagUNQO/+WaW5as5U7J4Ok3QTRj2Id8+50MSxiGMRx6LiWDQjZODQw6GHQ6//0INVI8bNxiObjVs9rKuSpcvojapkL7PRaE59ox5UfqOAw59bpc6Tnv2sbd0jtkH7/Cm3hcp6Y24L1fVoGQeosicOL2tLQ+VfDyoC+kQuATaqniNW9VwFBdBr2/rEgiqLR9RCFiioemzcMQ6AOuRGAgQKkRIJ0GYdY6YgWzK8cxVFQCVAFAENMhAQu9S62+vpyZ49K8aToiEEnZ1k2zYFoVEPynQR7BKhmsD0IZz+ENQchPT+NtCK5aT3EW+DrjGO3nrY6xCpjnGVJaCJcc7GxiCY3xvCtoxBaFTkOXOe7ijVmPjlsxykpvrzHDi7Kw6tsYqCKe1PL9sl4cMT1KGMaMTy/iOvFzyvyiE0sruBOUafYIDHgX7WiU+Y+kxMRtrMF5yV1HLKU1/TeUSBtKsAfbEH2kdNnwKt5ck2OWll2jfFH65Q/9dYfavo/1zp7+r/3yaVWlJ+8Ea3AVSkfR253man0NV5DKCyemnNwLr6mBuDxXKqIJaXfz2pXC5X1l0FZT1QUMv3z9YqaNoGz9a2FO2jDtuOirDuqgjrvoqw3u2ZNkNdHXV1OCDq6gZnds0V44FDG/UMPK9enODQxisQV05QVZBzzFXzrsq2880LJe8gInEA8UW+qJKekxJDOMYgdA58MXMQtD+Ebw5CoyKuMQjevRQzGTxZxIvbeWEkW5zTgAQHXgqh0/wGOqGBoWBgQBpICwaSk4EUCU7UoAH5TEo2TtaYGzA3gCDkA1taETmEam6A9e8Y5VihHNsVXruq7Pfp3QKPZb/IsWzHdUmVz8GHs8dWXQJ6RpvZbFNC/pTe5hoebdyCCsvUt6i1KQIWmMe2XV8FLjP7TV2gh7iZ5Y7rIlB92mVBXRWoSO36dl0CqlR7Xl1Cfry70badMatKyA95NwfjLc+vSsiPejcl3Lrd5dL4kzxvOxu35Ar5ts/X8ZUL5U0R160rD9PLK1lbSTB3FY6AU09FXfcV1HUavMAzMeygY0zFxvv7HUc1fkdhv8NR2O9wWNvWFdvabVtPbOu0bX2xrdu2DcS2Xtt2LLZt331hW2LboG1L8d4EQnAPBQ6Ieyjb99p0HParaGyQWsGvdRzG0TjzZgCC1RB2fwjbHITGsSHXHITGWUhPHyKoIbQPMhqB0FBFAn0Iv4Zg/SFccxAaFXFqCKs/BNOHaDKXGXnnNBu3mF8xv2J+BUBgfj3z/Gpka81UOoXX7aQRNtDOBnqbgT5vYOTpj38DWchALjSQkU3MCwZmJwNzpIGZ2gBfMMBa9LkTnMGpplNY6oxxN5KIdyO3G47dfcifo2KdvdUbQ972RuSRX/jpgh+L1Nl6dMWoPvzOlM6ek9iBzt0YLpFvLgKen0Thd3kwprATxVQei84chZ0o5irsRDFPYSeK+Z32wMei466DAiDuOhicdkG/2IZnsP5h4VkK+Gtp+PvjZyH7LxiYYw5CugpsTmPW2W6+eQF6tK346jXLp9Ioiq/eXLPX9T3tAFJqDkKlDWgZhc2Lvefi9nxE8HwCulUc4oP08bri5mDQWIJWKacS1TF9YPrA9HH26cOQZmwkW/zH3vX1OE4D8a9i8Y6I7STtIgFCvBwSD+gQ0t1juy2bQK8L2ew1+fbYSdzYSRyP4yTt3hmx7B2aGU/G/36eGY/BX2YW4dpDbjPVtfWJM3WGaTbDZCfxhD5o16t5Z+qca6alDjPsPHNsf9At2Ha1gK0MJ+8SNbhEG99n3yf6x/Pr+eBdojdwiWK4SzRCOF7AJ4qxVWkfs1fU6OwlgUWZHGzhbCUWJXVol/bBxiUa2bhEoSXzK+Ktz672fk4bgd7POeNeCktXIaCHhczYeXp+BQndRYBPEEYRRsBn/g4j6gRhxqUcVL7f77vfZ/IszNPN8G9b0sAz9LL7WIOPeLuFmMTGngIoB3bgmDVxKrQLru1s1oNZ2l0RBo4VIb687ZwQw+K4Lo7lte9IsOw+z4gZr2eR3eHv61Hr8+6EcEw6HqgONZGo1TNLpeCPi/oSKpeZUODf9IwCxD8AERw98H+GtT6eh7iIgevlovgNKiGMs1JBx6F4D7gAJOrpoEDHI+n20/c1k/iPxklxya+KvbCvuRzImFZJS/34/IKScepD0VLvclIJZxIQa1PDULbKcIbExHDJSVf743lEe9LVXlBrfE197QlThui0Jx3tDQwF7vqHsK5rS9xxUZVa0gLudSpJVyrRj62gpZVG4mj/77AyhJtBf9H6wAT1p12BmC10jrU0kwY5awRl6Anr1JZVYGd706wj8lduAsBXvlyoOueaH6IzChk0CtUYJZKNwnq91BllrxiFoD16inQah4pRiOkDZX8UJSHIKLFilLD5iXRGoYNGiU3O3U/peXSknBSjUHRCT9oleiN/JWCobGX6zRZklQfFKpvmZ6uzSjholQejD5mZZXSs5IpZQpQjxjxM+8jcYso0zms1mIH0DKS32VX21DO03f8dqlpElRhE+o5MAWHmdHvtkt+fTzu2jBzeH/9i6gosw+wo4qts+lV/FBv9kJOwqM8qJVa9hI10Q3PEvjlSN0d0zYm/c7Mt6/2t+szCJIxRI4UOe18tXLjVyLGw14ATt+PCTWsfblo7cdPai5vO4sa9eyeu6EDAMbkNTl8OTeXK5NBWrqx+XcPT1S9gbDp5BJ5ubT09d2YC7bmO/42Jrv+0P57zn7Ps+cL+uup5jkTXw5z5OGcipjbEoUwc0k3UECvHxaWDzzsycO6L9AdcvoQ3FmximjuCCMLa78QDp9FGiOYITXscdEyjPFGDzDuMcBCMmf5COhzEwJEnMgebbRjpgHAiowTWEgoYPdGq0tWdGjTZXyTxGbdOoiVNJNI9I2W6aWlfZJC1v6B9I1Y3AMJW70ZjtH9hX6Dp0rDXpSFqBGlVOnRME3ZMM8RC5U8+VLavyfukRD6CME7tyVOWybqecWpJQ23n9IlLWS7rGiZbe6KV5ZaUU2tJo47U/UFLGitSxYf1keky2PTDxxopfpBg6QeBEj+IcTYIv/JkKHrORQ418FECoh9FA+wP1ZKij++XIUx8rT/t6q8XX4SV/NxGfKgxz2BUf38wNMD/skb2BD9vwi1glUDRiChDBxlsXYZnYYyMlN0Fgr3fegIFDFU2vn8zphwPHpTG+/wCk9bDPWl+t1mrE3J3mzF1SIxBOb2EOQIvu4urAqXx8r1JwOQaAgUFCpA7kIgebA8V1CHrN08WiUBJRxRxYvnl+XxmE/o5Iz+uM7+Xmt3258fTG8iDGj16dvqv36d03cAiBwxrhwsL+SB34bhcHJ7WclFqYOC3BIebcEvjcCMQj/R/9C65z48A1OMnqtVELbDbTC0wYKquNtPpwEwPbzrTO6TkLSwKmtjsdzxulSFiiswywQkX3DhezPHh71COyhUjJzMvSyWGnfY6Z9Vucx+NzYlggF8F73QVLCdj+2wW/rmW0XBgGY3W9t1HgYXvPgosfPcS8R2tvHrvZMuhepDNq3VBxapqv2BbLNkaB6gg3Uukfn13WN+HfJPTv04c5v128sVtJwWdR8BtYP3AjhS1O9Kf/37poeS1osND0VuxN84QTbaN9ZZYEy815uo29Io22g24jeAxCTrR1DKIXNCebGpM0r2GtAl0U/+W7eiVcAIIUjLSKpPWmPsLDK2XpBtzLnVqBJLoIhQRdQNMYCBhryXEkUyJOeX64cx6h8fwaONpwo5OLKKN2CbaWGtP4doLQIIBCOFGwUZqE2wkFiDPSkbTzRQmYvhLAsdwpQju4GiyiKyRMDXgycd5xjWZDxQuBwttoGDpcL+sIK5QrBEw+WJlgV0FUDc4m7m2H84jYDKaXebSmwRmBbr9fDytgGuVG28kug347GHDMWjYg3odqGKETRySFRiMbATpuvCi3v9n3P7X2p6dK6lo4IeFhFlqsYyJKAlMhnM9FybCIgY6b00YCxnFBJjAefL6V1b3754b9r6BAuxeAghNNH1YANLyDWigmL4XOuMRqHMKdLVhsHjJKX1K8uP5t+PLi5O9nR15jmks7p2FgQKm25oXipnN1A65geBhtdjAhvgsnUzdDOsZ7OwwpMFDarGOmgNNA4a0k5kzVzMDB9Nigxm89IDMbC41BLKq8+B1XI8dO2XiwPWQYJppnEcLeKn7dAfb2oJrEXiAcJFWM8dah5K4hQSZg6TxlZyeH//5ubpgurzDRK0RFGwDm9SUu48DTisrlL7kU+oK2QYFO3WIWKu9QkTTShFNK0Y0YAfBJlpjLTAGSbt1SxhdctqVnY4Kp13h6U0LJPHAab8FyhiorgXaa0Ew2BYxsipjZIgCV5IpCgApUo1kiXjgMzOr6HjK7NbKr6wYoEOmIU4U4qQhBlWwSs0jjMgjLDUMMSY/VOQbZ0eoiDdW+CLK8Eqti2SlxipZhyIcaiNkHKGujbDXhuAw5mVfa2bBIvdq1awByWFXcjgiOexKlojvuybXE1EIKSpCDSGVCZ8werKo8tWsQV9zna+nWCGkqNQZeqMYOkJPMbxy2KYm/Zprhz3hQKashrTxUQhGWT8FEMALkuFm7/66a5I94VCmrAa28VmLytyYIsZsUeks0i7WUSfhOxzJye6kUJUjtEXc0lYDiYzIlWgrK1xpF6jNxpDD3MXZlgnq3q4823spz+u9aOq9iCOvXMJt2cCzvohbVGsJSobSl1+LaykxVMq0UnBSwHS9Mm7LBUxhHqXVSpQ5O6UUDdKrCqmsQ6oqkQotwJ72vrNLeLgaf9dzdjhmv+xOp+fXHM+dJATwem03Edjl9e2WUgp1e2FMIngptW8pl7365S0lNz0BXJuV6S+A27CkK58Cr+UK+eFN7/YT2DUkJY16+kUpu3tZtYahvYZ0uobGq1zrFDl1TsyaJa3KOSVqajpT9ecv4Abb5FKoziG0NxlwnRjCBtjTArS4YQ4DNuiggT5CIF8UQmCS4QABx3G8GaGOrMBHrMgOuWwPPgDgQ5FPu/Kjmt5YlVPIjz24eUvgZkDD2F7DaLqGtlfbPfzy8MvDLw+/IAJANTBt8BsZwG/U4zcYfmOgwAK/mWRvOtjwIR77yK0i2/ul7gQaKvLDrvxNTW+s8i7kbz309NDTQkMj9BzQcGuv4Wa6hqKMtAfHHhxPEOfBsQfHbuDYXKmhDGdD16IkcLZ7PP6+S7O5gbWhvgJHhTfI6R8or0AiGCrkucVwjFdRRxDA1lRhAJWusijX8PnxSmvOsS4w6Bme/YjING+/nssjD2T7YDiHpKdWOOdJc50aadaxQnoypEA2+jKZ6+U2qRWlegWlSDRaDqu433pSiUV9hBmwwwwIZhKKMiccnd5SwhGsQgNkCyXQa24iIagezUn1W3qhJpzyQg0G7p2jbQdD76qAuR3eZQFfthxSwPVxH2CBqtGm6cRuC4GYCfzdUzrO5UUdGOZC4IHHVLHJfJtcptfPVoc+X2G28n6wm6+WPednrNMXKDMW9Khvc7wSR6n2ZPXPMb/B2erqzb/10Wpy5bolatb1Dx/mA8usB5HT3RxEosAfRPxB5A0eRE7gojDgPcpifyS3Q9PQd3CmbWxmQGT054IB2WooGN8QBZ9uiiLJLVHksiMVAMFazMXHlr8Y5C8GQRMwfALDHScw+OC7hRZT4fOXEnyfF28CdlIfiwfZc7VYvAEnCFjQgAR/N8gqtxT7u0GL4I+lE0A9vrljfHP/CZoegVlo4RGYR2BfNQIzpyW4XRUSoK2BcP56kBWE89eDPDr014M8+nw76NNfD/L42ONjj489PgYIAOXBwQA2FQD7PDe2HoCG9/DsBy/2yjRp8QzXI0Bsyr4wbWCJb7UM4HP+iICQJEsjKzH/14gJm4SzEt9NwlltD4tXRO8v5Qz2zunUbW3m3XWGPX4SzgC+hF5v0CWdY4e+9R4N2lVO4E1loKZvqUmuxsHWJjk6A24qOg36mTlkSiLXwi9Azmvj+hvhvM7WMWMYkC2ymWwRTLZEx4p3M0ZPZ7vRY4eYzg1YSnZZ/vvp9WXZ9enywzc4YF9f/QIMHcDAiSozBOZxczrrBVT6TH5SL6gkRNNVwI0EeFcOGrRZqezsF7jaLwDaT/vxMwkw8ltWbW+nRDtD/sh32ZubIc49DO4hLtJukFgr4aDDOiuFn6aOHThlmjbzUkzTD36OTpgfK81RP0FcrDdxgnwQs+P4OXs+/7imV+x6pXLFaGnXI9aE9tBlLpfYTJdBR6OeBUEYaR+mbCUyQtClUf4KWcHo0OkbwKOHBReb3SYYKqJkgYiN6b1x4uoQwBl3C1dcQZ29aAV2d6MVdD032tDlz+bVqzcQ5oJtNs4xLOjNTB2/6I+p/AWBhbEco2Da5jFQf/Bex//W7G5iq3vODisEgLASAdoENg/K45hJv03MaNpT8cfzlJfi1Qdyj2fQu+/qC7YTX32Xn8ld+/n25R9Yv+Skq/3xDH29O6mowa9rWz+ubXxbe8HH25d7UZt2HmkliBhjm/UTrVrKT+mB9UIgAb9qICM8ztB7erWRgx4PGr70UMgDgPWoWK909KU8vBIj/Uk1e4B4i+biiIyUESKd1LxbIpLpBShgwkgZIQrWiyjf7p3YL+QN2GocWxhlGL9Wi5rFtw5JEZPMIvEPElL2j8DO8ggsGBQ2sLBBgpwzzR5f2cD+OcueL2uDQ0wiC2iIQ0LxAzTzngRhtIm3GJp8LyLx4PR7rvvqSe+7qIc1o36WVd/xIztndowD6e2CBzBwIwQIgTFnojIEBsPtsMPV58uTjp9JZP3rGbockZGDSBx50gKPIepMxvIVhmD8iLWqE58lCs4DMCjQn7XHbJWPiFeoEwP1hSqya2UCvXCqCO+QDyHydzJkYs2NI/J3MiBjrY0j8ncyIq+EMwmItalD5K0yFUNiYGANdHDzO71tmPAObubE+nHzqyD/VBmGq0N0sl/lCcy0qH408/GVtLRcCfajp5Xdq9mv7F8tZSh93SsfVK9UQxnJlGSMMpZafw3Ra8Qka0g3MmmMMJOsodxKzVd6bjSED4Lw5b8sR69bDRkOVC0xN76OFsu0OODEpZaYtCci/kEPiPHraK8dtcsJJ8ZER6l2FO35CfocUesj4BzNT6gjj5UGIhQ0k1Q7djcKQwzQaKtoFDc/Gx35g9LA9n/2rm43dhoI3yPxDhH3iPgvPxI3BQ5oJaSDCjxA25RmRenPdukmPD12Em/sbMYeb5JtCys4nB7O5/F47Njjz2NP5Njz/U3jA7DWBypBLG3ySMpQJcfh7SZj31vXLxIO9OrVOHekJMDmfNILp8UeKVHuefhiOA8/uXidC3sedqKL6mJkHr6IZJ3QPHwxmIc9BVQF9jx84ZiHL4bz8IXbMp9syxA34/XJtgxxM16fBpYhkZQQyTohy3waWMZTQFVgW+aTwzKfhpYxwGPa/2S0VXkozlFQ/2TY0YeWontVmvXsJ4feJrhZ0H5y6/1dkN7fhej9na13HMnaHJqb8FrBZXUu3V8sElCJlr0K8rs1McUr8CsMrqgp+SePZBOszK0kw77MZ9uXIWrggpQh+Ww65JUEf1ZlQBva+FrhnfKpLZ/65FNbPtXyHQPss2EdWV9z2vwZGl8muG7ANQjuDflYRLKeSBaHh9ez4W4oDZR4yIF7piaWSiwBsT+YKj8rJ0qWBs3xbDqRynZa7hiWm86pbJ4LKwzsM4ueuQNrupI/fFb/wtjUbJ1QrUtArPZE1LoePaeOw5bi9v6z5VHKsgD2oajNMaf6+GsCdcaLAvcOyINGgyrnhmhVWI0jB5zEppnzSDXEiSe2qYvagS6qH4nh5crC8pc0OIfFU2vsNYPPCiGypVNTeUIjYsge8biksoZrpnQHvhZiDmpVzG8XPrBLJfsJNkw9MAyXv5jTMMIyDG8Mw6BJZ2AYYRlmXH5yMKmp3oPsk46hKYTODubAooZl5yNoUDaNzTlTNiOS1TnmTEpsfBrJCl14a0DSdjaEB6TxqcqijQm1ZYCBcFCkVkVquMiLlNf3rpLerrmf4QK1VaCWBUpXAS1fu5WqRthEWrj2K1V1ppMz7gWshl7ASrEgYB02vm7xJYW9AFs+9cmntnyq5Tu8gJX1CawaL2AFfZAmuG7ANQhe2V7AKpLFoc3yq+0DrBrhBMDaPoDEEhD7g6nwK1EeIGi8VzSN9Gqt/7JhMNJc/V9Z9MpBpLX2r+S/IDI12yRUmxIAaa37r3rdH131V9aqL0uOSxxZlmFFSWy2vl2UHWhiW6CoQWxRfW+uO7Ko/BVL6wKireVYoWOFB2VTU221HHeSgcV4ZS/GK0CJ4WK88tmD2/ZQlv4aDDIZGITLX8xhEGEZhCuDwMvwwCDCaZBXewkmapJQ/QVpko6hKYC2l+AWXcOy8xE0KNtegmUzIlldFENoYqPTSFYHo60BSNuJCB6Axloqizbmc1ilqIcFlE0cTX2Rsqyl9/uWul+BvrsFryW8hOFatrHsfu9Ydr8/WHYN9CF+/bKNTRZZSW8KqSKjcJNeUKW9zK0EWSFnbSn9HwIV2pGD4J040rKAIuawUBK8PO56EA7XllKSmp9guz2Z2ik/KKoAkz1ZrIlC1hCSmd/AE4meaBQDUHMye2JwGNSTOTM98ebcr4TotyfDEE9CNav6aRxbD7CqYTWArb4byv1ekliA3CFWjt66w46dMg/H7o+NnwmdSdsBlv6Re/tAe21Uie4XgSI4Y6sCquM3MQGfLzu/Poexm3H3i8Cxm6sBx+9mslc2kw2itbN7yPGvot3W7/B2TLangKrAZrJXjqlvNWSyFRje9q9G5pebgkPHMuZ3pNAKG8UA+rsRNNVob9DhZkeCgg43JTkHHQYGHY5HAcrfoYC2izZ06+KYkEMeHnL4qa3uU0h1l0Y45aWu6rKP97GVYuFK/dgq9WO4UmKoFJw1W60NtVoK3kO05dVqVMVVq+IKEyT5BAZsqkW0bhZTjJyri4BxCYj4btzgSo9m8T1Ha7aYrfUNhkRrNodKpfqhJAHRmsAdIGuMHHuNSI+QowXsx8fxOnzfSJCeL/oFmM2OakP2Ya9r25LrOQJfB9GurYS/i6XvFq3vrbd1aZ6mjQPoXWybp3sZTagTvrGkkzTO3OKvLfEkZcyJv6OpVUHiQWeWeEpE6imQm+JVgYw6C7DYbgBlQuNNL+MUa8bYqqZaNP2GavvQmzInTggd1yQN0IR5VGHx/2TNUK8vcEbVgCq7n5CPLrA87l494CxFvL3Qz4FJKlg7CeYkj/ez4Ncq7j2nPN9PhCmnScbgp7wEY52glCZpLyhLeCK10nIkLk9SwkE5nCWilSNyLgw5Kc94Kno5ecZYRmA5mUhbOYnIDTlpJnKS8L5dMeMi5qh2payXw1NKBevblQhOEiJAOUmais7QlBqGpmmaxEz0+mRSDI9hfWQDOn0yw84sFTHplck41Vs1oNepVob0xiGMp3Ge9GJyIlVjoJg0pXErhsSCs16ZPOVCZHs5XHCaJMTV57Huc5IZgzDheSJob5wsizlhrsHDRwcP4VmcpyTeC8qJIISRkHUd/EjnenuGJ3l7pYkmJE1DPmKg2ULdRqF9o4mQ30Qao9PBJjnNGoUYz/I8TKHRDuWcJAnNjGEqB2qG1ockPO0UyuM8dJobG/AZFSk3JrmM8yxJ0ArRLKNpZ6FUBF25AhRiWUqMDzCXO+WYoPVhnHQ+AKW54CH6ANPK15ySVHDSf8pUiJhTtEqcpHnbZ0SwQJXGZ16SyYUqo/2oThIR5/hRzTJGeaORmpVCFIKWlIzyJIn7QSQnF4ZPukzzeD+qBZ1Fn1zEWZb2FopzklJ8n1FKOGk04ikN+sygxTuX028iEkOjhJAMP7AJjzsHR5A8yEaQfyMFUk56G6VMegV4hTjpPnwiP5ygqRFQSJorpwnp9SGE53FAAmu9o9Sby+/bR9hPfbnyaxpnjGFvVyZUvMmrG0X1y+OLuf3zJ/IpartI6c/loyqxqe6m3giA6wrM8wUHvNxaRyNlQVvxbSnopQrrdGSHKXM39gBFtNsCaGbVUHrQ3LbPneME407YxrljDmxiYO/UmaRqJYhOTbSQ6NqFzswz1LskuksdiuT2LdAkidtDOLgEiU1t1EUhKQQEE0O+LBqRiMFgaitDMr8yzFSGEPnL1UWEW+qwxjwZDBdDeOqEJ5YyvOlUlzaphRdR7cFntn04wj5m/yr70IiAYBpb+mSRLO5Qh1p9S2PTmIdgOgSnDrDVq5RoQwJobqFpVDvRYjDIqDYiVCCxC3i/kMpUv1VdCoEUqmz1SSLBAgYLq62sGe/eI8+PQK/+NwhWK/DkyrjwuLVWstOd+9oPJpLwvGL0+LxiTUPr1nFAvLu4LCU9CxU8Cyk9Azl+PCVtSlEDNLDjztz2mds+c9tnbhtP8s7JbeM+yIqy/ewV8jk2nl6pfzjIuKJDExfUm7ezNwki16W7qNUWb6O26Fa/IPa02e2V7Q/zqn0+AUEpdD4BOUqh8wmId30+n4B49TmfgHi94P/mCUh/7KFWs8fNw+3m1EcgIuTpcfFG744fPtBIYjNbLViEBmXzCH7W8YoelKBdCe/71d1Di/pQxvu698hTjp4Xr6+bC4mA6jeWJhWBr0zd1MR+lfoaQhbmI4+y8tLHLaqUIUri9itEbpFoE1VvluqXALl+CZzCtiYhSf4pkL4EyO6Bzl+yLI/mSPtxg3t4eYYUvjMkEgYoNPWVoPP0j2YCXs+fxGQ52gu3lk5PY0KmpTGpCCaJqTcPytTyR+cxQaZBCY3bb9wH05X4TT4YsPjKXJjny7uojMBr5+ZSHP1VRBSXtyGOrqOigqCVDd3soacNcYemoMl5nFoJRTVZBHY2HheBn4yhmbSo8LZQMvDLXtC6UlT4poBa4EWMr4/4VoyXDxgT4wICRoRDwHX4oqiU3ra/bVpLXitFzstiMzSnLYv7qWLKunJEkzHZG+A249bCJZfSoCZXZGo3b6b18ubkvYxPsr+Qv1QRXPmjHKbOSVLF/76+PWmOUypOn+P0MGMpkk/AZCyt+YB9qAkApIbYmkcEmxALpB4qs+qNo+rKrLpyVF0Nqt5E9NR5TVvq4YB5aLsA7+p9yLymoAwa4Ly4PWKGEwGoMdEJrHiAEi4vjiK8sBFioiatC8bnIyaW8r+szN5TTmyn+ysVn0gdVBy3lp3A4bHNqg/Fi6vNn7cPP9++vEwwdMUnW3oWN6nmx5bH9tPxhr5f35XbyZaePqTriWzcxI5Cf1EoS88S2PHhbXqqwT/zJLVwp6BH2sReWXRaRHWNM9+12uboDc/m9bb4/vHhQXoGjxs67ii0Bxgznl8s5ibsP/6wDx2xl5c2W998d/vPuJhdQXtB4LgpFeqbgO2xrhTfsXZ3jnYyW3yHO4guOP0Wt6JhdyUr83j7Pqooake4QaVxbi/PRPzUO8egCx7w9ub1BruTPM8ZYXOGzSMe/jXt5gwOAXQHIWYNvzJU70WBylg7Q510/mKj8xd/0/kLGRv1P5rqKt4DFaxiIFKYSBZtwNmTh11ct8KTtlHNQcHUBqJZR4dIs1HXEnh6knCmqR4brTT5HiDrNifnleUtV5aaev6eIKZzvy6+hYXrwQD8vR4ssygjDGHwrlmcdJXjo6uc+FhRwAMwQ4YML7kwssCFMRniGX4hrVhUJeCyR+0ll+FWUimS4FbSxIVMLeT/YM21gIkpUriQqY28/oDLODvtMk66yRRXXds6dnzrkm5yPnsNC3kN1O01MI/XwOb0GthEr4Gc0GvQIzPx/L2YRZlOWApVli69UR91YoTpxPzwuHto3g4/tQ9DxVI+DBVvee3J3OOLwRWmOa4kDa49+Z2lbQncSQJ12o1fekLkbFZeg/RHdhGHsLtL89ZRQVXqUURaY+XnXUZSEX9WY5UcNpX/ItMJb0v5LyqXsMqVmil9cyjJK7GTJRN//hulLCFRKfV1XYxjhxfjpBDXuGIHo4RFnSxgXNnD5NCp1v9A7rvu00tlT3isUMt17SzvycB9JccUjORmBzUDigFIYfcPR9x9eBaqRaXXtW8aXlRwwysrtSFrsP7U3xJ7tWvSngG6lqauSR8f54m5q4QUWpQgNjOxqURGjumCml21c8ToJYOoP1kUdankWmFLRFaxqy2VQMcFlL80XIuO5T/N/wM+1dpUw8wRNYKt9lg1WzWbR0RO8GYOgo1WyJAyarZPffiyOGCNrd08FZfXti+KHSXosEgcNfVCJreLtFidfwwswfoSCtmWOmUercPNm32F8wq6v5kGbdaOuSHaxQngKmh3gwy448rwd0je4AoqFCi6DrhwBIh4JgFRnoCMigfFq47LSPBqxKMCsk4JRKzol1+cZgs98yZ6mYhRbXn/9nqxqKNKIAXoNytal7iUv5dAwq2/gjJuMVzYE1S9/kaPS/eVIRsPRQfa4+IwxnW2kdJNN+vaP1S8HUVtW1GksZBhd67qb4pB3Qz75NYCcZj/PZPKzwBZ8cf46u4fwqZNdPkPMWmiSLKeDjM4sp9v/9ieObJZWghxZOXyHNkV/Qj8WGnyY2UIP1b+h/ixasCP7Y7hx6pl+TEsO1Yzs0cD2LFdtHuP7FhtsWOqRTvvyW/T8KKGG16b7FjNJPbE7FjNTQXc7Fidmdi52LE6GTJeO4p6R+Vedj8q575mx+rZ2LHKVMNMtu5k0pq5ql6KHavkjBFKXDV/gaSumv+hSzo4NWbbsS1xerILehDtiroCBUQIE0UHwp1U12ZKJMKAS2P4B1/egOpyXWdWQxzDD0kZAfEckAwG61EnOBHcpcbxqRM23Z7xXTFdH4Lr6roP8cSu2kQFBV6gt237yQK/bet2bZd626ZXqOF2H11c/cbs8gy7cd4P3/dOV3WTJvN3NmQr+4X2rwVvfFekoe6D2Q1d9zi7IX9+Q6LqP2/M+4ewhodUHR9HUWG/tPuHsNkOW/5jzHUoikqzURZFdbm+K88c1TwtPHNUZ47qzFGdOaozRzUfR7UJjeCqW6w/wummsAicmUmtTdR8pR+S1JoYjWUb/aAEPVNaZ0rLopLWNYYGWphKwvFZ8WRSzaHCM8E88nems0Y2eOXltE25HJ9Hhk1N3R9uZtqgHr1D1gLSr6ZsULcHG9QpRM1yVNi2nDZQFIOyLOkYZKiJjNb54/kYH8/9Q1j/hdR+XOCa/pqm1Ky+pamkluavbFbr96czpTVLC89XExG01vlq4vlq4vlq4vlqYtDVxG1o8NUyVxO3zUcXv+uriUcEX/2lCx0ahaKZKr5QgBe1a3k7Pgy8z/i2txm3uAr+i7cZqwR/m5HNcRWRwXci8ZoAMtYBSdg+0H3GD0GLVQn2waDlbgelSAHeyzkjjElQ+SNvhaGvJwVRNktwW7tL7P1Vl62OCw7alsFxSSM104OoqDekxd7BjUT02Lt/CJsA0OXf7eePtODuEnc58WN+EShyTNNgzf8rbm+u7h4flubEXv8weSsSC8KTEz+X/VIW1o68oNHrH+78+33Mwc3jS8PhUJK48HSI54yi3hGV0SI3yuOvvInreqj/9W4FVcAo9r462kEJBC3qnvJZP0QvJdw4XYDaBVrroV4V/Tp6bZrozyDYQ/0viyqoAkaYBIYNtLPGabNJOxPGoW55jB8mByTEn56zTk6LAe9/h8mgQTKAII6gtoxHKQQYFFQjoFdnyYmohAQ8IIvJ6qwasVWNMFMK1myeXdWse6rg5Le6i/0On+8kkH51rL9Ekf6S+nPQ46xoAXxiE/TMc2z5iiMvGqg/Bz0kjxZApwogyCYEZjHW3lvryq2v7n7dbtZPt0t7c5JgQ77yvqhHF5jOeJgvBfnGuwRXFJkpWAI3/sfQ21fWkU+sS3BNsTmSaXQdvQFjfGyqYvrmjOuoduXN9KU9LMsw4B3Mt7Bvw9d1kymt2H9uVa/phFWd4rbyE3NJTnyXKnQt6ZcPvZz89fhQLLspX2+sOZlFHDidvEYn1VtopoA+sPIm5ERkhp0EoMXEQxXtpCHmCWuW2Cn+a9slq9u0HXotf5vlVOU9zBNTvP/yZtqHPtVzLm9mninUn8x54dvisXNBl/b1KmJNFDTLuaKTkL5emsfJHu7PGERY0on3EmctPktb+Sh3rvRqb7uKXu3tjKN+7e18P4b2743tQnk+49NZALEyLiDAfwPaEERTAc4bflaHRAQ9YjzH6zBLucP3AV26qEcdEAIxv1eu2TZisW18jtX2fay3k/xyMpXrmujYYx9uvV/qfHczC1fn56nUnwOyMwUIYDiXBe7BieWnXj65R1oQ7XN1Xpd2tLTf9fD39sQ03/62wVuTfMJx6rixYrs9LNt6V9CDIP1iA4BLC1x2YO97Dvuj41Qp4g+UV6elpRd/PzwPljUC0I0FVcAIkrodnqtKvaANuQVVwFPm3vjl8f5q05KPlz35eKnJR/mDgLjHYnyr28k8Mf84B6sAyVh396hRQpajJrQaSBd0Mr0BqbEJUOMoigTVJ50WR3h+yo5bVXR+nuVf9q6t12kYBv+VinekJr2OF4SABx4QCJB4HttgiHJg4wy6f0/SNqzpSO3EaddCEUIHcF03l8+Ob5mG5YfxtLSSo7a8yY7acmTV4t8fxrZBA54O3R+162XXO5Lbo8NQflZSVToOnWyG4xGTeYCt8UAOEUIMa3tMGGDKFjt9KHbv1z/HiLtqlaUpT9CFpTcJ0P61gpMnavD7a0QfVqZbcx01MlS6h4s+t5p37SzJg+gBnGd2Zpc8M7Dp1ZnVmWao3ksfBOMzM5Imbb4xIESqEfcLsdWdqnD567ePvPtAIunhnk3rDz8uyY29mZOPHwXiNUEo/oQvVRdtwlUqpIlxrjOumRsY552qPfG0kbEW95c5lmUeiMEHMzIFpXi2b1Lia8bRAzh/s2IcK8bAxfE1W26kTduMEykxqt5TME77Ga/acycHuIcvS9rzIceijzhsi7wCRGasSx33UfPLF0pqIVnPJzJtuhmHRInbzFkEce+Wlpp3lSx4Qyf4Xk6U4vxUrY8VdJ4UJy4x2VJeA+V9B5lrtEAcKKurMe/HO05CrcAYT0yJLITix1rBqQpIZjqwymmcTMMuQ7ctmxxUo3Pew/mqTCxiFYa2XSk+FP7/HNH+5KHCBwvc/f4S4SyyPeHLvShX6huFyS7CWJVDqdfifMYlS5BeZ+BzWHxpffR3gmb0EyOBSnXFfREkD4PkCQF5Vnbi2B7i1MlNneTUdW2jHuP+aEX4FFeRjlw4dd3th4V/Olh7at1j3x1oe2bd5j3IjNrGvhAMwLKv+pTDAo7KFLau4hKEAVw+JROQmRQ3+LUFc4u1s2fXfBrWeDL1jTCnAZfMvrODVStV0DyTf/kHcgexhhfZuR7i+2fAuYMla6cY8zqVgfuwlm5rKxVoU6kYLJGBERMRqIkQ1LKlI/H5YVIflX3QMReerovi2yjxePfGgjyhNBbsEMdt4jReZdkNvMvjdCGs/7NtEaz5pT0f0vRpmFg2vtt7bXt34O1viARv1ezNJFLLu6hECoMDN4oUX4kUBw0njKWFacC4Lbn2RG2c4XzQ1ubZDYrsI8ONG6igQ23VgrGM2hkXN5zhtnRNBdotCssMJqXalH3l0BHOqHTpR9a0z8e9wL0fGfIL6hfEhhfE+FTaG/gTF8MYUXx39GgYT8M0JvQfI5bOUfNjy8gTAzA/tBiqGh5rGRfUWnYjA+6JgfMkFMjn0YcDdTzongfkP++K4vP3H7thfXRLvulcakCXbE0Mi/lla44VCJyC/rZLL/xvMzV7fUlKLbR1xJvPHz4M34uP5Eayup+C8eQ2jWFo4See/Mk7zNTYGO9L6PpH1gy8M6G6CiGUJ2oTadsRsWbVzREGtuLQp5xHKndHUivOvV6j5tnad6Tkhr0uMu9Pc7pYeVLg9Lhf2zwIUb39q/SnCJHw1pDi8t0EqZTBRLvVE05hH83HNn1cB/LgC0YEbRnJ379M7rz2qEX17SJwguxHFhx6vJebsiMAC7iRtstYPNzHmetjLMkVMTgUqLze9jo6sHaIF7h1o+TVukPculHibt1oBjqWwwF2pTwkQtBWhiB4T4b4rOqJs0mOrM09FbRGj+NGlyTTJelSH/cdb+MBd0uNFICJwUgNo9FOrzzkwXGvFh2YD31IJHWIS4eOemk3ZXzV8gt1r0618o1TvTnHbXlXgAzJ1SaJoUtpNtpXbqrPxF47XC0k8+LQFhKTv8+ZYQ5zU3rFuB7jJoPTohdZc1o5uOVw8qSVwllZC/guDEiXsVLx6lpa1uPuzKfu0j0gHbL8bzyEVrZqAkE+nYY9t3Gccdey6hkPvDoXHpruDUnt2U19nAuHOxni7iOwOD4i3L+H03prTCvcNC7ITQUxVk1PJV98WibWUam49vlbN2BGa0QTFts6Ahha3hpaCwe8nawp0gHb78Y/gvdMAt+aNN8aAzOT0L42Qd5HiltGio1ptaY0YRsuCUlYYbUAQ1s0M0gSVugD5EIyuGbGuolF4VEGI18xWB/nfxLNzAyQV/DivlaysZpYydYuPR1/Vw1qyS2q9vaLc1G1i6qF1/w/rmpRZWUJjFMFFTpqllawYCFFgpxM2Eig5I1HSK0nWVoqTgspUPgIJFNoIbG/RMn4Eiaz/UJ0uvISKkOFypYw2b8UJjtZhMmuiglPFSkxnnayiqddybCphVhCb72ht9NfQm/49PpT9X6LGN3JQ4zuZBOj21zJvKllGC2cdzKG8wyhP22AjaQnm7hf0mWbGGRtz9kpwgcTK6bVAIwXSTzZRBLP8dUyiCWxr6CjNnKb1tDBIcpaGtPqydoz0hufPGfdCclMI3cVyBS0mKBnLWo2q0jmcY8LM/4lkomp2eb2Ndsuocwtqmr7prFMSqquz1DmcY/hMVAs85y2Y5nH/X8Wy0Rcrr44WK2FRTkQAnBocQ7WDzRZ/ThYD9RvXRyseOeilbBYB+uBtkHdHaxLLNNxZqeGZsUSyySqWvrmkn+32eNWUwBDScm9oDQfB6UTLyiNjZwQFeDRB0p70vZg8S3RsCljLzZjMg7Kci8oi9UpRHO8sLAZnUKhlCAk1uCBQ6GUgCx22UzDxoBDoZSALEp124RCeR0L/ViIMvP9+nj/pLjfHe/W97vXx28bYej5DhoaY1bKWfjjxxau6xCetF7Sz0XLDSrJAr7i+aoTdzAUm7el+Vwg6sc/VITjX3Y5oD/JQ+k3OTH+SG6cXPivlx7Ol4QDkXpi5JKGUURVHyv6ffMTsmqa2swPfL1cvw7vxzZdAd8fOrxcMsDZXODrPVV/16BuBnAd359+Kwrxn0PDut+L2KcPo2YewwNpCwfHvE19OCQMfonwkdgw4k+kEymsRiiEIdG0rXnDwPEYVlv5oG3Y/3YQ0EyPh7THkcK7ApJCnC4O3d2JVfrtODgSLa2MZo+iSzOjeTczGq+d0XBKCaeIloZGA5i0F12h65Bnu81nGQEYXIX8Z8bscAhqg35OyLXYwo01SHAyMpotzHHmpPHtOGPWFUtamKFDSbE+D44jQ5uii30Z/H/A9q8bU4iaY3NvYltPJcac4khXYYHzE7ojmYCsLox9/vF9BCDrFCYlQbrgwWTw4Nc2vb4HaeJ4IK2ctLJyUisrhxDcJlo5Ce7xC7KwGlciKqrUcoOpOM6oohBEx5Vvm9PX3Z33ElLg8nWWRZwHnKXC4sHcQsJDltX0i4FyJYVFfYBnRPrL7RNs+njULKN985MVLlEiEfJlOHCBWcgNBB+lei9dZWHeYdZPxaOVkaqhkLt0kAtYr/FKh7Hn5f1xvRkcxUre9RfN8WYBY6VR7A2N3M2jkjujUe0Iks/OzEBycQNxdyAiGkjImKbrDldbWd/gL+6+n+5fne6/n4bf5JG2yXmQmO5r0+giI12i0cVGulSjWwVsQrZOGePxZVCMYiEdpMoID1KD4VxKwLmkfQ5M5gJzSQVziRXMEdKLiTCHPAeaHq/3C5hg7YqSOh7qSFmliRVvRVht/Wl3M8TwsNv9nY7c96n74ejXNm/iUnl9QJrFPoWr/4Jftc9D/IkuzCIfnoibGZkJVdxZRd6sNjOy1E2Obl6Nbo4eXeZndPMHzhUQ5NBkjhhhcDiXhemyMHu1jK5LdE3zcv3pbnf/eSM8i1+GNsq1C4/3kwxM7LcRRsss+rLPmShHse1OjP4JddlEQCxRCQGnlyhEVEchWDvPzCEIkeLM1p73hu232uSJWShI2/FMPYyn/l02H+Eg8H+5AIyKSFc1Ji10PH0dWguVvOMaiianheauP0D/L8jBXQPNMsA+jAYiHymQ7pObhdF7Xize6wphA+qwekCtikNtvgz8DAeRl0XktIgwelAoO4MefLf+PnwR6ND5rhMvvWqTCkXEFPH6nguzYL8YBZ6NAneV/g9XJO032G5XpNoe8OEJlDPJPYhE9qa4DUzeJfZlogJ8g+I6wN+d1oUM/NwcT/ZbFmI28z8JKcpPlcwoquMYfUU4IIimm/FxnBuiuLMKHvvbpZet+LdN+ur77ri+H6GAsYyQuSXxhHNLPBgpfvJCyKBSxs6o0knqiP5lWBn+REjMyjA9znCP02ClBR46tOyOnwY/2eEyXGeME/EUYIITYCLuuiglo+njhEuOKwEnvLT9GSzHVW1lbXufivvP27HKcfTymijNkt5qnLxTjZPl/A89bJas+CqvyVHWCeM8T2t6VEYty5NVMrXiIJuE2eGOSaq5aY7hMcg56czbWarnfOJIhYumdCqI0A5xVSaT5Yj0/f7qHbmnam5REituRiKWh9xEVG2fP1TI+h2FhGZmUZqBhpLx+IbmYNU5mSURV5wpicWKDcsZKKBRQYXil08uKU9gfdVfEFYtF8UMsVzSyI1q2EVltST4Kvszl4QlIdgQLQ6/1YFxtCIuBh7mBmaG9RfHaeZCZbsY7DaOr2gtDfGJeGO1/GEuLA+ptaMoxYJSUReViAQJq+29IP60EX8BZus5uy0wK/zsMZovcOoDOv8PY5mlEXkv43YpasdrIIPdywjEiuMUvJtKMXdgZrtHtG1J/UoPMEHHqlVG11NelJ1kQjZZ3I+BaEec5nTTHXKvPn4sPt/tqtqXERzv8e0d724xLYQbysZj7sVz7xpCQDve43k43pHurFo7W2rmeXvnLc5+TYgTPTz118XuwxPVDGjFkNrHiB//36k24n8X468VwHfxr6NdaNDpkRYHyfgqwBU4EQjuIZxho0cGiWbMrdUZqw9ebLQmZ4xoA7MQV4renx/CnN+PfD0BbzRI6SLO3ZgW59LrdWi4ISV6zLAWzbrZK7lCKMXBDbZC6KFsdyh/IbPJp1on9Oqux6wZ3JD538uD5oSey81MGBbLzUw30Sew+wJ7jl2ub3K9vgn0LdhNxH7j6e4HsATLx2IwyaB2M8lFgx0yvLjgKvjP1m6fhdQ9e70+7ra7j8Jq2o5+QXp1/sqCfJ4WxHDK30ZxOylduHnjrI5fsLpcWuQ5eXSQOnCevRszqgQZQgJwOJeF6bIwDQrOoM+6+u77eqQqVU3TLYGNiWm6ZH6azjm0QUklpKFFTnucIUvaja8nBkY48nkCXCk46gBVA18LQtwKIZrQ57zaXfxm79qWm6eB8Kt4uGeIVgfbDAwTknLBMAMDXMBlWhdSSFswgdo8PZJttV4rK8l2kgYI/0z/Ap9Wq5W83+qwUhdMjHIO11Di8LdJBBB/PulOKlabsrh+m+/7bV4vo4n5vCZ/nTMvnbjsu2zQZ3zoAz/HhYI4H729nybmJf5LnEpczOVY7/gkpHVI/5J9JnMwsktRGTediMhMeVvdlu3aNlqPD548iCwef7UpdN40uGLkqXkxR+1T3A+OXBVyYt89lye/TeOhHJ7dj3Je73LG/xpJBQ74bwvxH9sjn37u+/1CLoib0Zzy2PiIRf+zWzfGPMHGvIfi//5hQbKQ5RpMP38+PuoP+EvNT+dYab+evPv3sOj15F2MiOvJuwuNKmIp43p6aerppcgAJLYj7Ac94+jdQ+zt6R4tyvla7GK0+OR6+u6dxy8dKQ3DokHQ9P19qf/v5gwplw87fJPkgr1dVBme6MNCdvdgBgObdsLPFG/gcYubLBM8vbR7LcdEOKcLTsYEFpOCgv8anzv38MSuc3KRytmboxmDyD0U641sxcYdNUuMc190su1oGn8ENU6Tt4U8n3GJz7tC7808l0/3PV+4+euIw+PtIaPiF+t+/trsEqaUSvt+x9R68qXUjVXhNz0dXSRap0TS09EC7Rv98Uey0S7cB2c9uC6cMPLBBNabZ5bJwqAJJPSQFdNARs1z6z701ie07ldfgxVKksDmmA5js/3hx+Tn4tv7n37oRoUek/rXhf5lU+lfTI8czndlh9yykfc2irZX9npH9jpwjQFcOHUdeyo6Y+ZRdgImLj+2xevg+iNVvmJxmU9U+V1c8ahJ6cE7/4pN+ev901f6rNCsfqpY7MtmpKWgNfXkleLYroqyVXgC/98yyjuP393TqM8/tvg5Pv5QnIjDQRMgljpeOENkyFBoCNKGWOcNDpkTHTJfeFixQXTIUHjouYTPRn0Vs9BD8LoPv+3B3yNKY6PDtP01TLvUMM300N781b9tsBaXHanF0vtlhGEzaSRYfNQ95d0XWc3YWW9FmEEysV2VOI6AKhhfjF0dMRzX0d2f+uKs3bF55sBKASYOloDljAPg8qU/rzd77oukoCim3PbB20JYMEUyezbc0ReZj8P2gHf0RQBfbPqvV+9Zsge6qdCi7QrKJoGEHebeZpmsv4px19plQ8BfDsBBV0DZ3ZbhwypMKV9foaepdAFGndYrtz2oMaSB0pLvcEcZfGMD0j6s109GEy/88RX9+Fwkui6NJteZnhhuY6PMIyG5qJDeT6zTI7iEptXuocOraNu7pKi0zhErXlpfu+RFm5v31dadRY+tFmp1Ll9o6CPHZuaJLkyauT8+jFSjhJZAmJkjM9M6FDVS14Os+NC8pK5/3XEcqxplI1YpdblEK+Tricr1ftojUu7mruda2488YXhhM3Ld6sJ3XEbxfh3B+82WRLc9Kz6wG7Z2P8L6W7slof+KfxO94jFz074OxjkaHVqHanUoNrh+M8Cmh0TQZVNEXKTc1wusXsQ5e7P/Y/6ZuWNjAxEztu83pTr7HFzSnG7A0AdzCeoM8/X2T+S8Heh5+wYcPCSSy4x2Qvutd6o/hO++WA/wgPCHKuhvNe23JiYkZPeBuiIPsu+TdQXJDnyOttwiitRYXYiIXV6QT7ZQSnJR9tc9Xhp2IAhyU71iP/s4KUqN1CUOg7cotDRFkx2ntdgs+zEAy9vEEq3MdkOMk/XBAltv1LjfMBTw6Oaaim0FQyyg0GFLY2+XrN9aU435QROh/p84gkluKdl/aCwOYWjs42YQKupPQZeng8UNQ2GMUUTLoKIYrLQuTGtS1EhrP7haOrEirXNtwfYYsKnK2+mF2+lrqtOLYafT2Ns16nRTjf7h6/TC6fQ12enFoNNp7GMx6PTCdHpBd3pxoNMLstOx0rowrUlRI6394GrtdDqtc712Or3wdnq1RCX0CDNLtJQuNUbXDbqm0LsObS1u6kq0CFL7DRooBtmU8fjk6gtkSMMkG9LoX6Ae8mE7sdYoWg9dE210hK4NuqbR1Y1rcCOdkH3jGtxIp21Sr9i+b5P9lm5mC7UmoaFGKtJDN8/UQ7YRoRvTJaYyj9afI/k3AfkIXd2E5W/WqlfCrKmHKLBQrjdUlDdUrjdUlDdU2BsqZn74vKFyvKEivaFyvKGivKEaeEOVmPK0N1QHvKEivaHC3lDRmhQ10toPrtbK8YaK9obK8YbK7w0H0heNfE+BLxRyFFq6cSzUl4/AS9X4oIXvU1bIsaheiBqxPHhrvIU1JRVOQj86jIgmET4ymAQ3mAQqmAQ3mAQqmAQcTAIzP8gvqUZt3Vrmoh0AuA4AKAcwVNtgKQcA2AGAcQAetdeO2kuv+x/CtWv1+V0HvmKU00XzZe1vvSMR0EiEZiQyn4PGq9TYP7sG527ncKpzuNs5nOocjjuHM/MDPAbUJYajSvns7cBXymcV0YPni+afgGWEaxlBWUa4lhGUZQS2jGDmB3h8I9L9xcaVJHzlwFc++OcO/HPv8JJ9xwUqxpLStaSkLCldS0rKkhJbUjLzw2tJOWzr0mtJOcY01edylOFX1dMby3xkZJsCCXVKdwCvNbz2w4cngDsRFj5URrxJb8+jGPj5zwH/2Dth8qM9YaJ/AfKEifETdRelDA+Z0GdYwD3DwmV2sIKlv4LznmMxS0+EKeyYqu1wOXAW5IDAWHkQJy9wUdDnPE5MvvCqJcaqxUBFCoy0W+BAkeWjgZzgaRzjo/bdslPZrVXdmsF34WenI3dalt14WkZsQ5F7SJ+zbiwFj3+QIlZ2XE8XsWadWwiK6O8Z2S0ju2OkeWywldYN6BgVVtYQwe20oC1X00UsrSGCIgKGgMGeYrwh9PzRepeprbiZL+KVKIIiAobgkw3xuZjdnSsxe1CtOxHLoIiAIcTkT+NzOfsDX8nZbmYtO0MERQQMISePCDuuV8Gn44Jf1wwRr0FaUETAEGpgiHl7691+ut1az8++tb4YsbXOUsX/7VvroNL8urX+P9paz1R4MXRQIG419Lq1ft1av26tX7fWr1vr1631/8TWOtpXA7YI8+agQBxvXsYuoiY0cHgTSN4EhzeB4k0Y8CYkpjzNm3CAN4HkTcC8CbQmRY209oOrJTi8CTRvwtCFGvDl78FqQgOHN4HkzUGn09jHAga8CYY36U63eMSbZKdjpXVhWpOiRlr7wdXa6XSrc2D/uuNNCPAmIDcODW8CIR6j6wZdU+idQWPebNgQkuBcsONNaMp4eRMc3gSSN1EP+bBWrOVNMMxGGx2ha402ddG86RrcSKd40zW4ke49k+DwJlD0Bpg3LTR00sE0z9RDthGhG9MlprLYoxH1jZUfPB3R8KaVP+K0TviMxJKPPK3DJ5zW4S7PcopnucuznOJZjnmWM/PDx7Pc4VlO8ix3eJZTPMsHPMsTU57mWX6AZ8kENqy0LkxrUtRIaz+4WnKHZznNs3zoct/Al3Sc5gDPDjtdiyB5dtDpNPZRQzHPcsOzdKdbPOJZstOx0rowrUlRI6394GrtdLrVOXAQqeNZHuBZjtw+b3iWE+Ixum7QNYXeGTTmWZ4YESTPooFikE0ZL89yh2c5ybOoh3xYK9byLDdMSBsdoWuNNnXRPOsa3EineNY1uJHu41k+4Fm6mS3UmoSAWqmIZ3li6iHbiNCN6RJTWeyRuPomIB+hqxsrf8RZRN7wLPh4tn+2TECYZzE+jmeFy7OC4lnh8qygeFZgnhXM/PDxrHB4VpA8KxyeFRTPigHPisSUp3lWHOBZQblcrLQuTGtS1EhrP7haCodnBc2zYuhy38CXdDjzAM8OO12LIHl20Ok09lFDMc8Kw7N0p1s84lmy07HSujCtSVEjrRE4cFK15Vm60zV4yLMiwLMCuX3R8KwgxGN03aBrCr0zaMyzIjEiSJ5FA8UgmzJenhUOzwqSZ1EP+bBWrOVZYZiQNjpC1xpt6qJ51jW4kU7xrGtwI93Hs2LAs3QzNXTIs5Qe6AC0aZ6ph2wjQjemS0xlPp5F8m8C8hG6uunLj7poRrvYhme9O679k8cqYsMV4WPOcG+ky7KSYlnpsqykWFZilpXM/IB/51lyMe4suRh3llx4h4xAQ0Y2Q0bE5vHFJUS8TyJfIHetMz33mV45puc+0zvwFfcZMu3BGRMxlkxdS6aUJVPXkillyRRbMmXmh9eSqWNJ8FkydSwJPks68BX4LJn1LcmzGEtmriUzypKZa8mMsmSGLZkx8wN8wUlGJ+m4Zs/G5aFk4/JQsjF5KJtlPsjo9TJHPjb9N3d7KKd6KHd7KKd6KMc9lDPzwxep506knpOReo4jdRr7qKE4Us8TU56O1PMDkXpORepYaV2Y1qSokdZ+cLXOnUg9pyP13InUc/+cPHejBarTN8NOp7G3S9TpphrzA8jvzOJRGnLuS0PuF9BG8qchI/AyD6ch9wtoq4bTkCVidVNAu6b3yikz0gFJB+PR41LQjPRm58cnnSPp3DAvLR3Daw2vDTwuwU1HXyak8kkXSHoT5fukywPpc4KGqwNwTsPTA3CPMtm/Npcv746J5/Ny+cwx48O5fK8VXEIuX6Yic+8ic9KALbwCYXTWXOaVx1/lRWb1CYhMwhNx8pTfgHKsvEDWoRrbXsaEV2A6ukO4v0eysUMmmMaYT0pjNPHwvjvtWZoP26Yx8msa4/8jjXFEitLnMDvjbAWz897WcJo0xjFJa3x2DuLK+uTpItb8NGmMfIQhbA7i9BviV5ZMpouwaYzroIhxaYxihCHk7Fas5GxbvqYxBkWMS2McMyLU7HG9mp/ha9MYl0ER49IYx/iIdLanW6Wz/e06PVKGbzqdNbLZ3LfKZjPwOjtShm+GDSHjDXGTv4ZqU1vxxXwRr1O3oIiAIfKBIeZn+OZthu92s/vpi/d4xIqbf2KzfA32HGm+B3JCl60qdnmynUzqJWT9xl58hq+VE/dMFngTfH/uw7fmydMXAji8fq1xJGQrmdvKn6FtZuxbYFYQ8cLEqDzmouqbvWba5NuIF2DLZkETYt6rrZi2ykvEIwzep2LvKoZlsoRC1mhhEbRcUiZaU4SkpGViK5naL2dNy44H8n2wms1b0uq+q4t+ZG3hatf1cN30X8zzZsR6hB57nRQWJ2X2U21TX4wb8yLuf+Jlkfd+ZG32Y6MVO5KAYDB85IfeArFPP+Ax8Y8OhU4eRhSII14SkScii6G9l4QtDDTqdSdDfCyCIjsoxD5qROd2iWnPS+3NbnrhOUDysMM2SIhzMg8lwkkSd4tCJkg45shz0EDAc24LEeN/Jz6VSbtfY+p9V33ZWvRW//Wf8MHbu/gnjO7+vH24+/z+b/qFJusMyacXbU20Kq4zs9WOUob1Khvh+yPsYiue52GNS7Xe9bf95ufnp1NPLrc/4QukQKaEe/trgJTAGpd11mnlHy8FDJ8I/Mk7G/pji0qYK5L+CpT46+6tgDmh8lYg+BChmaAZpfJU5HzELK0plGYss4WCb/HZQoLzLOsKBV8+NIWMBRRwkXeFYiZ8TSEAkHaCHXwA0BbKF4s81YVi3ro+JRkbKI8lYzpXTMZTvJpG8Xr0NZNmFjG9NljdUaRc7mB1y0JEb+93Zudn+sP70O1uQdxE7bCEdpl91oTRvjHM58jgo2QQk/NRbTksA0ZY9Pjz1grazfxuL1/+h+Km194Jh00nm35u72bOf+VMBSo1c/pqv7XgrhgpgEcKGB2ftUGZDdGq5l9OGp/pxbt+2AXm8cyo+IxJkR6Iz04anbWLir0QQIaW/J2l8G4l/FixnLND0KEj4ovmpGPcY9JNpMOVERxD8SMYviFtMnD4vde6znDJh+Qq+u99wZvkd1os793m+TskgpQoMJCTQImAvrp7R1mNklJjCWTaa/zvKvldJB9S0H4Ow+88+T1tqw+un/yeJSAI5L4/Er3IcjCqHnaRMZipYxiDnXY/ot0uIHYLZm4WnD1yLEcsz1MhG4wKt8SpQrZj7DRU7AhhXzB27MV97nKZ+WyOv1r2vjGf7ZoZId/sDYO5MaP9UqaWr2BuyBe75REdsbXxWtUL154f77/Zbfb3Zw3YTAT07mFY+OjFuDisGBlWMeeYAQtSpTkRQO/eV+AcHbhSZRxVBjz7PoYdjsBSfpK6jRExifQRPxG76Q9H3E6/BHKasZlesXmrCbOZhcXtZZ9rK9z8G2ISQyzlw9/PT/vN7ru78nm3O/WWzYBhmFkTeIcTfi5n+FYn7rY+xjiE73v4O/u0BoEVQ6xosfZPYG1cF9H1JaQytRiCPViFJ3EaTEJTBwokVvawteqD7Z/AJkjp1aUSQ6gVf94DcQSrgiSy1O620aR6Wlr1L5PfbWMI7Qi0GkrAUzFC5hIrota28fv2r7IdabdGk2Ow6+n4VZ8gL59/1V/GT5vdH/cfJPfVvvzzj4fnp69/tf9NF4gi4bIbAhG7Au1h9pdvO/i2+8UeZ1/Yw+xmuGlpMQxYia764NyqX7mwlYuDlUNs5dwO/4n8rdWOlBAwXfNh2AZ8KNtE2shWdEdu05kqNGazGrBFNkaFzs/VwQfP6GEQKSDYiKAZu2AqLkK1HVxHHDWar1r0EDf9E9M2Gygi1/HTw067vWJT/nr/9NW9nnQf0Zn8y+3VtS3gqo7bNKZgQttivtYRo+Hp+Wlex3dOiB/BNjCFRuZ68opP4aGg/rFMVLbmkzMrn8LAs3333fY4BIQYfNaHyqM/1GBYMrNNEU7sKA4n2I5Rw3pkeHUcOvDEWJHnJUa4zLYRIzpyavuj3eJu1ucZOhoyXARq/vNDWd7//OduU353v9mxU6/IVBLnSihIE2CKXpYHhM9EJr14YAjPVLoAfwGBCwgJbYHggcVmT11xWHjhCsEzxaQXniM44zlPvXiWDQpA3ulz/qOR9Kq9ONKyfdzSALlsD0dZt9c2H7++UMn2QCFv1xeguxwov/AFhpdPP+gG09b+FufzmmC0MZfUv0x3fM332MhZfDAxMmGCSdmqwiEYW5FSMp61DRJCBoMcUorxR42UlLPJugBb5GkjJWN8ui6pWrRS2EKkM5RRXU8b5zO9l1TGO20gF8FAhe4mJmQrJlvkkxvFxAK6Rs3qbg6ia1SezuipheTQaZPzyY0y5KmltF02uaPSlHUGlgomN0mkqmtRqthkKVKpzrw8n2FeLjvjymyyEJ5C1yCWTv+YFu1Xrab7BhNRNULm2JWnrSIA0z+hlHd8qzhMHmwZlxCtSfQGaRsODwJfNxiGkwfDOLjN0y70DGb2NHDJUz+cKYRnTLFAgXwQCyvhD24BB59Zlo4KnTPwwgehLWRpIBYWuECeMvAXUEP9RaBAigtI7Y39BsIqKSXk5UXnxzr6WWdxIojoXHXRdVSM74vPQcyOz1nexucs/c8G6Ex0DCy4iNj1oyOlNF/MDdAldAF6mk7mLJYtunCWs3R6/KhsmK8knyzlLSbWX3yQt2hd8i5gy8Visi4sg47NGZsVn1vDMOBsuphMe3EbPk43sKEmG59zOV0bkQsbhvJ0uhhg1jZyRnzeEHQ3d8mmT4HyLD1Cm7K0G8GGRifrkkpIuxax6XNvkbN0/sRFZAs7MwQxWQqDrJOSZtNbxDm3A2ZGH9nvMZvuNXluJz966E7uZsa6IZfB9NZI3glJs+kzFyG79RWupvdOJmXnvXk22SZ5CvZjDs8q50xdoJ267O5/2i/L8vnl5LkD7GDyQPiex/fLMxh3x+OByw/bUsGn/mMvhSwqGHUrJEr63DVXOkRdpLE19zDC2XM+ce5FzRqFt0XwhkwtWAPb5Itzp0pQtxwy8vGB8uSXHEL0udF3nDjO39WJOzVKaXGcTZ2oM6N4xsj6V0SU7XwRjjFdPNVkMW5ieIRcQZiXj3GkVMHZ5SdT//xUQzhBSshbgIDjhdVmt3v+c3+GlJB/2LvW3shpKPpXIr4jxXYyDwmQum2BKUVFSEh8HTqFqRja7vQV/3vsOJ76Jrn2dZJ5LARtul10fH1949jHr2PWkImgSkSHwCIGnLngSTafTo9wNKVJTHJz++OOlwxBNJriz0ue8IQZNJH7WCOeHARCsLBsRCMbkVhLHmEIWwahbFtxZ8wl97AIsxcEf+aoS1nDpSypLFGoVpPEBQXLnuvsbFB+ZlStw6JbAX2ujMz6GgduBQxHUA11mYEEBO0TirSakdj+QoSzd2fMaaTS5MCRHPhQ0twCYa2i0xHilgwyJIMIxneE41QoMRYnQYzF4YhxQz3tvyz73Ysa95bRoIpQ7Jubdmb3PaXPtzRm3JdZo+mp25DxFziQgeDFVOTBgRkeNMcDdpTwabu83b8iCRgczIQQpzup2MLDK+oXFEFzyegyKIL2jzL/meFA4cqLKRcS8jDgs0jWcTOgQ17/UtsJYokzhYNKkZAmHvU13Fp7mE9pssNaI0+yCh5UXguKxLy4LjPD20mKaiuFlicz++mhquvbKCZZUdWI+VV7mIzA8/bJ8hB6tR2I49GUdgXmBflmAI/Q2Zegc0Y7nUrgcFXEwhTu4yjQ+6o6CiSZe6Srwym79S2x7/Znnn5FPhLrJI85joYXgMhfWz0gHu+MPbE6vnhi8pN+8cG565KGQlb6990hpq0BMT3mVYVxk8VxenmSxYkfSY6I8YdZ2X+Ikx2ClSGkrNPk3qGmxvZMmmgTY/1J08Fo07GJ09560IH6z0187xPT93QjHf/zoBHmk2wfveu0z++3t3rfWjnRdICum9VUCOkrzl8zlnHB5tRF5zA8A3Ar1oLjc6KC4h5pxzJvkIjcXV6nzDQt82EXnO8eVGV0EzGzfMxZPtf/tacqq3Mjq6yWqpnuZY1MbOEJ6inyYArupHgBMpJN9PbdnUt8X3GVQj9rzPx2DS6vIiR4B8us75opvXjMA/Q6gH4XwLZxJsWNC2DcwtHovL/86JJHlV1S1pf2SrE2aEtMt2svelV8oJcvvDSuLCQqT4zJfjhTJlgHEugM4H1cP+Kx0cbhyrwG4/Vm4U4q68hvcSXPV/cD1l7oB/keX7mLlQorcaxwsNuF+oMi3TnfV12pXgWCzF0k9yEnTu6vWfKaK8sIdOpCJwlTlhHkzMm+9HOKAOe7yvB5+5K8zhAYS6GXTAcfwzIXy1INlijYuXZcF2iuUjAMKyxWV1ymkBxDwhel2+FJtcCBpXAuWtEpqifD4BOQQZ6k9iPF6u4UJJgQPJoBjybVM8Xgc5DBTCvRrrD48LQBtv5gKRjwZp4oGzolBucWvvzjWWGxfVr3tt+01YVzRXLwr1q4ZpfoDrMlBzaFx+ay1gUbl5KlpwN4qrptG8C7MoU25O8Fzuq9gDKE9wJnsBfwolfFWUsvcJaoPLFe4KzRC3gTFGf1XuDM0wuc1XuBM39kLmFkWPLsi8wljIwXvSoua5FhibKQqDyxyFzWIhNIoDOAkbn0ROayHplLf2QuYGS4PzIXMDLcH5mLWmR4oiwkKk8sMhe1yAQSFBf1yFx4InNRj4wDbvP+B6esmjl6vw+p0TaOIXRp2rpS8owfPH674JJo/OD3+1OU359i/P4E/U4TlZvHcxcuNVxl5/P9GR6KUVj1Vi28AZYuWGrwGw4uuGv5h4BlF6zDrS3jHPMGckymP2nMdsFu3IFSocA3Og0aQ4iXGu+1z6F9HrLPoX1u7Xsq2A04uXSjwqNKhdUvFyxLsETBH4F8XCUqn0QlB9ULvWNPe1CaZ1+FN1JrnyVDsReuy58Z2D8d2I2iY6fsoh5nDnaliufD5nDfyufMg5042Isb/QfHTt3S5bp0ExQ7s1g1N1HezYd+Mqu7zQ1g+iotgn1QbxUMnm487OnZgC0xfLBo1OW5W501elX4osFSN8zzRBfEi2cw1DoHzxLQ98wZfajE6lEBz3DzHNS9svIB2QFonbvOM54wx3YzwVI569Bb7Tu2ccut1DpZOC5ZLS6Ffk/4kYBaYDL1CG9gchCYrAyMwBqdWmByEJh2+5NGo6bfHhafaRuaY+hZow1cSdz2vAWN2uap22aqYqhn5mkzOYP4qXrmPjyokNy0hniFBJeJ8jKENjJIRWgkkTqJxJM8K3tgnuZ70+fe4AkkSCBVgrUvgbIPaKXO0cNyXPSbRkuLxq9/YYs6C1hofozmAfHS4NcovuDQPg/Z59A+t/Y9LGABPoFFyQIW2AfpgmUJlih4AVnAIlHJE+xqZcgBFqVxhmAhB1BYhmIvXIffmGaAaPDeyNN7b6D/VwXDkW7v/yaStwxFgr5/of6gyKlbplyXaYIgQb//Zvv91l5/AXr9txlisaVbxh0FnfKb6ZQ9aAYjsJIodlWcu/2OSqoeFYcMMQ26Y41ONR61zV23dXdcWUY64wXsjBeIE7AzVrhQPDIYDx3pr7GAyFpAMvUIT0ByEJBMBwTvhmsByb0BeYNdMNONhIopWsppG5ojaNgFG7TEbc9b0Kht2AWrYqhnhjZYnEH0VD1zHA0qIDcNEV4Bnb5UJS3D54nKSjYSqJiAoja63nPQ9Z6bJZUFBpcALhV8jcOL80a3e+7pds8b3a6DbuLvn19Sd3ZfWy8TWWcacOZkoFMHZ9Tvy8mw1Ilpmcz+YFgqsLZZ2lCv2RrD0nDg3TsjePcOvTPJ7A/bvSGlgrHQhhJj0JcfTKeQNg068e1GQpOupEDezxOYotFIiSGF+8E9seSJJykCdVvOJ4GfLHlym8GnrFz8XWNzfU9OyJ9yXazih3asrGF1wSSCLT7V7Z6rGTPEbh2rPhVZYdu2GtQ/lO9LUottTGBgpSL8mdw9cMcblaJ6sBmA9xRkoN6eb9YZfk0qcXDpydZT65FOo6yox9OcmG+g8d2WtvBGy9Z+8E1U+eNT9Ivaso5/in4Bp+gBGmPxcFlnoWbcw0zeLuv4E+gM4BT9Ag+PNg6n6DUYn89YNOJ/u8qwarc8c79Z08pqPIL+VEcrLMddv18VIO7voQ28Kwne6ppFbPhVcUwTlWPwqm4N1cAkJWwOfjNWJWFzsIIqYJIebnPwL4+b5dbsD1bvwjlVpf9ll3nLLVToye7izOwMPIPb+Srbgcyyj8zSj3zsPqrW7C5Ndpcx2f3qnEj71Wb1q7PBDDgl4p363jj1fbxTecMp9OpX3Q9J3e205nLgTdnLRauLC+PigrKluvz+m1aqzl2WHTfFzvIsol4iJj61B1z7UXb0ffd3338ZG7xpp59232B4IzJ68PzCmLig7yfevldHgLbOJVqWRpe9vWXHxC3N7uvten7eVrLOBnZVvbsPu8YnIpTMhpLZUFruZUNZ/hV1/2Nz2zbYpQ3Vwn69/2s9SoySlbyOqjAaKzBav4W9QGdK+sqL0tSrVpJwxt+Ii8Zoi3qOhxWZCxUamKSncg4fPSWv31zMMfwvV4a0k0YR4UxajE7SABqkezzXFiPI2lW7iqaGWmSjHOpggkm95VALMYyBziWwX2nX9IXoKdokhtG86m0gWAIyWSsTA04Gedoo7bpJshnjxzus/1+Uds0PpOy64qO265et7Vpk9QEFi5CB5XQZ2HUZjYKjYAHA7t0Jh5mv/b27xNaoBvsfUINd39JZ+QCDA9QL+hCl00iLqAZbiFEOdpSDHXBs0Z/bZwMZ6PwSew+PMqK4GG6gryatGMZAcHzUd3y1+V/K+jYGhHCs+AWpsoRVVuBwMc3y6WTGqCNGxual/VGVJXasOKqyjKosoyrLqMoyqrKMqiyjKstXZgcaSZhl2dYF8sRYGHVRDqOLMmpcjBoXo8bFqHExalyMGhejxkU4LqPGxahxMWpcjBoXo8bFqHExalyMGhejxsWocXFKGhfjUXEsMhsz49OU2VgGzt5f1wO68c4dXsOI+uGrQsEbIb1OVK5YSK8bIfUm0BnAkF57QnpdD6kFI+zop9oknL+wUsNtKINwY9w2fbqB/8njuQtWFUHl5ff8Ks7zqyjPr6DnaaLy8/juwqVphnfwUSNl1EihaKQ8rhoaKWD1uAF3/Xlchf15XDn+6BTVw9AB6UtTHEUnwHpdoLZEEVt6fnE80imqp/KIqiPDqSoyQX+aKjLVw05AlCqgSdWSDNQoYwRWqmYK4NsqLLxzDyqVTqFs6L9Rp+xnB2uVsoNkAD889U+CU/DT0yZ2P6okQQ0vbWMn4UVX8Aq6VqtjH9pd5W+R9x/wiNsP+P/k7gP94shXH2jwf/Hmg+Kneq95mRQ/Ib1mHatCLhFscVXDKp+LK8RuHatcllfoPIPLXDdhbSegBBXUjUKUoBD0levKKBx14sJRjmyS+TtCoGcUjqI59cUKR123unhtXLymnCna4MpRuuGUugElKUf9FxSogJGrViNXlZGrUcaqwryAOtfjzNWuvnWXb9q1S33lmz4u141SwRpAgaq3CtYASlznxsL5VxFhHFpQbPehBYvR9eCNR01L/fjjj8eHQx+5ydMIfYY8jdBnYJPJZHoEyYVW2QGh/yOJJ7gyAksRIdpl7SDhaZwKSdVPwRWcJBtR+aQHqc9dhcEIZ/n5gGf5pWt8HRZBWEkOE4jka3+KjWQNhQP1oC5tW2QOdBrcPnfwmxLMPIdhgODCHyo6G59tZ85YAxOeeBxnDcsZblkAr7MS7rHNG7YFPhBe/9rQ6MgiJRpUvSdrNGhsQtPNUGVU/YEHDM5BSWVWwQ34SxCAMAdzt1QFiC7qblECDaYMolGGsqltNS+CJTjUKMYja7CVgsLVMc20jK6tAE3At1C2DzQjuEyEbr8oNoTyhF4fIm3YasviBy+VkNwGKsltZXbawxfFRbePf6sG58/l5vnuq+SueNm+Pt8/Ptz8bf+fSkAa4+xeY48xDuspqlBVx+6aButbqoUPcm+6iPWvur8x5N7WMUvtzYGurqm/Zums7LWoY4OqGveWhtiGo+DXhtj20BXIeiojVEUICxPgVYFqIfAyYU3IqG+Rm5rYI4RsMAvBEOCDTLyt+fN+oxrO1XL7993D9d3zc6/WZycWGW59Aq8rdV/WIT9bQf1sScE20X14fBhb9bFVH1v1sVUfoFUfqgXu3wRqm5HKYBFu0F4SdSLVTpaCGdTfno6iWsQPJ3F7qCnUlqlEM/lLmkLd6c92nT1tHEZrm52NFaz9zKptmdQ548pEJxXUFmHT2JlWVNm0Cc2buqaoHyJSmrYQTT8E4dqE0g+B+VFMIuaRm6HTdZE2z/eHEcglqN6WyIIipSszXxRkDqE6CsFtKKpkGlcw7QJhI4oO2f3mcBtG4KwiQ2YVmWfar4gSluWNHMpXTr/qIHbW0qNbu638P/qs5d5lZalTjj4vZE6x4ZmAlVn8TGG1zUEKd5uDzE97npDGveyb6UG9egvD9ha0HEgTtOg8yip4TwPr254D7rynA0U2jIEeL2EykIHOFXFL1EXFHeg5VK4KkHc2wIYxECxB1w0qdghlB1bjmGqwEp7YmKoiPNEDq8GHSrTBUk4eK20NjyfcnuFl/Ksiix2xZQ0vMvK4I9vLeK2oRiqEcWNRjVSOP/5BQnFbOIIFGlnkCUegsgaVCnr4wVKXXR6WKdFGM6c3WAqP9o49Wiqy3qOlHZuk2NB+RNzoEuXIAMO2gvXesaK+zL5Dv4oe30pSSFP6MD1+9Fhk4+hxHD0OO3ossn6jx23f/HuPPvNhBi69Dexj5AMHPXoY9KC+vU+Pm70PCgA1fk/ylPOEs0n4auYSPsumfngG4dN86sIxQmgTaLrL/BnMIJ7PJqkXP4d4MWchjxiDSSb5tEwSvma63EMuZvPUC+cAPklnBh68Jq+ETzMR8F9OQIL5NM299qcAzlTlCZQ2hQkyPg15xFgtyZwBnz448lFZmqCzNG2DfqNdFMGyzdakj4288oPoSGtZtnSWlrYXpCrJtLuJmbHA4xlWkRmGlRmGNTcMi6WnTbGS92+/qj6Mtf2NRrt0y1wGK+1OvMrWtDSiW6WvOnabjKV5ZWU6n3a2opvd0opukrqbyaYTa2Y27WymeifS/NY9NLp7M95kc9aZmDDOeWVGzGedC5WnlRXVR3T2ZTpJjZGZmHUm7Ca0qucMRjaWawFqVbGth7vv9tvDYJ1D//6lapMJzeG+Wihaa1QVtXtTtCVQb+/15OY12xe+eHg75jsndaL+d/7yhbzzP/q+85d+79y+6W9U+dYX92/3q7uDrySJnJNXkvLZjLyQxNh0coiFpNBij+rGqvUeMZlmObba426hK882M/yGQLF2ps+nIpvrNSGWZJ4U786govRDDdbWBh9ce9K3p+hME22HsuqkikxZePonW7oD5q+zcunJYINnrlWYTMm1FRWt4Q5dRx+Mln+5+PBC1Ha5chNQFtzAKLsqOHQqfL28c2l91AXzLVF1sPKvRJUnCY7fNVToN0A6K6xP/2q7KDivrdDZkuGn6OEWSUZan1NgBU1oC5sKXPp8AjfW6+pkF4NMq9PW20YtZXW4sX4bdSU+vLFeF4F0aX21YHb05az2IbkY7Dp42uINOk0S4YfwO9LjpLAU7sXyp35OmEbk1rfkIyDmdM3616oHeLe/tB2VckQ1O59Osa7lvV0b2rPdmlPYs32vOvXYrbana8ABF6+4+eXn1+XmpKn5oeg2aWdV2efhhIAvwb4tlnAP7dS9W9suLG45J5V1Ws5JYpwsToqHJ3wfDJI3GSTXcArdXEmqMIzkEdxUCsNNh6J7HKV7SEzAvSySae/xmJxzFyz0fit+AvyQTA7btwnF0MPO5PC4xI0b985Ja0J+E8QNRAjnitpBhJC/mLKgRmJKs0cKWWnN8P8QhSwYmUIGdsB0P+Ze8IG2EQUNHJwo8r5EkRN53uYIRLEihpYn/nz/8Pp8dJ54TOpniBOZZ+2FNrGYiTcOwIcjN6dAP8zLiuYfp0IPaPMpaF/Yf3/xqczr/Mve1fZGTgPhvxLxFSHWTrK7lRDS3fEqUUAFic9pszQVaUuzOdbh12PHSWsnmXhsJ9m9ZYFTKYzHEzuxHz8zntE3ZXrZlD/1TRmx87RbTbvzfMzLh7/z6lw3H/m32d3XbEMxuVrH0LpcZr1LQ8SwpyRKxaUx190+UQttkCABbuAkSv0OWKxsxfi/KdoGt8pcqcYmLBzJw6s6I9NcjpU2AkA9xGtlO+PtVkEBuCPZtdLDXRLk19BVpEqV3KuSw3jgXUe+zCDNaaXJ3o3JMrW4C7vmTyZ6AixWZavrQPQzihje67qFZtBd917Xvaq1j+n+0IUjcKk6teQobxiUSUAAWVUrb8j/jD7hN91kJe8RhZlqwXdw8fBvuyCuegdorUXbJ+MNA8KfDZJVJ+NbrpW3RpTBZO+EIDht32veUNjU6oeuIDRbP3YFP4yM/wfaHddrmBELu5qvTwmRynUbjkfLjg5IISh4Lbf6ax8oyGfSQstqVMUHrzzN160SB1D6ToLS9xKUfitB6Q9nAUrbUiAeoPS1WpEjpszukKVAQAu+8bSAfetbEOW75tjkrKCx4HtnBc0Y/OCqoJ2FH10VsPeeFrB3vmPwE3IWXA4n7Wnk9Xzy83N5+k7U9XplVcLllHyuI7ky7goeOaA2iagQrhvS9qFd3LUWSTNo4pwwA0UkWjpsw1mYRzt2cGvr+vwk3cF3ie7AvysMlTZZ26A992YpDaSWscPp7kk9ANdKRMvxIb3N1LMw1yGeRjQTjYAG6pvEf4WzZrKNPsHSJqEBfuvWG0W7bCANQuSJZBs+rEIFrD4eUC+GCZM5s1Efj6iPBtSHtXpzQsxGfTSiPhxQH42oD/vqwxH1tKceXukY7eumG/grKNhGbyDeHJih0ed1bZDWpyk2SOujHhmk9UEMDdL6sFBdenjUlUFvPz7xIcpG/Q5KfRh5e9icXJMuhKhoAFuvlA+uF5yA9yfagR30WgibRLcwhVWF+gPLNw1+5LSKOlcTuApgdKquOUI2KEHz+/IlbxGNsYxMMYbPLR8d8IMqurI5G9Ncqaul0FzBmruyeTX2kjEtZqhg3BA4ZohpMUMpl05bcUxEUlFxY9ARSTJ8CUPWtOFLI8KRZncVpMKQ0yrgFTv7GxF1mSWqVWoTc2QL9sckn2SsTOyR6+nEQ6y2NhFFkIoJqKZXwmqSICvU04BKbJ4HJvGMAV9oj+72EmalJxj19Og2n31euSoopILCQ4HvM7DtRAqMXmn4GWJvDd7ZdrcTKTBGhYHP4H2DIW3eptT9dUrzRoX7K+39GOj4uny2FGjeb5PvCz1npIegTvUww1/z/3mUoaDjamPcmDsDn4hr08vCSybmB2lfGF0XmIsGuEy8DfM4VzylsBpPUgqrUbyjEK5OLJpSvDXDh43TPghEFkGM89+TwNkxYzAl1dKchucEvf0LlJk3uHy2aMxwIgXujxBNpMAdpxz/1q33bQzv+yBYtOgAtRpgVX9Mz08LQCwtu87qSKUXegBL5EKFnMn3qw7ska5XUPqgiN+vggNvA4gqMEMoXnFxQJLqOsU/BBANNWv5P7BopGoNAxpAgqq75T4ShlJAcq1KxmOPtNbGaT02ThtVMob9j/dbtfeN6B11Med+Wzth2v6HZmqVgZCwL0wyELj1hTtTexVfbYOQbtZbsIE2cISOvmFh7xUjdKSmov7iEECSagaE4g8oqxrwQrgBL1D/USu5fynK4CU0eodEDcfaGzry/PHAvEWQ8FoXFqLwvG0OijB/m+u37QBJb/VJ2yhedOCs9beinisOhI7ggKkmKRoHX5AAWUGRD+CodJ2SgyjXAUQHcA3F3RMX/7snn6Uj8tpK2Cjg46ll/ujbdRhqKNpJi5ev7yEzCvWKb8i9pYfd5V4hTwBHPyg5pjdEnHJyi0OOW15N44HvbZztD0lyvS3btaRotN3K9eIczkoFNjOkUqy7qdSd0teMPdii7WIZk63TirSt2zWmVdB+2l/6oNvnth40r8//4/55f7fLd/vfi+Tv3b/PD+kCUHfCAmYLAWPp21X2BmHHK4RF5J7UCo1ZZ0hElgsjAUVWSq4bIIIlWWhb2kuFNQWyBvKXXJKFAUXUvjqkYZC04zjy1jy2bbikaJBAykttww8D0dag/qEouxa1E4UtSFyUx6Arx2sSOyX1QxXZkvrxxQuOsM3PzYei9ugF6FBMPmao7NNDqRYNvj2HLd47+TOjiOzPZhbOuT0m4bg9RACAgcQMvz0+/8XHfgGcoN2wEIcF8ZiL7vsDhFg8ktWksCHEHg6p6iHjv4ntsgCEM004GxXmC0HnkjpwG6RU756LLsQaAhwqS/U6u7Adln1U4+/5EsInBhiDJ2XAhE5pxCM0vKl2mi9gwivtDMETl04BWdoKt3r5ryDlJxG4MhNfkNVW3myp9UAPWoaoGZFwX1FfhsGqtmhEniryUkF9qYJCk056sy5bQV0QfeYN8o9En33CpQk4/2T4BSBGj76w/Yk0lhi5TG65Lm32yAtXuLF0lpHGHHLdE0SG7nEm9SFl6jiIcaObsaUmrdSRyIzyeddq3iMC23JRLhhAWsvuA3K7ANFbTVQIBqvleCsluvjmjbq6aSHtzUj4cloMgrVG58Ko1hUMYnQ8SOz0gFIyHwXWmoEE2BNg9GEzCgszhquyWoxFaLACh/LNGP/hjED+P3dmlK8QeSkdovKoQuVFXJ9FYzFn7q1X7k07/U6RLRwRuP1m1ENrlQSxY8yml20UHdmCs41a2WY8UTXHpvYUVfL3Pr0Rdb7qkqoLnKaIHmFgwboeKxxB8kYq5icrN95VtrPmXSnGq6jQohgQKElRfP5xytWaa7gaIWNF8ZiV6PcShbnIu7V1yqEjOBjt01oWqGtmOGaTOlGnxwaBjOJB4BTMJGgGHnw5ASdznGdzxSo8o6SZOXqjzmeL0vSkRgtkUhq4fxw3ms8V55p7tmcEOQLWWKQDPiQmeb4rk/vFQx3pFd1enTivy4gNr9vb7VGEz60UNHtAGRG0J4KMqR2NOYJfua0Fl9+0gaggkFph5ER21JFtiKFKO6zwl8Rn20shFcRGBcVfcnFQgRtMgW/wr4ulDmrhNR3kU/Jz5VOYD7YgftBgGmjBnKFN4buz+0IT4tcei0wsgcUbgqjfpyLJ813+fF8kj18vCinEDtKHFLMCCnkQBJkKHASxCvYKKAqDoBDLGolYWNwVNJICArGImwmYxF+1xhCBgWrvczNciKD92CSsZuIhIhqfYGLRXoQjl3xmjivjgllAJodsJfA0oUYhZXfgLFUdquwlDDIkVK0GSJ6joEWP2LUGLs5cYT+couoIiE8iPMYZxtTrCRic0AYyul3WRWBGIxn1CtaWc32dAlA7YnRb4decxTiYg4Yp4rc+LvmKz8Ai1Ef2pxbRtopJtB5eb//RJblovFmcJNnzbbaz6WZ/jgKJfZZ2L1D9Y2jxz53SgPslXhuYk3qI0BdhY9CEYBmdNW8NtuEaVZxMRMvsM2MXFdUbGLtgBB0WNBBBZEZdSuoPBO6yiHbaW3iZWllM6H3jZUq7zqMl6JwpomTAPclqXwM4CAugMF+ECwstzADC6d0zctBmiz4/T41FTAVcgsBzn418XT3e+TSwvhb0Vi83e2VnF3097GYnItQoC7mimuMryJprXZ6zqKNcBoIlKImvxF/wteR+K2potT/0LiS395GhBtpWciCvl56DFSIym6cxFm3kH2ADOmiRzQLfjBmU6XHTWStthilJSWvlXENwKBHByqJB9tpg0XjlQ0m7Y7J7GhkTqo1JK21GYm9jQgPepxlXNWPSNsBhpRoAIZBKWxXhEm39Fm29FL8zkMmZvGVyVnI4twuMBc5qtOMTR2O7a7crXJD3nODVKSQGAffsEKN3dLcrBjdxOoXkdMqz4XQs4KIhLrj+0YtxxaC17G7qwBTxm0BnLUz7Y5fe7+ZFP/dEW9QDEtaBB8ZEU/WSXksjj/d8tcHtzLc8e1R33T3fBUT7csGgvAnvGh/3u0Vzsf1kIsj7B0tdERa/KZ+o6CdPXj7u5mZPuxeC1+v18pzoUQLHEP44bOjYZrUhRLNiUpfkJYrMaLk35JkYeTku395byCV0CrkNCOlM/hy60vVFHNVfM3I3wLr0DP1T1/6xoVOj/Yc+A4CMnRo1YNXr3e96WL2Darvp78ntfu7N7DFVr+ofOKwFfWhqZFPwmAYUV0FyxbcFyWUYk+CvguJVdFn/D7SITrQMp8xbBdZ/NKwCv5BDW1LK8GMxRTguaAb+USYIb1555n0cbm/xTlhcXLNWgDmXafuyNLqUPwo5krfCkPPZl0vztgxW32G226pokdU/UZe8hzcU92e1I5DejMXeZ8+frM7BVqdRq8ctfKf29Yv1mVq7S/juT8uIPc/wZu6JMQ0tNmrxUIuPPu5nd+MeO578KDyDM8uQdsq7ZhAZobhn0yAPmDEouhYsAmaMIaoFGQlKiKrQBCsa3C7l4FqAqJgTHV9oiv9j0DCGooBP2J7Xq459PYxRzwc4kftl3gqMW7kvyZL7FlFc7IabRCJtTSBehDE9St4eSmN83h6TcNgRPkqSn8H0Oy3WAW/aqYAnoU26TmzNyFYFfHOsBTOkiTjTmgAmheqNr5FL+knYMyls9IdIeBdyw1AR79is7RYx5jE6xCploW2C+lBTjkwf39gRBrbXG81RYSMDUcVAxUpzccvXx0KUtoQfq1oj0bnmAxQKGeE/XFJILOvTgxLVk5HwdOaZ0KleeJxuEw7kowq7+ajalQKfP+Lilzwi4B+G/FXYQP4zqsiPT5E5G2JDF3PMZ66I6Q7bvc8N3hc5Yk8DWDSNAo9JWE+kwPlF9M471hgQ+ypwL6waTaRg7awg9lSQ3XkeIKmnASycSIH7JJCJFBhfRPQhWB6DlcOvdhb+kOT588dy6SMx2cYkxh6Ja2HskdgkHKnC0ZbQ8JM/P09xgpb/UznzSHNE28mOxFqp1SSEH6A1Jxo61b9Q8Kkj1aKECJOioFE11bHb/oCcZJ0GobELdaYPQRJpPSAyEOsNBk/t286RMckQjifDrfcN+nYbC/HkxRpNXrAIT0XEIBXRF662nVN7gkm5Y7h1v0Hf76tCPMGxxhMcEZ7giLtawyUre/gwDBIUJRmOArBnGMJFGAas/bKDqO0gIXoPET7z44XDOB0Oo0mkUFEZw7WRHMbmwmEIDUnmefZMMl/ITidS4Hz6ZdE0CpLMWUHoqcCbRVl7GsDiaRR4TMJmIgXuL+J2IgXOH6M3j7P1ZQC2yPM3PAkTKdg4K4gnUrB1VrD2VODNJIWeBrBoIgXuk0AnUuD8IibZRAqMH6Mrl/VGXkm0dAmrWwqhavhUutjKc7z77R2C7gxokHHZc4bsd0Op+Hy339rD7e38qTdb0li7PY4ljY9V/2yQeg3FX5hKZlSYLengTTxO4JFVh8E7pFuYUaQ6o0gD6hpcNCB81WfocOFCjHKrw1Z6nKRkV/UzhpgYp1rvdsSIdV/xFhSOVOG4sQJBgbJ1LWnOIyJIWzOPXNGuPBmXj7r5vykoGiqqqyggASia3XStiMatiDtWZDcI6rKiteTyHCNUlK7+gi1SgiMZxvp7b1nGTewax3QiFB0uzyiAgA5pe3jEKZkHAzGyaqxAoKBxnu5qOig0Hxjil8eK57/45/dnku93nwU7VhYf9w/PT7/81f433mAZxMQiHGRSc2SFbZKsG+iSI0VehGMhMqGqTfdfkNXWKtHBFskBGYzwsmEzzUC4TYMnbGZkNQkF5cGBXU2kwHjuHh5/1M1k+CPAnRusph7duS+Rnnu2P6RY/hJz+be7tP75kIsL+Unx1+7pp91+77XYSo6Oj7l5uZ3vNfFeIvzWSizhbleSfD3VwHok3GHbGcYXvwajwzFRn4F875+eny7wYuoptf5kLvAC9w5c4IVx/D32jQu8sFxXp4IC3lupcd+sqIcV7dbrYUU7xx5WYKPQR6y4alR4WIH6zA2OMknTq5Q9vXD2F87+wtk7c/apNWlPOvQ312AsnIHk92lPNUWE+paybIbZFfB57Qq4dXcFIK4/ZzeI6OiKXJwB/Xrxp+4M8ImGmNIXgHNKzOUMKBtfwCdR/GxyZwAipR18Wp/8qGB9Up3oyO52Up3qrO7KV0x0TPfiKzyDYM7ntG4+E6FP67ZUZIhjTKxeA0sTPt2D+7H8Apij58xvjPfK4bhuYakMO45lPdWwumVpncoh4LMYn7BXwANn4L/tuVYX7+WN0Wn2CK9Xc9INwqL3iTZYdwXeEGEikOKOkja49sa3x2m5PoWFDVsJ2eYVtjYCW8/Zxgg5D+67XuzP6WOTykyy93pvXWbPwsbDCuxCb/Ys+Pg3rjAXi1CeBdq6Fu6zsr6QM3uKd9J1FyCrdcdHKNUt79wrpG6bw+TAs4BYZD6VrTCeiMYL0XRsLHL9lvEEXxZTOBXM1bA1btwY/m7OlUHRuTJ0r0lFhLlBlmJqT8sMm8sVUTaxzP+xd6W7jtNQ+FXyHyHFdpwFISEhxAMAL3A7GWhE2drCTXh64qS9zVLX3/FxutH5MzPSsestPp+/s/W7ghcYAlnmSdoM+YBp7GlliZaKtwtUlsg33u5QbLWWAanlpYhlTLnhRW42vxMLLcNYmJnFnh2//pQ52EcA4QgYbpl+TuqYkJFdx4SM7EYYTT+XJkWW3cDfYY5M+mRv6w9gEgJpXD1p3TmEtUTeuhY0vS+YuC5G8tY1gpq3rpHEvHUMgGZEJZbMrGzgDGXtz+Np61Uk8LT124up4uQ0G1/fs7tCZitfSxNMeT+uC+5s7KjzQv8L0vILEi+DeBm3KgtuVfx0bP0PJJYfSB7S+eL/B40vJKOo5SOEYFLAMSf8IUyBJTc0ZNOsG65hcTF0zk4PzU53L8N04P3ACJ1XpH8gzB4Eg3fCt9u3T5+vSyzmSqn75RXPIvEeklCqI71JF9r9re3+L2EXHBVPMjgHfgj8paI1jQQ99uHOpNFB236azny6PU95XD0A2zaqHVAjALy66gSdHOynVt+9lzKSmRmB2+t41y5JI47iQDmgzaU0zNV+4mZrh/jVajg5I9c2uBeq9AKqXX8igc4DqiWQsQdQqwBIuCQgbJHYMgXxtwRPXINKPcrZ24jOxyvXiXnQhoR7Q3PwwRrcCK5XxfoTCNXO/jolApowfKIb2voTCNbODgEKc6Q6Or22Hu/gnrfeTXb3oHUMYn/9fA2ee4Jjb1HdpNfGNHZ5Xjq97wUEfNRQqUYAxTc6bPZEyOwa2MwCzbzYwGtxaXzo5Il7YPTlT4QtAZ5uDZ8W06KhdChaCnzw07jy8cMd/+81Q+inXkUfmac//v69FD98/nRtlf0RL39VjT1Xv73OdtIXB/UbyIOsKutBx0Y7ykLmRSRQlWp6bzu5vvLrTUmEukG4g9Wyum/BIN4AdiR2Ok+u+jxoz4BZzZdTnoFfl1wXqeNFfbgv1t0/AqkJp/3hyuaLo7YYag/5XfX2y5U0yDzlCma+iK+vac6R+5ro4KwRZYOZAgRYj/+N5jQtp9UVAdvCysghGhfSi2NH6DekxWAs7Q9eKjN40tPffBWVRtrIggq6rKF3bBzdTpGLgJoc8sXW8b2n/vZSr4FVfACg4Yt3bECh/xb25q9HemhjWKEWbLAAOp2cwMJbDxXewgAFt6/I6ZePKKUGHpQXfvgNgxjzGTPTG/ZfQc2bcPuF+fIOFljUw6AJNPqxvfBf0GhhaDRvsSeio/0Mx7Q92DpfEQPLVrPO2x4somOY1ou6QUw72Eui+xHbsIdQ1WrUZgW1qTYjsNT+bNR2A4KlagOCpdVDoKW9E8/w4FK7I3fioPvCSxa8VB2YlWcETHs+YtrTIdP+qMj3wfgVCm5aHX9+xUROKzT67fxvB8FPewqAOi38shCqh0sjCGX+u7hTLGSYWBIRkcwSRKvEFH3USGzTJYqo2lA5Gn9tX22u7Xq5oIVjSTXsq78Cq9EAytwLUAzU8FwJm7/C6+DbauDDKxiIIWe8g8OxHcefDqW4KfbzQHwHXWkffxhW2bDS/FCZA225/2lbtR/Q5vOyuqraj4IKskg4+fBW8P2S4GrUoxCt5PjWv931SfCNWu72JHlXse9fSxdbvIf4/BA8r/D3UsjFXLzu4RJnJHXcYPcw08hMu5bG99DXu9+qzefm+9ZN+Aok6BDIJ6m+hVPwCMt/aQZh8Hw3GgDOv0dJkRaRFGlRuOtfdA1SKbRpgKQA6BoIJdShhbusRN8iTZPYtECSKPRqQWd9A6D+Qn/rp7qfBprZYU1zhm5Un6wBKiLdKCMaXRiJmoxEw6WhmyQqzWCcnmFQxFxVNkO/7LVTfjOtnVJBFG0r2gpCTtxdWgwzLvcLrxVtBW29vv8wPoRCDg6Is0rHSfz6dPHYRby7BI5u4u2/L1bUSIB35G2gEOUlaeuj6hVWBXWyHKA6DgNCM8tBqmpLGIbXsxjak8Mo/CnuJYDZctAsuO/9P5/cAO5MANa6lGef4ebOMn8ob8PD1AKn2JdwnrrB9H44ZuqlTM70SMyFEXgQXy+Yu70WcHrhv/5+K7/9/O/lcD/d9zP/ncTyOx+9wtNFp3Y3X8DcpDB4ePQPkd+rP1+RDojfpdumgEc67CeBDiJy0kVfdFaF7S2yiS1I/i8L2tjoIAjKYeM1X+z5NSk68M4BCqYYrxbfcJk8Kt12ZCb7dN0Qh4GWOCqNmwU4gDnfb6RgAnvxTeU3RB++zczQ3fZgEZ262dlFt0Rnv+1sFFtr17NRbBFnv3aovSgUsWCkt5Ahv6xPunl5C/411DjBXW/jVOQ8d72t0x3wBRRuDBQW9BS4OVTge+ttUZP/ZWW/5aKFjdthz4oXuCkht6gHwGXEsmVMoV8D9yJ6gJ4e5YyAzyt84RbAJ2DwwsOHLozRTCe9IqMZfyyzn8RNiMjpwtKSF6umHeXt2AsC7HlFKcCA49lhz0OZcDDYc80gBStmQJ3t2XEK1mADLuyBoxWsqIU7BThiwQf2GIwzhj0/GMfKO4c9z8n5EJFPWUsSnJmhmbYDAEtMQhwAiqRtI29pwCBAgIWJDyfAeAGAOwEAm6ezkPDVfxjtX9bOYIXbmkgeJ9PCWD33Grt1bth+/ulttVta+/1WfhSM+KOM3qO1vUjXsFJb9FsZScBvttVJsUlrW7vrbXWi25For2KucZO2G7pkpERZs7toBLsLzn1e1vyJHPqooZnYlEJZ43sSps6WZRiUJV2yzhY0i/PtCVsa40mgyR34r0AtuFP4KDpLBxnD3FF9RyvT0TOgDLYfRlnzQMbHdePbwQZsj3igUtYM8em0TxpMe2XvIAQ2cjYPt2Z8NLvlnbMteEzs/kZgB8HXjHPQ0PRqCyF4lHuj4ughaDYgev+2FfEV+K5RgJ7UtvJz65+HgiLWIkmvz3aRXGh37+UoLq+U0frnduiw061pUWgRpxTOyzTSeZYVuL/u+lPvsAtwZAdRaRFVI1EjGNkGkExFReSuNNJO0AS05XERD4k9Z2Rg20Y52zxS1efqvZzt+tulw1itRw3WLvnd+CxW79Cyt63kqBW08LvxDldr6Ny3reSoFXTwd/OTb0ZpE5ZTYbMuNmF1RtjaczIWNqKRdcx6JizswulY2EzPKjw/82YzbMLyjLBtgtNzb0Ttw0hmwtYJNqaozngcZvNvQK1b6v70X5WNku0ncJ/s90e4kP+LMCHUTLQ97Y+1hhl90Eh4S8Fz0jDk2T4EaTksfRA2RVknQ2AbfE0KSB+18qYMutt4f7iHtodrcdVdNc9AGxBiAm1vg91hm3fuZEib34khnmgHu8MO7/y7WH/ivUt3dcIdArvg+q7W7K1IwMRW9jGk3LLvCbPo+scy+HfBLj3/cRz8u1h/wh7d7o/Cewi1ZC+DZG+FYB8HAZ5IKn3R0RUD6kJembpQmY5v4HlMIiTOFF8X+eCt5Czy2b2j+0hsyCQ5JBacSYhUlLCpAsoTfvjra/ProR/li77JzQZWHUEEPse7Bs7sQW0LNWuRaPDxbs5ItQZayFELZ46itoWatShor3yzeJRXvqS88hX+yleUV76EX/lmenfwyu+EFf7KV/Yxawp/kL74g/vhD9Yl9GZmO+A9OwPxXiakcSxGQVD8Ea3DoBwNZV+RZ+Yx9DPwGHgCoAuvhEAvlXUZ4Lnk/f5uTyubRXiRKUHJFNaBSLmncgs+ft1D8J5FQEZH+3YRkNFJfbsIx+h4D6G9HtjrINl7EYrSAc6kD6cjB5xOetWyLx2jc9dlX8Ym+o4MkCrPCd4ipk0WZ0I42qhJG5XL9PA7sNMGMLax0wY2tjGPA42NwlH5O78YUYUyWtZ3cK1xl5p0EZ7M39XFiCqUVVPWsWrcgSa9S67u6AlT5HFWkP1nciWSLBIgaXdspds/zlbJtJUodFxEZF8dYF4TXx1wXo0atQLn1SSjVti87pQx7IQTnDFMKIyhsgtnFC4yf3wushNOcC4yoXCRyi6cUVjOHGc5q7KmMf9V2dBIeUrhAEI1AEKNAbxwAIXzfVzG9/p8rya4Jp3vISWwkwsRximBZL24DBrpoecTrbR1yugjAOVcK9IwzlO9krQcFrqYsCmLs9bY8bQuB+Ej8aabkU6C8N4JzntfK63Q8/DdTgplQRqH7x0k2f5qik3z8qlmNt3NZ9w1dwg13/CQsrdCs49Dxj6SKfuzyLmfJp/0z9kkb8ommjMu2304Dv6TOB3JzLeLw2fhP4nTp5n7dsE3PCTcIdSKvQyKvRWSfRwk+0gK9mch0E8Ttn18WD7Sk+VDJi9vVsSbtcAMHyfnV8zoAdVdLOtksIKtfGKT08N+nf6VE/dKp3dl2ci5yy5mQIHqRZbNaJ5r6zwbPe23eCSbjBFNMJuMEdWoTUZbzTfZVDSxiua4/ajA7UciflwDkhFNMAOSEdWoAUlbVyCbiiZW0Rw3dhW4sUvE923tKkSSRFRrl9tKfM7alRVK6Yhq7UrjPEtdrfSwFWb7blul01ZCxVpFZMsasIZjyxpmaZ9Z1sA1nFjWwDVsRmuI2ejbVumoFbaGz2DF64Q1aMXrhFPcipdSrHjaLlxQLI8ippgehaDYHoX8nxkfO2ENGh874RQ3PqYU46O2CxcUg6mIKRZTISgmUyFfNtPlbaY3sZrudqXkG02XNZuGMMUEMW+xDYZexld3kukFzEHPZBBic1tOYsrNr3l3ESBknR82r9gWgIRtheAncuDHP+hgFiHvLviGsYw7hDplL0PO3oqMfRwK9pHM2Z+FiNnfZsG+HwRMwNsvyph9Uwq2KYJvJBSSbZIRMdsuJATbONUfCv9pDE5m4dvH4fPwn8XpExWxbx+He8J/Fqe7Snjfd4cLkzGNwa3tfePxjaYpewy15q+E5u9Hwj4UCf9kKvbnodifqGTfE5J9Vwn+hYne2rAB+WRClsnJhKxeCZGgADpnKEtZS4+guyHbjgX1lHVCtD8PWXYsBKisU3pgX50N2mBBQ2PLBhYyVDbSI4BwuM5YkFHZJET793CdsZCkllclBymWzXCdsSCm/4kR3YimmBHdiGaoET3DjegpwYiu7bICN/kLidv8BSEPu1gmu9oDG/2NaIoZ/Y1ohhr9M9zonxKM/touK3AXBSFxHwVBSGkv7jN93slJQYs8Ijsp6LRIIqqTQp6LQkZUJ4UsU7GIqE4KqUpUEVGdFJJMJLGrVTZtJYtYOtcwnwdD+1QFALZr4g8BbtfEHwLcrok/BLhdE38IcLsm/hDgdjXZqBW4XU0+agVt18v1wup6cRTOQNeLTjjHXS9ykutFRnK9SEmuF/qCtCK5jJAyZwpS6kzxBLkz78RlpBPOQJeRTjjHXUZykstIRnIZSUkuI/qCtCK5upBSoApSDlRBSIL6cnV5ubqEGfvL1eU/9q6lyXEaCJ/3X7i4zInCkp+hoCgWlhNVUMABjpk4u07hSnadLLH59ViWnMiPtlpux5kZpihgZ7bVaj0sff1Q92uoyyyhLmQrvNGEbvYETGZRcLIngJxPsPDIjmyf7E2npzQMyGEFATm2gZzpswjJMR7RXHEmk32NxyKmxtvQQ35WVBGKmDwNzCWvxYq8H9gMSZFd8pfBOPnzZDM8u/XIBxWjP0Bm5Cy0BaM/xWYB+fJiPvkGZSH1Gp8hBCokBxUwnxzZwAJ6fAXzyFEezKfHmjBOD3lhHj3yRp0YhKFoBxebfPo15ydhKNoxziaff+oyIYxEu9LY5ANQXayEgWi3++QDkB4aFpNlKCL6TET09Qjp2yKkb86A/o0E9E/Vp58YPv3g8ujnp0c/xjn5MuEzXGn0ixV7u08IlfO0PPNLJ1th/OlHyi3gm7ezRx9t7dHD/kmke7KitHMQIf1Dx2dsk54pae2rUfouRun6czip7ZurLf9Yb9FXw7S6b6iWJ7rxi1NFoCvV5CpYdIDOsCJMuPi1EPlg0fIybOWuAF94+r5F6AbMB/zx/7QpK9IgetIla459HJG+H48r6iOJfwwtxHZvGoiLUzZAPQMQ4EPIWNHHqDcA1waxF6Ii4AVcOabGLkrebmDsYpng7zqwBhf8jY0kPlqEEje0HAVTj7Y49YgBqqyPVN2A4yJIL0087uNCHyW6RbTg7RZmsZYL2JPhWMiAPXw01tEqHOtoFY8lqMUkIuH58bWkBFb0JbB5wSzS5VdikPP2Qzw8Cx7urPn2+wDfVwDfmwPg3xfeX9aXgu/J4JqO78nVXWdI9O5j0TVs5ST6ttMN2bNNLz0wv5LRqBjBVcUIFzYt8jgOcUoGC/zoqRsh7ZWHLrI3Zn0mgOgatiAgbIUU0sRHPoKyRrAYANt7z8QcjsaIosHdMWIttRV4rhUnFKq0ApUqzBqJEl+NuDbCG4ARVwW9USWi3FshPBsTLghWrcQAeNjMxlTkbWNO9l+SOfk6vf97wMnpdfR9olF6BrRHLjRFt2qTDesFI08DQ64EGvNeUa9WviRaGPV6fugyFOp1eRBxlGndDTh7efh4WeN6g2dXkb/yLJLs1I2imMWeRZadupHvmVPGsK79N+Seb5Obpm7EOQ+4RXKaoyqIsoqeV0aX+5aqt3UV1O8lEWlHJK13K6XMzq0gtDLcZ9LV5XDfSTc3Be5DWdBdYPW+Xz4MR77vF0LYFEhnGCVTzCHua+4mp8AdHN3kFLgzallXiXzHjHm7Pqtj5VVnttOZAwu3CFAs20pXBUoIWxVVBhwrVjxup3dzixm9hdrNO2p3MKeT54mo3SWnaN1owz6sbpJ9LGS1m675k8saz5hBfvpS0J/VBmRfk098RJluyE8o6UUN0NW+J6j+0VX1j5dW/Z9X1llUZleCDigQrFnxReU9JSR/fGo5/4x5ZIWaMKXsX8kmleLjE8rjLaeNWTnm8MFbVgqJlT5iTJTkvzrwnoAyktPfTyzvwPNvpUjYvCYRegQ56m2qMoLhYdSKpjgS/Zeg0cz5LmUyCC4YGcm/IFfmdAYzxM7R3+fQq5PN502drNDM502dLMJs3lTEUkzQqeJGp8rXuw/p6YfDfl+dmIecdeN+ZbI5mWtOppqbJdPcrY5N5/0uq6TeH/bbL2yO0NP0EzRH7DVDUGdvEZrF2X3cJr+Jv/s+zw/nBZRfpmm/uiI0SMwB4kWV5Qq3VphU13li34sC5+wcj6DsrKdhjyfZXvNeA+6onk2OTuGwOzqB43FIfw/apGvlv8H4RXNZ6MKokwvl1lkzhy+ukrfywgtCIa/QtBGuXDm68F7aEeupR3JdYMBdMkA56vD/U34/Nf8/G/5/Xjcz7Gw53V37EigdL+DNtBZQCrz+NUmPhHWNwq/vSqVpFGF9W76MgMWM/j7mmHhkgFzxoKLLDNleYSrc9FSCsXCOKSLnlqxYIAeY7Y1jMfKwmqTCJ88Q2WdUBDQ1kapfFQECLJrbm1cmo9aOttYp+lhVQNjP+wVAa+uJUnAfGNry2TAeuNJv44dxBKCzD1rNAYmeBbAEaHUg98F1PJdHvuPxKIyBBrzdgPHAd0cb6CbvD6wRCCD2dWJuIA4GxvmBAcThEDEHiKP2ILnHovFBxj3uHyJQ7tWQKBG0QK4uS+B4jg9RttYyHKPkrTWphhaGHBSXtVeQGaj9NrXcszC5vojMvawiSB8O03OIPhqm9yD6eJgemMpDuzKnw2LfCx3OQtcFGnRUJ4+F3ih9u4ynmb5djtIsUBG3+H9Q/jxjhUFJvZLU5iKDkpy5kt5cPFDRc0lvLiCo6D1Jby4iqOh9A33QoQ8M9GGHPjTQRx36yEAfd+hjA317udaj1Off2szH1yrVqVMTdRm3qZXcxkKDgvqyy8y1BgW5cZeVjOv0xl1WMk+nN+6ykvk6vXGXlSzQ6Y27rGShTm/cZSWLdHrjLitZa7G0Xba8vUTaMxpzhrhKLiaNGgENuxdXCk0/WZOGjfPydiYNG5fy3CaNlTRprKRJI5YmjfglmDRysuu0YI06OjkLbcUCm+rZSteu8U5Z/Z+kbTNyBuiCRdj0zVbjSzdUr03BYmoy5YL5WBZWg6uw5ByL52Fn3pyv37j+VuOjBy0UzMV+NmYWxo/XanCXxaNEmV9nfnIJjWb9EWnorcbXXEaUwcnPhpKansVYFlaDq47NORYvws68+eQ1rr/V+Aq2Qn9763zzx8E5/yYVjvQ3qUocT983YMc5nus/c3ZJhkIxIApLYW0yPB8Ox/Qu/m4eWPi7WRiG0QKGRrP/mkn/dXSVHuMlr4OzNS/5HE7vddJxOBu86gkHPN+QSMXbjnd4DfmRS53y5AjHiAOvbfZ+rUlS4XCHOcyHyJPCbahP673kLVgA2v0PmiTF29ql7cKsmc66mlCN88Aof9J4l29resjI8FNbDBFZDc/zO534JyExGNKsk5Y/GWY6KblO/q6ajRP4KJ63AgfqvFKYt/CpIISk/bG1LUQnzqVK8rDALStBEoqdAfD+lWnMBelI7d7i19bRc07CMRmCngwckoG3l6NqC4vA2yL4yxsOOoEWrAm0iAIgzkJs41Js/NsFWryVPby9u1kCsAdkeHMAGKvxA96wMWJSKH/EMIBkeCd5vLM3S9woKPHeJokMC60/fV4nb7f/DnKRJ0upjqOvuhTgDhc9Kb5IkPrDHL708sep7S/7ZzKD5ijpM7Cabq6mWxzJFsuquNLc7jpYFr85bdd5kh8+LgCd2/mMXPdpPJQcC3DMrznNP+Un6Ao9nTsvCHPuMIA01e/lUdKjzvVk8vEcU526AtLYnEgyLanDI1yOIlkLwO69KDa5joogNT8t/UpwrZhyY6xpnSGqBCl3SWH1EnaXlFZvVndZL3tpUgCkeYtUEIJvVk+9F4FJCZA+tkgFoXN3b88FU3EwOLZgTyR2dZJ7BIFldpLHDgXKZnDzQGJkVmKQHVaeQQ4UvpzD+Tb5CSOMMXcSZO4kytxJmLl7QTjT0giYcGUFTPigGXBTq4942MQvq2v1plAxtQBo+TXi0cYPqHhazYfbmQ2LpqKB1phmTNVQoMCE+frj9t/DLlm0IFVtTF24eJTU6jXoFOhGThyAlDwgKNSxV47CzYJ3qSWIQyRRFKbNwviyqCFkBrgigaznrEcHtzvpYNZMnnfE2GVL16oBcIiUevghORqH3BKFzHHjgUnILK7vGYAIUGQGH3BivnNnuXKfwoWLMOxke5vb0sLU4dHaY9642lxT4qfWtSRuqV21o7LtopdU4C5/SfXvHGTKXnGK21w5Z5sbp2C1vuw+kTNcyv0Mz/CCP4kz3MJHAA6EzCLHcxheam/iPVInfZENc8Hm9R6Z6R65zT2gHfzffP5YW7N/WGfZ4fNpATP29AgQE7FnQ+zrxKG/ipaILTFHiQQ3iBKRf6lfa2vucIdZZWu4MIF70GICmidC6dhAvF43nuoGeIX0ietj8ISOl44H4PhDr5Y+cVAkvyeS7yhORlcAMqQm6aip3SwRZoeARQJJiyICc1cGVoNTb0IwASoyhMk3NGgFtDzKasLGEgFfOSWviO+Q90/iLQYozcwi/dqcIRfKP4DrQMaMeN3kHM1XP4hErEYgO/CBDkbwVskRqPQ+uHQG20JmlZbwNqaFxpiLQISDMSMlf5lBI6SAZWpODXLmO3IGQWr6P3Ld28KbicHkRchnaW+E9tneSjWZrBlI3aCnDbxpFATx5zczaQVvKk7NLf0gbscHeU8/XExED18NkHGI7IrWxU8zYfVW7+Im0gRoA9wBYS8j6uU7GyC+sO0D+j51Ul7IO4CzT3slbYJvnQGqpGAax/MVj/ZJr5QaEh0gu/Z7xYtDQ9E7LpgQUBjFBgai91sRyUAXRXdFcuKnmXCc6F6HWHKbSoj14D5IiPWgJl7Sv5F3ppyl8tuHx2YcEpf0mP7VbGqBehqmf133WodrVjMteY+r/ON1BuZCOqKPBhw8CJjTlSjd1CKdrhJV5N2GmwQxkoF2cH+Po+16q5FDvck/afMmkYtcv5PcdLnczI+iV9qEfqV6mQ24vFG81HCviOWNHP2pP9X16Ft04npptekvq2gjqIAW+hTjWxR8apNHixZsYgtILHmbXvbRZfb1e/TN5RJVt+ePh/O+/vnmjpbhXKJmu9o9nDKQ5asxGCGtUvPmEC25VWLQ0utYIkqOMRLJGxblgbK29+AKhsjbVl62X5gDS0s+mprU10k9QXgvrxazcWspFcizMVFwwERhob4/GcfZ4gaKOXxvw2JY1ZK7qZ0EJQPgZrWYCKqppuO8a6VR5bWpZp5yDc/dUkM1c1BtBLNZiowJJcARENtTKwNkxP4LNhMD4xKgLS3ipy4sVDjx1RXr+DHj3qsrdkZXbLCQJzbhr77Y5+2LLf2uQsMs3LYc77ZVT9U4SKzPR7sO/Kv39tV7S17g5ZQjHJ6/rVaCiucze29fRk1qulIwGyif7rt8dd8+EfctQa+g1oBWDAgV03wiA6puVzCiAAWficHkRcCqp2jl8Koe9rRBoSWePuf7p5+qjd9OO/SiYIw40Imje5WmGFAL5TCnKIV0lbCtrLHRsNlPnp2W1lc3P3lz65q6yrX2xAigidztKzaBLowcLTCTgS6KaiwECtTIEUlIap3RoFatz7Zp904pb+cjgTOxpVyfnTN33IoeVqyCttYWmERPKSpkGYgFTqGSCd3Cc7DYj2fddbWCp+PxKAnrveA8nh15NxhNEhXbx6Mamtq8UywSg7InrSnsBjhDjVq+xaReVWDITVLHelAVredg3p+d0oqUj2QkjNvLI/YWSBtqtEVsII504lAs+4gUvk68ctxKaJA20GmjmhaUYlNciMUHJuj5dUGegZnhlErwhdPRISsDB9P+hTbsJ9gYVAelj+tBDsDvzxBsZHhM7M0kgRzC5Sox16FUekBwd1NGZUOwmGcrO0QRq0FieAzPkoUQkE1mU9jYZPzhj0Y9spxqEPn/pkA0xCEnfQ0IyuQiaNP6/8i8NrACi7NigF03u21K3yui6pkT2zffpDEhO8ggpEoQzcOgMGrP+gJytYKDWYC+DPz6oMYuosrSkBIFEHtoqgynFGdEsbUgaJYC8Yt/tvlpt1lnv2/yQ5YtYD1oZavkwX0U8R5eH1PDN+lY+qAheq7nMK+VNJjW79L6bbhpgOtVkw0aKNfEjouC6xW0r4hRYF2Schz+DtvE4h+jp++xboNSLSUpv4dPUCLFHtblwWil8k16d4Q4h7PLHURm6bK+LiiWMJzs7hIjOMn/5YLRjDFwt0N41fWTH/6uvoz36+y4/cLZFqf883F32P/yt/qdaICCgdWnhAWC17uwbpTWf7jehYSrcJNi7fm6DH4jgz8sA3NjOyGQJn0Dg01qdC0ZZ3ISKI5sQbHeOQSLObb3UA7eiKjIqHRQflxmSLsSPr4aEcJjTJDJYkdXq2GTrbI5LN7vsuqgS9b539v9z9vKxjnj8fEcJ8lwHqptOON4POsBeXYjGln2/WFPW+HLsWiekNeD8bkejNneEh1Y9m23ndV+tEuwaP19dtfT7guduBl87JcghmO5ofAfZOEh96QZN2LOBdphl+0tT2r7QdwZ/GJwp8Hq07XyiF+e1/9sF7D3sI7BBx8tchfL0FAQBce+Jf2SCUrRSDryMfHXqTlOoB1TXQpyxwNYt6qOMYto6lKmWcA58GUMuDmYQPD1DUKEbWIhBKYqn3gwaw6YOLzn3QYBLox//XgUMfSIFwLffe1U3Tiu+C8i4j+TAf8w46DNWPwLeu6DbqxEEcCM9bRn4iVBEchtZDQyVrRVa5SRsQrD8ARjXExAJgQe4ctcfXzy+QPKJFmEQmJUFEMlceQUzG1ERkSkwNtCOJ3R7zAEMUc/G9llejiHWL7QkBBeOKvFWhTMWPFGHUTy40DUvBEHwO60fNY8Vaawb2R1ISOr1ZOFTjhEfZ5f34xDfYh1lEDh7qZcwIgqd5qcCYoh1eZRtjcii4XXf3jGV5Mtui+4nIyKWsZUq998ftxtqqoqVkH0vQhxD/r7ABCk7hZf2JC5SAyv84Vd4iEkbnR1mVup2HW31NKBAocrRL5NPmzfZdnu43GrwruXzQ3zJXdjz8Mlhwl5sHhymKT49XDU8Zw52UtStpukDTqHm4hOOne4+BX4mlKQd14ljpAfk0ITR3JOHQYRlxqx5HuGiD9W5+UFvZ64U/VU/VsCnIViqoktGjthXUAekny7H2jiVo3QBRHPCZcasTETTV0GsKHGZcNBPXhtFggkTQrelfi/9q5muU0YCL+KpvfOVDIG59JTn6A99VgmNPEMQ2IiOShPH2TJmQV50fKTOBAu8STZ/fhY2WY/rbTKig7GosnYWRNkwHk3L0HHgY2u2EhyMPAmEuYWsVH0zQXeK/k0aQHDZ/3rcXfXxb3gLVgYJnjstg50+AH549zgy3rk5NuRk1dvp/Rd8CiJdps4Ss5JMvyL3yDJd/kLXfxU7/xtrO33LCG/fs/seoqFEpMc1TjNsZMTrLcYfwjnoP3JpICWPQJqnmU9333hBkrvKDWuLDRgVMJiIx+7XTlwZKN7Etnng3uI9CmJtpvwIHm4S9B/16N7pVY8Nj+nzp/HV1pduYQs/bYCxha3vgRGHthqa3vEbA8Xkv9nTHFpMBlt+WKWh4blAbn4CyBao5v6BmZb3XGQh1mmCROYsfCM+Q+2/UY5SK2+EuPBiXNnKlBT3SSsOwnrJmH9RphSr9GGMKVTqDHFCUs/wDmr0DGucmj+UttKjgD791bxLmTZRJaCVRj0xuN8+lEiyGUTuWRygwBHPmdLHEFOW5wjnPPW46w5wz9MuhloYyy3CHTssZZdyO1Ax0wiwInP2RJHkEufc4JA71qcHXSKILcDvWPpx0/7z0B3fH7lMeN+RAQOfTP1r7SNj7AaCs/RaavjUH9pB2U4wCQnJY50D0sUlL4DKIcCTNOPKLhCD+VPXOGH+qeW/3AAPo4A8TycvOjXFozqXzmAfChATnwDkhWu1bhAynoC90EVt+Zfc6tBdXUT4nEcJ2u5qr8QXgXrKlhXwboK1mUIVmipWm2QzSOj85tWidY6QIXc3bF9FK0KrumrKSjOxI3Y3TgOhOKi4bDPCfXC9GS4VgtnVy1cNXuwupYvrbpmB1cRVvGd62LW+v70OnY33Nz1viL6X4rd2OY/C5ksOAb9LwVv1E7C2U8zKKJ/Z+SGveuWN0VhfsOmImq7MnvK5J/7f4/Zr+z/vtjLh+Lp5yvzH4ebq4cIAA==";
    return PredefinedShapes;
}(Base));
export { PredefinedShapes };
/**
 * @hidden
 */
var FormatCellsDialogDataBuilder = /** @class */ (function (_super) {
    tslib_1.__extends(FormatCellsDialogDataBuilder, _super);
    function FormatCellsDialogDataBuilder(a, b) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.a = null;
        _this.j = true;
        _this.h = 0x7FFFFFFF & ~(208404486 | 32768 | 33554432);
        _this.i = null;
        _this.k = false;
        _this.l = false;
        _this.b = a;
        _this.a = b;
        _this.i = new WorksheetCellFormatData(a[0].workbook, 0);
        return _this;
    }
    FormatCellsDialogDataBuilder.f = function (a, b) {
        var e_110, _0, e_111, _1;
        if (a == null || a.length == 0 || b == null || b.length == 0) {
            return new FormatCellsDialogData();
        }
        var c = new FormatCellsDialogDataBuilder(a, b);
        var d, e, f, g, h, i;
        d = e = f = g = h = i = null;
        var j = new RowCellFormatEnumerator();
        var k = new RowCellFormatEnumerator();
        var l = new ColumnCellFormatEnumerator();
        var m = new ColumnCellFormatEnumerator();
        for (var n = 0; n < a.length; n++) {
            var o = a[n];
            for (var p = 0; p < b.length; p++) {
                var q = b[p];
                var r = q.firstRow;
                var s = q.lastRow;
                var t = q.firstColumn;
                var u = q.lastColumn;
                var v = r;
                c.k = false;
                var w = false;
                try {
                    for (var _2 = tslib_1.__values(fromEnum(o._rows$i._m(r, s))), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var x = _3.value;
                        var y = x.index;
                        if (y > r) {
                            i = c.e(o, y - 1, y, t, u, j, k, 4, 2, 134217728, 67108864, true, i);
                        }
                        if (y != v) {
                            if (!c.k) {
                                c.q(o, t, u);
                                if (t < u) {
                                    h = c.c(o, v, t, u, j, true, h);
                                }
                            }
                            if (!w && y - v > 1) {
                                w = true;
                                i = c.e(o, v, v + 1, t, u, j, k, 4, 2, 134217728, 67108864, true, i);
                            }
                        }
                        c.l = false;
                        var z = t;
                        try {
                            for (var _4 = tslib_1.__values(fromEnum(x._ch(t, u, true))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                                var aa = _5.value;
                                if (!aa.n) {
                                    continue;
                                }
                                if (z < aa.r) {
                                    c.p(x, z, aa.r - 1);
                                }
                                c.o(aa.j);
                                z = aa.r + 1;
                            }
                        }
                        catch (e_111_1) { e_111 = { error: e_111_1 }; }
                        finally {
                            try {
                                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                            }
                            finally { if (e_111) throw e_111.error; }
                        }
                        if (z <= u) {
                            c.p(x, z, u);
                        }
                        if (t < u) {
                            h = c.c(o, x.index, t, u, j, true, h);
                        }
                        v = x.index + 1;
                    }
                }
                catch (e_110_1) { e_110 = { error: e_110_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_110) throw e_110.error; }
                }
                if (v <= s) {
                    if (!c.k) {
                        c.q(o, t, u);
                        if (t < u) {
                            h = c.c(o, v, t, u, j, true, h);
                        }
                    }
                    if (v > 0) {
                        i = c.e(o, v - 1, v, t, u, j, k, 4, 2, 134217728, 67108864, true, i);
                    }
                    if (!w && v < s) {
                        w = true;
                        i = c.e(o, v, v + 1, t, u, j, k, 4, 2, 134217728, 67108864, true, i);
                    }
                }
                if (r == 0) {
                    d = c.d(o, r, t, u, j, 134217728, 67108864, d);
                }
                else {
                    d = c.e(o, r - 1, r, t, u, j, k, 4, 2, 134217728, 67108864, false, d);
                }
                if (s < o.workbook.maxRowCount - 1) {
                    e = c.e(o, s, s + 1, t, u, j, k, 4, 2, 134217728, 67108864, true, e);
                }
                else {
                    e = c.d(o, s, t, u, j, 4, 2, e);
                }
                if (t == 0) {
                    f = c.d(o, t, r, s, l, 524288, 262144, f);
                }
                else {
                    f = c.e(o, t - 1, t, r, s, l, m, 4194304, 2097152, 524288, 262144, false, f);
                }
                if (u < o.workbook.maxColumnCount - 1) {
                    g = c.e(o, u, u + 1, r, s, l, m, 4194304, 2097152, 524288, 262144, true, g);
                }
                else {
                    g = c.d(o, u, r, s, l, 4194304, 2097152, g);
                }
            }
        }
        var ab = new FormatCellsDialogData();
        ab.ad = FormatCellsDialogDataBuilder.m(a, b);
        if (h != null) {
            ab.t = h.b;
            ab.e = h.a;
        }
        if (i != null) {
            ab.s = i.b;
            ab.d = i.a;
        }
        var ac = c.i;
        for (var ad = 1; ad != 1073741824; ad = (ad << 1)) {
            switch (ad) {
                case 1:
                    ab.m = ac.alignment;
                    break;
                case 2:
                    ab.p = e.b;
                    break;
                case 4:
                    ab.b = e.a;
                    break;
                case 8:
                    ab.q = ac.diagonalBorderColorInfo;
                    break;
                case 16:
                    ab.j = ac.diagonalBorders;
                    break;
                case 32:
                    ab.c = ac.diagonalBorderStyle;
                    break;
                case 64:
                    ab.i = ac.fill;
                    break;
                case 128:
                    ab.z = ac.font != null ? ac.font._bold$i : Nullable$1.toNullable(Boolean_$type, null);
                    break;
                case 256:
                    ab.r = ac.font != null ? ac.font.colorInfo : null;
                    break;
                case 512:
                    ab.x = ac.font != null ? ac.font.height : -1;
                    break;
                case 1024:
                    ab.aa = ac.font != null ? ac.font._italic$i : Nullable$1.toNullable(Boolean_$type, null);
                    break;
                case 2048:
                    ab.ah = ac.font != null ? ac.font.name : null;
                    break;
                case 4096:
                    ab.ab = ac.font != null ? ac.font._strikeout$i : Nullable$1.toNullable(Boolean_$type, null);
                    break;
                case 8192:
                    ab.k = ac.font != null ? ac.font.superscriptSubscriptStyle : -1;
                    break;
                case 16384:
                    ab.l = ac.font != null ? ac.font.underlineStyle : -1;
                    break;
                case 65536:
                    ab.ai = ac.formatString;
                    break;
                case 131072:
                    ab.y = ac.indent;
                    break;
                case 262144:
                    ab.u = f.b;
                    break;
                case 524288:
                    ab.f = f.a;
                    break;
                case 1048576:
                    ab.ac = ac._locked$i;
                    break;
                case 2097152:
                    ab.v = g.b;
                    break;
                case 4194304:
                    ab.g = g.a;
                    break;
                case 8388608:
                    ab.ae = Nullable$1.toNullable(Number_$type, ac.rotation);
                    break;
                case 16777216:
                    ab.af = ac._shrinkToFit$i;
                    break;
                case 67108864:
                    ab.w = d.b;
                    break;
                case 134217728:
                    ab.h = d.a;
                    break;
                case 268435456:
                    ab.n = ac.verticalAlignment;
                    break;
                case 536870912:
                    ab.ag = ac._wrapText$i;
                    break;
            }
        }
        return ab;
    };
    FormatCellsDialogDataBuilder.g = function (a) {
        var b = new EditModeWorkbookFontInfo();
        a._v.initializeEditFont(b, false);
        var c = new FormatCellsDialogData();
        c.z = b.e;
        c.r = b.c;
        c.x = b.d;
        c.aa = b.f;
        c.ah = b.i;
        c.ab = b.g;
        c.k = b.a;
        c.l = b.b;
        return c;
    };
    FormatCellsDialogDataBuilder.m = function (a, b) {
        var c = 0;
        for (var d = 0; d < a.length; d++) {
            if (a[d]._mergedCellsRegions$i.count == 0) {
                continue;
            }
            for (var e = 0; e < b.length; e++) {
                var f = b[e];
                var g = a[d]._mergedCellsRegions$i;
                for (var h = 0; h < g.count; h++) {
                    if (g.item(h)._t(f.firstRow, f.firstColumn, f.lastRow, f.lastColumn)) {
                        c++;
                        if (b.length > 1) {
                            return Nullable$1.toNullable(Boolean_$type, null);
                        }
                        var i = g.item(h)._h;
                        if (i._w != f.firstColumn || i._ac != f.firstRow || i._x != f.lastColumn || i._ae != f.lastRow) {
                            return Nullable$1.toNullable(Boolean_$type, null);
                        }
                    }
                }
            }
        }
        if (c == 0) {
            return Nullable$1.toNullable(Boolean_$type, false);
        }
        if (a.length == c) {
            return Nullable$1.toNullable(Boolean_$type, true);
        }
        return Nullable$1.toNullable(Boolean_$type, null);
    };
    FormatCellsDialogDataBuilder.prototype.n = function (a, b, c) {
        var d = a._ff;
        var e = a._f9(b);
        var f = null;
        while (f == null || f.r < c) {
            f = d._inner[e];
            this.o(f.b);
            e++;
        }
    };
    FormatCellsDialogDataBuilder.prototype.c = function (a, b, c, d, e, f, g) {
        if (g != null && g.d) {
            return g;
        }
        var h = g != null ? g : new CellBorderValue();
        var i = f ? 4194304 : 4;
        var j = f ? 2097152 : 2;
        var k = f ? 524288 : 134217728;
        var l = f ? 262144 : 67108864;
        e.h(a, b, c, d);
        e.c();
        var m = c;
        var n;
        while (m < d) {
            n = e.b;
            if (m == e.f) {
                e.c();
            }
            m++;
            var o = e.b;
            var p = EnumUtil.getEnumValue(CellBorderLineStyle_$type, n._da(i, null));
            var q = SpreadsheetUtilities.cn(p);
            var r = EnumUtil.getEnumValue(CellBorderLineStyle_$type, o._da(k, null));
            var s = SpreadsheetUtilities.cn(r);
            var t = void 0;
            var u = void 0;
            if (q >= s) {
                u = p;
                t = n._da(j, null);
            }
            else {
                u = r;
                t = o._da(l, null);
            }
            if (!h.e(u, t)) {
                break;
            }
            if (Base.referenceEquals(n, o)) {
                m = e.f;
            }
        }
        return h;
    };
    FormatCellsDialogDataBuilder.prototype.o = function (a) {
        for (var b = 1; b != 1073741824; b = (b << 1)) {
            if ((this.h & b) != 0) {
                var c = a._da(b, null);
                if (this.j) {
                    this.i._dv(b, c);
                }
                else if (!Base.equalsStatic(c, this.i._dd(b))) {
                    this.h &= ~b;
                    this.i._ds(b);
                }
            }
        }
        this.j = false;
    };
    FormatCellsDialogDataBuilder.prototype.d = function (a, b, c, d, e, f, g, h) {
        if (h != null && h.d) {
            return h;
        }
        var i = h == null ? new CellBorderValue() : h;
        e.h(a, b, c, d);
        while (e.c()) {
            var j = e.b;
            if (!i.e(EnumUtil.getEnumValue(CellBorderLineStyle_$type, j._da(f, null)), j._da(g, null))) {
                break;
            }
        }
        return i;
    };
    FormatCellsDialogDataBuilder.prototype.p = function (a, b, c) {
        if (a._hasCellFormat) {
            if (!this.l) {
                this.l = true;
                this.o(a._cellFormatInternal.d);
            }
        }
        else if (!this.k) {
            this.n(a.worksheet, b, c);
        }
    };
    FormatCellsDialogDataBuilder.prototype.q = function (a, b, c) {
        this.k = true;
        this.n(a, b, c);
    };
    FormatCellsDialogDataBuilder.prototype.e = function (a, b, c, d, e, f, g, h, i, j, k, l, m) {
        if (m != null && m.d) {
            return m;
        }
        var n = m == null ? new CellBorderValue() : m;
        f.h(a, b, d, e);
        f.c();
        g.h(a, c, d, e);
        g.c();
        var o = d;
        while (o <= e) {
            if (o > g.f) {
                g.c();
            }
            if (o > f.f) {
                f.c();
            }
            var p = EnumUtil.getEnumValue(CellBorderLineStyle_$type, f.b._da(h, null));
            var q = SpreadsheetUtilities.cn(p);
            var r = EnumUtil.getEnumValue(CellBorderLineStyle_$type, g.b._da(j, null));
            var s = SpreadsheetUtilities.cn(r);
            var t = void 0;
            var u = void 0;
            if ((q == s && !l) || s > q) {
                u = r;
                t = g.b._da(k, null);
            }
            else {
                u = p;
                t = f.b._da(i, null);
            }
            if (!n.e(u, t)) {
                break;
            }
            o = Math.min(f.f + 1, g.f + 1);
        }
        return n;
    };
    FormatCellsDialogDataBuilder.$t = markType(FormatCellsDialogDataBuilder, 'FormatCellsDialogDataBuilder');
    return FormatCellsDialogDataBuilder;
}(Base));
export { FormatCellsDialogDataBuilder };
/**
 * @hidden
 */
var SetFormatCellsDialogDataHelper = /** @class */ (function (_super) {
    tslib_1.__extends(SetFormatCellsDialogDataHelper, _super);
    function SetFormatCellsDialogDataHelper() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.e = null;
        _this.c = null;
        _this.b = null;
        _this.a = null;
        return _this;
    }
    SetFormatCellsDialogDataHelper.prototype.f = function () {
        var _this = this;
        var a = this.c;
        var b = this.b;
        if (nullableNotEquals(a.ad, b.ad)) {
            if (nullableEquals(b.ad, true)) {
                this.e._g2(1);
            }
            else {
                this.e._g2(0);
            }
        }
        this.j(a.p, a.b, b.p, b.b);
        this.j(a.w, a.h, b.w, b.h);
        this.j(a.u, a.f, b.u, b.f);
        this.j(a.v, a.g, b.v, b.g);
        this.j(a.t, a.e, b.t, b.e);
        this.j(a.s, a.d, b.s, b.d);
        if (b.j != 0 && (b.j != a.j || WorkbookColorInfo.l_op_Inequality(b.q, a.q) || b.c != a.c)) {
            this.k(DiagonalBorders_$type, a.j, b.j, 16, SpreadsheetUtilities.eh);
            this.j(a.q, a.c, b.q, b.c);
        }
        var c = 0;
        var d = function (e) { return c++; };
        this.i(d);
        if (c == 1) {
            this.k(CellFill.$, a.i, b.i, 64, SpreadsheetUtilities.ei);
            this.k(Nullable$1.$.specialize(Boolean_$type), a.z, b.z, 128, SpreadsheetUtilities.ef);
            this.k(WorkbookColorInfo.$, a.r, b.r, 256, SpreadsheetUtilities.ej);
            this.k(Number_$type, a.x, b.x, 512, SpreadsheetUtilities.el);
            this.k(Nullable$1.$.specialize(Boolean_$type), a.aa, b.aa, 1024, SpreadsheetUtilities.eo);
            this.k(String_$type, a.ah, b.ah, 2048, SpreadsheetUtilities.ek);
            this.k(Nullable$1.$.specialize(Boolean_$type), a.ab, b.ab, 4096, SpreadsheetUtilities.et);
            this.k(FontSuperscriptSubscriptStyle_$type, a.k, b.k, 8192, SpreadsheetUtilities.ev);
            this.k(FontUnderlineStyle_$type, a.l, b.l, 16384, SpreadsheetUtilities.ew);
            this.k(String_$type, a.ai, b.ai, 65536, SpreadsheetUtilities.em);
            this.k(HorizontalCellAlignment_$type, a.m, b.m, 1, SpreadsheetUtilities.ee);
            this.k(Number_$type, a.y, b.y, 131072, SpreadsheetUtilities.en);
            this.k(Nullable$1.$.specialize(Boolean_$type), a.ac, b.ac, 1048576, SpreadsheetUtilities.ep);
            this.k(Nullable$1.$.specialize(Number_$type), a.ae, b.ae, 8388608, function (e, f) { return SpreadsheetUtilities.er(e, f.value); });
            this.k(Nullable$1.$.specialize(Boolean_$type), a.af, b.af, 16777216, SpreadsheetUtilities.es);
            this.k(VerticalCellAlignment_$type, a.n, b.n, 268435456, SpreadsheetUtilities.ex);
            this.k(Nullable$1.$.specialize(Boolean_$type), a.ag, b.ag, 536870912, SpreadsheetUtilities.ey);
        }
        else if (c > 1) {
            var e_112 = 0;
            var f = function (g) { return e_112 |= g; };
            this.i(f);
            var g = new List$1(Delegate_$type, 0);
            for (var h = 1; h != 1073741824; h = (h << 1)) {
                var i = null;
                if ((e_112 & h) != 0) {
                    switch (h) {
                        case 64:
                            i = function (j) { return j._a0(_this.b.i, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 128:
                            i = function (j) { return j._a2(Nullable$1.$.specialize(Boolean_$type), _this.b.z, 128, false, SpreadsheetUtilities.ah(j), function (k) { return k._bold$i; }, function (k, l) { return k._bold$i = l; }); };
                            break;
                        case 256:
                            i = function (j) { return j._a2(WorkbookColorInfo.$, _this.b.r, 256, false, SpreadsheetUtilities.ah(j), function (k) { return k.colorInfo; }, function (k, l) { return k.colorInfo = l; }); };
                            break;
                        case 512:
                            i = function (j) { return j._a2(Number_$type, _this.b.x, 512, false, SpreadsheetUtilities.ah(j), function (k) { return k.height; }, function (k, l) { return k.height = l; }); };
                            break;
                        case 1024:
                            i = function (j) { return j._a2(Nullable$1.$.specialize(Boolean_$type), _this.b.aa, 1024, false, SpreadsheetUtilities.ah(j), function (k) { return k._italic$i; }, function (k, l) { return k._italic$i = l; }); };
                            break;
                        case 2048:
                            i = function (j) { return j._a2(String_$type, _this.b.ah, 2048, false, SpreadsheetUtilities.ah(j), function (k) { return k.name; }, function (k, l) { return k.name = l; }); };
                            break;
                        case 4096:
                            i = function (j) { return j._a2(Nullable$1.$.specialize(Boolean_$type), _this.b.ab, 4096, false, SpreadsheetUtilities.ah(j), function (k) { return k._strikeout$i; }, function (k, l) { return k._strikeout$i = l; }); };
                            break;
                        case 8192:
                            i = function (j) { return j._a2(FontSuperscriptSubscriptStyle_$type, _this.b.k, 8192, false, SpreadsheetUtilities.ah(j), function (k) { return k.superscriptSubscriptStyle; }, function (k, l) { return k.superscriptSubscriptStyle = l; }); };
                            break;
                        case 16384:
                            i = function (j) { return j._a2(FontUnderlineStyle_$type, _this.b.l, 16384, false, SpreadsheetUtilities.ah(j), function (k) { return k.underlineStyle; }, function (k, l) { return k.underlineStyle = l; }); };
                            break;
                        case 65536:
                            i = function (j) { return j._a5(_this.b.ai, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 1:
                            i = function (j) { return j._au(_this.b.m, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 131072:
                            i = function (j) { return j._a8(_this.b.y, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 1048576:
                            i = function (j) { return j._bb(_this.b.ac, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 8388608:
                            i = function (j) { return j._bf(_this.b.ae.value, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 16777216:
                            i = function (j) { return j._bg(_this.b.af, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 268435456:
                            i = function (j) { return j._bm(_this.b.n, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        case 536870912:
                            i = function (j) { return j._bn(_this.b.ag, false, SpreadsheetUtilities.ah(j)); };
                            break;
                        default: break;
                    }
                    if (i != null) {
                        g.add(i);
                    }
                }
            }
            this.e._io(List$1.$.specialize(Delegate_$type), g, function (j, k) {
                var l = j.b(true);
                for (var m = 0; m < k.count; m++) {
                    k._inner[m](j);
                }
                j.g(l);
            }, this.a, e_112);
        }
    };
    SetFormatCellsDialogDataHelper.g = function (a, b, c) {
        if (nullableNotEquals(b.z, c.z)) {
            a._bold$i = c.z;
        }
        if (WorkbookColorInfo.l_op_Inequality(b.r, c.r)) {
            a.colorInfo = c.r;
        }
        if (b.x != c.x) {
            a.height = c.x;
        }
        if (nullableNotEquals(b.aa, c.aa)) {
            a._italic$i = c.aa;
        }
        if (b.ah != c.ah) {
            a.name = c.ah;
        }
        if (nullableNotEquals(b.ab, c.ab)) {
            a._strikeout$i = c.ab;
        }
        if (b.k != c.k) {
            a.superscriptSubscriptStyle = c.k;
        }
        if (b.l != c.l) {
            a.underlineStyle = c.l;
        }
    };
    SetFormatCellsDialogDataHelper.prototype.h = function ($t, a, b, c, d) {
        if (!Base.equalsStatic(getBoxIfEnum($t, b), getBoxIfEnum($t, a))) {
            d(c);
        }
    };
    SetFormatCellsDialogDataHelper.prototype.i = function (a) {
        var b = this.c;
        var c = this.b;
        this.h(CellFill.$, b.i, c.i, 64, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.z, c.z, 128, a);
        this.h(WorkbookColorInfo.$, b.r, c.r, 256, a);
        this.h(Number_$type, b.x, c.x, 512, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.aa, c.aa, 1024, a);
        this.h(String_$type, b.ah, c.ah, 2048, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.ab, c.ab, 4096, a);
        this.h(FontSuperscriptSubscriptStyle_$type, b.k, c.k, 8192, a);
        this.h(FontUnderlineStyle_$type, b.l, c.l, 16384, a);
        this.h(String_$type, b.ai, c.ai, 65536, a);
        this.h(HorizontalCellAlignment_$type, b.m, c.m, 1, a);
        this.h(Number_$type, b.y, c.y, 131072, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.ac, c.ac, 1048576, a);
        this.h(Nullable$1.$.specialize(Number_$type), b.ae, c.ae, 8388608, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.af, c.af, 16777216, a);
        this.h(VerticalCellAlignment_$type, b.n, c.n, 268435456, a);
        this.h(Nullable$1.$.specialize(Boolean_$type), b.ag, c.ag, 536870912, a);
    };
    SetFormatCellsDialogDataHelper.prototype.d = function (a, b) {
        var c = this.b;
        var d = this.c;
        var e = 0;
        if (WorkbookColorInfo.l_op_Equality(c.p, a) && c.b == b) {
            d.b = c.b;
            d.p = c.p;
            e |= 8;
        }
        if (WorkbookColorInfo.l_op_Equality(c.w, a) && c.h == b) {
            d.h = c.h;
            d.w = c.w;
            e |= 2;
        }
        if (WorkbookColorInfo.l_op_Equality(c.u, a) && c.f == b) {
            d.f = c.f;
            d.u = c.u;
            e |= 1;
        }
        if (WorkbookColorInfo.l_op_Equality(c.v, a) && c.g == b) {
            d.g = c.g;
            d.v = c.v;
            e |= 4;
        }
        if (WorkbookColorInfo.l_op_Equality(c.s, a) && c.d == b) {
            d.d = c.d;
            d.s = c.s;
            e |= 16;
        }
        if (WorkbookColorInfo.l_op_Equality(c.t, a) && c.e == b) {
            d.e = c.e;
            d.t = c.t;
            e |= 32;
        }
        if (c.j != 0 && WorkbookColorInfo.l_op_Equality(c.q, a) && c.c == b) {
            d.q = c.q;
            d.c = c.c;
            if (3 == (c.j & 3)) {
                e |= 64;
            }
            if (5 == (c.j & 5)) {
                e |= 128;
            }
        }
        return e;
    };
    SetFormatCellsDialogDataHelper.prototype.j = function (a, b, c, d) {
        if (WorkbookColorInfo.l_op_Inequality(a, c) || b != d) {
            var e = this.d(c, d);
            this.e._im(this.a, e, c, d);
        }
    };
    SetFormatCellsDialogDataHelper.prototype.k = function ($t, a, b, c, d) {
        if (!Base.equalsStatic(getBoxIfEnum($t, b), getBoxIfEnum($t, a))) {
            this.e._io($t, b, d, this.a, c);
        }
    };
    SetFormatCellsDialogDataHelper.$t = markType(SetFormatCellsDialogDataHelper, 'SetFormatCellsDialogDataHelper');
    return SetFormatCellsDialogDataHelper;
}(Base));
export { SetFormatCellsDialogDataHelper };
/**
 * @hidden
 */
var RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont = /** @class */ (function (_super) {
    tslib_1.__extends(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont, _super);
    function RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont(a) {
        var _this = _super.call(this) || this;
        _this._g = Nullable$1.toNullable(Boolean_$type, null);
        _this._e = null;
        _this._f = 0;
        _this._h = Nullable$1.toNullable(Boolean_$type, null);
        _this._j = null;
        _this._i = Nullable$1.toNullable(Boolean_$type, null);
        _this._c = 0;
        _this._d = 0;
        _this._b = null;
        CoreUtilities.y(a);
        _this._b = a;
        return _this;
    }
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "bold", {
        get: function () {
            return unwrapNullable(this._bold$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._bold$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "_bold$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(Nullable$1.$.specialize(Boolean_$type), _this._g); _this._g = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.ef, a, 128);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "colorInfo", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(WorkbookColorInfo.$, _this._e); _this._e = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(WorkbookColorInfo.$, SpreadsheetUtilities.ej, a, 256);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "height", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(Number_$type, _this._f); _this._f = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(Number_$type, SpreadsheetUtilities.el, a, 512);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "italic", {
        get: function () {
            return unwrapNullable(this._italic$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._italic$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "_italic$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(Nullable$1.$.specialize(Boolean_$type), _this._h); _this._h = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.eo, a, 1024);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "name", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(String_$type, _this._j); _this._j = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(String_$type, SpreadsheetUtilities.ek, a, 2048);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "strikeout", {
        get: function () {
            return unwrapNullable(this._strikeout$i);
        },
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._strikeout$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "_strikeout$i", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(Nullable$1.$.specialize(Boolean_$type), _this._i); _this._i = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(Nullable$1.$.specialize(Boolean_$type), SpreadsheetUtilities.et, a, 4096);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "superscriptSubscriptStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(FontSuperscriptSubscriptStyle_$type, _this._c); _this._c = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(FontSuperscriptSubscriptStyle_$type, SpreadsheetUtilities.ev, a, 8192);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype, "underlineStyle", {
        get: function () {
            var _this = this;
            return ((function () { var a = _this._b._g(FontUnderlineStyle_$type, _this._d); _this._d = a.p0; return a.ret; })());
        },
        set: function (a) {
            this._b._al(FontUnderlineStyle_$type, SpreadsheetUtilities.ew, a, 16384);
        },
        enumerable: true,
        configurable: true
    });
    RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype.setFontFormatting = function (a) {
        this._b._al(IWorkbookFont_$type, function (b, c) { return b.font.setFontFormatting(c); }, a, 32640);
    };
    RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.prototype._k = function (a) {
        CoreUtilities.z(a, "source");
        this._g = a._bold$i;
        this._e = a.colorInfo;
        this._f = a.height;
        this._h = a._italic$i;
        this._j = a.name;
        this._i = a._strikeout$i;
        this._c = a.superscriptSubscriptStyle;
        this._d = a.underlineStyle;
    };
    RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont.$t = markType(RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont, 'RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont', PropertyChangeNotifier.$, [IWorkbookFont_$type]);
    return RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont;
}(PropertyChangeNotifier));
export { RangeWorksheetCellFormatBase_RangeWorksheetCellFormatFont };
/**
 * @hidden
 */
var RangeWorksheetCellFormatBase_EmptyFormat = /** @class */ (function (_super) {
    tslib_1.__extends(RangeWorksheetCellFormatBase_EmptyFormat, _super);
    function RangeWorksheetCellFormatBase_EmptyFormat() {
        return _super.call(this) || this;
    }
    RangeWorksheetCellFormatBase_EmptyFormat.prototype.get__s = function () {
        return null;
    };
    Object.defineProperty(RangeWorksheetCellFormatBase_EmptyFormat.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    RangeWorksheetCellFormatBase_EmptyFormat.prototype._q = function () {
        return this;
    };
    RangeWorksheetCellFormatBase_EmptyFormat.prototype._ak = function (a, b, c) {
        throw new NotSupportedException(0);
    };
    RangeWorksheetCellFormatBase_EmptyFormat.prototype._al = function ($t, a, b, c) {
        throw new NotSupportedException(0);
    };
    RangeWorksheetCellFormatBase_EmptyFormat.$t = markType(RangeWorksheetCellFormatBase_EmptyFormat, 'RangeWorksheetCellFormatBase_EmptyFormat', RangeWorksheetCellFormatBase.$);
    RangeWorksheetCellFormatBase_EmptyFormat._ao = new RangeWorksheetCellFormatBase_EmptyFormat();
    return RangeWorksheetCellFormatBase_EmptyFormat;
}(RangeWorksheetCellFormatBase));
export { RangeWorksheetCellFormatBase_EmptyFormat };
/**
 * Returns and sets formatting information on a range of cells.
 */
var SpreadsheetCellRangeFormat = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellRangeFormat, _super);
    function SpreadsheetCellRangeFormat(a) {
        var _this = _super.call(this) || this;
        _this._g = null;
        _this._j = null;
        CoreUtilities.y(a);
        var b = PropertyChangeListenerList.e(RangeWorksheetCellFormatBase.$, _this._g, a, _this, true);
        _this._g = b.p0;
        return _this;
    }
    /**
     * @hidden
     */
    SpreadsheetCellRangeFormat.prototype.e = function (sender, property, extraInfo) {
        if (sender == this._g) {
            this.a(property);
        }
        _super.prototype.e.call(this, sender, property, extraInfo);
    };
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "alignment", {
        /**
         * Gets or sets the horizontal alignment of the content in a cell.
         * The horizontal alignment of the content in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the [[HorizontalCellAlignment]] enumeration.
         * @see [[verticalAlignment]]
         */
        get: function () {
            return this._g.alignment;
        },
        /**
         * Gets or sets the horizontal alignment of the content in a cell.
         * The horizontal alignment of the content in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the [[HorizontalCellAlignment]] enumeration.
         * @see [[verticalAlignment]]
         */
        set: function (a) {
            this._g.alignment = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "fill", {
        /**
         * Gets or sets the fill of the cell.
         * The fill of the cell.
         * @see [[CellFill]]
         * @see [[CellFillPattern]]
         * @see [[CellFillLinearGradient]]
         * @see [[CellFillRectangularGradient]]
         */
        get: function () {
            return this._g.fill;
        },
        /**
         * Gets or sets the fill of the cell.
         * The fill of the cell.
         * @see [[CellFill]]
         * @see [[CellFillPattern]]
         * @see [[CellFillLinearGradient]]
         * @see [[CellFillRectangularGradient]]
         */
        set: function (a) {
            this._g.fill = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "font", {
        /**
         * Gets or sets the default font formatting.
         * <p class="body">
         * This font formatting is just the default font used in the cell. This can be overridden by strings on a character by character basis by
         * using the [[FormattedString]] class.
         * </p>
         * The default font formatting.
         */
        get: function () {
            return this._j || this._g.font;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "formatString", {
        /**
         * Gets or sets the number format string.
         * <p class="body">For more information on excel format strings, consult Microsoft Excel help.</p>
         * The number format string.
         * @throws [[ArgumentException]] The assigned value is an invalid format string and [[Workbook.validateFormatStrings]] is True.
         * @see [[Workbook.validateFormatStrings]]
         */
        get: function () {
            return this._g.formatString;
        },
        /**
         * Gets or sets the number format string.
         * <p class="body">For more information on excel format strings, consult Microsoft Excel help.</p>
         * The number format string.
         * @throws [[ArgumentException]] The assigned value is an invalid format string and [[Workbook.validateFormatStrings]] is True.
         * @see [[Workbook.validateFormatStrings]]
         */
        set: function (a) {
            this._g.formatString = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "indent", {
        /**
         * Gets or sets the indent in units of average character widths.
         * <p class="body">
         * A value of -1 indicates that the default value should be used.
         * </p>
         * The indent in units of average character widths or -1 to use the default indent.
         * @throws [[ArgumentOutOfRangeException]] The assigned value is not -1 and is outside the valid indent level range of 0 and 250.
         */
        get: function () {
            return this._g.indent;
        },
        /**
         * Gets or sets the indent in units of average character widths.
         * <p class="body">
         * A value of -1 indicates that the default value should be used.
         * </p>
         * The indent in units of average character widths or -1 to use the default indent.
         * @throws [[ArgumentOutOfRangeException]] The assigned value is not -1 and is outside the valid indent level range of 0 and 250.
         */
        set: function (a) {
            this._g.indent = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "locked", {
        /**
         * Gets or sets the valid which indicates whether the cell is locked in protected mode.
         * <p class="body">The Locked valid is used in Excel file only if the associated [[Worksheet]] or [[Workbook]]
         * is protected. Otherwise the value is ignored.
         * </p>
         * The valid which indicates whether the cell is locked in protected mode.
         * @see */
        get: function () {
            return unwrapNullable(this._locked$i);
        },
        /**
         * Gets or sets the valid which indicates whether the cell is locked in protected mode.
         * <p class="body">The Locked valid is used in Excel file only if the associated [[Worksheet]] or [[Workbook]]
         * is protected. Otherwise the value is ignored.
         * </p>
         * The valid which indicates whether the cell is locked in protected mode.
         * @see */
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._locked$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "_locked$i", {
        /**
         * @hidden
         */
        get: function () {
            return this._g._locked$i;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._g._locked$i = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "rotation", {
        /**
         * Gets or sets the rotation of the cell content in degrees.
         * <p class="body">
         * Cell text rotation, in degrees; 0  90 is up 0  90 degrees, 91  180 is down 1  90 degrees, and 255 is vertical.
         * </p>
         * The rotation of the cell content in degrees.
         */
        get: function () {
            return this._g.rotation;
        },
        /**
         * Gets or sets the rotation of the cell content in degrees.
         * <p class="body">
         * Cell text rotation, in degrees; 0  90 is up 0  90 degrees, 91  180 is down 1  90 degrees, and 255 is vertical.
         * </p>
         * The rotation of the cell content in degrees.
         */
        set: function (a) {
            this._g.rotation = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "shrinkToFit", {
        /**
         * Gets or sets the value indicating whether the cell content will shrink to fit the cell.
         * <p class="body">
         * If True, the size of the cell font will shrink so all data fits within the cell.
         * </p>
         * The value indicating whether the cell content will shrink to fit the cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the ExcelDefaultableBoolean enumeration.
         */
        get: function () {
            return unwrapNullable(this._shrinkToFit$i);
        },
        /**
         * Gets or sets the value indicating whether the cell content will shrink to fit the cell.
         * <p class="body">
         * If True, the size of the cell font will shrink so all data fits within the cell.
         * </p>
         * The value indicating whether the cell content will shrink to fit the cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the ExcelDefaultableBoolean enumeration.
         */
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._shrinkToFit$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "_shrinkToFit$i", {
        /**
         * @hidden
         */
        get: function () {
            return this._g._shrinkToFit$i;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._g._shrinkToFit$i = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "style", {
        /**
         * Gets or sets the parent [[WorkbookStyle]] of the format.
         * <p class="body">
         * The parent style of a cell or differential format provides default format values. Depending on which FormatOptions
         * flags are present, only certain groups of format properties will be resolved from parent style. When any of the properties in a
         * group is set to a non-default value, the FormatOptions will automatically have that flag included so the format provides values
         * in that group rather than the style providing values in that group.
         * </p>
         * <p class="body">
         * By default, all cell and differential formats will have a parent style of the normal style, which is exposed by the
         * [[WorkbookStyleCollection.normalStyle]] property. If a value of null is assigned as the Style for a cell or differential
         * format, then NormalStyle will actually be set.
         * </p>
         * A [[WorkbookStyle]] instance if this is a cell or differential format, or null if this is a style format.
         * @throws [[InvalidOperationException]] The value assigned is non-null and the format is a style format.
         * @throws [[ArgumentException]] The value assigned is from a different [[Workbook]].
         * @see [[Workbook.styles]]
         * @see [[WorkbookStyle]]
         */
        get: function () {
            return this._g.style;
        },
        /**
         * Gets or sets the parent [[WorkbookStyle]] of the format.
         * <p class="body">
         * The parent style of a cell or differential format provides default format values. Depending on which FormatOptions
         * flags are present, only certain groups of format properties will be resolved from parent style. When any of the properties in a
         * group is set to a non-default value, the FormatOptions will automatically have that flag included so the format provides values
         * in that group rather than the style providing values in that group.
         * </p>
         * <p class="body">
         * By default, all cell and differential formats will have a parent style of the normal style, which is exposed by the
         * [[WorkbookStyleCollection.normalStyle]] property. If a value of null is assigned as the Style for a cell or differential
         * format, then NormalStyle will actually be set.
         * </p>
         * A [[WorkbookStyle]] instance if this is a cell or differential format, or null if this is a style format.
         * @throws [[InvalidOperationException]] The value assigned is non-null and the format is a style format.
         * @throws [[ArgumentException]] The value assigned is from a different [[Workbook]].
         * @see [[Workbook.styles]]
         * @see [[WorkbookStyle]]
         */
        set: function (a) {
            this._g.style = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "verticalAlignment", {
        /**
         * Gets or sets the vertical alignment of the content in a cell.
         * The vertical alignment of the content in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the [[VerticalCellAlignment]] enumeration.
         * @see [[alignment]]
         */
        get: function () {
            return this._g.verticalAlignment;
        },
        /**
         * Gets or sets the vertical alignment of the content in a cell.
         * The vertical alignment of the content in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the [[VerticalCellAlignment]] enumeration.
         * @see [[alignment]]
         */
        set: function (a) {
            this._g.verticalAlignment = a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "wrapText", {
        /**
         * Gets or sets the value which indicates whether text will wrap in a cell.
         * <p class="body">
         * If True, and the row associated with the cell has a default [[WorksheetRow.height]], the row's
         * height will automatically be increased to fit wrapped content.
         * </p>
         * The value which indicates whether text will wrap in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the ExcelDefaultableBoolean enumeration.
         */
        get: function () {
            return unwrapNullable(this._wrapText$i);
        },
        /**
         * Gets or sets the value which indicates whether text will wrap in a cell.
         * <p class="body">
         * If True, and the row associated with the cell has a default [[WorksheetRow.height]], the row's
         * height will automatically be increased to fit wrapped content.
         * </p>
         * The value which indicates whether text will wrap in a cell.
         * @throws [[InvalidEnumArgumentException]] The value assigned is not defined in the ExcelDefaultableBoolean enumeration.
         */
        set: function (a) {
            arguments[0] = wrapNullable(Boolean_$type, arguments[0]);
            this._wrapText$i = arguments[0];
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellRangeFormat.prototype, "_wrapText$i", {
        /**
         * @hidden
         */
        get: function () {
            return this._g._wrapText$i;
        },
        /**
         * @hidden
         */
        set: function (a) {
            this._g._wrapText$i = a;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Sets the specified borders for the associated range to the specified style and color.
     * @param borders Identifies the borders to be changed
     * @param borderColor The color for the borders
     * @param borderStyle The style for the borders
     */
    SpreadsheetCellRangeFormat.prototype.setBorders = function (borders, borderColor, borderStyle) {
        this._g._ak(borders, borderColor, borderStyle);
    };
    /**
     * @hidden
     */
    SpreadsheetCellRangeFormat.prototype._u = function (a) {
        if (a != this._j) {
            this._j = a;
            this.a("Font");
        }
    };
    SpreadsheetCellRangeFormat.$t = markType(SpreadsheetCellRangeFormat, 'SpreadsheetCellRangeFormat', PropertyChangeNotifierExtended.$);
    return SpreadsheetCellRangeFormat;
}(PropertyChangeNotifierExtended));
export { SpreadsheetCellRangeFormat };
/**
 * @hidden
 */
var SpreadsheetHeaderBackgroundLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderBackgroundLayer, _super);
    function SpreadsheetHeaderBackgroundLayer(a, b) {
        var _this = _super.call(this, SpreadsheetScrollRegion.$, a, b, PredefinedSpreadsheetLayers.m) || this;
        _this._t = null;
        _this._t = new SpreadsheetHeaderBackgroundObserver(a, runOn(_this, _this._o));
        return _this;
    }
    SpreadsheetHeaderBackgroundLayer.prototype.get__m = function () {
        return 0;
    };
    Object.defineProperty(SpreadsheetHeaderBackgroundLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderBackgroundLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        this._t.dispose();
    };
    SpreadsheetHeaderBackgroundLayer.prototype._q = function (a, b, c, d) {
        SpreadsheetRenderUtilities.b(this._j, a, b, c, d);
    };
    SpreadsheetHeaderBackgroundLayer.prototype.get__s = function () {
        return this._j._o.renderCache;
    };
    Object.defineProperty(SpreadsheetHeaderBackgroundLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderBackgroundLayer.$t = markType(SpreadsheetHeaderBackgroundLayer, 'SpreadsheetHeaderBackgroundLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetHeaderBackgroundLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetHeaderBackgroundLayer };
/**
 * @hidden
 */
var SpreadsheetItemLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetItemLayerObserver, _super);
    function SpreadsheetItemLayerObserver() {
        var _this = _super.call(this) || this;
        _this._a = null;
        _this._a = new PropertyChangeListener$1(SpreadsheetItemLayerObserver.$, _this, SpreadsheetItemLayerObserver._c, false);
        return _this;
    }
    SpreadsheetItemLayerObserver.prototype._b = function (a) {
        SpreadsheetUtilities.d6(a, this._a, true);
    };
    SpreadsheetItemLayerObserver._c = function (a, b, c, d) {
        a._d(b, c, d);
    };
    SpreadsheetItemLayerObserver.prototype._e = function (a) {
        SpreadsheetUtilities.ec(a, this._a);
    };
    SpreadsheetItemLayerObserver.$t = markType(SpreadsheetItemLayerObserver, 'SpreadsheetItemLayerObserver', Base.$, [IDisposable_$type]);
    return SpreadsheetItemLayerObserver;
}(Base));
export { SpreadsheetItemLayerObserver };
/**
 * @hidden
 */
var SpreadsheetScrollRegionLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetScrollRegionLayerObserver, _super);
    function SpreadsheetScrollRegionLayerObserver(a) {
        var _this = _super.call(this) || this;
        _this._f = null;
        _this._f = a;
        return _this;
    }
    SpreadsheetScrollRegionLayerObserver.$t = markType(SpreadsheetScrollRegionLayerObserver, 'SpreadsheetScrollRegionLayerObserver', SpreadsheetItemLayerObserver.$);
    return SpreadsheetScrollRegionLayerObserver;
}(SpreadsheetItemLayerObserver));
export { SpreadsheetScrollRegionLayerObserver };
/**
 * @hidden
 */
var SpreadsheetHeaderBackgroundObserver = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderBackgroundObserver, _super);
    function SpreadsheetHeaderBackgroundObserver(a, b) {
        var _this = _super.call(this, a) || this;
        _this._g = null;
        _this._b(a);
        _this._g = b;
        return _this;
    }
    SpreadsheetHeaderBackgroundObserver.prototype.dispose = function () {
        this._e(this._f);
    };
    SpreadsheetHeaderBackgroundObserver.prototype._d = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._f._x) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._f._l) {
                    d = true;
                }
                else if (this._f._ay(a)) {
                    d = true;
                }
                break;
            case "ActiveSelection":
            case "HotTrackedIndex":
            case "ActualItemPositions":
            case "SelectionMode":
            case "ResourceProvider":
                if (a == this._f) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._f._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._g();
        }
    };
    SpreadsheetHeaderBackgroundObserver._h = function (a, b, c, d) {
        a._d(b, c, d);
    };
    SpreadsheetHeaderBackgroundObserver.$t = markType(SpreadsheetHeaderBackgroundObserver, 'SpreadsheetHeaderBackgroundObserver', SpreadsheetScrollRegionLayerObserver.$);
    return SpreadsheetHeaderBackgroundObserver;
}(SpreadsheetScrollRegionLayerObserver));
export { SpreadsheetHeaderBackgroundObserver };
/**
 * @hidden
 */
var SpreadsheetHeaderGridlineLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderGridlineLayer, _super);
    function SpreadsheetHeaderGridlineLayer(a, b) {
        var _this = _super.call(this, SpreadsheetScrollRegion.$, a, b, PredefinedSpreadsheetLayers.p) || this;
        _this._t = null;
        _this._t = new PropertyChangeListener$1(SpreadsheetHeaderGridlineLayer.$, _this, SpreadsheetHeaderGridlineLayer._u, false);
        SpreadsheetUtilities.d6(a, _this._t, true);
        return _this;
    }
    SpreadsheetHeaderGridlineLayer.prototype.get__m = function () {
        return 1;
    };
    Object.defineProperty(SpreadsheetHeaderGridlineLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderGridlineLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._t);
        }
    };
    SpreadsheetHeaderGridlineLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._i(true, true);
        var g = f.length;
        var h = e._aw;
        var i = e._ad;
        var j = e._o.renderCache;
        var k = e._br;
        var l = 6;
        var m = h ? 19 : 33;
        var n = h ? 21 : 35;
        var o = h ? 20 : 34;
        var p = h ? 22 : 36;
        var q = e._co;
        var r = SpreadsheetUtilities.b8(6, e._br);
        if (g > 0) {
            var s = r / 2;
            var t = !e._aw;
            var u = e._ar();
            var v = e._l;
            var w = v.count;
            var x = d.x;
            var y = d.y;
            var z = b.d;
            var aa = z * 2;
            var ab = new Array(g);
            var ac = 0;
            for (var ad = 0; ad < g - 1; ad++) {
                var ae = e._t(v._inner[ad]._j);
                var af = ae < ac ? ac : ae;
                var ag = void 0;
                switch (af) {
                    default:
                    case 0:
                        ag = m;
                        break;
                    case 1:
                        ag = n;
                        break;
                    case 2:
                        ag = o;
                        break;
                    case 3:
                    case 4:
                        ag = p;
                        break;
                }
                ab[ad] = ag;
                ac = ae;
            }
            if (g > 0) {
                ab[g - 1] = ab[g - 2];
            }
            if (t) {
                var ah = s - x;
                var ai = -y;
                var aj = c.y - ai;
                var ak = b.h(c.bottom - s) - ai;
                var al = 1;
                for (var am = 0; am < g; am++) {
                    var an = void 0;
                    if ((am < w && e._av(am, true)) || am == w && e._au(am - 1, true)) {
                        an = b.h(c.x + al + f[am] - aa) - ah;
                        a.drawLine(l, ab[am], k, an, aj, an, ak);
                        an = b.h(c.x + al + f[am] + aa) - ah;
                    }
                    else {
                        an = b.h(c.x + al + f[am]) - ah;
                    }
                    a.drawLine(l, ab[am], k, an, aj, an, ak);
                }
                var ao = b.h(c.bottom) - (s - y);
                a.drawLine(l, m, k, b.h(c.x) - (s - x), ao, b.h(c.x + f[g - 1]) - x + s, ao);
            }
            else {
                var ap = -x;
                var aq = s - y;
                var ar = c.x - ap;
                var as = b.h(c.right - s) - ap;
                var at = 1;
                for (var au = 0; au < g; au++) {
                    var av = void 0;
                    if ((au < w && e._av(au, true)) || au == w && e._au(au - 1, true)) {
                        av = b.h(c.y + at + f[au] - aa) - aq;
                        a.drawLine(l, ab[au], k, ar, av, as, av);
                        av = b.h(c.y + at + f[au] + aa) - aq;
                    }
                    else {
                        av = b.h(c.y + at + f[au]) - aq;
                    }
                    a.drawLine(l, ab[au], k, ar, av, as, av);
                }
                var aw = b.g(c.right) - (s - x);
                a.drawLine(l, m, k, aw, b.h(c.y) - (s - y), aw, b.h(c.y + f[g - 1]) - y + s);
            }
        }
    };
    SpreadsheetHeaderGridlineLayer.prototype.get__s = function () {
        return this._j._o.renderCache;
    };
    Object.defineProperty(SpreadsheetHeaderGridlineLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderGridlineLayer.prototype._v = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._j._l) {
                    d = true;
                }
                else if (this._j._ay(a)) {
                    d = true;
                }
                break;
            case "Offset":
                if (a == this._j._x) {
                    d = true;
                }
                break;
            case "PreviousVisibleItemIndex":
            case "NextVisibleItemIndex":
            case "HotTrackedIndex":
            case "ActualItemPositions":
            case "SelectionMode":
            case "ResourceProvider":
                if (a == this._j) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._j._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetHeaderGridlineLayer._u = function (a, b, c, d) {
        a._v(b, c, d);
    };
    SpreadsheetHeaderGridlineLayer.$t = markType(SpreadsheetHeaderGridlineLayer, 'SpreadsheetHeaderGridlineLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetHeaderGridlineLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetHeaderGridlineLayer };
/**
 * @hidden
 */
var SpreadsheetHeaderSelectionLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderSelectionLayer, _super);
    function SpreadsheetHeaderSelectionLayer(a, b) {
        var _this = _super.call(this, SpreadsheetScrollRegion.$, a, b, PredefinedSpreadsheetLayers.s) || this;
        _this._u = null;
        _this._t = null;
        _this._v = false;
        _this._u = new PropertyChangeListener$1(SpreadsheetHeaderSelectionLayer.$, _this, SpreadsheetHeaderSelectionLayer._x, false);
        SpreadsheetUtilities.d6(a, _this._u, true);
        return _this;
    }
    SpreadsheetHeaderSelectionLayer.prototype._r = function (a) {
        var b = !this._j._aw;
        var c = this._j._br;
        var d = this._j._bs;
        if (!b) {
            a.width += c;
        }
        else {
            a.height += d;
        }
        return a;
    };
    SpreadsheetHeaderSelectionLayer.prototype.get__m = function () {
        return 0;
    };
    Object.defineProperty(SpreadsheetHeaderSelectionLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._u);
        }
    };
    SpreadsheetHeaderSelectionLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        if (e._ar() && e._ai != 2) {
            var f = e._bx;
            var g = 4;
            var h = b.d;
            var i = -d.x;
            var j = -d.y;
            var k = e._aw;
            var l = c.x;
            var m = c.y;
            var n = c.right - h / 2;
            var o = c.bottom - h / 2;
            var p = e._l;
            var q = e._ab.cellRanges;
            var r = q.count == 1;
            var s = 1;
            if (k) {
                m += s;
            }
            else {
                l += s;
            }
            l = b.h(l) - i;
            m = b.h(m) - j;
            n = b.h(n) - i;
            o = b.h(o) - j;
            if (k) {
                l = n - h * 2;
            }
            else {
                m = o - h * 2;
            }
            var t = false;
            if (r) {
                var u = Enumerable.ad(SpreadsheetCellRange.$, q);
                var v = e._z;
                if (v != null) {
                    if (k) {
                        if (v.startIndex > u.firstColumn && v.startIndex <= u.lastColumn) {
                            t = true;
                        }
                        else {
                            m = e._bn(u.firstRow, true) * f + c.y + s;
                            o = e._bn(u.lastRow, false) * f + c.y + s;
                            var w = 100;
                            if (m < -w) {
                                m = -w;
                            }
                            if (o > c.bottom + w) {
                                o = c.bottom + w;
                            }
                            m = b.h(m) - j;
                            o = b.h(o) - j;
                            m -= h;
                            if (v.startIndex == u.firstColumn) {
                                m -= h;
                                o += h;
                            }
                        }
                    }
                    else {
                        if (v.startIndex > u.firstRow && v.startIndex <= u.lastRow) {
                            t = true;
                        }
                        else {
                            l = e._bn(u.firstColumn, true) * f + c.x + s;
                            n = e._bn(u.lastColumn, false) * f + c.x + s;
                            l = b.h(l) - i;
                            n = b.h(n) - i;
                            l -= h;
                            if (v.startIndex == u.firstRow) {
                                l -= h;
                                n += h;
                            }
                        }
                    }
                    if (!t) {
                        t = true;
                        a.fillRectangle1(g, l, m, Math.max(n - l, 0), Math.max(o - m, 0));
                    }
                }
            }
            if (!t) {
                var x = e._i(true);
                var y = x.length - 1;
                for (var z = 0; z < y; z++) {
                    if (!e._as(p._inner[z]._j)) {
                        continue;
                    }
                    var aa = z == 0 || !e._as(p._inner[z - 1]._j);
                    var ab = x[z];
                    var ac = x[z + 1];
                    if (k) {
                        ab += c.y + s;
                        ac += c.y + s;
                        m = b.h(ab) - j;
                        o = b.h(ac) - j;
                        if (aa) {
                            m -= h;
                        }
                    }
                    else {
                        ab += c.x + s;
                        ac += c.x + s;
                        l = b.h(ab) - i;
                        n = b.h(ac) - i;
                        if (aa) {
                            l -= h;
                        }
                    }
                    a.fillRectangle1(g, l, m, Math.max(n - l, 0), Math.max(o - m, 0));
                }
            }
            this._w = r;
        }
        else {
            this._w = false;
        }
    };
    SpreadsheetHeaderSelectionLayer.prototype.get__s = function () {
        return this._j._o.renderCache;
    };
    Object.defineProperty(SpreadsheetHeaderSelectionLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetHeaderSelectionLayer.prototype, "_w", {
        get: function () {
            return this._v;
        },
        set: function (a) {
            if (a != this._v) {
                this._v = a;
                if (a) {
                    var b = PropertyChangeListenerList.e(SpreadsheetScrollRegion.$, this._t, this._j._z, this._u, true);
                    this._t = b.p0;
                }
                else {
                    var c = PropertyChangeListenerList.e(SpreadsheetScrollRegion.$, this._t, null, this._u, true);
                    this._t = c.p0;
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionLayer.prototype._y = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j._x || (this._j._z != null && a == this._j._z._x)) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._j._l) {
                    d = true;
                }
                else if (this._j._ay(a)) {
                    d = true;
                }
                break;
            case "AdjacentRowColumn":
                if (this._v && a == this._j) {
                    var e = PropertyChangeListenerList.e(SpreadsheetScrollRegion.$, this._t, this._j._z, this._u, true);
                    this._t = e.p0;
                    d = true;
                }
                break;
            case "ActiveSelection":
            case "SelectionMode":
            case "ResourceProvider":
                if (a == this._j) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._j._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetHeaderSelectionLayer._x = function (a, b, c, d) {
        a._y(b, c, d);
    };
    SpreadsheetHeaderSelectionLayer.$t = markType(SpreadsheetHeaderSelectionLayer, 'SpreadsheetHeaderSelectionLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetHeaderSelectionLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetHeaderSelectionLayer };
/**
 * @hidden
 */
var SpreadsheetPaneLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneLayerObserver, _super);
    function SpreadsheetPaneLayerObserver(a) {
        var _this = _super.call(this) || this;
        _this._f = null;
        _this._f = a;
        return _this;
    }
    SpreadsheetPaneLayerObserver.$t = markType(SpreadsheetPaneLayerObserver, 'SpreadsheetPaneLayerObserver', SpreadsheetItemLayerObserver.$);
    return SpreadsheetPaneLayerObserver;
}(SpreadsheetItemLayerObserver));
export { SpreadsheetPaneLayerObserver };
/**
 * @hidden
 */
var InvalidDataLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(InvalidDataLayerObserver, _super);
    function InvalidDataLayerObserver(a, b) {
        var _this = _super.call(this, a) || this;
        _this._g = null;
        _this._g = b;
        _this._b(a.columnScrollRegion._x);
        _this._b(a.rowScrollRegion._x);
        _this._b(a);
        return _this;
    }
    InvalidDataLayerObserver.prototype._d = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._f.rowScrollRegion._x || a == this._f.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "InvalidCellArray":
                if (a == this._f) {
                    d = true;
                }
                break;
            case "ResourceProvider":
                if (a == this._f.rowScrollRegion || a == this._f.columnScrollRegion) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._f.rowScrollRegion._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._g();
        }
    };
    InvalidDataLayerObserver.prototype.dispose = function () {
        this._e(this._f.columnScrollRegion._x);
        this._e(this._f.rowScrollRegion._x);
        this._e(this._f);
    };
    InvalidDataLayerObserver.$t = markType(InvalidDataLayerObserver, 'InvalidDataLayerObserver', SpreadsheetPaneLayerObserver.$);
    return InvalidDataLayerObserver;
}(SpreadsheetPaneLayerObserver));
export { InvalidDataLayerObserver };
/**
 * @hidden
 */
var PaneInteractionLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(PaneInteractionLayerObserver, _super);
    function PaneInteractionLayerObserver(a, b) {
        var _this = _super.call(this, a) || this;
        _this._g = null;
        _this._h = false;
        _this._g = b;
        _this._b(a.columnScrollRegion);
        _this._b(a.rowScrollRegion);
        _this._b(a);
        return _this;
    }
    PaneInteractionLayerObserver.prototype._d = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (this._h) {
                    if (a == this._f.rowScrollRegion._x || a == this._f.columnScrollRegion._x) {
                        d = true;
                    }
                }
                break;
            case "ItemBeingResized":
            case "ItemBeingResizedRelativeEdge":
                if (a == this._f.rowScrollRegion || a == this._f.columnScrollRegion) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._g();
        }
    };
    PaneInteractionLayerObserver.prototype.dispose = function () {
        this._e(this._f.columnScrollRegion);
        this._e(this._f.rowScrollRegion);
        this._e(this._f);
    };
    PaneInteractionLayerObserver.$t = markType(PaneInteractionLayerObserver, 'PaneInteractionLayerObserver', SpreadsheetPaneLayerObserver.$);
    return PaneInteractionLayerObserver;
}(SpreadsheetPaneLayerObserver));
export { PaneInteractionLayerObserver };
/**
 * @hidden
 */
var ShapeLayerObserver = /** @class */ (function (_super) {
    tslib_1.__extends(ShapeLayerObserver, _super);
    function ShapeLayerObserver(a, b) {
        var _this = _super.call(this, a) || this;
        _this._g = null;
        _this._g = b;
        _this._b(a);
        _this._b(a.columnScrollRegion._x);
        _this._b(a.rowScrollRegion._x);
        return _this;
    }
    ShapeLayerObserver.prototype.dispose = function () {
        this._e(this._f);
        this._e(this._f.columnScrollRegion._x);
        this._e(this._f.rowScrollRegion._x);
    };
    ShapeLayerObserver.prototype._d = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._f.rowScrollRegion._x || a == this._f.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._f._r) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._g();
        }
    };
    ShapeLayerObserver.$t = markType(ShapeLayerObserver, 'ShapeLayerObserver', SpreadsheetPaneLayerObserver.$);
    return ShapeLayerObserver;
}(SpreadsheetPaneLayerObserver));
export { ShapeLayerObserver };
/**
 * @hidden
 */
var SpreadsheetPaneButtonLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneButtonLayer, _super);
    function SpreadsheetPaneButtonLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.l) || this;
        _this._t = null;
        _this._t = new PropertyChangeListener$1(SpreadsheetPaneButtonLayer.$, _this, SpreadsheetPaneButtonLayer._y, false);
        SpreadsheetUtilities.d6(a, _this._t, true);
        SpreadsheetUtilities.d6(a.columnScrollRegion, _this._t, true);
        SpreadsheetUtilities.d6(a.rowScrollRegion, _this._t, true);
        return _this;
    }
    SpreadsheetPaneButtonLayer.prototype.get__m = function () {
        return 2;
    };
    Object.defineProperty(SpreadsheetPaneButtonLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneButtonLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._t);
            SpreadsheetUtilities.ec(this._j.columnScrollRegion, this._t);
            SpreadsheetUtilities.ec(this._j.rowScrollRegion, this._t);
        }
    };
    SpreadsheetPaneButtonLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneButtonLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneButtonLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._q;
        if (f.count > 0) {
            var g = e.columnScrollRegion;
            var h = e.rowScrollRegion;
            var i = h._bx;
            var j = e.visibleRange;
            var k = g._ad;
            var l = SpreadsheetUtilities.b8(6, g._br);
            var m = l / 2;
            var n = b.d;
            var o = -d.x;
            var p = -d.y;
            var q = SpreadsheetPaneButtonLayer._v(b);
            var r = SpreadsheetPaneButtonLayer._u(b);
            for (var s = 0; s < f.count; s++) {
                var t = f._inner[s];
                var u = SpreadsheetPaneButtonLayer._x(e, t, l, g, h, q, r);
                if (u > 0) {
                    var v = t.g;
                    var w = b.h(v.x + c.x) - o;
                    var x = b.h(v.x + c.x + v.width) - o;
                    var y = b.h(v.y + c.y) - p;
                    var z = b.h(v.y + c.y + v.height) - p;
                    var aa = x - w;
                    var ab = z - y;
                    var ac = (t.a & 2) == 0;
                    a.drawRectangle(6, ac ? 65 : 68, g._br, w + m, y + m, Math.max(aa - l, 0), Math.max(ab - l, 0));
                    w += n;
                    y += n;
                    aa = Math.max(0, aa - n * 2);
                    ab = Math.max(0, ab - n * 2);
                    if (aa > 0 && ab > 0) {
                        a.fillRectangle1(ac ? 66 : 69, w, y, aa, ab);
                        a.drawDropDownGlyph(t.a, w, y, aa, ab);
                    }
                }
            }
        }
    };
    SpreadsheetPaneButtonLayer._u = function (a) {
        return a.d * 2;
    };
    SpreadsheetPaneButtonLayer._v = function (a) {
        return a.d;
    };
    SpreadsheetPaneButtonLayer.prototype._z = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j.rowScrollRegion._x || a == this._j.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._j.rowScrollRegion._l) {
                    d = true;
                }
                else if (a == this._j.columnScrollRegion._l) {
                    d = true;
                }
                else if (getInstanceType(a) == SpreadsheetUtilities.d4) {
                    d = true;
                }
                break;
            case "ActualItemPositions":
                if (a == this._j.rowScrollRegion) {
                    d = true;
                }
                else if (a == this._j.columnScrollRegion) {
                    d = true;
                }
                break;
            case "ResourceProvider":
                if (this._j.rowScrollRegion == a) {
                    d = true;
                }
                break;
            case "ActiveCellAsRange":
                if (a == this._j.rowScrollRegion._ab) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._j.rowScrollRegion._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetPaneButtonLayer._y = function (a, b, c, d) {
        a._z(b, c, d);
    };
    SpreadsheetPaneButtonLayer._w = function (a, b, c) {
        var d = a.columnScrollRegion;
        var e = a.rowScrollRegion;
        var f = SpreadsheetUtilities.b8(6, d._br);
        return SpreadsheetPaneButtonLayer._x(a, b, f, d, e, SpreadsheetPaneButtonLayer._v(c), SpreadsheetPaneButtonLayer._u(c));
    };
    SpreadsheetPaneButtonLayer._x = function (a, b, c, d, e, f, g) {
        var h = d._bx;
        var i = a.selection._t(new SpreadsheetCell(b.d, b.c));
        var j = d._bn(i.firstColumn, true) * h;
        var k = d._bn(i.lastColumn, false) * h;
        var l = e._bn(i.firstRow, true) * h;
        var m = e._bn(i.firstRow, false) * h;
        var n = Math.max(0, Math.min(17, (m - l) - g));
        var o;
        switch (b.b) {
            default:
            case 2:
            case 3:
                o = new Rect(0, k + c, m - n, n, n);
                break;
            case 4:
            case 1:
            case 0:
                n = Math.max(0, Math.min(n, (k - j) - f));
                o = new Rect(0, k - n - f, m - n - g, n, n);
                break;
        }
        b.g = new Rect(0, o.x, o.y, o.width, o.height);
        return n;
    };
    SpreadsheetPaneButtonLayer.$t = markType(SpreadsheetPaneButtonLayer, 'SpreadsheetPaneButtonLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneButtonLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneButtonLayer };
/**
 * @hidden
 */
var SpreadsheetPaneCellBackgroundLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellBackgroundLayer, _super);
    function SpreadsheetPaneCellBackgroundLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.m) || this;
        _this._u = null;
        _this._u = new PropertyChangeListener$1(SpreadsheetPaneCellBackgroundLayer.$, _this, SpreadsheetPaneCellBackgroundLayer._v, false);
        SpreadsheetUtilities.d6(a, _this._u, true);
        SpreadsheetUtilities.d6(a.columnScrollRegion._x, _this._u, true);
        SpreadsheetUtilities.d6(a.rowScrollRegion._x, _this._u, true);
        return _this;
    }
    SpreadsheetPaneCellBackgroundLayer.prototype.get__m = function () {
        return 0;
    };
    Object.defineProperty(SpreadsheetPaneCellBackgroundLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellBackgroundLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._u);
            SpreadsheetUtilities.ec(this._j.columnScrollRegion._x, this._u);
            SpreadsheetUtilities.ec(this._j.rowScrollRegion._x, this._u);
        }
    };
    SpreadsheetPaneCellBackgroundLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneCellBackgroundLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellBackgroundLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._w;
        var g = e._k;
        var h = e.columnScrollRegion;
        var i = e.rowScrollRegion;
        var j = i._i(true);
        var k = h._i(true);
        var l = j.length - 1;
        var m = k.length - 1;
        var n = i._bx;
        if (l > 0 && m > 0 && g != null) {
            var o = b.d;
            var p = o / 2;
            var q = -d.x;
            var r = -d.y;
            var s = i._br;
            for (var t = 1; t <= l; t++) {
                var u = g.d(t);
                for (var v = 1; v <= m; v++) {
                    var w = f.item(t, v);
                    var x = w.f;
                    var y = w.g;
                    if (x != null || y != null) {
                        var z = void 0, aa = void 0, ab = void 0, ac = void 0;
                        var ad = void 0, ae = void 0, af = void 0, ag = void 0;
                        var ah = u ? g.item(t, v) : null;
                        if (ah != null && ah.r) {
                            if (t > 1 && g.item(t - 1, v) == ah) {
                                continue;
                            }
                            if (v > 1 && g.item(t, v - 1) == ah) {
                                continue;
                            }
                            z = h._bn(ah.ab, true) * n + c.x;
                            aa = h._bn(ah.x, false) * n + c.x;
                            ab = i._bn(ah.ak, true) * n + c.y;
                            ac = i._bn(ah.ag, false) * n + c.y;
                        }
                        else {
                            z = k[v - 1] + c.x;
                            aa = k[v] + c.x;
                            ab = j[t - 1] + c.y;
                            ac = j[t] + c.y;
                        }
                        ad = z;
                        ae = aa;
                        af = ab;
                        ag = ac;
                        z = b.h(z) - q;
                        aa = b.h(aa) - q;
                        ab = b.h(ab) - r;
                        ac = b.h(ac) - r;
                        z -= o;
                        ab -= o;
                        if (ah == null || !ah.r) {
                            if (t != l - 1 && f.item(t + 1, v).f != null) {
                                ac -= o;
                            }
                            if (v != m - 1 && f.item(t, v + 1).f != null) {
                                aa -= o;
                            }
                        }
                        if (x != null) {
                            a.fillRectangle3(x, z, ab, Math.max(aa - z, 0), Math.max(ac - ab, 0));
                        }
                        if (y != null) {
                            z = ad;
                            aa = ae;
                            ab = af;
                            ac = ag;
                            z += o * 2;
                            aa -= o * 2;
                            if (z < aa) {
                                var ai = WorkbookColorInfo.l_op_Inequality(y.axisColor, null);
                                var aj = 0;
                                var ak = y.direction == -5004;
                                if (ai) {
                                    var al = ((aa - z) * y.axisPosition);
                                    aj = b.h(ak ? aa - al : z + al) - q;
                                    a.drawLine1(5, y.axisColor, s, aj - p, b.h(ab) - r, aj - p, b.h(ac) - r);
                                }
                                ab += o * 1;
                                ac -= o * 3;
                                if (ab < ac) {
                                    ab = b.h(ab) - r;
                                    ac = b.h(ac) - r;
                                    var am = ai && y.barPositionTo > y.barPositionFrom;
                                    var an = void 0, ao = void 0;
                                    if (ak) {
                                        an = am && y.barPositionTo == y.axisPosition ? aj + o : b.h(aa - ((aa - z) * y.barPositionTo)) - q;
                                        ao = am && y.barPositionFrom == y.axisPosition ? aj - o : b.h(aa - ((aa - z) * y.barPositionFrom)) - q;
                                    }
                                    else {
                                        an = am && y.barPositionFrom == y.axisPosition ? aj + o : b.h(z + ((aa - z) * y.barPositionFrom)) - q;
                                        ao = am && y.barPositionTo == y.axisPosition ? aj - o : b.h(z + ((aa - z) * y.barPositionTo)) - q;
                                    }
                                    if (ao - an >= o) {
                                        if (WorkbookColorInfo.l_op_Inequality(y.barColor, null)) {
                                            var ap = void 0, aq = void 0;
                                            if (y.barFillType == 1) {
                                                if (ak) {
                                                    aq = am && y.barPositionFrom == y.axisPosition ? SpreadsheetPaneCellBackgroundLayer._t : y.barColor;
                                                    ap = am && y.barPositionFrom == y.axisPosition ? y.barColor : SpreadsheetPaneCellBackgroundLayer._t;
                                                }
                                                else {
                                                    ap = am && y.barPositionTo == y.axisPosition ? SpreadsheetPaneCellBackgroundLayer._t : y.barColor;
                                                    aq = am && y.barPositionTo == y.axisPosition ? y.barColor : SpreadsheetPaneCellBackgroundLayer._t;
                                                }
                                            }
                                            else {
                                                ap = aq = y.barColor;
                                            }
                                            a.fillRectangle4(ap, aq, true, an, ab, ao - an, ac - ab);
                                        }
                                        if (WorkbookColorInfo.l_op_Inequality(y.barBorder, null)) {
                                            a.drawRectangle1(6, y.barBorder, s, an - p, ab + p, ao - an, ac - ab - o);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    };
    SpreadsheetPaneCellBackgroundLayer.prototype._w = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j.rowScrollRegion._x || a == this._j.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "CellFillArray":
                if (a == this._j) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetPaneCellBackgroundLayer._v = function (a, b, c, d) {
        a._w(b, c, d);
    };
    SpreadsheetPaneCellBackgroundLayer.$t = markType(SpreadsheetPaneCellBackgroundLayer, 'SpreadsheetPaneCellBackgroundLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    SpreadsheetPaneCellBackgroundLayer._t = new WorkbookColorInfo(Color.u(255, 255, 255, 255));
    return SpreadsheetPaneCellBackgroundLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneCellBackgroundLayer };
/**
 * @hidden
 */
var SpreadsheetPaneCellBorderLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneCellBorderLayer, _super);
    function SpreadsheetPaneCellBorderLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.n) || this;
        _this._t = null;
        _this._t = new PropertyChangeListener$1(SpreadsheetPaneCellBorderLayer.$, _this, SpreadsheetPaneCellBorderLayer._u, false);
        SpreadsheetUtilities.d6(a, _this._t, true);
        SpreadsheetUtilities.d6(a.columnScrollRegion._x, _this._t, true);
        SpreadsheetUtilities.d6(a.rowScrollRegion._x, _this._t, true);
        return _this;
    }
    SpreadsheetPaneCellBorderLayer.prototype.get__m = function () {
        return 1;
    };
    Object.defineProperty(SpreadsheetPaneCellBorderLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellBorderLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._t);
            SpreadsheetUtilities.ec(this._j.columnScrollRegion._x, this._t);
            SpreadsheetUtilities.ec(this._j.rowScrollRegion._x, this._t);
        }
    };
    SpreadsheetPaneCellBorderLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneCellBorderLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneCellBorderLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._w;
        var g = e._k;
        var h = e.columnScrollRegion;
        var i = e.rowScrollRegion;
        var j = i._i(true);
        var k = h._i(true);
        var l = j.length - 1;
        var m = k.length - 1;
        var n = i._bx;
        var o = h._br;
        var p = i._bs;
        if (l > 0 && m > 0) {
            var q = b.d;
            var r = a.getFarPixelAdjustment(b);
            var s = q * 2;
            var t = q * 3;
            var u = q * 4;
            var v = -d.x;
            var w = -d.y;
            var x = PointUtil.create();
            var y = PointUtil.create();
            var z = h._br;
            var aa = h._bs;
            var ab = c.y;
            var ac = c.x;
            var ad = l + 1;
            var ae = m + 1;
            var af = false;
            var ag = SpreadsheetUtilities.b8(6, p);
            for (var ah = 1; ah <= ad; ah++) {
                var ai = b.h(j[ah - 1] + ab);
                var aj = ah <= l ? b.h(j[ah] + ab) : ai;
                for (var ak = 1; ak <= ae; ak++) {
                    var al = b.h(k[ak - 1] + ac);
                    var am = f.item(ah, ak);
                    if (am.a != 0) {
                        af = true;
                    }
                    if (am.e != 0 && ak <= m) {
                        var an = b.h(k[ak] + ac);
                        switch (am.e) {
                            case 6:
                                {
                                    var ao = f.item(ah - 1, ak);
                                    var ap = am.n;
                                    var aq = ag / 2;
                                    x.x = al - v + am.i * q;
                                    y.x = an - r - v - am.j * q;
                                    y.y = x.y = ai - (q + aq + w);
                                    var ar = f.item(ah, ak - 1).e == 6;
                                    var as = ao.d == 6;
                                    var at = am.d == 6;
                                    var au = f.item(ah, ak + 1).e == 6;
                                    var av = f.item(ah - 1, ak + 1).d == 6;
                                    var aw = f.item(ah, ak + 1).d == 6;
                                    if (as) {
                                        x.x -= q;
                                    }
                                    else if (at) {
                                        x.x -= t;
                                    }
                                    if (av) {
                                        y.x -= s;
                                    }
                                    if (ao.c == 6) {
                                        var ax = g.item(ah - 1, ak - 1) != g.item(ah - 1, ak) || g.item(ah - 1, ak - 1) == null || g.item(ah - 1, ak) == null;
                                        if (ax && (ao.a & 2) != 0) {
                                            x.x = Math.max(x.x, al - v + u);
                                        }
                                        var ay = g.item(ah - 1, ak + 1) != g.item(ah - 1, ak) || g.item(ah - 1, ak + 1) == null || g.item(ah - 1, ak) == null;
                                        if (ay && (ao.a & 1) != 0) {
                                            y.x = Math.min(y.x, an - v - u);
                                        }
                                    }
                                    a._drawLine2$i(6, ap, p, x.x, x.y, y.x, y.y);
                                    x.x = al - v + am.i * q;
                                    y.x = an - r - v - am.j * q;
                                    x.y += s;
                                    y.y = x.y;
                                    if (at) {
                                        x.x -= q;
                                    }
                                    else if (ar) {
                                    }
                                    else if (as) {
                                        x.x -= t;
                                    }
                                    if (aw) {
                                        y.x -= s;
                                    }
                                    if (am.c == 6) {
                                        var az = g.item(ah, ak - 1) != g.item(ah, ak) || g.item(ah, ak - 1) == null || g.item(ah, ak) == null;
                                        if (az && (am.a & 2) != 0) {
                                            x.x = Math.max(x.x, al - v + u);
                                        }
                                        var a0 = g.item(ah, ak + 1) != g.item(ah, ak) || g.item(ah, ak + 1) == null || g.item(ah, ak) == null;
                                        if (a0 && (am.a & 1) != 0) {
                                            y.x = Math.min(y.x, an - v - u);
                                        }
                                    }
                                    a._drawLine2$i(6, ap, p, x.x, x.y, y.x, y.y);
                                    break;
                                }
                            case 13:
                                {
                                    var a1 = am.n;
                                    var a2 = SpreadsheetUtilities.b8(9, p) / 2;
                                    x.x = al - v + am.i * q;
                                    y.x = an - r - v - am.j * q;
                                    y.y = x.y = ai - (a2 + w) - q;
                                    a._drawLine2$i(9, a1, p, x.x, x.y, y.x, y.y);
                                    y.y = x.y = ai - (a2 + w);
                                    a._drawLine2$i(8, a1, p, x.x, x.y, y.x, y.y);
                                    break;
                                }
                            default:
                                {
                                    var a3 = SpreadsheetUtilities.i(am.e);
                                    var a4 = am.n;
                                    var a5 = SpreadsheetUtilities.b8(a3, p) / 2;
                                    x.x = al - v + am.i * q;
                                    y.x = an - r - v - am.j * q;
                                    y.y = x.y = ai - (a5 + w);
                                    if (a5 > aa) {
                                        y.y = x.y = x.y + aa;
                                    }
                                    a._drawLine2$i(a3, a4, p, x.x, x.y, y.x, y.y);
                                    break;
                                }
                        }
                    }
                    if (am.d != 0 && ah <= l) {
                        switch (am.d) {
                            case 6:
                                {
                                    var a6 = f.item(ah, ak - 1);
                                    var a7 = am.m;
                                    var a8 = ag / 2;
                                    var a9 = am.e == 6;
                                    var ba = f.item(ah - 1, ak).d == 6;
                                    var bb = a6.e == 6;
                                    var bc = f.item(ah + 1, ak).e == 6;
                                    var bd = f.item(ah + 1, ak).d == 6;
                                    var be = f.item(ah + 1, ak - 1).e == 6;
                                    y.x = x.x = al - (q + a8 + v);
                                    y.y = aj - r - w - am.h * q;
                                    x.y = ai - w + am.k * q;
                                    var bf = x.y;
                                    var bg = y.y;
                                    if (a6.c == 6) {
                                        var bh = g.item(ah, ak - 1) != g.item(ah, ak) || g.item(ah, ak - 1) == null || g.item(ah, ak) == null;
                                        if (bh && (a6.a & 2) != 0) {
                                            x.y = Math.max(x.y, ai + w + s);
                                        }
                                        var bi = g.item(ah, ak - 1) != g.item(ah, ak) || g.item(ah, ak - 1) == null || g.item(ah, ak) == null;
                                        if (bi && (a6.a & 1) != 0) {
                                            y.y = Math.min(y.y, aj - w - s);
                                        }
                                    }
                                    a._drawLine2$i(6, a7, o, x.x, x.y, y.x, y.y);
                                    x.x += s;
                                    y.x = x.x;
                                    x.y = bf;
                                    y.y = bg;
                                    if (a9) {
                                        if (am.k < 0) {
                                            x.y += s;
                                        }
                                    }
                                    else if (ba) {
                                        if (bb) {
                                            x.y -= q;
                                        }
                                    }
                                    else if (bb) {
                                        if (am.k >= 0) {
                                            x.y -= s;
                                        }
                                    }
                                    if (bc) {
                                        if (am.h < 0) {
                                            y.y -= s;
                                        }
                                    }
                                    else if (bd) {
                                        if (be) {
                                            y.y += s;
                                        }
                                    }
                                    else if (be) {
                                        y.y += s;
                                    }
                                    if (am.c == 6 && ak < ae) {
                                        var bj = g.item(ah, ak + 1) != g.item(ah, ak) || g.item(ah, ak + 1) == null || g.item(ah, ak) == null;
                                        if (bj && (am.a & 1) != 0) {
                                            x.y = Math.max(x.y, ai + w + s);
                                        }
                                        var bk = g.item(ah, ak + 1) != g.item(ah, ak) || g.item(ah, ak + 1) == null || g.item(ah, ak) == null;
                                        if (bk && (am.a & 2) != 0) {
                                            y.y = Math.min(y.y, aj - w - s);
                                        }
                                    }
                                    a._drawLine2$i(6, a7, o, x.x, x.y, y.x, y.y);
                                    break;
                                }
                            case 13:
                                {
                                    var bl = am.m;
                                    var bm = SpreadsheetUtilities.b8(9, o) / 2;
                                    y.x = x.x = al - (bm + v) - q;
                                    y.y = aj - r - w - am.h * q;
                                    x.y = ai - w + am.k * q;
                                    a._drawLine2$i(9, bl, o, x.x, x.y, y.x, y.y);
                                    y.x = x.x = al - (bm + v);
                                    a._drawLine2$i(8, bl, o, x.x, x.y, y.x, y.y);
                                    break;
                                }
                            default:
                                {
                                    var bn = SpreadsheetUtilities.i(am.d);
                                    var bo = am.m;
                                    var bp = SpreadsheetUtilities.b8(bn, o) / 2;
                                    y.x = x.x = al - (bp + v);
                                    y.y = aj - r - w - am.h * q;
                                    x.y = ai - w + am.k * q;
                                    if (bp > z) {
                                        y.x = x.x = x.x + z;
                                    }
                                    a._drawLine2$i(bn, bo, o, x.x, x.y, y.x, y.y);
                                    break;
                                }
                        }
                    }
                }
            }
            if (af) {
                for (var bq = 1; bq < ad; bq++) {
                    var br = b.h(j[bq - 1] + ab);
                    for (var bs = 1; bs < ae; bs++) {
                        var bt = f.item(bq, bs);
                        if (bt.a != 0) {
                            var bu = g.item(bq, bs);
                            if (bu == null || !bu.r || (bq == 1 && bs == 1) || (bq == 1 && g.item(bq, bs - 1) != bu) || (bs == 1 && g.item(bq - 1, bs) != bu) || (g.item(bq - 1, bs) != bu && g.item(bq, bs - 1) != bu)) {
                                var bv = br;
                                if (SpreadsheetUtilities.cm(bt.e) > 1) {
                                    bv += q;
                                }
                                var bw = b.h(k[bs - 1] + ac);
                                var bx = void 0, by = void 0;
                                if (bu != null && bu.r) {
                                    if (g.item(bq - 1, bs) == bu) {
                                        bv = b.h(i._bn(bu.ak, true) * n + ab);
                                    }
                                    if (g.item(bq, bs - 1) == bu) {
                                        bw = b.h(h._bn(bu.ab, true) * n + ac);
                                    }
                                    var bz = h._cf(bu.x);
                                    if (bz < 0) {
                                        bx = h._bn(bu.x, false) * n + ac;
                                    }
                                    else {
                                        bx = k[bz + 1] + ac;
                                        bx -= q * Math.min(SpreadsheetUtilities.cm(f.item(bq, bz + 1).d), 2);
                                    }
                                    var b0 = i._cf(bu.ag);
                                    if (b0 < 0) {
                                        by = i._bn(bu.ag, false) * n + ab;
                                    }
                                    else {
                                        by = j[b0 + 1] + ab;
                                        if (SpreadsheetUtilities.cm(f.item(b0 + 1, bs).e) > 1) {
                                            by -= q;
                                        }
                                    }
                                }
                                else {
                                    bx = k[bs] + ac;
                                    by = j[bq] + ab;
                                    bx -= q * Math.min(SpreadsheetUtilities.cm(f.item(bq, bs + 1).d), 2);
                                    if (SpreadsheetUtilities.cm(f.item(bq + 1, bs).e) > 1) {
                                        by -= q;
                                    }
                                }
                                var b1 = b.h(bx);
                                var b2 = b.h(by);
                                switch (bt.c) {
                                    case 6:
                                        {
                                            var b3 = bt.l;
                                            switch (bt.a) {
                                                case 1:
                                                    a._drawLine2$i(6, b3, o, bw + u, bv, b1, b2 - q);
                                                    a._drawLine2$i(6, b3, o, bw, bv + q, b1 - u, b2);
                                                    break;
                                                case 2:
                                                    a._drawLine2$i(6, b3, o, bw, b2 - q, b1 - u - q, bv);
                                                    a._drawLine2$i(6, b3, o, bw + u, b2, b1, bv + q);
                                                    break;
                                                case 3:
                                                    var b4 = b1 - bw;
                                                    var b5 = b2 - bv;
                                                    a._drawLine2$i(6, b3, o, bw + u, bv, bw + b4 / 2, bv + b5 / 2 - q);
                                                    a._drawLine2$i(6, b3, o, bw + b4 / 2, bv + b5 / 2 - q, b1 - u - q, bv);
                                                    a._drawLine2$i(6, b3, o, b1, bv + q, bw + b4 / 2 + u, bv + b5 / 2);
                                                    a._drawLine2$i(6, b3, o, bw + b4 / 2 + u, bv + b5 / 2, b1, b2 - q);
                                                    a._drawLine2$i(6, b3, o, b1 - u, b2, bw + b4 / 2, bv + b5 / 2 + q);
                                                    a._drawLine2$i(6, b3, o, bw + b4 / 2, bv + b5 / 2 + q, bw + u, b2);
                                                    a._drawLine2$i(6, b3, o, bw, b2 - q, bw + b4 / 2 - u, bv + b5 / 2);
                                                    a._drawLine2$i(6, b3, o, bw + b4 / 2 - u, bv + b5 / 2, bw, bv + q);
                                                    break;
                                            }
                                            break;
                                        }
                                    case 0: break;
                                    default:
                                        {
                                            var b6 = bt.c == 13 ? 10 : SpreadsheetUtilities.i(bt.c);
                                            var b7 = bt.l;
                                            if (bt.a != 2) {
                                                a._drawLine2$i(b6, b7, o, bw, bv, b1, b2);
                                            }
                                            if (bt.a != 1) {
                                                a._drawLine2$i(b6, b7, o, bw, b2, b1, bv);
                                            }
                                            break;
                                        }
                                }
                            }
                        }
                    }
                }
            }
        }
    };
    SpreadsheetPaneCellBorderLayer.prototype._v = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j.rowScrollRegion._x || a == this._j.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "CellFillArray":
                if (a == this._j) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetPaneCellBorderLayer._u = function (a, b, c, d) {
        a._v(b, c, d);
    };
    SpreadsheetPaneCellBorderLayer.$t = markType(SpreadsheetPaneCellBorderLayer, 'SpreadsheetPaneCellBorderLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneCellBorderLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneCellBorderLayer };
/**
 * @hidden
 */
var SpreadsheetPaneGridlineLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneGridlineLayer, _super);
    function SpreadsheetPaneGridlineLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.p) || this;
        _this._t = null;
        _this._t = new PropertyChangeListener$1(SpreadsheetPaneGridlineLayer.$, _this, SpreadsheetPaneGridlineLayer._u, false);
        SpreadsheetUtilities.d6(a, _this._t, true);
        return _this;
    }
    SpreadsheetPaneGridlineLayer.prototype.get__m = function () {
        return 1;
    };
    Object.defineProperty(SpreadsheetPaneGridlineLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneGridlineLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._t);
        }
    };
    SpreadsheetPaneGridlineLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneGridlineLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneGridlineLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._k;
        var g = e._aa;
        var h = e._w;
        var i = e.rowScrollRegion._i(true);
        var j = e.columnScrollRegion._i(true);
        var k = i.length - 1;
        var l = j.length - 1;
        if (f != null && g != null && k > 0 && l > 0 && e.rowScrollRegion._bx >= 0.4) {
            var m = e.rowScrollRegion._br;
            var n = SpreadsheetUtilities.b8(6, m);
            var o = n / 2;
            var p = void 0, q = void 0;
            var r = d.x;
            var s = d.y;
            var t = b.d;
            var u = t * 2;
            p = -r;
            q = o - s;
            for (var v = 0; v < k; v++) {
                var w = b.h(i[v + 1] + c.y) - q;
                var x = -1;
                var y = 0;
                for (var z = 1; z <= l; z++) {
                    var aa = h.item(v + 1, z).f != null || h.item(v + 2, z).f != null;
                    var ab = h.item(v + 2, z).e != 0;
                    var ac = h.item(v + 1, z).d != 0 || h.item(v + 2, z).d != 0;
                    var ad = (f.item(v + 1, z) != null && f.item(v + 1, z) == f.item(v + 2, z));
                    if (aa || ab || (x >= 0 && ac) || ad) {
                        if (x < 0) {
                            continue;
                        }
                        var ae = 0;
                        var af = 0;
                        if (ac) {
                            af = Math.max(SpreadsheetUtilities.cm(h.item(v + 1, z).d), SpreadsheetUtilities.cm(h.item(v + 2, z).d));
                            if (af > 1) {
                                ae = -u;
                            }
                            else {
                                ae = -t;
                            }
                        }
                        else if (aa || ab) {
                            ae = -t;
                        }
                        a.drawLine3(g, m, b.h(j[x] + y + c.x) - p, w, b.h(j[z - 1] + ae + c.x) - p, w);
                        if (ac && !ab && !ad && !aa) {
                            x = z - 1;
                            y = af > 2 ? 1 : 0;
                        }
                        else {
                            x = -1;
                            y = 0;
                        }
                    }
                    else if (x < 0) {
                        x = z - 1;
                        y = ac && Math.max(SpreadsheetUtilities.cm(h.item(v + 1, z).d), SpreadsheetUtilities.cm(h.item(v + 2, z).d)) > 2 ? 1 : 0;
                    }
                }
                if (x >= 0) {
                    a.drawLine3(g, m, b.h(j[x] + y + c.x) - p, w, b.h(j[l] + c.x) - p, w);
                }
            }
            p = o - r;
            q = -s;
            for (var ag = 1; ag <= l; ag++) {
                var ah = b.h(j[ag] + c.x) - p;
                var ai = -1;
                var aj = 0;
                for (var ak = 0; ak < k; ak++) {
                    var al = h.item(ak + 1, ag).f != null || h.item(ak + 1, ag + 1).f != null;
                    var am = h.item(ak + 1, ag + 1).d != 0;
                    var an = h.item(ak + 1, ag).e != 0 || h.item(ak + 1, ag + 1).e != 0;
                    var ao = (f.item(ak + 1, ag) != null && f.item(ak + 1, ag) == f.item(ak + 1, ag + 1));
                    if (al || am || (ai >= 0 && an) || ao) {
                        if (ai < 0) {
                            continue;
                        }
                        var ap = 0;
                        var aq = 0;
                        if (an) {
                            aq = Math.max(SpreadsheetUtilities.cm(h.item(ak + 1, ag).e), SpreadsheetUtilities.cm(h.item(ak + 1, ag + 1).e));
                            if (aq > 1) {
                                ap = -u;
                            }
                            else {
                                ap = -t;
                            }
                        }
                        else if (al || am) {
                            ap = -t;
                        }
                        a.drawLine3(g, m, ah, b.h(i[ai] + aj + c.y) - q, ah, b.h(i[ak] + ap + c.y) - q);
                        if (an && !am && !ao && !al && h.item(ak + 1, ag + 1).d == 0) {
                            ai = ak;
                            aj = aq > 2 ? 1 : 0;
                        }
                        else {
                            ai = -1;
                            aj = 0;
                        }
                    }
                    else if (ai < 0) {
                        ai = ak;
                        aj = an && Math.max(SpreadsheetUtilities.cm(h.item(ak + 1, ag).e), SpreadsheetUtilities.cm(h.item(ak + 1, ag + 1).e)) > 2 ? 1 : 0;
                    }
                }
                if (ai >= 0) {
                    a.drawLine3(g, m, ah, b.h(i[ai] + aj + c.y) - q, ah, b.h(i[k] + c.y) - q);
                }
            }
        }
    };
    SpreadsheetPaneGridlineLayer.prototype._v = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "CellValueArray":
            case "GridlinePen":
                if (a == this._j) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetPaneGridlineLayer._u = function (a, b, c, d) {
        a._v(b, c, d);
    };
    SpreadsheetPaneGridlineLayer.$t = markType(SpreadsheetPaneGridlineLayer, 'SpreadsheetPaneGridlineLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneGridlineLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneGridlineLayer };
/**
 * @hidden
 */
var SpreadsheetPaneInteractionOverlayLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneInteractionOverlayLayer, _super);
    function SpreadsheetPaneInteractionOverlayLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.q) || this;
        _this._t = null;
        _this._t = new PaneInteractionLayerObserver(a, runOn(_this, _this._o));
        return _this;
    }
    SpreadsheetPaneInteractionOverlayLayer.prototype.get__m = function () {
        return 2;
    };
    Object.defineProperty(SpreadsheetPaneInteractionOverlayLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneInteractionOverlayLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        this._t.dispose();
    };
    SpreadsheetPaneInteractionOverlayLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneInteractionOverlayLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneInteractionOverlayLayer.prototype._q = function (a, b, c, d) {
        this._t._h = SpreadsheetRenderUtilities.a(this._j, a, b, c, d);
    };
    SpreadsheetPaneInteractionOverlayLayer.$t = markType(SpreadsheetPaneInteractionOverlayLayer, 'SpreadsheetPaneInteractionOverlayLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneInteractionOverlayLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneInteractionOverlayLayer };
/**
 * @hidden
 */
var SpreadsheetPaneInvalidDataLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneInvalidDataLayer, _super);
    function SpreadsheetPaneInvalidDataLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.r) || this;
        _this._t = null;
        _this._t = new InvalidDataLayerObserver(a, runOn(_this, _this._o));
        return _this;
    }
    SpreadsheetPaneInvalidDataLayer.prototype.get__m = function () {
        return 2;
    };
    Object.defineProperty(SpreadsheetPaneInvalidDataLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneInvalidDataLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        this._t.dispose();
    };
    SpreadsheetPaneInvalidDataLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneInvalidDataLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneInvalidDataLayer.prototype._q = function (a, b, c, d) {
        SpreadsheetRenderUtilities.c(this._j, a, b, c, d);
    };
    SpreadsheetPaneInvalidDataLayer.$t = markType(SpreadsheetPaneInvalidDataLayer, 'SpreadsheetPaneInvalidDataLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneInvalidDataLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneInvalidDataLayer };
/**
 * @hidden
 */
var SpreadsheetPaneSelectionLayer = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneSelectionLayer, _super);
    function SpreadsheetPaneSelectionLayer(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b, PredefinedSpreadsheetLayers.s) || this;
        _this._u = null;
        _this._t = null;
        _this._u = new PropertyChangeListener$1(SpreadsheetPaneSelectionLayer.$, _this, SpreadsheetPaneSelectionLayer._v, false);
        SpreadsheetUtilities.d6(a, _this._u, true);
        SpreadsheetUtilities.d6(a.columnScrollRegion, _this._u, true);
        SpreadsheetUtilities.d6(a.rowScrollRegion, _this._u, true);
        var c = PropertyChangeListenerList.e(SpreadsheetSelection.$, _this._t, a.rowScrollRegion._ab, _this._u, true);
        _this._t = c.p0;
        return _this;
    }
    SpreadsheetPaneSelectionLayer.prototype._r = function (a) {
        var b = this._j.columnScrollRegion._br;
        var c = this._j.rowScrollRegion._bs;
        a.x -= b;
        a.width += b;
        a.y -= c;
        a.height += c;
        return a;
    };
    SpreadsheetPaneSelectionLayer.prototype.get__m = function () {
        return 0;
    };
    Object.defineProperty(SpreadsheetPaneSelectionLayer.prototype, "_m", {
        get: function () {
            return this.get__m();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneSelectionLayer.prototype._p = function () {
        _super.prototype._p.call(this);
        if (this._j != null) {
            SpreadsheetUtilities.ec(this._j, this._u);
            SpreadsheetUtilities.ec(this._j.columnScrollRegion, this._u);
            SpreadsheetUtilities.ec(this._j.rowScrollRegion, this._u);
            if (this._t != null) {
                SpreadsheetUtilities.ec(this._t, this._u);
            }
        }
    };
    SpreadsheetPaneSelectionLayer.prototype.get__s = function () {
        return this._j._s.renderCache;
    };
    Object.defineProperty(SpreadsheetPaneSelectionLayer.prototype, "_s", {
        get: function () {
            return this.get__s();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneSelectionLayer.prototype._q = function (a, b, c, d) {
        var e = this._j;
        var f = e._ag || e.selection;
        var g = f.cellRanges;
        var h = g.count;
        if (h > 0 && e.columnScrollRegion._ai != 2) {
            var i = e.columnScrollRegion;
            var j = e.rowScrollRegion;
            var k = j._bx;
            var l = e.visibleRange;
            var m = h == 1;
            var n = i._ad;
            var o = 4;
            var p = m && i._o.renderCache.o(o);
            var q = m ? p ? 14 : 13 : 6;
            var r = m ? 3 : 2;
            var s = 1;
            var t = 0;
            var u = SpreadsheetUtilities.b8(q, i._br) / 2;
            var v = b.d;
            var w = v / 2;
            var x = v * 2;
            var y = v * 3;
            var z = v + w;
            var aa = -d.x;
            var ab = -d.y;
            var ac = 10;
            l = new SpreadsheetCellRange(Math.min(l.firstRow, j._ag(-ac / k)._j), Math.min(l.firstColumn, i._ag(-ac / k)._j), Math.max(l.lastRow, j._ag((c.height + ac) / k)._j), Math.max(l.lastColumn, i._ag((c.width + ac) / k)._j));
            var ad = void 0;
            if (p) {
                ad = u / 3;
            }
            else if (m) {
                ad = 0;
            }
            else {
                ad = u;
            }
            for (var ae = 0; ae < h; ae++) {
                var af = g.item(ae);
                af = af.intersect(l);
                if (af.isEmpty) {
                    continue;
                }
                var ag = i._bn(af.firstColumn, true) * k + c.x;
                var ah = i._bn(af.lastColumn, false) * k + c.x;
                var ai = j._bn(af.firstRow, true) * k + c.y;
                var aj = j._bn(af.lastRow, false) * k + c.y;
                if (p == false && ae == f.activeCellRangeIndex && i._ap == false) {
                    if (af.firstRow == j.startIndex) {
                        ai += v;
                    }
                    if (af.firstColumn == i.startIndex) {
                        ag += v;
                    }
                }
                ag = b.h(ag) - aa;
                ah = b.h(ah) - aa;
                ai = b.h(ai) - ab;
                aj = b.h(aj) - ab;
                ag -= v;
                ai -= v;
                var ak = ah - ag;
                var al = aj - ai;
                if (ak > x && al > x) {
                    var am = new Rect(0, ag + x, ai + x, Math.max(ak - x * 2, 0), Math.max(al - x * 2, 0));
                    if (ae == f.activeCellRangeIndex) {
                        var an = f._r;
                        var ao = af.intersect(an);
                        if (!ao.isEmpty) {
                            var ap = i._bn(ao.firstColumn, true) * k + c.x;
                            var aq = i._bn(ao.lastColumn, false) * k + c.x;
                            var ar = j._bn(ao.firstRow, true) * k + c.y;
                            var as = j._bn(ao.lastRow, false) * k + c.y;
                            as -= v;
                            aq -= v;
                            ap = b.h(ap) - aa;
                            aq = b.h(aq) - aa;
                            ar = b.h(ar) - ab;
                            as = b.h(as) - ab;
                            if (p == false && ae == f.activeCellRangeIndex && i._ap == false) {
                                if (ao.firstRow == j.startIndex) {
                                    ar += v;
                                }
                                if (ao.firstColumn == i.startIndex) {
                                    ap += v;
                                }
                            }
                            var at = new Rect(0, ap, ar, Math.max(aq - ap, 0), Math.max(as - ar, 0));
                            at.intersect(am);
                            if (at.isEmpty) {
                                a.fillRectangle1(t, am.x, am.y, am.width, am.height);
                            }
                            else {
                                a.fillRectangle2(t, am.x, am.y, am.width, am.height, at.x, at.y, at.width, at.height);
                            }
                            if (!m) {
                                a.drawRectangle(6, 37, i._br, ap + z, ar + z, Math.max((aq - ap) - y, 0), Math.max((as - ar) - y, 0));
                            }
                            am = Rect.empty;
                        }
                    }
                    if (!am.isEmpty) {
                        a.fillRectangle1(t, am.x, am.y, am.width, am.height);
                    }
                    a.drawRectangle(6, s, i._br, ag + z, ai + z, Math.max(ak - y, 0), Math.max(al - y, 0));
                }
                a.drawRectangle(q, r, i._br, ag + ad, ai + ad, Math.max(ak - ad * 2, 0), Math.max(al - ad * 2, 0));
                if (m) {
                    var au = 6;
                    var av = void 0;
                    if (g.item(0).firstColumn == 0 && g.item(0).lastColumn == i._ci) {
                        av = new Rect(0, ag, aj - y, 5 * v, 5 * v);
                        a.drawLine(6, au, i._br, av.right + w, av.y - v, av.right + w, av.bottom);
                        a.drawLine(6, au, i._br, av.x - v, av.y - w, av.right, av.y - w);
                    }
                    else if (g.item(0).firstRow == 0 && g.item(0).lastRow == j._ci) {
                        av = new Rect(0, ah - y, ai, 5 * v, 5 * v);
                        a.drawLine(6, au, i._br, av.x - w, av.y - v, av.x - w, av.bottom);
                        a.drawLine(6, au, i._br, av.x - v, av.bottom + w, av.right, av.bottom + w);
                    }
                    else {
                        av = new Rect(0, ah - y, aj - y, 5 * v, 5 * v);
                        a.drawLine(6, au, i._br, av.x - v, av.y - w, av.right, av.y - w);
                        a.drawLine(6, au, i._br, av.x - w, av.y - v, av.x - w, av.bottom);
                    }
                    var aw = 5;
                    a.fillRectangle1(aw, av.x, av.y, av.width, av.height);
                }
            }
            if (!f._v.isEmpty) {
                var ax = f._v.intersect(l);
                if (!ax.isEmpty) {
                    var ay = i._bn(ax.firstColumn, true) * k + c.x;
                    var az = i._bn(ax.lastColumn, false) * k + c.x;
                    var a0 = j._bn(ax.firstRow, true) * k + c.y;
                    var a1 = j._bn(ax.lastRow, false) * k + c.y;
                    ay = b.h(ay) - aa - v;
                    az = b.h(az) - aa;
                    a0 = b.h(a0) - ab - v;
                    a1 = b.h(a1) - ab;
                    var a2 = az - ay;
                    var a3 = a1 - a0;
                    if (a2 > 0 && a3 > 0) {
                        a.fillRectangle1(71, ay, a0, a2, a3);
                        ay += z;
                        a0 += z;
                        a2 -= y;
                        a3 -= y;
                        if (a2 > 0 && a3 > 0) {
                            a.drawRectangle(6, 72, i._br, ay, a0, a2, a3);
                        }
                    }
                }
            }
        }
    };
    SpreadsheetPaneSelectionLayer.prototype._w = function (a, b, c) {
        var d = false;
        switch (b != null ? b : "") {
            case "":
            case "Offset":
                if (a == this._j.rowScrollRegion._x || a == this._j.columnScrollRegion._x) {
                    d = true;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (this._j.rowScrollRegion._ab != null && this._j.rowScrollRegion._ab._a1(a)) {
                    d = true;
                }
                else if (getInstanceType(a) == SpreadsheetUtilities.d5) {
                    d = true;
                }
                break;
            case "ActiveSelection":
                if (this._j.rowScrollRegion == a) {
                    var e = PropertyChangeListenerList.e(SpreadsheetSelection.$, this._t, this._j.rowScrollRegion._ab, this._u, true);
                    this._t = e.p0;
                    d = true;
                }
                break;
            case "SelectionMode":
            case "ResourceProvider":
                if (this._j.rowScrollRegion == a) {
                    d = true;
                }
                break;
            case "ActiveCellAsRange":
            case "RangeToUnselect":
                if (a == this._j.rowScrollRegion._ab) {
                    d = true;
                }
                break;
            case "ResourceVersion":
                if (a == this._j.rowScrollRegion._ad) {
                    d = true;
                }
                break;
        }
        if (d) {
            this._o();
        }
    };
    SpreadsheetPaneSelectionLayer._v = function (a, b, c, d) {
        a._w(b, c, d);
    };
    SpreadsheetPaneSelectionLayer.$t = markType(SpreadsheetPaneSelectionLayer, 'SpreadsheetPaneSelectionLayer', SpreadsheetRendererElementLayer$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneSelectionLayer;
}(SpreadsheetRendererElementLayer$1));
export { SpreadsheetPaneSelectionLayer };
/**
 * @hidden
 */
var SpreadsheetRenderUtilities = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetRenderUtilities, _super);
    function SpreadsheetRenderUtilities() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetRenderUtilities.b = function (a, b, c, d, e) {
        var f = a._i(true, true);
        var g = f.length - 1;
        var h = a._bx;
        var i = a._ad;
        var j, k, l, m;
        if (a._aw) {
            j = 11;
            k = 13;
            l = 12;
            m = 14;
        }
        else {
            j = 24;
            k = 26;
            l = 25;
            m = 27;
        }
        var n = c.d;
        var o = -e.x;
        var p = -e.y;
        var q = a._aw;
        var r = d.left;
        var s = d.top;
        var t = d.right - n / 2;
        var u = d.bottom - n / 2;
        var v = a._ar();
        var w = a._l;
        var x = a._co;
        var y = 1;
        if (q) {
            s += y;
        }
        else {
            r += y;
        }
        r = c.h(r) - o;
        t = c.h(t) - o;
        s = c.h(s) - p;
        u = c.h(u) - p;
        for (var z = 0; z < g; z++) {
            var aa = f[z];
            var ab = f[z + 1] - n;
            if (q) {
                aa += d.y + y;
                ab += d.y + y;
                s = c.h(aa) - p;
                u = c.h(ab) - p;
            }
            else {
                aa += d.x + y;
                ab += d.x + y;
                r = c.h(aa) - o;
                t = c.h(ab) - o;
            }
            var ac = j;
            if (v || nullableNotEquals(x, null)) {
                switch (a._t(w._inner[z]._j)) {
                    case 3:
                    case 4:
                        ac = m;
                        break;
                    case 1:
                        ac = k;
                        break;
                    case 2:
                        ac = l;
                        break;
                }
            }
            var ad = Math.max(t - r, 0);
            var ae = Math.max(u - s, 0);
            b.fillRectangle1(ac, r, s, ad, ae);
        }
    };
    SpreadsheetRenderUtilities.a = function (a, b, c, d, e) {
        var f = a.columnScrollRegion;
        var g = a.rowScrollRegion;
        var h = nullableNotEquals(f._cp, null) ? f : nullableNotEquals(g._cp, null) ? g : null;
        var i = h != null;
        if (h != null) {
            var j = c.d;
            var k = -e.x;
            var l = -e.y;
            var m = h._aw;
            var n = h._bx;
            var o = h._bn(h._cp.value, true) * n;
            var p = d.x;
            var q = d.y;
            var r = d.right;
            var s = d.bottom;
            var t = h._br;
            p = c.h(p) - k;
            q = c.h(q) - l;
            r = c.h(r) - k;
            s = c.h(s) - l;
            var u = m ? 40 : 39;
            var v = 6;
            var w = SpreadsheetUtilities.b8(v, t) / 2;
            if (m) {
                q = s = c.h(o + d.y) - l - w;
            }
            else {
                p = r = c.h(o + d.x) - k - w;
            }
            b.drawLine(v, u, t, p, q, r, s);
            var x = h._bp;
            if (!isNaN_(x)) {
                x *= n;
                if (m) {
                    q = s = c.h(x + d.y) - l - w;
                }
                else {
                    p = r = c.h(x + d.x) - k - w;
                }
                b.drawLine(v, u, t, p, q, r, s);
            }
        }
        return i;
    };
    SpreadsheetRenderUtilities.c = function (a, b, c, d, e) {
        var f = a._h;
        var g = a._k;
        var h = a.columnScrollRegion;
        var i = a.rowScrollRegion;
        var j = i._i(true);
        var k = h._i(true);
        var l = j.length - 1;
        var m = k.length - 1;
        var n = i._bx;
        var o = Math.max(n, 1);
        if (l > 0 && m > 0) {
            var p = 64;
            var q = c.d;
            var r = -e.x;
            var s = -e.y;
            var t = SpreadsheetUtilities.b8(13, h._br) * n;
            for (var u = 1; u <= l; u++) {
                if (f.c(u) == false) {
                    continue;
                }
                var v = g.d(u);
                for (var w = 1; w <= m; w++) {
                    if (f.item(u, w)) {
                        var x = void 0, y = void 0, z = void 0, aa = void 0;
                        var ab = v ? g.item(u, w) : null;
                        if (ab != null && ab.r) {
                            if (u > 1 && g.item(u - 1, w) == ab) {
                                continue;
                            }
                            if (w > 1 && g.item(u, w - 1) == ab) {
                                continue;
                            }
                            x = h._bn(ab.ab, true) * n + d.x;
                            y = h._bn(ab.x, false) * n + d.x;
                            z = i._bn(ab.ak, true) * n + d.y;
                            aa = i._bn(ab.ag, false) * n + d.y;
                        }
                        else {
                            x = k[w - 1] + d.x;
                            y = k[w] + d.x;
                            z = j[u - 1] + d.y;
                            aa = j[u] + d.y;
                        }
                        x = c.h(x - 1) - r;
                        z = c.h(z - 1) - s;
                        y = c.h(y) - r;
                        aa = c.h(aa) - s;
                        b.drawEllipse(t, p, h._br, x - 5, z - 2, (y - x) + 10, (aa - z) + 4);
                    }
                }
            }
        }
    };
    SpreadsheetRenderUtilities.$t = markType(SpreadsheetRenderUtilities, 'SpreadsheetRenderUtilities');
    return SpreadsheetRenderUtilities;
}(Base));
export { SpreadsheetRenderUtilities };
/**
 * @hidden
 */
var SpreadsheetMouseOperation$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetMouseOperation$1, _super);
    function SpreadsheetMouseOperation$1($t) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this._aa = null;
        _this._aw = null;
        _this._ax = null;
        _this._w = null;
        _this._v = null;
        _this._ad = null;
        _this._ac = null;
        _this._ag = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        return _this;
    }
    SpreadsheetMouseOperation$1.prototype._o = function (a, b) {
        switch (b) {
            case 3:
            case 4:
            case 0:
                this._at();
                break;
        }
    };
    SpreadsheetMouseOperation$1.prototype._s = function (a) {
        this._au(a);
        if (a.b()) {
            var b = a.h();
            var c = this._av(this._ac, this._y, b.x, this._aw.left, this._aw.right, this._ai);
            this._ac = c.p0;
            var d = this._av(this._ad, this._ae, b.y, this._aw.top, this._aw.bottom, this._aj);
            this._ad = d.p0;
            if ((this._ad != null && this._ad.e) || (this._ac != null && this._ac.e)) {
                this._w = a;
            }
            else {
                this._w = null;
            }
        }
        else {
            this._w = null;
        }
    };
    SpreadsheetMouseOperation$1.prototype._g = function (a) {
        this._au(a);
        return _super.prototype._g.call(this, a);
    };
    Object.defineProperty(SpreadsheetMouseOperation$1.prototype, "_ay", {
        get: function () {
            return this._ax;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetMouseOperation$1.prototype, "_x", {
        get: function () {
            return this._v;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetMouseOperation$1.prototype, "_ab", {
        get: function () {
            return this._aa;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetMouseOperation$1.prototype._am = function (a, b, c) {
        var d = this._aa;
        this._aa = a;
        this._ax = c;
        this._aw = b;
        if (this._aa == null) {
            this._ap(d);
        }
        else {
            this._an(a);
        }
    };
    SpreadsheetMouseOperation$1.prototype._ah = function () {
        var a = this._ae;
        var b = this._y;
        if (a == null) {
            if (b == null) {
                return false;
            }
            a = typeCast(SpreadsheetRowScrollRegion.$, b._z);
        }
        else if (b == null) {
            b = typeCast(SpreadsheetColumnScrollRegion.$, a._z);
        }
        var c = a._o;
        var d = c.getPane(a, b);
        if (d == null) {
            return false;
        }
        if (!c.canActivatePane(d)) {
            return c.activePane != null && (a.isFrozen || b.isFrozen);
        }
        return c.activatePane(d);
    };
    SpreadsheetMouseOperation$1.prototype._af = function () {
        return null;
    };
    SpreadsheetMouseOperation$1.prototype._al = function () {
        if (this._ag != null) {
            this._ag.c();
            this._ag = null;
        }
        this._k = null;
    };
    SpreadsheetMouseOperation$1.prototype._an = function (a) {
    };
    SpreadsheetMouseOperation$1.prototype._ao = function (a, b) {
    };
    SpreadsheetMouseOperation$1.prototype._ap = function (a) {
        this._al();
        this._at();
    };
    SpreadsheetMouseOperation$1.prototype._ar = function () {
        var _this = this;
        if (this._ag != null) {
            this._ag.c();
        }
        this._ag = new TimedOperation(function () {
            var a = _this._af();
            if (a == null) {
                _this._al();
            }
            else {
                _this._k = a;
            }
        }, 250);
    };
    SpreadsheetMouseOperation$1.prototype._ak = function (a) {
        var b = 118;
        a = Math.min(b - 2, Math.abs(a));
        return Math.pow((b - a) / b, 3) * 500;
    };
    SpreadsheetMouseOperation$1.prototype._aq = function () {
        var a = this._y || this._ae;
        if (a != null) {
            a._o.verifyScrollPositions();
        }
        if (this._w != null) {
            this._s(this._w);
        }
    };
    SpreadsheetMouseOperation$1.prototype._as = function (a) {
        if (a != null) {
            a.h();
        }
        a = null;
        return {
            p0: a
        };
    };
    SpreadsheetMouseOperation$1.prototype._at = function () {
        this._w = null;
        var a = this._as(this._ad);
        this._ad = a.p0;
        var b = this._as(this._ac);
        this._ac = b.p0;
    };
    SpreadsheetMouseOperation$1.prototype._au = function (a) {
        if (this._ab != null) {
            var b = this._v;
            this._v = a;
            this._ao(b, this._v);
        }
        else if (this._v != null) {
            var c = this._v;
            this._v = null;
            this._ao(c, this._v);
        }
    };
    SpreadsheetMouseOperation$1.prototype._av = function (a, b, c, d, e, f) {
        if (b == null || !f) {
            var g = this._as(a);
            a = g.p0;
        }
        else {
            if (a == null) {
                a = new SpreadsheetMouseOperation_ScrollTimer$1(this.$t, runOn(this, this._aq));
            }
            var h = c >= e;
            if (!h && c >= d) {
                a.h();
            }
            else {
                var i = h ? c - e : d - c;
                var j = this._ak(i);
                a.g(b, h, truncate(Math.abs(j)));
            }
        }
        return {
            p0: a
        };
    };
    SpreadsheetMouseOperation$1.$t = markType(SpreadsheetMouseOperation$1, 'SpreadsheetMouseOperation$1', SpreadsheetMouseOperation.$);
    return SpreadsheetMouseOperation$1;
}(SpreadsheetMouseOperation));
export { SpreadsheetMouseOperation$1 };
/**
 * @hidden
 */
var SpreadsheetPaneMouseOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneMouseOperation, _super);
    function SpreadsheetPaneMouseOperation() {
        return _super.call(this, SpreadsheetPane.$) || this;
    }
    SpreadsheetPaneMouseOperation.prototype.get__y = function () {
        return this._ab.columnScrollRegion;
    };
    Object.defineProperty(SpreadsheetPaneMouseOperation.prototype, "_y", {
        get: function () {
            return this.get__y();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneMouseOperation.prototype.get__ae = function () {
        return this._ab.rowScrollRegion;
    };
    Object.defineProperty(SpreadsheetPaneMouseOperation.prototype, "_ae", {
        get: function () {
            return this.get__ae();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneMouseOperation.$t = markType(SpreadsheetPaneMouseOperation, 'SpreadsheetPaneMouseOperation', SpreadsheetMouseOperation$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneMouseOperation;
}(SpreadsheetMouseOperation$1));
export { SpreadsheetPaneMouseOperation };
/**
 * @hidden
 */
var SpreadsheetCellDropDownOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellDropDownOperation, _super);
    function SpreadsheetCellDropDownOperation() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._az = null;
        return _this;
    }
    SpreadsheetCellDropDownOperation.prototype.get__z = function () {
        return 19;
    };
    Object.defineProperty(SpreadsheetCellDropDownOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellDropDownOperation.prototype.get__ai = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetCellDropDownOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellDropDownOperation.prototype.get__aj = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetCellDropDownOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellDropDownOperation.prototype._a0 = function (a) {
        var b = a.h();
        var c = this._ab;
        var d = c._q;
        for (var e = 0; e < d.count; e++) {
            if (d._inner[e].g.containsLocation(b.x, b.y)) {
                return d._inner[e];
            }
        }
        return null;
    };
    SpreadsheetCellDropDownOperation.prototype._al = function () {
        this._az = null;
        _super.prototype._al.call(this);
    };
    SpreadsheetCellDropDownOperation.prototype._m = function (a) {
        if (a.a() == 1) {
            var b = this._a0(a);
            var c = this._ab._s.spreadsheetOwnerState._h;
            var d = c._a8._bc;
            if (c._du(b)) {
                this._al();
                c._d4(this._ab, b);
                return false;
            }
        }
        return false;
    };
    SpreadsheetCellDropDownOperation.prototype._a1 = function (a, b) {
        return WorkbookColorInfo.l_op_Inequality(b, null) ? SpreadsheetUtilities.dc(b._getResolvedColor1(a)) : null;
    };
    SpreadsheetCellDropDownOperation.prototype._af = function () {
        var _this = this;
        var a = this._x;
        if (this._az != null && this._ab != null && a != null && this._i == 0) {
            var b_1 = this._a3(this._az);
            if (!stringIsNullOrEmpty(b_1)) {
                var c_2 = a.h();
                return ((function () {
                    var $ret = new SpreadsheetToolTipContext();
                    $ret.d = { $type: Point_$type, x: c_2.x - 7, y: c_2.y + 20 };
                    $ret.a = 4;
                    $ret.c = _this._ab._s.getHeaderCaption(_this._az.d, _this._az.c) + ":";
                    $ret.b = b_1;
                    return $ret;
                })());
            }
        }
        return null;
    };
    SpreadsheetCellDropDownOperation.prototype._a3 = function (a) {
        if (a != null) {
            if (a.b == 1 || a.b == 0) {
                var b = this._ab._s.getFilter(a.d, a.c);
                if (b != null) {
                    return this._a4(b);
                }
                return this._ab._s.spreadsheetOwnerState._h._fs("DefaultAutoFilterToolTip");
            }
        }
        return null;
    };
    SpreadsheetCellDropDownOperation.prototype._a4 = function (a) {
        var e_113, _0, e_114, _1;
        var b = this._ab._s.spreadsheetOwnerState._h;
        if (typeCast(AverageFilter.$, a) !== null) {
            return b._fs(a.type == 0 ? "FilterDescription_AboveAverage" : "FilterDescription_BelowAverage");
        }
        else if (typeCast(CustomFilter.$, a) !== null) {
            var c = a;
            if (c.condition2 == null) {
                return this._a2(b, c.condition1);
            }
            else {
                return b._fs(c.conditionalOperator == 0 ? "FilterDescription_Custom_And" : "FilterDescription_Custom_Or", this._a2(b, c.condition1), this._a2(b, c.condition2));
            }
        }
        else if (typeCast(FixedValuesFilter.$, a) !== null) {
            var d = b.workbook._e6;
            var e = a;
            var f = new StringBuilder(0);
            try {
                for (var _2 = tslib_1.__values(fromEnum(e._dateGroups$i)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var g = _3.value;
                    if (f.c > 0) {
                        f.l(", ");
                    }
                    switch (g._f) {
                        case 0:
                            f.l(b._fs("FilterDescription_FixedValues_Year", g.value));
                            break;
                        case 1:
                            f.l(b._fs("FilterDescription_FixedValues_Month", g.value));
                            break;
                        case 2:
                            f.l(b._fs("FilterDescription_FixedValues_Day", g.value));
                            break;
                        case 3:
                            f.l(b._fs("FilterDescription_FixedValues_Hour", g.value));
                            break;
                        case 4:
                            f.l(b._fs("FilterDescription_FixedValues_Minute", g.value));
                            break;
                        case 5:
                            f.l(b._fs("FilterDescription_FixedValues_Second", g.value));
                            break;
                    }
                }
            }
            catch (e_113_1) { e_113 = { error: e_113_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_113) throw e_113.error; }
            }
            try {
                for (var _4 = tslib_1.__values(fromEnum(e._displayValues$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var h = _5.value;
                    if (f.c > 0) {
                        f.l(", ");
                    }
                    f.l(h);
                }
            }
            catch (e_114_1) { e_114 = { error: e_114_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_114) throw e_114.error; }
            }
            if (e.includeBlanks) {
                if (f.c > 0) {
                    f.l(", ");
                }
                f.l(b._fs("FilterDescription_FixedValues_Blanks"));
            }
            return b._fs("FilterDescription_FixedValues", f.toString());
        }
        else if (typeCast(TopOrBottomFilter.$, a) !== null) {
            var i = a;
            var j = void 0;
            switch (i.type) {
                case 3:
                    j = "FilterDescription_BottomPercent";
                    break;
                case 1:
                    j = "FilterDescription_BottomItems";
                    break;
                case 2:
                    j = "FilterDescription_TopPercent";
                    break;
                default:
                case 0:
                    j = "FilterDescription_TopItems";
                    break;
            }
            return b._fs(j, i.value);
        }
        else if (typeCast(DatePeriodFilter.$, a) !== null) {
            var k = a;
            if (k.type == 1) {
                return b._fs("FilterDescription_QuarterNumber", k.value);
            }
            else {
                return b._fs("FilterDescription_MonthNumber", SpreadsheetUtilities.dh(k.value, b.workbook._e6));
            }
        }
        else if (typeCast(RelativeDateRangeFilter.$, a) !== null) {
            var l = a;
            return b._fs("FilterDescription_RelativeDate_" + EnumUtil.getName(RelativeDateRangeOffset_$type, l.offset) + EnumUtil.getName(RelativeDateRangeDuration_$type, l.duration));
        }
        else if (typeCast(YearToDateFilter.$, a) !== null) {
            return b._fs("FilterDescription_YearToDate");
        }
        else if (typeCast(FillFilter.$, a) !== null) {
            var m = a;
            if (m.fill == CellFill.noColor) {
                return b._fs("FilterDescription_CellFill_NoFill");
            }
            if (typeCast(CellFillPattern.$, m.fill) !== null) {
                var n = m.fill;
                if (n.patternStyle == 0) {
                    return b._fs("FilterDescription_CellFill_NoFill");
                }
                else if (n.patternStyle == 1) {
                    var o = this._a1(b.workbook, n.backgroundColorInfo);
                    if (!stringIsNullOrEmpty(o)) {
                        return b._fs("FilterDescription_CellFill_Named", o);
                    }
                }
            }
            return b._fs("FilterDescription_CellFill_Unknown");
        }
        else if (typeCast(FontColorFilter.$, a) !== null) {
            var p = a;
            if (p.fontColorInfo.isAutomatic) {
                return b._fs("FilterDescription_FontColor_Automatic");
            }
            var q = this._a1(b.workbook, p.fontColorInfo);
            if (!stringIsNullOrEmpty(q)) {
                return b._fs("FilterDescription_FontColor_Named", q);
            }
            return b._fs("FilterDescription_FontColor_Unknown");
        }
        else if (typeCast(IconFilter.$, a) !== null) {
            var r = a;
            var s = SpreadsheetUtilities.an(r._m, r._p);
            if (s == -1) {
                return b._fs("FilterDescription_NoCellIcon");
            }
            return b._fs("FilterDescription_WithCellIcon", b._fs("Icon_" + EnumUtil.getName(FormatConditionIcon_$type, s)));
        }
        return null;
    };
    SpreadsheetCellDropDownOperation.prototype._a2 = function (a, b) {
        return a._fs("FilterDescription_ComparisonItem_" + EnumUtil.getName(ExcelComparisonOperator_$type, b.comparisonOperator), b.value);
    };
    SpreadsheetCellDropDownOperation.prototype._s = function (a) {
        if (this._i == 0) {
            var b = this._a0(a);
            if (b != this._az) {
                this._al();
                this._az = b;
                if (this._az != null && this._a3(b) != null) {
                    this._ar();
                }
            }
        }
        _super.prototype._s.call(this, a);
    };
    SpreadsheetCellDropDownOperation.prototype._u = function (a) {
    };
    SpreadsheetCellDropDownOperation.$t = markType(SpreadsheetCellDropDownOperation, 'SpreadsheetCellDropDownOperation', SpreadsheetPaneMouseOperation.$);
    return SpreadsheetCellDropDownOperation;
}(SpreadsheetPaneMouseOperation));
export { SpreadsheetCellDropDownOperation };
/**
 * @hidden
 */
var SpreadsheetCellContextMenuOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellContextMenuOperation, _super);
    function SpreadsheetCellContextMenuOperation() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetCellContextMenuOperation.prototype.get__ai = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetCellContextMenuOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellContextMenuOperation.prototype.get__aj = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetCellContextMenuOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellContextMenuOperation.prototype.get__z = function () {
        return 10;
    };
    Object.defineProperty(SpreadsheetCellContextMenuOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellContextMenuOperation.prototype._m = function (a) {
        var b = this._ab._ag;
        var c = b._m;
        if (c != null && b != null) {
            var d = a.h();
            if (c._d7(true)) {
                var e = this._ab;
                var f = e.rowScrollRegion._bx;
                var g = e.rowScrollRegion._ag(d.y / f);
                var h = e.columnScrollRegion._ag(d.x / f);
                var i = new SpreadsheetCell(g._j, h._j);
                if (!b._ao(i)) {
                    if (!b._a9(i)) {
                        return false;
                    }
                }
                var j = SpreadsheetUtilities.aa(b);
                c._v._ShowPaneContextMenu$i(this._ab, j, d);
            }
        }
        return false;
    };
    SpreadsheetCellContextMenuOperation.prototype._u = function (a) {
    };
    SpreadsheetCellContextMenuOperation.$t = markType(SpreadsheetCellContextMenuOperation, 'SpreadsheetCellContextMenuOperation', SpreadsheetPaneMouseOperation.$);
    return SpreadsheetCellContextMenuOperation;
}(SpreadsheetPaneMouseOperation));
export { SpreadsheetCellContextMenuOperation };
/**
 * @hidden
 */
var SpreadsheetHeaderMouseOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderMouseOperation, _super);
    function SpreadsheetHeaderMouseOperation() {
        return _super.call(this, SpreadsheetScrollRegion.$) || this;
    }
    SpreadsheetHeaderMouseOperation.prototype.get__y = function () {
        return typeCast(SpreadsheetColumnScrollRegion.$, this._ab);
    };
    Object.defineProperty(SpreadsheetHeaderMouseOperation.prototype, "_y", {
        get: function () {
            return this.get__y();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderMouseOperation.prototype.get__ae = function () {
        return typeCast(SpreadsheetRowScrollRegion.$, this._ab);
    };
    Object.defineProperty(SpreadsheetHeaderMouseOperation.prototype, "_ae", {
        get: function () {
            return this.get__ae();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetHeaderMouseOperation.prototype, "_az", {
        get: function () {
            return this._ab != null && this._ab._aw;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderMouseOperation.$t = markType(SpreadsheetHeaderMouseOperation, 'SpreadsheetHeaderMouseOperation', SpreadsheetMouseOperation$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetHeaderMouseOperation;
}(SpreadsheetMouseOperation$1));
export { SpreadsheetHeaderMouseOperation };
/**
 * @hidden
 */
var SpreadsheetHeaderContextMenuOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderContextMenuOperation, _super);
    function SpreadsheetHeaderContextMenuOperation() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetHeaderContextMenuOperation.prototype.get__ai = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetHeaderContextMenuOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderContextMenuOperation.prototype.get__aj = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetHeaderContextMenuOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderContextMenuOperation.prototype.get__z = function () {
        return 10;
    };
    Object.defineProperty(SpreadsheetHeaderContextMenuOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderContextMenuOperation.prototype._m = function (a) {
        var b = this._ab._ab;
        var c = b._m;
        if (c != null) {
            var d = a.h();
            if (c._d7(true)) {
                var e = this._ab;
                var f = typeCast(SpreadsheetRowScrollRegion.$, e) !== null;
                var g = e._z;
                var h = e._bx;
                var i = f ? d.y : d.x;
                var j = e._ag(i / h);
                var k = f ? b._bj : b._bi;
                if (i - j._m >= 0 && i - j._m <= 8) {
                    var l = e._m.indexOf(j);
                    if (e._av(l)) {
                        var m = 8;
                        var n = (e._bm(j, false) - e._bm(j, true)) * h;
                        if ((7 + 8) * 2 > n) {
                            m = Math.max(n * 0.25, 1);
                        }
                        if (i - j._m <= m) {
                            j = e._b7(j._j - 1);
                        }
                    }
                }
                if (SpreadsheetUtilities.a6(k, j._j) == false) {
                    var o = f ? new SpreadsheetCellRange(j._j, b._ac._i, j._j, b._ac._h) : new SpreadsheetCellRange(b._ad._i, j._j, b._ad._h, j._j);
                    var p = f ? new SpreadsheetCell(j._j, g.startIndex) : new SpreadsheetCell(g.startIndex, j._j);
                    if (false == b._resetSelection2(o, p, false)) {
                        return false;
                    }
                }
                c._v._ShowHeaderContextMenu$i(this._ab, d);
            }
        }
        return false;
    };
    SpreadsheetHeaderContextMenuOperation.prototype._u = function (a) {
    };
    SpreadsheetHeaderContextMenuOperation.$t = markType(SpreadsheetHeaderContextMenuOperation, 'SpreadsheetHeaderContextMenuOperation', SpreadsheetHeaderMouseOperation.$);
    return SpreadsheetHeaderContextMenuOperation;
}(SpreadsheetHeaderMouseOperation));
export { SpreadsheetHeaderContextMenuOperation };
/**
 * @hidden
 */
var SpreadsheetEnterEditModeOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetEnterEditModeOperation, _super);
    function SpreadsheetEnterEditModeOperation() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetEnterEditModeOperation.prototype.get__ai = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetEnterEditModeOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetEnterEditModeOperation.prototype.get__aj = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetEnterEditModeOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetEnterEditModeOperation.prototype.get__z = function () {
        return 10;
    };
    Object.defineProperty(SpreadsheetEnterEditModeOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetEnterEditModeOperation.prototype._m = function (a) {
        var b = this._ab.rowScrollRegion._ab._m;
        if (b != null) {
            b._gh(a.h(), this._ab);
        }
        return false;
    };
    SpreadsheetEnterEditModeOperation.prototype._u = function (a) {
    };
    SpreadsheetEnterEditModeOperation.$t = markType(SpreadsheetEnterEditModeOperation, 'SpreadsheetEnterEditModeOperation', SpreadsheetPaneMouseOperation.$);
    return SpreadsheetEnterEditModeOperation;
}(SpreadsheetPaneMouseOperation));
export { SpreadsheetEnterEditModeOperation };
/**
 * @hidden
 */
var SpreadsheetHeaderResizeOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderResizeOperation, _super);
    function SpreadsheetHeaderResizeOperation(a) {
        var _this = _super.call(this) || this;
        _this._a0 = 0;
        _this._a6 = 0;
        _this._a7 = 0;
        _this._ba = 0;
        _this._a9 = 0;
        _this._a8 = 0;
        _this._bb = 0;
        _this._a5 = null;
        _this._a2 = false;
        _this._a3 = false;
        _this._a1 = false;
        _this._bc = 0;
        _this._a0 = a;
        _this._a3 = a == 1;
        _this._a2 = a == 2;
        return _this;
    }
    SpreadsheetHeaderResizeOperation.prototype.get__ai = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetHeaderResizeOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderResizeOperation.prototype.get__aj = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetHeaderResizeOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderResizeOperation.prototype.get__z = function () {
        return this._az ? this._a3 ? 12 : 6 : this._a3 ? 13 : 5;
    };
    Object.defineProperty(SpreadsheetHeaderResizeOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderResizeOperation.prototype._an = function (a) {
        _super.prototype._an.call(this, a);
    };
    SpreadsheetHeaderResizeOperation.prototype._o = function (a, b) {
        _super.prototype._o.call(this, a, b);
        switch (b) {
            case 4:
            case 0:
                this._ab._cp = Nullable$1.toNullable(Number_$type, null);
                break;
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._m = function (a) {
        this._a1 = false;
        if (this._a2) {
            this._bf();
            return false;
        }
        this._ab._cp = Nullable$1.toNullable(Number_$type, this._bc);
        var b = a.h();
        var c = this._ab;
        var d = (this._az ? b.y : b.x) / c._bx;
        var e = c._b7(this._bc);
        var f = c._bm(e, false);
        this._a5 = null;
        this._bb = c._cf(this._bc + (this._a3 ? 1 : 0));
        this._a6 = d - f;
        this._a7 = d;
        this._a8 = d - this._a7;
        c._bp = d - this._a6;
        this._ba = Math.min(this._a6 - d, 0);
        this._a9 = c._b4(truncate(Math.max(c._ch - e._i + this._a6, 0)));
        return true;
    };
    SpreadsheetHeaderResizeOperation.prototype._s = function (a) {
        _super.prototype._s.call(this, a);
        if (this._i == 2) {
            this._be(a);
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._be = function (a) {
        var b = a.h();
        var c = this._ab;
        var d = (this._az ? b.y : b.x) / c._bx;
        var e = d - this._a7;
        e = Math.max(Math.min(e, this._a9), this._ba);
        if (e != this._a8) {
            this._a8 = e;
            var f = c._m;
            var g = c._l;
            var h = this._ay;
            if (this._az && (b.y < h.y || b.y >= h.bottom)) {
                this._a1 = true;
            }
            else if (!this._az && (b.x < h.x || b.x >= h.right)) {
                this._a1 = true;
            }
            else {
                this._a1 = false;
            }
            c._bp = (this._a1 ? this._a7 : d) - this._a6;
            g.beginUpdate();
            g.clear();
            if (this._a1 || CoreUtilities.c(e, 0) || (e < 0 && this._bb < 0)) {
                g._a3(f);
            }
            else if (this._bb < 0) {
                g._a3(f);
                var i = f.count == 0 ? 0 : Enumerable.ah(WorksheetItemPosition.$, f)._l;
                var j = c._b5(Math.max(e + c._bw - this._a6, 0));
                g.add(new WorksheetItemPosition(1, c._ci, i, j));
            }
            else if (e < 0) {
                if (this._a5 == null) {
                    this._a5 = c._a1(this._bc + 1);
                }
                var k = c._b5(Math.max(d + c._bw - this._a6, 0));
                for (var l = 0; l <= this._bb; l++) {
                    if (k <= 0) {
                        break;
                    }
                    var m = f._inner[l];
                    var n = Math.min(m._i, k);
                    k -= n;
                    g.add(new WorksheetItemPosition(1, m._j, m._m, n));
                }
                var o = g.count == 0 ? f._inner[0]._m : g._inner[g.count - 1]._l;
                for (var p = 0; p < this._a5.count; p++) {
                    var q = this._a5.item(p);
                    g.add(new WorksheetItemPosition(1, q._j, o, q._i));
                    o += q._i;
                }
            }
            else {
                for (var r = 0; r < this._bb; r++) {
                    g.add(f._inner[r]);
                }
                var s = this._a3 ? new WorksheetItemPosition(1, this._bc, f._inner[this._bb]._m, 0) : f._inner[this._bb];
                var t = c._b5(e) + s._i;
                g.add(new WorksheetItemPosition(1, s._j, s._m, t));
                var u = g._inner[g.count - 1]._l;
                var v = this._a3 ? this._bb : this._bb + 1;
                for (var w = v; w < f.count; w++) {
                    var x = f._inner[w];
                    g.add(new WorksheetItemPosition(1, x._j, u, x._i));
                    u += x._i;
                }
            }
            g.endUpdate();
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._u = function (a) {
        if (!this._a1 && !CoreUtilities.c(this._a8, 0)) {
            if (this._l != null) {
                var b = this._az;
                var c = b ? 2 : 3;
                var d = SpreadsheetHeaderResizeOperation._a4(this._ab._ab, b, this._bc);
                this._l(c, d, runOn(this, this._bh));
            }
            else {
                this._bh();
            }
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._g = function (a) {
        return 2;
    };
    SpreadsheetHeaderResizeOperation.prototype._ap = function (a) {
        _super.prototype._ap.call(this, a);
        a._cp = Nullable$1.toNullable(Number_$type, null);
        this._a1 = false;
    };
    SpreadsheetHeaderResizeOperation.prototype._bd = function (a) {
        if (nullableNotEquals(a, null)) {
            if (this._ab.startIndex > a.value._h || this._ab.endIndex < a.value._i) {
                var b = this._ab._o;
                if (b != null) {
                    var c = Nullable$1.toNullable(IntRange.$, null);
                    var d = c;
                    var e = c;
                    if (this._az) {
                        d = a;
                    }
                    else {
                        e = a;
                    }
                    b._scrollRangeIntoView$i(b.activePane, d, e);
                }
            }
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._bf = function () {
        if (this._l != null) {
            var a = this._az;
            var b = a ? 2 : 3;
            var c = SpreadsheetHeaderResizeOperation._a4(this._ab._ab, a, this._bc);
            this._l(b, c, runOn(this, this._bg));
        }
        else {
            this._bg();
        }
    };
    SpreadsheetHeaderResizeOperation.prototype._bg = function () {
        var a = this._ab._ab;
        var b = this._az;
        if (SpreadsheetHeaderResizeOperation._a4(a, b, this._bc)) {
            SpreadsheetHeaderResizeOperation._bi(a, b, this._ab, -1);
            this._bd(Nullable$1.toNullable(IntRange.$, SpreadsheetUtilities.cy(b ? a._bj : a._bi, this._bc).value));
        }
        else {
            this._ab._ak(-1, this._bc);
            this._bd(Nullable$1.toNullable(IntRange.$, new IntRange(1, this._bc, this._bc)));
        }
    };
    SpreadsheetHeaderResizeOperation._a4 = function (a, b, c) {
        var e_115, _0, e_116, _1;
        var d = false;
        try {
            for (var _2 = tslib_1.__values(fromEnum(a.cellRanges)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var e = _3.value;
                if (b && e.firstRow <= c && c <= e.lastRow) {
                    d = true;
                    break;
                }
                else if (!b && e.firstColumn <= c && c <= e.lastColumn) {
                    d = true;
                    break;
                }
            }
        }
        catch (e_115_1) { e_115 = { error: e_115_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_115) throw e_115.error; }
        }
        if (d) {
            try {
                for (var _4 = tslib_1.__values(fromEnum(a.cellRanges)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var f = _5.value;
                    if (b && !a._a0(f)) {
                        d = false;
                        break;
                    }
                    else if (!b && !a._az(f)) {
                        d = false;
                        break;
                    }
                }
            }
            catch (e_116_1) { e_116 = { error: e_116_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_116) throw e_116.error; }
            }
        }
        return d;
    };
    SpreadsheetHeaderResizeOperation.prototype._bh = function () {
        var a = this._ab;
        var b = a._ab;
        var c = this._az;
        var d = SpreadsheetHeaderResizeOperation._a4(b, c, this._bc);
        if (this._a8 > 0) {
            var e = this._a3 ? 0 : a._m._inner[this._bb]._i;
            var f = (e + a._b5(this._a8));
            var g = a._o != null ? a._o.activePane : null;
            if (d) {
                SpreadsheetHeaderResizeOperation._bi(b, c, a, f);
                this._bd(Nullable$1.toNullable(IntRange.$, SpreadsheetUtilities.cy(c ? b._bj : b._bi, this._bc).value));
            }
            else {
                a._ak(f, this._bc);
                this._bd(Nullable$1.toNullable(IntRange.$, new IntRange(1, this._bc, this._bc)));
            }
        }
        else {
            var h = a._m;
            var i = a._l;
            var j = this._a3 ? this._bb : this._bb + 1;
            if (d) {
                var k = 0;
                for (var l = 0; l < i.count; l++) {
                    if (i._inner[l]._j == this._bc) {
                        k = i._inner[l]._i;
                        break;
                    }
                }
                SpreadsheetHeaderResizeOperation._bi(b, c, a, k);
            }
            else {
                var m = 0;
                for (; m < j; m++) {
                    if (m >= i.count) {
                        break;
                    }
                    var n = h._inner[m];
                    var o = i._inner[m];
                    if (n._j != o._j) {
                        break;
                    }
                    if (n._i != o._i) {
                        a._ak(o._i, o._j);
                    }
                }
                if (m == j - 1) {
                    a._ak(0, h._inner[m]._j);
                }
                else if (m < j) {
                    var p = new Array(1);
                    p[0] = new IntRange(1, h._inner[m]._j, h._inner[j - 1]._j);
                    a._am(0, p);
                }
            }
        }
    };
    SpreadsheetHeaderResizeOperation._bi = function (a, b, c, d) {
        var e = b ? a._bg : a._bf;
        var f = b ? a._am : a._al;
        if (f) {
            c._al(d);
        }
        else {
            c._am(d, Enumerable.a(IntRange.$, e));
        }
    };
    SpreadsheetHeaderResizeOperation.$t = markType(SpreadsheetHeaderResizeOperation, 'SpreadsheetHeaderResizeOperation', SpreadsheetHeaderMouseOperation.$);
    return SpreadsheetHeaderResizeOperation;
}(SpreadsheetHeaderMouseOperation));
export { SpreadsheetHeaderResizeOperation };
/**
 * @hidden
 */
var SpreadsheetInteractionManager$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetInteractionManager$1, _super);
    function SpreadsheetInteractionManager$1($t, a, b) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this.h = null;
        _this.j = null;
        _this.a = 0;
        _this.c = null;
        _this.f = 0;
        _this.b = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        CoreUtilities.y(a);
        _this.b = b;
        var c = PropertyChangeListenerList.e(_this.$t, _this.h, a, _this, true);
        _this.h = c.p0;
        _this.n();
        return _this;
    }
    Object.defineProperty(SpreadsheetInteractionManager$1.prototype, "e", {
        get: function () {
            return this.c;
        },
        set: function (a) {
            if (a != this.c) {
                if (this.c != null) {
                    this.c._a3 = null;
                }
                this.c = a;
                if (this.c != null) {
                    this.c._a3 = this.j;
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInteractionManager$1.prototype, "g", {
        get: function () {
            return this.f;
        },
        set: function (a) {
            if (a != this.f) {
                this.f = a;
                this.b.onCursorChanged(a);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInteractionManager$1.prototype, "i", {
        get: function () {
            return this.h;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetInteractionManager$1.prototype.m = function (a, b, c) {
        var d = this.d;
        if (d != null) {
            var e = d.activePane;
            var f = typeCast(SpreadsheetPaneManager.$, e._s);
            if (f != null) {
                d._gi(a, c, void 0, void 0, void 0, b);
                return;
            }
        }
        c();
    };
    SpreadsheetInteractionManager$1.prototype.n = function () {
        var a = this.j != null ? this.j._z : 0;
        this.g = a;
    };
    SpreadsheetInteractionManager$1.prototype.o = function () {
        var a = this.d;
        this.e = a;
    };
    SpreadsheetInteractionManager$1.prototype.p = function () {
        this.e = null;
        if (this.j != null) {
            this.j._n();
        }
        this.v();
    };
    SpreadsheetInteractionManager$1.prototype.l = function (a) {
        var b = false;
        var c = this.d;
        if (c != null) {
            b = true;
            if (!c._d7(true)) {
                return b;
            }
            this.b.focusControlIfNeeded();
        }
        if (!a.c()) {
            return b;
        }
        if (this.j != null && this.j._i != 0) {
            b = true;
            var d = this.j._g(a);
            if (d == 2) {
                return b;
            }
            a.f();
            if (d == 1) {
                return b;
            }
        }
        this.w(a);
        if (this.j != null) {
            this.a = a.a();
            this.j._p(a);
            b = true;
            this.w(a);
        }
        return b;
    };
    SpreadsheetInteractionManager$1.prototype.q = function (a) {
        this.w(a);
        if (this.j != null) {
            this.j._q(a);
        }
    };
    SpreadsheetInteractionManager$1.prototype.r = function (a) {
        if (this.j != null) {
            this.j._r(a);
            this.v();
        }
    };
    SpreadsheetInteractionManager$1.prototype.s = function (a) {
        this.w(a);
        if (this.j != null) {
            this.j._s(a);
        }
    };
    SpreadsheetInteractionManager$1.prototype.t = function (a) {
        if (this.j != null) {
            if (a.a() == this.a || this.a == 0) {
                this.e = null;
                this.j._t(a);
            }
            this.w(a);
        }
    };
    SpreadsheetInteractionManager$1.prototype.u = function (a, b, c) {
        if (a == this.j) {
            switch (b) {
                case "Cursor":
                    this.n();
                    break;
                case "ToolTip":
                    this.x();
                    break;
            }
        }
    };
    SpreadsheetInteractionManager$1.prototype.v = function () {
        if (this.j != null && this.j._i == 0) {
            this.e = null;
            this.j._l = null;
            this.j._am(null, Rect.empty, Rect.empty);
            this.j = null;
            this.n();
        }
    };
    SpreadsheetInteractionManager$1.prototype.w = function (a) {
        if (this.j == null || this.j._i == 0) {
            var b = this.k(a);
            if (b != this.j) {
                var c = this.j;
                this.j = b;
                if (c != null) {
                    c._am(null, Rect.empty, Rect.empty);
                    c._l = null;
                    SpreadsheetUtilities.ec(c, this);
                }
                if (b != null) {
                    SpreadsheetUtilities.d6(b, this, false);
                }
                this.a = 0;
                var d = this.e;
                if (d != null) {
                    this.e = null;
                    if (b != null) {
                        this.e = d;
                    }
                }
                if (b != null) {
                    var e = this.d;
                    var f = this.b._getRelativeSpreadsheetControlBounds$i();
                    var g = this.b._getLayerContainerSize$i();
                    b._l = runOn(this, this.m);
                    b._am(this.i, new Rect(0, 0, 0, g.width, g.height), f);
                }
                this.n();
                this.x();
            }
        }
    };
    SpreadsheetInteractionManager$1.prototype.x = function () {
        var a = this.d;
        var b = this.b.isToolTipAllowed();
        if (this.j == null || this.j._k == null || b == false) {
            this.b.hideToolTip();
        }
        if (b && this.j != null && this.j._k != null) {
            this.b.showToolTip(this.j._k);
        }
    };
    SpreadsheetInteractionManager$1.prototype.onPropertyValueChanged = function (a, b, c) {
        this.u(a, b, c);
    };
    SpreadsheetInteractionManager$1.$t = markType(SpreadsheetInteractionManager$1, 'SpreadsheetInteractionManager$1', Base.$, [IPropertyChangeListener_$type]);
    return SpreadsheetInteractionManager$1;
}(Base));
export { SpreadsheetInteractionManager$1 };
/**
 * @hidden
 */
var SpreadsheetMenuBuilder_InitializeItemsState$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetMenuBuilder_InitializeItemsState$1, _super);
    function SpreadsheetMenuBuilder_InitializeItemsState$1($t) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this.d = new LongValue();
        _this.c = new SpreadsheetCell();
        _this.e = null;
        _this.a = 0;
        _this.f = null;
        _this.b = null;
        _this.g = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        return _this;
    }
    SpreadsheetMenuBuilder_InitializeItemsState$1.$t = markType(SpreadsheetMenuBuilder_InitializeItemsState$1, 'SpreadsheetMenuBuilder_InitializeItemsState$1');
    return SpreadsheetMenuBuilder_InitializeItemsState$1;
}(Base));
export { SpreadsheetMenuBuilder_InitializeItemsState$1 };
/**
 * @hidden
 */
var SpreadsheetMouseOperation_ScrollTimer$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetMouseOperation_ScrollTimer$1, _super);
    function SpreadsheetMouseOperation_ScrollTimer$1($t, a) {
        var _this = _super.call(this) || this;
        _this.$t = null;
        _this.b = null;
        _this.a = null;
        _this.d = false;
        _this.c = null;
        _this.$t = $t;
        _this.$type = _this.$type.specialize(_this.$t);
        _this.c = a;
        return _this;
    }
    Object.defineProperty(SpreadsheetMouseOperation_ScrollTimer$1.prototype, "e", {
        get: function () {
            return this.a != null && this.a.b;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetMouseOperation_ScrollTimer$1.prototype.g = function (a, b, c) {
        this.d = b;
        this.b = a;
        if (this.a == null) {
            this.a = new PlatformTimer();
            var d = this.a;
            d.tick = delegateCombine(d.tick, runOn(this, this.f));
        }
        if (!this.a.b) {
            this.a.g = c;
            this.a.k();
        }
        else {
            this.a.g = c;
        }
    };
    SpreadsheetMouseOperation_ScrollTimer$1.prototype.h = function () {
        if (this.a != null) {
            this.a.l();
        }
    };
    SpreadsheetMouseOperation_ScrollTimer$1.prototype.f = function (a, b) {
        this.b._x._an(this.d ? 4 : 1);
        this.c();
    };
    SpreadsheetMouseOperation_ScrollTimer$1.$t = markType(SpreadsheetMouseOperation_ScrollTimer$1, 'SpreadsheetMouseOperation_ScrollTimer$1');
    return SpreadsheetMouseOperation_ScrollTimer$1;
}(Base));
export { SpreadsheetMouseOperation_ScrollTimer$1 };
/**
 * @hidden
 */
var SpreadsheetPaneInteractionManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneInteractionManager, _super);
    function SpreadsheetPaneInteractionManager(a, b) {
        var _this = _super.call(this, SpreadsheetPane.$, a, b) || this;
        _this.ab = null;
        _this.aa = null;
        _this.y = null;
        _this.z = null;
        _this.ab = new SpreadsheetEnterEditModeOperation();
        _this.aa = new SpreadsheetCellSelectionOperation();
        _this.y = new SpreadsheetCellContextMenuOperation();
        _this.z = new SpreadsheetCellDropDownOperation();
        return _this;
    }
    SpreadsheetPaneInteractionManager.prototype.get_d = function () {
        return this.i.selection._m;
    };
    Object.defineProperty(SpreadsheetPaneInteractionManager.prototype, "d", {
        get: function () {
            return this.get_d();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneInteractionManager.prototype.k = function (a) {
        var b = this.d != null && this.d.isInEditMode;
        if (b == false && a.c() && a.a() == 1 && a.g() == 0 && a.e() == 2) {
            return this.ab;
        }
        var c = a.h();
        var d = this.i;
        var e = d._q;
        for (var f = 0; f < e.count; f++) {
            if (e._inner[f].g.containsLocation(c.x, c.y)) {
                return this.z;
            }
        }
        if (a.c() && a.a() == 2) {
            return this.y;
        }
        var g = d.rowScrollRegion;
        if (g._m.count > 0) {
            var h = d.columnScrollRegion;
            if (h._m.count > 0) {
                if ((c.x <= h._bm(Enumerable.ah(WorksheetItemPosition.$, h._m), false) * h._bx) && (c.y <= g._bm(Enumerable.ah(WorksheetItemPosition.$, g._m), false) * g._bx)) {
                    return this.aa;
                }
            }
        }
        return null;
    };
    SpreadsheetPaneInteractionManager.$t = markType(SpreadsheetPaneInteractionManager, 'SpreadsheetPaneInteractionManager', SpreadsheetInteractionManager$1.$.specialize(SpreadsheetPane.$));
    return SpreadsheetPaneInteractionManager;
}(SpreadsheetInteractionManager$1));
export { SpreadsheetPaneInteractionManager };
/**
 * @hidden
 */
var SpreadsheetScrollRegionInteractionManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetScrollRegionInteractionManager, _super);
    function SpreadsheetScrollRegionInteractionManager(a, b) {
        var _this = _super.call(this, SpreadsheetScrollRegion.$, a, b) || this;
        _this.ac = null;
        _this.aa = null;
        _this.ab = null;
        _this.z = null;
        _this.y = null;
        _this.ac = new SpreadsheetHeaderSelectionOperation();
        _this.aa = new SpreadsheetHeaderResizeOperation(0);
        _this.ab = new SpreadsheetHeaderResizeOperation(1);
        _this.z = new SpreadsheetHeaderResizeOperation(2);
        _this.y = new SpreadsheetHeaderContextMenuOperation();
        return _this;
    }
    SpreadsheetScrollRegionInteractionManager.prototype.get_d = function () {
        return this.i._ab._m;
    };
    Object.defineProperty(SpreadsheetScrollRegionInteractionManager.prototype, "d", {
        get: function () {
            return this.get_d();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetScrollRegionInteractionManager.prototype.k = function (a) {
        var b = a.h();
        var c = this.i;
        var d = typeCast(SpreadsheetRowScrollRegion.$, c) !== null;
        var e = d ? b.y : b.x;
        var f = c._i(true);
        var g = 8;
        var h = 7;
        var i = this.d;
        var j = i != null && i.isInEditMode;
        var k = i._ct(d);
        var l = this.ab;
        var m = this.aa;
        if (j == false && a.c() && a.a() == 1 && a.e() == 2) {
            m = this.z;
            l = this.z;
        }
        if (a.c() && a.a() == 2) {
            return this.y;
        }
        if (f.length == 0 && nullableEquals(c._cr, null)) {
            if (k && e < h) {
                l._bc = c._ci;
                return l;
            }
        }
        else {
            for (var n = 1; n < f.length; n++) {
                if (e < f[n]) {
                    var o = f[n] - e;
                    var p = e - f[n - 1];
                    var q = f[n] - f[n - 1];
                    if ((7 + 8) * 2 > q) {
                        g = Math.max(q * 0.25, 1);
                        h = Math.max(q * 0.25, 1);
                    }
                    if (k && j == false) {
                        if (p < g) {
                            if (c._av(n - 1)) {
                                l._bc = c._m._inner[n - 1]._j - 1;
                                return l;
                            }
                            if (n != 1) {
                                m._bc = c._m._inner[n - 2]._j;
                                return m;
                            }
                        }
                        else if (o < h) {
                            m._bc = c._m._inner[n - 1]._j;
                            return m;
                        }
                    }
                    if (this.b.isMouseOver()) {
                        this.ac._a3 = Nullable$1.toNullable(Number_$type, c._m._inner[n - 1]._j);
                    }
                    else {
                        this.ac._a3 = Nullable$1.toNullable(Number_$type, null);
                    }
                    return this.ac;
                }
            }
            if (k && j == false && nullableEquals(c._cq, null) && Enumerable.ah(WorksheetItemPosition.$, c._m)._j < c._ci) {
                l._bc = c._ci;
                return l;
            }
        }
        return null;
    };
    SpreadsheetScrollRegionInteractionManager.$t = markType(SpreadsheetScrollRegionInteractionManager, 'SpreadsheetScrollRegionInteractionManager', SpreadsheetInteractionManager$1.$.specialize(SpreadsheetScrollRegion.$));
    return SpreadsheetScrollRegionInteractionManager;
}(SpreadsheetInteractionManager$1));
export { SpreadsheetScrollRegionInteractionManager };
/**
 * @hidden
 */
var SpreadsheetCellSelectionOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellSelectionOperation, _super);
    function SpreadsheetCellSelectionOperation() {
        var _this = _super.call(this) || this;
        _this._a3 = null;
        _this._ba = false;
        _this._a9 = false;
        _this._az = 10;
        _this._a0 = null;
        _this._a7 = null;
        _this._a8 = null;
        _this._br = null;
        _this._bc = 0;
        _this._bb = null;
        _this._be = Nullable$1.toNullable(SpreadsheetCell.$, null);
        _this._a2 = null;
        _this._a7 = new PropertyChangeListener$1(SpreadsheetCellSelectionOperation.$, _this, SpreadsheetCellSelectionOperation._bk, false);
        _this._bb = new Dictionary$2(SpreadsheetCell.$, Rect.$, 0);
        return _this;
    }
    SpreadsheetCellSelectionOperation.prototype.get__ai = function () {
        return this._ab.columnScrollRegion == this._ab.columnScrollRegion._o.activePane.columnScrollRegion;
    };
    Object.defineProperty(SpreadsheetCellSelectionOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellSelectionOperation.prototype.get__aj = function () {
        return this._ab.rowScrollRegion == this._ab.rowScrollRegion._o.activePane.rowScrollRegion;
    };
    Object.defineProperty(SpreadsheetCellSelectionOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellSelectionOperation.prototype.get__z = function () {
        return this._az;
    };
    Object.defineProperty(SpreadsheetCellSelectionOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellSelectionOperation.prototype._af = function () {
        var _this = this;
        var a = this._x;
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(this._be, Nullable$1.toNullable(SpreadsheetCell.$, null)) && this._ab != null && a != null && this._i == 0) {
            var b_2 = a.h();
            var c = this._ab.rowScrollRegion._bx;
            var d = this._ab.columnScrollRegion._ag(b_2.x / c);
            var e = this._ab.rowScrollRegion._ag(b_2.y / c);
            var f = this._ab.rowScrollRegion._ab;
            var g_7 = this._ab.rowScrollRegion._cf(e._j);
            var h_11 = this._ab.columnScrollRegion._cf(d._j);
            var i_9;
            var j_7 = ((function () { var k = _this._bf(g_7, h_11, i_9); i_9 = k.p2; return k.ret; })());
            if (j_7 != null) {
                if (SpreadsheetUtilities.be(i_9)) {
                    var k = 4;
                    var l = this._ab._k.item(g_7 + 1, h_11 + 1);
                    var m = l != null && l.r;
                    var n = this._ab.rowScrollRegion._bn(m ? l.ag : e._j, false) * c;
                    var o = this._ab.columnScrollRegion._bn(m ? l.ab : d._j, true) * c;
                    var p = this._ab.columnScrollRegion._bn(m ? l.x : d._j, false) * c;
                    if (this._ay.isEmpty == false) {
                        if (n > this._ay.bottom) {
                            n = this._ay.bottom;
                        }
                        if (o < this._ay.left) {
                            o = this._ay.left;
                        }
                        if (p > this._ay.right) {
                            p = this._ay.right;
                        }
                    }
                    b_2 = SpreadsheetUtilities.e3((o + (p - o) / 2), n + k);
                }
                else {
                    b_2 = { $type: Point_$type, x: b_2.x, y: b_2.y + 10 };
                }
                return ((function () {
                    var $ret = new SpreadsheetToolTipContext();
                    $ret.d = b_2;
                    $ret.b = j_7;
                    $ret.a = i_9;
                    return $ret;
                })());
            }
        }
        return null;
    };
    SpreadsheetCellSelectionOperation.prototype._an = function (a) {
        this._a1 = a._s.spreadsheetOwnerState;
        _super.prototype._an.call(this, a);
    };
    SpreadsheetCellSelectionOperation.prototype._o = function (a, b) {
        if (b == 0) {
            this._bh();
            this._bg();
            this._a9 = false;
        }
        this._bq();
        _super.prototype._o.call(this, a, b);
    };
    SpreadsheetCellSelectionOperation.prototype._m = function (a) {
        var _this = this;
        this._au(a);
        var b = a.h();
        var c = this._ab.rowScrollRegion._bx;
        var d = this._ab.columnScrollRegion._ag(b.x / c);
        var e = this._ab.rowScrollRegion._ag(b.y / c);
        var f = this._ab.rowScrollRegion._ab;
        this._br = b;
        if (!f._a3()) {
            return false;
        }
        var g = a.g();
        var h = new SpreadsheetCell(e._j, d._j);
        var i = this._ab._s.getCellRange(h);
        var j = f._x;
        var k = this._ab._s.canSelect(h);
        var l = ((g & 4) != 0) || j == 1;
        var m = ((g & 2) != 0) || j == 2;
        var n = false;
        var o = null;
        if (m == l) {
            if (!this._ah()) {
                return false;
            }
            if (m == false) {
                o = ((function () { var p = _this._a4(b, d, e); d = p.p1; e = p.p2; return p.ret; })());
            }
            f = this._ab.rowScrollRegion._ab;
            if (k) {
                n = f._a9(i._c);
            }
        }
        else if (!k) {
        }
        else if (m) {
            if (f._ao(h)) {
                this._a2 = new UnselectionHelper(h, f);
                n = true;
            }
            else {
                n = f._ah(h);
            }
        }
        else if (SpreadsheetCell.l_op_Inequality(h, f.activeCell)) {
            n = f._as(h);
        }
        this._a6 = o;
        this._bo();
        if (this._a6 != null) {
            this._bm();
        }
        return n;
    };
    SpreadsheetCellSelectionOperation.prototype._s = function (a) {
        var _this = this;
        this._au(a);
        var b = a.h();
        var c = this._ab;
        var d = c.rowScrollRegion._bx;
        var e = c.columnScrollRegion._ag(b.x / d);
        var f = c.rowScrollRegion._ag(b.y / d);
        var g = c.rowScrollRegion._ab;
        if (this._i == 0) {
            var h_12, i_10;
            this._a6 = ((function () { var j = _this._a5(b, e, f, h_12, i_10); e = j.p1; f = j.p2; h_12 = j.p3; i_10 = j.p4; return j.ret; })());
            var j = c._k != null ? c._k.item(h_12 + 1, i_10 + 1) : null;
            var k = j != null && j.r ? new SpreadsheetCell(j.ak, j.ab) : new SpreadsheetCell(f._j, e._j);
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(Nullable$1.toNullable(SpreadsheetCell.$, k), this._be)) {
                this._al();
                this._be = Nullable$1.toNullable(SpreadsheetCell.$, k);
                var l_6;
                if (((function () { var m = _this._bf(h_12, i_10, l_6); l_6 = m.p2; return m.ret; })()) != null) {
                    if (SpreadsheetUtilities.be(l_6) == false || this._a6 != null) {
                        this._ar();
                    }
                }
            }
        }
        if (this._i == 2) {
            var m = new SpreadsheetCell(f._j, e._j);
            if (this._a2 != null) {
                this._a2.g(m);
            }
            else if (c._s.canSelect(m)) {
                g._as(m);
            }
        }
        this._bo();
        _super.prototype._s.call(this, a);
    };
    SpreadsheetCellSelectionOperation.prototype._u = function (a) {
        var _this = this;
        this._au(a);
        this._al();
        var b = this._ab;
        var c = a.h();
        var d = b.rowScrollRegion._bx;
        var e = b.columnScrollRegion._ag(c.x / d);
        var f = b.rowScrollRegion._ag(c.y / d);
        var g = ((function () { var h = _this._a4(c, e, f); e = h.p1; f = h.p2; return h.ret; })());
        if (this._a0 != null && this._a6 != null && this._a9 == false && g == this._a6) {
            if (this._a0._p != null) {
                this._a0._p(g);
            }
        }
        else {
            this._a6 = g;
        }
        this._bg();
        this._a9 = false;
        this._bn();
        this._bo();
        if (this._a2 != null) {
            var h = this._a2;
            this._a2 = null;
            h.e();
        }
    };
    SpreadsheetCellSelectionOperation.prototype._g = function (a) {
        this._au(a);
        return 1;
    };
    SpreadsheetCellSelectionOperation.prototype._ap = function (a) {
        this._au(null);
        this._a6 = null;
        this._bo();
        this._a1 = null;
        this._al();
        this._bh();
        _super.prototype._ap.call(this, a);
    };
    Object.defineProperty(SpreadsheetCellSelectionOperation.prototype, "_a6", {
        get: function () {
            return this._a3;
        },
        set: function (a) {
            if (a != this._a3) {
                this._a9 = false;
                this._a3 = a;
                this._bq();
                this._al();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellSelectionOperation.prototype, "_a1", {
        get: function () {
            return this._a0;
        },
        set: function (a) {
            var b = PropertyChangeListenerList.e(SpreadsheetOwnerState.$, this._a0, a, this._a7, true);
            this._a0 = b.p0;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellSelectionOperation.prototype._bg = function () {
        var a = this._a8;
        this._a8 = null;
        if (a != null) {
            a.c();
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bh = function () {
        if (this._a2 != null) {
            var a = this._a2;
            this._a2 = null;
            a.d();
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bi = function () {
    };
    SpreadsheetCellSelectionOperation.prototype._bj = function () {
    };
    SpreadsheetCellSelectionOperation.prototype._a4 = function (a, b, c) {
        var _this = this;
        var d, e;
        return {
            ret: ((function () { var f = _this._a5(a, b, c, d, e); b = f.p1; c = f.p2; d = f.p3; e = f.p4; return f.ret; })()),
            p1: b,
            p2: c
        };
    };
    SpreadsheetCellSelectionOperation.prototype._a5 = function (a, b, c, d, e) {
        var _this = this;
        this._bp();
        d = this._ab.rowScrollRegion._cf(c._j);
        e = this._ab.columnScrollRegion._cf(b._j);
        if (e < 0 || d < 0) {
            return {
                ret: null,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        if (this._ab._l == null) {
            return {
                ret: null,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var f = this._ab._l.item(d + 1, e + 1);
        var g = this._ab._k.item(d + 1, e + 1);
        if (g != null) {
            var h_13 = c._j;
            var i_11 = b._j;
            if (g != null && g.r) {
                h_13 = g.ak;
                i_11 = g.ab;
            }
            var j_8;
            if (this._bb.count > 0 && ((function () { var k = _this._bb.tryGetValue(new SpreadsheetCell(h_13, i_11), j_8); j_8 = k.p1; return k.ret; })())) {
                if (j_8.containsPoint(a) == false) {
                    return {
                        ret: null,
                        p1: b,
                        p2: c,
                        p3: d,
                        p4: e
                    };
                }
            }
        }
        return {
            ret: f,
            p1: b,
            p2: c,
            p3: d,
            p4: e
        };
    };
    SpreadsheetCellSelectionOperation.prototype._bf = function (a, b, c) {
        var d = this._ab;
        if (d != null && d._l != null) {
            var e = d._l.item(a + 1, b + 1);
            if (e != null) {
                if (stringIsNullOrEmpty(e.toolTip) == false) {
                    c = 3;
                    return {
                        ret: e.toolTip,
                        p2: c
                    };
                }
                var f = e.targetAddress;
                if (!stringIsNullOrEmpty(f)) {
                    c = 2;
                    return {
                        ret: SpreadsheetUtilities.di(this._a0 != null ? this._a0._h : null, "DefaultHyperlinkToolTip", f),
                        p2: c
                    };
                }
            }
            var g = d._k.item(a + 1, b + 1);
            if (g != null && g.k && this._a0 != null) {
                if (g.q) {
                    c = 1;
                    return {
                        ret: SpreadsheetUtilities.di(this._a0._h, "InvalidDateTimeToolTip"),
                        p2: c
                    };
                }
                var h = new SpreadsheetCell(d.rowScrollRegion._m._inner[a]._j, d.columnScrollRegion._m._inner[b]._j);
                c = 0;
                return {
                    ret: this._a0._w(h),
                    p2: c
                };
            }
        }
        c = 0;
        return {
            ret: null,
            p2: c
        };
    };
    SpreadsheetCellSelectionOperation.prototype._al = function () {
        this._be = Nullable$1.toNullable(SpreadsheetCell.$, null);
        _super.prototype._al.call(this);
    };
    SpreadsheetCellSelectionOperation.prototype._ao = function (a, b) {
        _super.prototype._ao.call(this, a, b);
        if (b == null) {
            this._bn();
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bl = function (a, b, c) {
        if (a == this._a0) {
            switch (b) {
                case "IsInEditMode":
                    this._bo();
                    break;
            }
        }
    };
    SpreadsheetCellSelectionOperation._bk = function (a, b, c, d) {
        a._bl(b, c, d);
    };
    SpreadsheetCellSelectionOperation.prototype._bm = function () {
        var _this = this;
        if (this._a8 == null) {
            this._a8 = new TimedOperation(function () {
                _this._a9 = true;
                _this._bg();
                _this._bo();
            }, 1000);
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bn = function () {
        var a = this._x;
        if (a == null || this._ab == null) {
            this._ba = false;
        }
        else {
            var b = a.g();
            this._ba = ((b & 4) != 0) || ((b & 2) != 0);
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bo = function () {
        var a = this._a0 != null && this._a0._s;
        var b = this._a3 != null && this._ba == false && a == false && this._a9 == false ? 17 : 10;
        if (b != this._az) {
            this._az = b;
            this.a("Cursor");
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bp = function () {
        if (this._ab == null) {
            this._bb.clear();
        }
        else if (this._bc != this._ab._ao) {
            this._bc = this._ab._ao;
            this._bb.clear();
            var a = this._ab._ap;
            if (a != null && this._ab._l != null && this._ab._l.c && this._ab._p.count > 0) {
                this._ab.selection._m._v.addCellTextLocations(this._bb, this._ab);
            }
        }
    };
    SpreadsheetCellSelectionOperation.prototype._bq = function () {
        if (this._a6 != null && this._i == 0) {
            this._bj();
        }
        else {
            this._bi();
        }
    };
    SpreadsheetCellSelectionOperation.$t = markType(SpreadsheetCellSelectionOperation, 'SpreadsheetCellSelectionOperation', SpreadsheetPaneMouseOperation.$);
    return SpreadsheetCellSelectionOperation;
}(SpreadsheetPaneMouseOperation));
export { SpreadsheetCellSelectionOperation };
/**
 * @hidden
 */
var SpreadsheetHeaderSelectionOperation = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderSelectionOperation, _super);
    function SpreadsheetHeaderSelectionOperation() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._a2 = Nullable$1.toNullable(Number_$type, null);
        _this._a0 = null;
        return _this;
    }
    SpreadsheetHeaderSelectionOperation.prototype.get__ai = function () {
        return this._y != null && this._ab == this._ab._o.activePane.columnScrollRegion;
    };
    Object.defineProperty(SpreadsheetHeaderSelectionOperation.prototype, "_ai", {
        get: function () {
            return this.get__ai();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionOperation.prototype.get__aj = function () {
        return this._ae != null && this._ab == this._ab._o.activePane.rowScrollRegion;
    };
    Object.defineProperty(SpreadsheetHeaderSelectionOperation.prototype, "_aj", {
        get: function () {
            return this.get__aj();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionOperation.prototype.get__z = function () {
        return this._az ? 11 : 9;
    };
    Object.defineProperty(SpreadsheetHeaderSelectionOperation.prototype, "_z", {
        get: function () {
            return this.get__z();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionOperation.prototype._an = function (a) {
        _super.prototype._an.call(this, a);
        a._co = this._a2;
    };
    SpreadsheetHeaderSelectionOperation.prototype._o = function (a, b) {
        if (b == 0) {
            this._a4();
        }
        _super.prototype._o.call(this, a, b);
    };
    SpreadsheetHeaderSelectionOperation.prototype._m = function (a) {
        var b = a.h();
        var c = this._ab._bx;
        var d = this._az;
        var e = d ? b.y : b.x;
        var f = this._ab._ag(e / c);
        var g = this._ab._ab;
        if (!g._a3()) {
            return false;
        }
        var h = a.g();
        var i = this._ab._z.startIndex;
        var j = d ? new SpreadsheetCell(f._j, i) : new SpreadsheetCell(i, f._j);
        var k = d ? new SpreadsheetCellRange(f._j, g._ac._i, f._j, g._ac._h) : new SpreadsheetCellRange(g._ad._i, f._j, g._ad._h, f._j);
        var l = g._x;
        var m = this._ab._o.canSelect1(k);
        var n = ((h & 4) != 0) || l == 1;
        var o = ((h & 2) != 0) || l == 2;
        var p = false;
        if (o == n) {
            if (!this._ah()) {
                return false;
            }
            g = this._ab._ab;
            if (m) {
                p = g._resetSelection2(k, j, false);
            }
        }
        else if (!m) {
        }
        else if (o) {
            if (g._ap(k)) {
                this._a0 = new UnselectionHelper(j, g);
                this._a0.h(k);
                p = true;
            }
            else {
                p = g._addActiveCellRange1(k, j, false);
            }
        }
        else if (SpreadsheetCell.l_op_Inequality(j, g.activeCell)) {
            p = g._at(k, false);
        }
        return p;
    };
    SpreadsheetHeaderSelectionOperation.prototype._q = function (a) {
        _super.prototype._q.call(this, a);
    };
    SpreadsheetHeaderSelectionOperation.prototype._r = function (a) {
        this._ab._co = Nullable$1.toNullable(Number_$type, null);
        _super.prototype._r.call(this, a);
    };
    SpreadsheetHeaderSelectionOperation.prototype._s = function (a) {
        if (this._i == 2) {
            this._a5(a);
        }
        _super.prototype._s.call(this, a);
    };
    SpreadsheetHeaderSelectionOperation.prototype._a5 = function (a) {
        var b = a.h();
        var c = this._ab._bx;
        var d = this._az;
        var e = d ? b.y : b.x;
        var f = this._ab._ag(e / c);
        var g = this._ab._ab;
        var h = d ? new SpreadsheetCellRange(f._j, g._ac._i, f._j, g._ac._h) : new SpreadsheetCellRange(g._ad._i, f._j, g._ad._h, f._j);
        if (this._a0 != null) {
            this._a0.h(h);
        }
        else if (this._ab._o.canSelect1(h)) {
            g._at(h, false);
        }
    };
    SpreadsheetHeaderSelectionOperation.prototype._u = function (a) {
        if (this._a0 != null) {
            var b = this._a0;
            this._a0 = null;
            b.e();
        }
    };
    SpreadsheetHeaderSelectionOperation.prototype._g = function (a) {
        return 1;
    };
    SpreadsheetHeaderSelectionOperation.prototype._ap = function (a) {
        _super.prototype._ap.call(this, a);
        a._co = Nullable$1.toNullable(Number_$type, null);
        this._a4();
    };
    Object.defineProperty(SpreadsheetHeaderSelectionOperation.prototype, "_a3", {
        get: function () {
            return this._a2;
        },
        set: function (a) {
            if (nullableNotEquals(this._a2, a)) {
                this._a2 = a;
                if (this._ab != null) {
                    this._ab._co = a;
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderSelectionOperation.prototype._a4 = function () {
        if (this._a0 != null) {
            var a = this._a0;
            this._a0 = null;
            a.d();
        }
    };
    SpreadsheetHeaderSelectionOperation.$t = markType(SpreadsheetHeaderSelectionOperation, 'SpreadsheetHeaderSelectionOperation', SpreadsheetHeaderMouseOperation.$);
    return SpreadsheetHeaderSelectionOperation;
}(SpreadsheetHeaderMouseOperation));
export { SpreadsheetHeaderSelectionOperation };
/**
 * @hidden
 */
var UnselectionHelper = /** @class */ (function (_super) {
    tslib_1.__extends(UnselectionHelper, _super);
    function UnselectionHelper(a, b) {
        var _this = _super.call(this) || this;
        _this.a = new SpreadsheetCell();
        _this.b = new SpreadsheetCell();
        _this.c = null;
        _this.a = a;
        _this.c = b;
        _this.f(a);
        return _this;
    }
    UnselectionHelper.prototype.d = function () {
        this.c._v = SpreadsheetCellRange.empty;
    };
    UnselectionHelper.prototype.e = function () {
        var a = this.c._v;
        if (!a.isEmpty) {
            this.d();
            this.c.unselectRange(a);
        }
    };
    UnselectionHelper.prototype.f = function (a) {
        this.c._v = new SpreadsheetCellRange(this.a.row, this.a.column, a.row, a.column);
        this.b = a;
    };
    UnselectionHelper.prototype.g = function (a) {
        if (SpreadsheetCell.l_op_Inequality(a, this.b)) {
            this.f(a);
        }
    };
    UnselectionHelper.prototype.h = function (a) {
        this.c._v = new SpreadsheetCellRange(Math.min(a.firstRow, this.a.row), Math.min(a.firstColumn, this.a.column), Math.max(a.lastRow, this.a.row), Math.max(a.lastColumn, this.a.column));
    };
    UnselectionHelper.$t = markType(UnselectionHelper, 'UnselectionHelper');
    return UnselectionHelper;
}(Base));
export { UnselectionHelper };
/**
 * @hidden
 */
var SpreadsheetCellHitTestResult = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetCellHitTestResult, _super);
    function SpreadsheetCellHitTestResult(a, b) {
        var _this = _super.call(this) || this;
        _this.a = new SpreadsheetCell();
        _this.c = null;
        CoreUtilities.z(b, "pane");
        _this.a = a;
        _this.c = b;
        return _this;
    }
    Object.defineProperty(SpreadsheetCellHitTestResult.prototype, "b", {
        get: function () {
            return this.a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetCellHitTestResult.prototype, "d", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetCellHitTestResult.$t = markType(SpreadsheetCellHitTestResult, 'SpreadsheetCellHitTestResult', SpreadsheetHitTestResult.$);
    return SpreadsheetCellHitTestResult;
}(SpreadsheetHitTestResult));
export { SpreadsheetCellHitTestResult };
/**
 * @hidden
 */
var SpreadsheetHeaderHitTestResult = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetHeaderHitTestResult, _super);
    function SpreadsheetHeaderHitTestResult(a, b) {
        var _this = _super.call(this) || this;
        _this.c = 0;
        _this.a = null;
        CoreUtilities.z(b, "scrollRegion");
        _this.c = a;
        _this.a = b;
        return _this;
    }
    Object.defineProperty(SpreadsheetHeaderHitTestResult.prototype, "d", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetHeaderHitTestResult.prototype, "b", {
        get: function () {
            return this.a;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetHeaderHitTestResult.$t = markType(SpreadsheetHeaderHitTestResult, 'SpreadsheetHeaderHitTestResult', SpreadsheetHitTestResult.$);
    return SpreadsheetHeaderHitTestResult;
}(SpreadsheetHitTestResult));
export { SpreadsheetHeaderHitTestResult };
/**
 * @hidden
 */
export var ISpreadsheetPaneOwner_$type = new Type(null, 'ISpreadsheetPaneOwner');
/**
 * @hidden
 */
var SpreadsheetPaneManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneManager, _super);
    function SpreadsheetPaneManager(a, b, c, d, e, f) {
        var _this = _super.call(this) || this;
        _this._av = 184550424;
        _this._bm = true;
        _this._h = null;
        _this._n = null;
        _this._g = null;
        _this._m = null;
        _this._i = null;
        _this._o = null;
        _this._de = null;
        _this._df = null;
        _this._an = null;
        _this._bg = null;
        _this._bb = null;
        _this._p = null;
        _this._ji = Size.empty;
        _this._fl = null;
        _this._jl = new Size();
        _this._jk = new Size();
        _this._jj = new Size();
        _this._dv = 0;
        _this._du = 0;
        _this._eb = null;
        _this._d9 = null;
        _this._ea = null;
        _this._am = null;
        _this._a2 = null;
        _this._ba = null;
        _this._v = SpreadsheetCellRange.empty;
        _this._w = SpreadsheetCellRange.empty;
        _this._t = SpreadsheetCellRange.empty;
        _this._u = SpreadsheetCellRange.empty;
        _this._ed = 0;
        _this._ee = 0;
        _this._dw = 1;
        _this._a7 = null;
        _this._a5 = null;
        _this._at = 0;
        _this._bn = false;
        _this._ft = null;
        _this._jg = null;
        _this._dq = 0;
        _this._dr = 0;
        _this._ds = 0;
        _this._dt = 0;
        _this._al = null;
        _this._bk = null;
        _this._a0 = null;
        _this._dp = null;
        _this._bl = null;
        _this._dx = 0;
        _this._d2 = 0;
        _this._az = null;
        CoreUtilities.z(a, "worksheet");
        CoreUtilities.z(b, "selectionFactory");
        CoreUtilities.z(d, "onPrompt");
        CoreUtilities.z(e, "tabManager");
        CoreUtilities.z(f, "ownerState");
        var g = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetPane.$), _this._h, new ObservableCollectionExtended$1(SpreadsheetPane.$, 2, false, true), _this, false);
        _this._h = g.p0;
        _this._n = new ReadOnlyNotifyCollection$1(SpreadsheetPane.$, _this._h);
        var h = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetColumnScrollRegion.$), _this._g, new ObservableCollectionExtended$1(SpreadsheetColumnScrollRegion.$, 2, false, true), _this, false);
        _this._g = h.p0;
        _this._m = new ReadOnlyNotifyCollection$1(SpreadsheetColumnScrollRegion.$, _this._g);
        var i = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetRowScrollRegion.$), _this._i, new ObservableCollectionExtended$1(SpreadsheetRowScrollRegion.$, 2, false, true), _this, false);
        _this._i = i.p0;
        _this._o = new ReadOnlyNotifyCollection$1(SpreadsheetRowScrollRegion.$, _this._i);
        _this._df = CoreUtilities.j(SpreadsheetScrollRegion.$, _this._i);
        _this._de = CoreUtilities.j(SpreadsheetScrollRegion.$, _this._g);
        _this._bk = new PropertyChangeListener$1(SpreadsheetPaneManager.$, _this, function (j, k, l, m) { return j._hj(k, l, m); }, false);
        _this._bb = a;
        _this._eb = b;
        _this._d9 = c;
        _this._ea = d;
        _this._a7 = new DeferredOperation(runOn(_this, _this._jc));
        _this._p = new InViewPaneInfo(_this);
        _this._a2 = e;
        _this._ba = new WorkbookFontSnapshot(_this._bb.workbook._styles$i.normalStyle._i);
        _this._dp = new Queue$1(DisposableAction.$);
        SpreadsheetUtilities.d6(_this._a2._j, _this._bk, true);
        _this._al = f;
        SpreadsheetUtilities.d6(_this._al, _this._bk, true);
        _this._gs();
        _this._gq();
        _this._iz();
        return _this;
    }
    SpreadsheetPaneManager.prototype.e = function (a, b, c) {
        switch (b != null ? b : "") {
            case "Offset":
                if (!this._b7(64) && typeCast(SpreadsheetScrollInfo.$, a) !== null) {
                    var d = a;
                    var e = d._a2;
                    var f = truncate(MathUtilities.f(d._ac));
                    var g = !e._aw ? this._be(f) : this._bb._cq(f);
                    var h = !e._aw ? runOn(this, this._dy) : runOn(this, this._dz);
                    e.startIndex = g._j;
                    e._bw = h((f - g._m));
                    this._cj = true;
                }
                break;
            case "StartIndex":
                if (typeCast(SpreadsheetScrollRegion.$, a) !== null) {
                    this._cj = true;
                    this._ht(134217728);
                }
                break;
            case "EndIndex":
                if (typeCast(SpreadsheetScrollRegion.$, a) !== null) {
                    this._ht(134217728);
                }
                break;
            case "ActivePane":
                if (a == this) {
                    this._i4();
                    this._ht(512 | 1024 | 33554432 | 16777216);
                    if (this._a2._j.count > 1) {
                        this._ht(2097152);
                    }
                    var i = this._ff(this.activePane);
                    if (nullableNotEquals(i, null)) {
                        this._bb.displayOptions._z = i.value;
                    }
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                var j = getInstanceType(a);
                if (j == SpreadsheetUtilities.d3 || j == SpreadsheetUtilities.d2) {
                    this._at &= ~2048;
                    this._ht(512 | 2097152);
                }
                break;
            case "ActiveCell":
                if (this.activePane != null && a == this.activePane.selection) {
                    this._at &= ~2048;
                    this._ht(1024 | 16777216);
                }
                this._ht(2097152);
                break;
            case "ResourceVersion":
                if (a == this._a6) {
                    this._p.ac();
                    this._cj = true;
                }
                break;
            case "AvailableColumnRange":
            case "AvailableRowRange":
            case "CellSelectionMode":
            case "ActiveCellRangeIndex":
            case "ActiveCellAsRange":
                if (this.activePane != null && a == this.activePane.selection) {
                    this._at &= ~2048;
                }
                this._ht(2097152);
                break;
            case "IsRangeChangeSuspended":
                if (typeCast(SpreadsheetScrollInfo.$, a) !== null) {
                    this._hi(a);
                }
                break;
        }
        if (this.activePane != null && a == this.activePane.selection) {
            this._at &= ~2048;
        }
        _super.prototype.e.call(this, a, b, c);
    };
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_ao", {
        get: function () {
            return this._am;
        },
        set: function (a) {
            if (this._am != a) {
                this._am = a;
                this.a("ActiveCellPane");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_fu", {
        get: function () {
            return this._ft;
        },
        set: function (a) {
            if (this._ft != a) {
                this._ft = a;
                this.a("ActiveCellInputMessage");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_jh", {
        get: function () {
            return this._jg;
        },
        set: function (a) {
            if (PointUtil.notEquals(this._jg, a)) {
                this._jg = a;
                this.a("ActiveCellInputMessagePosition");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "activePane", {
        get: function () {
            return this._an;
        },
        set: function (a) {
            if (this._an != a) {
                this._an = a;
                this.a("ActivePane");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_a1", {
        get: function () {
            return this._a0;
        },
        set: function (a) {
            if (a != this._a0) {
                this._a0 = a;
                this._i4();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_bh", {
        get: function () {
            return this._bg;
        },
        set: function (a) {
            if (this._bg != a) {
                this._bg = a;
                this.a("ActiveTable");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_dg", {
        get: function () {
            return this._de;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_dh", {
        get: function () {
            return this._m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_j", {
        get: function () {
            return this._g;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_b9", {
        get: function () {
            return this._b7(2048);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_ca", {
        get: function () {
            return this._b7(2);
        },
        set: function (a) {
            if (this._c5(2, a)) {
                this._ip(4, true);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_cd", {
        get: function () {
            return this._b7(128);
        },
        set: function (a) {
            this._c5(128, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_ce", {
        get: function () {
            return this._b7(1);
        },
        set: function (a) {
            if (this._c5(1, a)) {
                this._ip(4, true);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_cc", {
        get: function () {
            return WorksheetRegionAddress._r(this._bb._g1, Nullable$1.toNullable(WorksheetRegionAddress.$, null));
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_cj", {
        get: function () {
            return this._bm;
        },
        set: function (a) {
            if (this._bm != a) {
                this._iw();
                this._bm = a;
                this.a("IsLayoutDirty");
                this._iv();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_dl", {
        get: function () {
            return this._n;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_k", {
        get: function () {
            return this._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_d0", {
        get: function () {
            return this._ds;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_d1", {
        get: function () {
            return this._dt;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_jo", {
        get: function () {
            return this._ji;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_a6", {
        get: function () {
            return this._a5;
        },
        set: function (a) {
            if (this._a5 != a) {
                var b = PropertyChangeListenerList.e(ISpreadsheetResourceProvider_$type, this._a5, a, this, true);
                this._a5 = b.p0;
                this._p.ac();
                this.a("ResourceProvider");
                this._ht(4096);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_dm", {
        get: function () {
            return this._df;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_dn", {
        get: function () {
            return this._o;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_l", {
        get: function () {
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_fs", {
        get: function () {
            return this._fl;
        },
        set: function (a) {
            if (a != this._fl) {
                var b = stringIsNullOrEmpty(a) ? null : this._bb._getRegion1(a, 1);
                this._v = b == null ? SpreadsheetCellRange.empty : new SpreadsheetCellRange(b.firstRow, b.firstColumn, b.lastRow, b.lastColumn);
                this._fl = a;
                this.a("ScrollRange");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_d3", {
        get: function () {
            return this._du;
        },
        set: function (a) {
            if (this._du != a) {
                this._du = a;
                this.a("SplitterHeight");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_d4", {
        get: function () {
            return this._dv;
        },
        set: function (a) {
            if (this._dv != a) {
                this._dv = a;
                this.a("SplitterWidth");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_a3", {
        get: function () {
            return this._a2;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_bc", {
        get: function () {
            return this._bb;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "_d8", {
        get: function () {
            return this._dw;
        },
        set: function (a) {
            if (a != this._dw) {
                this._dw = a;
                if (this._al._j.p) {
                    this._hv();
                }
                this.a("ZoomLevel");
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneManager.prototype._fx = function () {
        this._fv(false);
    };
    SpreadsheetPaneManager.prototype._fw = function () {
        this._fv(true);
    };
    SpreadsheetPaneManager.prototype._fy = function (a) {
        var b = this._bh;
        if (b == null) {
            return;
        }
        var c = this.activePane.selection;
        if (a) {
            b.insertColumns(b._columns$i.count);
            if (c.cellRanges.count == 1 && c.cellRanges.item(0)._ad == 1) {
                c._bw(0, 1);
            }
        }
        else {
            b.insertDataRows(b.dataAreaRegion._aa);
            if (c.cellRanges.count == 1 && c.cellRanges.item(0)._aa == 1) {
                c._bw(1, 0);
            }
        }
    };
    SpreadsheetPaneManager.prototype._en = function () {
        var e_117, _0;
        var a = this._bb.isProtected;
        if (this._a2._j.count > 0) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var b = _2.value;
                    var c = b._j;
                    var d = c.isProtected;
                    if (d != a) {
                        return Nullable$1.toNullable(Boolean_$type, null);
                    }
                }
            }
            catch (e_117_1) { e_117 = { error: e_117_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_117) throw e_117.error; }
            }
        }
        return Nullable$1.toNullable(Boolean_$type, a);
    };
    SpreadsheetPaneManager.prototype._f1 = function (a) {
        var b = this.activePane.selection;
        if (nullableNotEquals(this._fj(a ? 16 : 8), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        if (a) {
            if (b._am) {
                this._h4(-1);
            }
            else {
                this._h8(-1, Enumerable.a(IntRange.$, b._bg));
            }
        }
        else {
            if (b._al) {
                this._h3(-1);
            }
            else {
                this._f0(Enumerable.a(SpreadsheetCellRange.$, b.cellRanges), true);
            }
        }
    };
    SpreadsheetPaneManager.prototype._f2 = function (a, b, c) {
        if (c === void 0) { c = null; }
        if (c == null) {
            c = this.activePane;
        }
        var d;
        var e;
        var f;
        var g;
        var h;
        switch (a) {
            default:
            case 2:
                g = runOn(this._bb, this._bb._cq);
                f = runOn(this._bb, this._bb._cp);
                d = b.firstRow;
                e = c.rowScrollRegion;
                h = runOn(this, this._fi);
                if (this._b9 && this._dn.count > 0 && this._dn.item(0).isFrozen && d <= this._dn.item(0).endIndex) {
                    return;
                }
                break;
            case 3:
                g = runOn(this._bb, this._bb._cq);
                f = runOn(this._bb, this._bb._cp);
                d = b.lastRow;
                e = c.rowScrollRegion;
                h = runOn(this, this._fe);
                break;
            case 0:
                g = runOn(this, this._be);
                f = runOn(this._bb, this._bb._cn);
                d = b.firstColumn;
                e = c.columnScrollRegion;
                h = runOn(this, this._fh);
                if (this._b9 && this._dh.count > 0 && this._dh.item(0).isFrozen && d <= this._dh.item(0).endIndex) {
                    return;
                }
                break;
            case 1:
                g = runOn(this, this._be);
                f = runOn(this._bb, this._bb._cn);
                d = b.lastColumn;
                e = c.columnScrollRegion;
                h = runOn(this, this._fc);
                break;
        }
        var i = e._aj(true);
        if (d < i._i) {
            e.startIndex = d;
            e._bw = 0;
        }
        else if (d > i._h) {
            var j = f(d);
            var k = e._x._af;
            var l = j._m + j._i - k;
            var m = g(truncate(l));
            var n = m._j;
            if (m._m + k < j._l) {
                var o = h(n);
                if (o.hasValue) {
                    n = o.value;
                }
            }
            e.startIndex = n;
            e._bw = 0;
        }
    };
    SpreadsheetPaneManager.prototype._f3 = function (a, b) {
        var c = b[0];
        for (var d = 1; d < b.length; d++) {
            c = c.union(b[d]);
        }
        this._f5(a, c);
    };
    SpreadsheetPaneManager.prototype._f5 = function (a, b) {
        if (a == null) {
            a = this.activePane;
        }
        var c = false;
        var d = Nullable$1.toNullable(Number_$type, b.firstRow);
        var e = Nullable$1.toNullable(Number_$type, b.lastRow);
        var f = Nullable$1.toNullable(Number_$type, b.firstColumn);
        var g = Nullable$1.toNullable(Number_$type, b.lastColumn);
        if (this._b9) {
            var h = this._ar(b._c);
            var i = this._ar(b._b);
            if (i.rowScrollRegion.isFrozen) {
                e = Nullable$1.toNullable(Number_$type, null);
            }
            if (h.rowScrollRegion.isFrozen) {
                d = Nullable$1.toNullable(Number_$type, null);
            }
            if (i.columnScrollRegion.isFrozen) {
                g = Nullable$1.toNullable(Number_$type, null);
            }
            if (h.columnScrollRegion.isFrozen) {
                f = Nullable$1.toNullable(Number_$type, null);
            }
            a = i;
        }
        if (a == null) {
            return;
        }
        c = SpreadsheetPaneManager._bp(a.columnScrollRegion, f, g);
        c = SpreadsheetPaneManager._bp(a.rowScrollRegion, d, e) || c;
        if (c) {
            this._cj = true;
        }
    };
    SpreadsheetPaneManager._bp = function (a, b, c) {
        var d, e;
        if (nullableEquals(b, null)) {
            if (nullableEquals(c, null)) {
                return false;
            }
            d = e = c.value;
        }
        else {
            d = b.value;
            e = nullableEquals(c, null) ? d : c.value;
        }
        var f = a.endIndex;
        if (f > a.startIndex && a._bk != 0) {
            f--;
        }
        if (d < a.startIndex || e > f) {
            var g = a._b7(d);
            var h = a._b7(e);
            var i = a.actualExtent / a._bx;
            var j = a._b4(h._l - g._m);
            a._bw = 0;
            if (j > i || d < a.startIndex) {
                a.startIndex = d;
            }
            else {
                var k = a._b5(i);
                var l = Math.max(0, h._l - k);
                var m = a._b8(l);
                a.startIndex = l > m._m ? a._b8(m._l)._j : m._j;
            }
            return true;
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._f4 = function (a, b, c, d, e, f) {
        if (a == null) {
            a = this.activePane;
            if (a == null) {
                return;
            }
        }
        var g = a.columnScrollRegion;
        var h = this._bb._cn(b.column);
        var i = g._x._af;
        var j = h._m + truncate((h._i * d)) - truncate((i * c));
        if (j < 0) {
            j = 0;
        }
        var k = this._be(j);
        var l = k._j;
        if (l < b.column && k._m + i < h._l) {
            l++;
        }
        var m = a.rowScrollRegion;
        var n = this._bb._cp(b.row);
        var o = m._x._af;
        var p = n._m;
        if (f != 0) {
            p += (n._i * f);
        }
        if (e != 0) {
            p -= (o * e);
        }
        if (p < 0) {
            p = 0;
        }
        k = this._bb._cq(truncate(p));
        var q = k._j;
        if (q < b.row && k._m + o < n._l) {
            q++;
        }
        g.startIndex = l;
        g._bw = 0;
        m.startIndex = q;
        m._bw = 0;
    };
    SpreadsheetPaneManager.prototype._bq = function (a) {
        var e_118, _0;
        var _loop_18 = function (b) {
            var c = Nullable$1.toNullable(Boolean_$type, null);
            var d = SpreadsheetPaneManager._b5(b._j, a.firstRow, a.firstColumn, a.lastRow, a.lastColumn, function (e) {
                var f = nullableEquals(e._c5, true);
                if (nullableEquals(c, null)) {
                    c = Nullable$1.toNullable(Boolean_$type, f);
                    return true;
                }
                else {
                    return f == c.value;
                }
            });
            if (d == false) {
                this_8._ea(new SpreadsheetUserPromptInfo(25, null, null, null, false));
                return { value: false };
            }
        };
        var this_8 = this;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var state_8 = _loop_18(b);
                if (typeof state_8 === "object")
                    return state_8.value;
            }
        }
        catch (e_118_1) { e_118 = { error: e_118_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_118) throw e_118.error; }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._br = function (a) {
        if (this._bb.isProtected) {
            var b = [this._bb];
            var c = [new WorksheetRegionAddress(1, a.row, a.row, a.column, a.column)];
            var d = this._ay(boxArray$1(b), boxArray$1(c), false, void 0, true);
            if (d == 2) {
                d = this._ay(boxArray$1(b), boxArray$1(c), false, void 0, false);
            }
            if (d != 1) {
                return false;
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._bs = function (a) {
        if (this._bb.isProtected) {
            var b = this.activePane;
            if (b == null) {
                return false;
            }
            var c = b._ag;
            if (c._bi.count == 0 && c._bj.count == 0) {
                return false;
            }
            if (c._aw) {
                return false;
            }
            if (c._ax) {
                return false;
            }
            var d = this._bb.protection;
            if (c._bi.count > 0) {
                var e = a ? d.allowInsertingColumns : d.allowDeletingColumns;
                if (e == false) {
                    return false;
                }
            }
            else {
                var f = a ? d.allowInsertingRows : d.allowDeletingRows;
                if (f == false) {
                    return false;
                }
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._bt = function (a) {
        this._jc();
        var b = this._bh;
        if (b != null && b.isHeaderRowVisible) {
            var c = this.activePane != null ? this.activePane.selection : null;
            if (c != null) {
                var d = b._bz.index;
                for (var e = 0; e < c._bg.count; e++) {
                    var f = c._bg.item(e);
                    if (f._i <= d && f._h >= d) {
                        if (!a && f._i <= b._by._ac && f._h >= b._by._ae) {
                            return true;
                        }
                        return false;
                    }
                }
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._bu = function () {
        var e_119, _0, e_120, _1, e_121, _2;
        var a = this.activePane;
        if (a != null) {
            try {
                for (var _3 = tslib_1.__values(fromEnum(a.selection.cellRanges)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var b = _4.value;
                    var c = SpreadsheetUtilities.ay(b);
                    try {
                        for (var _5 = tslib_1.__values(fromEnum(this._a2._j)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var d = _6.value;
                            try {
                                for (var _7 = tslib_1.__values(fromEnum(d._j._tables$i)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                    var e = _8.value;
                                    if (c._j(e._by)) {
                                        return false;
                                    }
                                }
                            }
                            catch (e_121_1) { e_121 = { error: e_121_1 }; }
                            finally {
                                try {
                                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                }
                                finally { if (e_121) throw e_121.error; }
                            }
                        }
                    }
                    catch (e_120_1) { e_120 = { error: e_120_1 }; }
                    finally {
                        try {
                            if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                        }
                        finally { if (e_120) throw e_120.error; }
                    }
                }
            }
            catch (e_119_1) { e_119 = { error: e_119_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_119) throw e_119.error; }
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._bv = function (a, b) {
        var _this = this;
        if (b === void 0) { b = null; }
        var c;
        return ((function () { var d = _this._cy(a, true, c, b); c = d.p2; return d.ret; })());
    };
    SpreadsheetPaneManager.prototype._canSelect = function (a) {
        if (this._bb.isProtected) {
            switch (this._bb.protection.selectionMode) {
                case 2: return false;
                case 1:
                    if (!this._cr(a.row, a.column)) {
                        return false;
                    }
                    break;
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._canSelect1 = function (a) {
        if (this._bb.isProtected) {
            switch (this._bb.protection.selectionMode) {
                case 2: return false;
                case 1:
                    if (!SpreadsheetPaneManager._cp(this._bb, a.firstRow, a.firstColumn, a.lastRow, a.lastColumn, null)) {
                        return false;
                    }
                    break;
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._f6 = function (a) {
        var b = this.activePane;
        if (b != null) {
            var c = b.selection;
            var d = a ? 1 : -1;
            var e = c.cellRanges.count;
            var f = (c.activeCellRangeIndex + d + e) % e;
            var g = c.cellRanges.item(f);
            if (this._canSelect(g._c)) {
                c._setActiveCell(g._c, Nullable$1.toNullable(Number_$type, f));
            }
        }
    };
    SpreadsheetPaneManager.prototype._f7 = function (a) {
        if (nullableNotEquals(this._fj(4), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        SpreadsheetPaneManager_IndentHelper.o(this, a);
    };
    SpreadsheetPaneManager.prototype._gb = function () {
        var a = this._bb._fd.count;
        this._bb._g8();
        if (a != 0 || this._bb._fd.count != 0) {
            this._cj = true;
        }
    };
    SpreadsheetPaneManager.prototype._ak = function (a, b, c, d) {
        var e_122, _0, e_123, _1, e_124, _2, e_125, _3;
        if (c === void 0) { c = null; }
        if (d === void 0) { d = null; }
        if (c == null) {
            var e = this.activePane;
            if (e != null) {
                if (c == null) {
                    c = Enumerable.a(SpreadsheetCellRange.$, e.selection.cellRanges);
                }
            }
        }
        if (c != null) {
            if (this._b1(true, true)) {
                return 1;
            }
            var f = new List$1(WorksheetRegion.$, 0);
            try {
                for (var _4 = tslib_1.__values(fromEnum(this._a2._j)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var g = _5.value;
                    f.o(SpreadsheetUtilities.f(g._j, boxArray$1(c)));
                }
            }
            catch (e_122_1) { e_122 = { error: e_122_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_0 = _4.return)) _0.call(_4);
                }
                finally { if (e_122) throw e_122.error; }
            }
            var h = f.toArray();
            var i = new HashSet$1(IRegionBlockingValue_$type, 0);
            try {
                ExcelUtils.gf(h, i);
            }
            catch (j) {
                if (this._ea(new SpreadsheetUserPromptInfo(a, null, j, null, b))) {
                    return 1;
                }
                return 0;
            }
            var k = false;
            try {
                for (var _6 = tslib_1.__values(fromEnum(i)), _7 = _6.next(); !_7.done; _7 = _6.next()) {
                    var l = _7.value;
                    if (d != null) {
                        var m = l.blockedRegion.worksheet;
                        if (m.isProtected && m == this._bb) {
                            var n = d.a(m);
                            var o = l.blockedRegion._h;
                            if (SpreadsheetPaneManager._cp(m, o._ac, o._w, o._ae, o._x, n) == false) {
                                k = true;
                                continue;
                            }
                        }
                    }
                    l.removeFromRegion();
                }
            }
            catch (e_123_1) { e_123 = { error: e_123_1 }; }
            finally {
                try {
                    if (_7 && !_7.done && (_1 = _6.return)) _1.call(_6);
                }
                finally { if (e_123) throw e_123.error; }
            }
            var p = SpreadsheetUtilities.h(boxArray$1(c));
            var q = this._a2._j.count > 1 && a != 2;
            try {
                for (var _8 = tslib_1.__values(fromEnum(this._a2._j)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                    var r = _9.value;
                    var s = r._j;
                    if (q) {
                        if (SpreadsheetPaneManager._cf(s, p)) {
                            this._ea(((function (t, u, v) { return new SpreadsheetUserPromptInfo(t, null, null, v, u); })(20, b, s)));
                            continue;
                        }
                    }
                    var w = s.isProtected && s == this._bb && d != null ? d.a(s) : null;
                    var x = s._tables$i;
                    for (var y = x.count - 1; y >= 0; y--) {
                        var z = x._item(y);
                        var aa = z._by;
                        for (var ab = 0; ab < p.length; ab++) {
                            if (p[ab]._h(aa)) {
                                x.removeAt(y, false);
                                break;
                            }
                        }
                    }
                    var ac = s.filterSettings.region;
                    if (ac != null && ac._aa > 0) {
                        var ad = ac._h._f(ac._h._ac);
                        for (var ae = 0; ae < p.length; ae++) {
                            if (p[ae]._h(ad)) {
                                s.filterSettings.clearRegion();
                                break;
                            }
                        }
                    }
                    var af = s._eh;
                    s._eh = true;
                    try {
                        var ag = s._rows$i;
                        for (var ai = 0; ai < c.length; ai++) {
                            var ah = c[ai];
                            var aj = w != null ? LockedEditRangeInfoForCellRange.a(w, ah.firstRow, ah.firstColumn, ah.lastRow, ah.lastColumn) : null;
                            try {
                                for (var _10 = tslib_1.__values(fromEnum(s._rows$i._m(ah.firstRow, ah.lastRow))), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                                    var ak = _11.value;
                                    var al = ak.index;
                                    for (var am = ah.firstColumn; am <= ah.lastColumn; am++) {
                                        var an = SpreadsheetPaneManager._getCellRange2(al, am, s);
                                        var ao = an._c;
                                        if (!an.isSingleCell) {
                                            var ap = SpreadsheetPaneManager._e2(an, s);
                                            if (SpreadsheetCell._l_op_Inequality_Lifted$i(ap, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                                                ao = ap.value;
                                            }
                                        }
                                        if (ao.row == al && ao.column >= am) {
                                            if (aj != null) {
                                                var aq = s._b4(ak, ao.column);
                                                if (nullableEquals(aq._c5, true) && aj.e(al, ao.column) == false) {
                                                    k = true;
                                                    continue;
                                                }
                                            }
                                            ak.setCellValue(ao.column, null);
                                        }
                                        else {
                                            am = an.lastColumn;
                                        }
                                    }
                                }
                            }
                            catch (e_125_1) { e_125 = { error: e_125_1 }; }
                            finally {
                                try {
                                    if (_11 && !_11.done && (_3 = _10.return)) _3.call(_10);
                                }
                                finally { if (e_125) throw e_125.error; }
                            }
                        }
                    }
                    finally {
                        s._eh = af;
                    }
                    var ar = void 0;
                    var as = SpreadsheetPaneManager._hx(false, false, ar, s, boxArray$1(c));
                    ar = as.p2;
                    SpreadsheetUtilities.e0(s, p);
                }
            }
            catch (e_124_1) { e_124 = { error: e_124_1 }; }
            finally {
                try {
                    if (_9 && !_9.done && (_2 = _8.return)) _2.call(_8);
                }
                finally { if (e_124) throw e_124.error; }
            }
            if (k) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            }
        }
        return 2;
    };
    SpreadsheetPaneManager.prototype._gc = function (a, b, c) {
        var e_126, _0, e_127, _1, e_128, _2, e_129, _3, e_130, _4, e_131, _5, e_132, _6, e_133, _7;
        if (c === void 0) { c = true; }
        var d = this.activePane;
        if (d == null) {
            return;
        }
        var e = new HashSet$1(WorksheetMergedCellsRegion.$, 0);
        if (this._b1(true, a, e)) {
            return;
        }
        try {
            for (var _8 = tslib_1.__values(fromEnum(e)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                var f = _9.value;
                f.worksheet._mergedCellsRegions$i.remove_1(f);
            }
        }
        catch (e_126_1) { e_126 = { error: e_126_1 }; }
        finally {
            try {
                if (_9 && !_9.done && (_0 = _8.return)) _0.call(_8);
            }
            finally { if (e_126) throw e_126.error; }
        }
        var g = d.selection;
        if (b && nullableNotEquals(this._fj(4), true)) {
            var h = this._ax(g, false, void 0, c);
            switch (h) {
                case 0: return;
                case 2:
                    this._gc(a, true, false);
                    return;
                case 1: break;
            }
        }
        var i = this._bb.workbook._styles$i._i(0);
        var j = i._i;
        try {
            for (var _10 = tslib_1.__values(fromEnum(this._a2._j)), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                var k = _11.value;
                var l = k._j;
                try {
                    for (var _12 = tslib_1.__values(fromEnum(g.cellRanges)), _13 = _12.next(); !_13.done; _13 = _12.next()) {
                        var m = _13.value;
                        var n = g._a0(m);
                        var o = g._az(m);
                        var p = false;
                        var q = m.firstRow;
                        var r = l._f9(m.firstColumn);
                        var s = null;
                        if (o == false) {
                            var t = l._f9(m.lastColumn);
                            s = new Array(t - r + 1);
                            for (var u = r; u <= t; u++) {
                                var v = l._ff._inner[u];
                                var w = v.b;
                                var x = void 0;
                                if (w._cd || Base.referenceEquals(v.b, j)) {
                                    x = false;
                                }
                                else if ((w.style == null || w.style._n) && !WorksheetCellFormatProxy._y(w, j, ExcelUtils.n(w.formatOptions))) {
                                    x = false;
                                }
                                else {
                                    x = true;
                                }
                                s[u - r] = x;
                                p = x || p;
                            }
                            if (p) {
                                for (var y = m.firstRow; y <= m.lastRow; y++) {
                                    var z = l._rows$i.item(y);
                                }
                            }
                        }
                        try {
                            for (var _14 = tslib_1.__values(fromEnum(l._rows$i._m(m.firstRow, m.lastRow))), _15 = _14.next(); !_15.done; _15 = _14.next()) {
                                var aa = _15.value;
                                var ab = aa.index;
                                if (n == false && aa._hasCellFormat && !Base.referenceEquals(aa._cellFormatInternal.d, j)) {
                                    for (var ac = m.firstColumn; ac <= m.lastColumn; ac++) {
                                        aa._bc(ac).formatOptions = 0;
                                        aa._bc(ac).style = i;
                                    }
                                }
                                else {
                                    var ad = null;
                                    var ae = -1;
                                    var af = m.firstColumn;
                                    try {
                                        for (var _16 = tslib_1.__values(fromEnum(aa._ch(m.firstColumn, m.lastColumn, true))), _17 = _16.next(); !_17.done; _17 = _16.next()) {
                                            var ag = _17.value;
                                            if (p && o == false && af != ag.r) {
                                                for (; af < ag.r; af++) {
                                                    if (ad == null || af > ad.r) {
                                                        ae = l._f9(af);
                                                        ad = l._ff._inner[ae];
                                                    }
                                                    if (!s[ae - r]) {
                                                        af = ad.r;
                                                        continue;
                                                    }
                                                    aa._bc(af).formatOptions = 0;
                                                    aa._bc(af).style = i;
                                                }
                                            }
                                            if (ad == null || ag.r > ad.r) {
                                                ae = l._f9(ag.r);
                                                ad = l._ff._inner[ae];
                                            }
                                            var ah = (ag.n && !Base.referenceEquals(ag.j, j)) || s[ae - r];
                                            if (ah) {
                                                aa._bc(ag.r).formatOptions = 0;
                                                aa._bc(ag.r).style = i;
                                            }
                                            af = ag.r + 1;
                                        }
                                    }
                                    catch (e_130_1) { e_130 = { error: e_130_1 }; }
                                    finally {
                                        try {
                                            if (_17 && !_17.done && (_4 = _16.return)) _4.call(_16);
                                        }
                                        finally { if (e_130) throw e_130.error; }
                                    }
                                    if (p && o == false) {
                                        for (; af <= m.lastColumn; af++) {
                                            if (ad == null || af > ad.r) {
                                                ae = l._f9(af);
                                                ad = l._ff._inner[ae];
                                            }
                                            if (!s[ae - r]) {
                                                af = ad.r;
                                                continue;
                                            }
                                            aa._bc(af).style = i;
                                            aa._bc(af).formatOptions = 0;
                                        }
                                    }
                                }
                            }
                        }
                        catch (e_129_1) { e_129 = { error: e_129_1 }; }
                        finally {
                            try {
                                if (_15 && !_15.done && (_3 = _14.return)) _3.call(_14);
                            }
                            finally { if (e_129) throw e_129.error; }
                        }
                    }
                }
                catch (e_128_1) { e_128 = { error: e_128_1 }; }
                finally {
                    try {
                        if (_13 && !_13.done && (_2 = _12.return)) _2.call(_12);
                    }
                    finally { if (e_128) throw e_128.error; }
                }
                var ai = new WorksheetCellFormatData(l.workbook, 0);
                try {
                    for (var _18 = tslib_1.__values(fromEnum(g._bj)), _19 = _18.next(); !_19.done; _19 = _18.next()) {
                        var aj = _19.value;
                        try {
                            for (var _20 = tslib_1.__values(fromEnum(l._rows$i._m(aj._i, aj._h))), _21 = _20.next(); !_21.done; _21 = _20.next()) {
                                var ak = _21.value;
                                if (ak._hasCellFormat) {
                                    ak._cellFormatInternal._setFormatting1(ai, -97);
                                }
                            }
                        }
                        catch (e_132_1) { e_132 = { error: e_132_1 }; }
                        finally {
                            try {
                                if (_21 && !_21.done && (_6 = _20.return)) _6.call(_20);
                            }
                            finally { if (e_132) throw e_132.error; }
                        }
                    }
                }
                catch (e_131_1) { e_131 = { error: e_131_1 }; }
                finally {
                    try {
                        if (_19 && !_19.done && (_5 = _18.return)) _5.call(_18);
                    }
                    finally { if (e_131) throw e_131.error; }
                }
                var al = l.workbook._ca._p;
                try {
                    for (var _22 = tslib_1.__values(fromEnum(g._bi)), _23 = _22.next(); !_23.done; _23 = _22.next()) {
                        var am = _23.value;
                        for (var an = am._i; an <= am._h; an++) {
                            var ao = l._cb(an);
                            if (ao.b != null && al._ca(ao.b) == false) {
                                var ap = Math.min(am._h, ao.r);
                                for (var aq = an; aq <= ap; aq++) {
                                    l._columns$i.item(aq)._cellFormatInternal._setFormatting1(ai, 8);
                                }
                            }
                            an = ao.r;
                        }
                    }
                }
                catch (e_133_1) { e_133 = { error: e_133_1 }; }
                finally {
                    try {
                        if (_23 && !_23.done && (_7 = _22.return)) _7.call(_22);
                    }
                    finally { if (e_133) throw e_133.error; }
                }
                var ar = l._conditionalFormats$i;
                if (ar.count > 0) {
                    var as = SpreadsheetUtilities.h(g.cellRanges);
                    SpreadsheetUtilities.eb(l, as);
                }
            }
        }
        catch (e_127_1) { e_127 = { error: e_127_1 }; }
        finally {
            try {
                if (_11 && !_11.done && (_1 = _10.return)) _1.call(_10);
            }
            finally { if (e_127) throw e_127.error; }
        }
    };
    SpreadsheetPaneManager.prototype._gd = function () {
        var a = this._bh;
        if (a != null) {
            a.clearFilters();
            a.clearSortConditions();
        }
        else if (this._bb.filterSettings.region != null) {
            this._bb.filterSettings.clearFilters();
            this._bb.filterSettings.sortSettings._sortConditions$i.clear();
        }
    };
    SpreadsheetPaneManager.prototype._ge = function () {
        if (this._bb._fd.count > 0) {
            this._bb._fd.clear();
            this._cj = true;
        }
    };
    SpreadsheetPaneManager.prototype._s = function (a) {
        var b;
        var c;
        var d = this._bb._cr(a.row, a.column);
        if (d == null) {
            var e = this._bb._rows$i.item(a.row);
            c = this._bd(e, a.row, a.column);
            b = this._ai(e, a.column);
        }
        else {
            c = this._bd(this._bb._rows$i._aj(d.firstRow), d.firstRow, d._v);
            b = this._ah(d);
        }
        var f = this._bb._ck(b.h, b.ak, b.ab);
        var g = this._e5(f);
        this._aj(b, g, c, false);
        return new SpreadsheetCellEditInfo(b, c, nullableEquals(g, true));
    };
    SpreadsheetPaneManager.prototype._ah = function (a) {
        var _this = this;
        var b = a._h;
        return ((function () {
            var $ret = new SpreadsheetCellValueInfo();
            $ret.ab = b._w;
            $ret.ak = b._ac;
            $ret.x = b._x;
            $ret.ag = b._ae;
            $ret.r = true;
            $ret.h = a._k;
            $ret.w = a.firstColumn;
            $ret.ao = a.value;
            $ret.d = _this._p.k.c(b._ac, b._w);
            return $ret;
        })());
    };
    SpreadsheetPaneManager.prototype._ai = function (a, b) {
        var _this = this;
        var c = a.index;
        return ((function () {
            var $ret = new SpreadsheetCellValueInfo();
            $ret.ab = b;
            $ret.x = b;
            $ret.ak = c;
            $ret.ag = c;
            $ret.r = false;
            $ret.h = a;
            $ret.w = b;
            $ret.ao = a._getCellValue1(b);
            $ret.d = _this._p.k.c(c, b);
            return $ret;
        })());
    };
    SpreadsheetPaneManager.prototype._b0 = function (a, b) {
        var c = this._bb._rows$i._aj(a);
        if (c != null) {
            var d = c._a2(b);
            if (d != null && d.j(b)) {
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._bz = function (a) {
        var b = a._h;
        return this._b0(b._ac, b._w);
    };
    SpreadsheetPaneManager.prototype._gf = function (a) {
        var e_134, _0;
        var b = this.activePane;
        if (b == null) {
            return;
        }
        var c = b.selection;
        if (c._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 144), false));
        }
        else if (c._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 144), false));
        }
        else if (nullableEquals(a, true) && c._bj.count > 0) {
            return;
        }
        else if (nullableEquals(a, false) && c._bi.count > 0) {
            return;
        }
        else {
            if (nullableEquals(a, null)) {
                if (c._bj.count > 0) {
                    this._gh();
                    if (c._bi.count > 0) {
                        this._h0(true);
                    }
                    return;
                }
                else if (c._bi.count > 0) {
                    this._gg();
                    return;
                }
                else {
                    if (this._bh != null && !this._cb()) {
                        if (c.cellRanges.count > 1) {
                            this._gi(false);
                            return;
                        }
                        var d = this._bh.dataAreaRegion._h;
                        var e = c.cellRanges.item(0);
                        var f = e._aa > e._ad;
                        if (e._ad == d._af) {
                            f = false;
                        }
                        else if (e.firstRow <= d._ac && e.lastRow >= d._ae) {
                            f = true;
                        }
                        this._gi(f);
                        return;
                    }
                    var g = c.cellRanges.item(0);
                    if (g._aa > g._ad) {
                        a = Nullable$1.toNullable(Boolean_$type, true);
                    }
                    else if (g._ad > g._aa) {
                        a = Nullable$1.toNullable(Boolean_$type, false);
                    }
                    else {
                        for (var h = g.firstColumn; h <= g.lastColumn; h++) {
                            if (SpreadsheetCell._l_op_Inequality_Lifted$i(Nullable$1.toNullable(SpreadsheetCell.$, null), this._ev(g.lastRow, h, 3))) {
                                a = Nullable$1.toNullable(Boolean_$type, false);
                                break;
                            }
                        }
                        if (nullableEquals(a, null)) {
                            a = Nullable$1.toNullable(Boolean_$type, true);
                        }
                    }
                }
            }
            if (nullableNotEquals(this._en(), false)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var i = Enumerable.a(SpreadsheetCellRange.$, c.cellRanges);
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var j = _2.value;
                    for (var l = 0; l < i.length; l++) {
                        var k = i[l];
                        j._j._he(SpreadsheetUtilities.ay(k), nullableEquals(a, true));
                    }
                }
            }
            catch (e_134_1) { e_134 = { error: e_134_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_134) throw e_134.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gg = function () {
        var e_135, _0, e_136, _1;
        var a = this.activePane;
        if (a == null) {
            return;
        }
        var b = a.selection;
        if (b._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 146), false));
        }
        else if (b._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 146), false));
        }
        else {
            if (nullableNotEquals(this._fj(256), true)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var c = Enumerable.a(IntRange.$, Enumerable.n(IntRange.$, b._bf));
            try {
                for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var d = _3.value;
                    if (SpreadsheetPaneManager._co(d._j, b) == false) {
                        this._ea(new SpreadsheetUserPromptInfo(27, null, null, null, false));
                        return;
                    }
                }
            }
            catch (e_135_1) { e_135 = { error: e_135_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_135) throw e_135.error; }
            }
            try {
                for (var _4 = tslib_1.__values(fromEnum(this._a2._j)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var e = _5.value;
                    for (var g = 0; g < c.length; g++) {
                        var f = c[g];
                        e._j._columns$i._remove1(f._i, (f._h - f._i) + 1);
                    }
                }
            }
            catch (e_136_1) { e_136 = { error: e_136_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_136) throw e_136.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gh = function () {
        var e_137, _0, e_138, _1;
        var a = this.activePane;
        if (a == null) {
            return;
        }
        var b = a.selection;
        if (b._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 144), false));
        }
        else if (b._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 144), false));
        }
        else {
            if (nullableNotEquals(this._fj(512), true)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var c = Enumerable.a(IntRange.$, Enumerable.n(IntRange.$, b._bg));
            try {
                for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var d = _3.value;
                    if (SpreadsheetPaneManager._co(d._j, b) == false) {
                        this._ea(new SpreadsheetUserPromptInfo(28, null, null, null, false));
                        return;
                    }
                }
            }
            catch (e_137_1) { e_137 = { error: e_137_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_137) throw e_137.error; }
            }
            try {
                for (var _4 = tslib_1.__values(fromEnum(this._a2._j)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var e = _5.value;
                    for (var g = 0; g < c.length; g++) {
                        var f = c[g];
                        e._j._rows$i._remove1(f._i, (f._h - f._i) + 1);
                    }
                }
            }
            catch (e_138_1) { e_138 = { error: e_138_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_138) throw e_138.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gi = function (a) {
        var b = this._bh;
        if (b == null) {
            return;
        }
        var c = this.activePane.selection;
        var d = Enumerable.a(IntRange.$, (a ? c._bf : c._bg));
        for (var e = d.length - 1; e >= 0; e--) {
            var f = d[e];
            var g = (f._h - f._i) + 1;
            if (a) {
                if (f._i == b._by._w && g == b._by._af) {
                    var h = b.worksheet;
                    var i = b._by;
                    h._tables$i.remove_1(b, false);
                    h._he(i, true);
                }
                else {
                    b.deleteColumns(f._i - b._by._w, g);
                }
            }
            else {
                if (f._i == b._by._ac && f._h == b._by._ae) {
                    var j = b.worksheet;
                    var k = b._by;
                    j._tables$i.remove_1(b, false);
                    j._he(k, false);
                }
                else {
                    if (b.isTotalsRowVisible && f._h == b._by._ae) {
                        b.isTotalsRowVisible = false;
                        if (g == 1) {
                            continue;
                        }
                        g--;
                    }
                    if (f._i <= b.dataAreaRegion.firstRow && f._h >= b.dataAreaRegion.lastRow) {
                        b.deleteDataRows(1, b.dataAreaRegion._aa - 1);
                        var l = b.worksheet._rows$i._aj(b.dataAreaRegion.firstRow);
                        if (l != null) {
                            for (var m = b._by._w, n = b._by._x; m <= n; m++) {
                                l.setCellValue(m, null);
                            }
                        }
                    }
                    else {
                        b.deleteDataRows(f._i - b.dataAreaRegion.firstRow, g);
                    }
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gj = function () {
        this._a7.i();
        this._at = 0;
        SpreadsheetUtilities.ec(this._a2._j, this._bk);
        SpreadsheetUtilities.ec(this._al, this._bk);
        if (this._a5 != null) {
            SpreadsheetUtilities.ec(this._a5, this);
        }
    };
    SpreadsheetPaneManager.prototype._b1 = function (a, b, c) {
        var e_139, _0;
        if (c === void 0) { c = null; }
        var d = this.activePane;
        if (d != null) {
            var e = d.selection;
            var f = SpreadsheetUtilities.h(e.cellRanges);
            var g = false;
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var h = _2.value;
                    var i = h._j;
                    for (var j = 0; j < f.length; j++) {
                        var k = f[j];
                        var l = i._hi(f[j], c);
                        f[j] = l.p0;
                        if (WorksheetRegionAddress._q(f[j], k)) {
                            g = true;
                            if (a == false) {
                                break;
                            }
                        }
                    }
                    if (g && a == false) {
                        break;
                    }
                }
            }
            catch (e_139_1) { e_139 = { error: e_139_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_139) throw e_139.error; }
            }
            if (g) {
                if (a) {
                    e._resetSelection(SpreadsheetUtilities.g(boxArray$1(f)), e.activeCell, e.activeCellRangeIndex, false);
                    this._i2();
                }
                if (b) {
                    this._ea(new SpreadsheetUserPromptInfo(17, null, null, null, false));
                }
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._b2 = function (a, b, c) {
        return this._b3(a, new SpreadsheetCellRange(b.row, b.column), c);
    };
    SpreadsheetPaneManager.prototype._b3 = function (a, b, c) {
        return this._b4(a, Nullable$1.toNullable(IntRange.$, new IntRange(1, b.firstRow, b.lastRow)), Nullable$1.toNullable(IntRange.$, new IntRange(1, b.firstColumn, b.lastColumn)), c);
    };
    SpreadsheetPaneManager.prototype._b4 = function (a, b, c, d) {
        if (a == null) {
            a = this.activePane;
            if (a == null) {
                return false;
            }
        }
        if (nullableNotEquals(b, null)) {
            b = Nullable$1.toNullable(IntRange.$, b.value._b(this._bb._rows$i.maxCount - 1)._a(0));
        }
        if (nullableNotEquals(c, null)) {
            c = Nullable$1.toNullable(IntRange.$, c.value._b(this._bb._columns$i.maxCount - 1)._a(0));
        }
        var e = nullableNotEquals(c, null) ? c.value._i : a.visibleRange.firstColumn;
        var f = nullableNotEquals(c, null) ? c.value._h : a.visibleRange.lastColumn;
        var g = nullableNotEquals(b, null) ? b.value._i : a.visibleRange.firstRow;
        var h = nullableNotEquals(b, null) ? b.value._h : a.visibleRange.lastRow;
        var i = nullableNotEquals(c, null) ? this._e6(a.columnScrollRegion, c.value, d) : Nullable$1.toNullable(IntRange.$, null);
        var j = nullableNotEquals(b, null) ? this._e6(a.rowScrollRegion, b.value, d) : Nullable$1.toNullable(IntRange.$, null);
        var k = (nullableNotEquals(c, null) && (nullableEquals(i, null) || !c.value.equals(i.value))) || (nullableNotEquals(b, null) && (nullableEquals(j, null) || !b.value.equals(j.value)));
        if (!k) {
            return true;
        }
        var l, m, n, o;
        l = m = n = o = 0;
        var p, q;
        var r = a.visibleRange;
        if ((nullableEquals(i, null) && f <= r.firstColumn) || (nullableNotEquals(i, null) && e < i.value._i)) {
            q = e;
            l = 0;
            n = 0;
        }
        else if ((nullableEquals(i, null) && e >= r.lastColumn) || (nullableNotEquals(i, null) && f > i.value._h)) {
            var s = this._bb._fq(e, f, false);
            var t = this._el(s);
            if (t > a.columnScrollRegion._x._af) {
                q = e;
                l = 0;
                n = 0;
            }
            else {
                q = f;
                l = n = 1;
            }
        }
        else {
            q = r.firstColumn;
            l = n = 0;
        }
        if ((nullableEquals(j, null) && h <= r.firstRow) || (nullableNotEquals(j, null) && g < j.value._i)) {
            p = g;
            m = 0;
            o = 0;
        }
        else if ((nullableEquals(j, null) && g >= r.lastRow) || (nullableNotEquals(j, null) && h > j.value._h)) {
            var u = this._bb._ft(g, h, false);
            var v = this._em(u);
            if (v > a.rowScrollRegion._x._af) {
                p = g;
                m = 0;
                o = 0;
            }
            else {
                p = h;
                m = o = 1;
            }
        }
        else {
            p = r.firstRow;
            m = o = 0;
        }
        if (this._b9) {
            if (a.rowScrollRegion.isFrozen || (this._dn.count > 1 && this._dn.item(0).isFrozen && this._dn.item(0).endIndex >= p)) {
                p = r.firstRow;
                m = o = 0;
            }
            if (a.columnScrollRegion.isFrozen || (this._dh.count > 1 && this._dh.item(0).isFrozen && this._dh.item(0).endIndex >= q)) {
                q = r.firstColumn;
                l = n = 0;
            }
            if (p == r.firstRow && q == r.firstColumn) {
                return true;
            }
        }
        this._f4(a, new SpreadsheetCell(p, q), l, n, m, o);
        return true;
    };
    SpreadsheetPaneManager.prototype.extendRangeForMergedCells = function (a) {
        return SpreadsheetPaneManager._extendRangeForMergedCells1(this._bb, a, null);
    };
    SpreadsheetPaneManager.prototype._gl = function (a) {
        var _this = this;
        if (this.activePane == null) {
            return;
        }
        var b = this._bh;
        var c = this.activePane.selection;
        var d = c.activeCell;
        if (b != null) {
            var e = b._columns$i._item(d.column - b._by._w);
            switch (a) {
                case 0:
                    var f = this._fm(d);
                    if (stringIsNullOrEmpty(f)) {
                        e._j(true);
                    }
                    else {
                        e._j(false, f);
                    }
                    break;
                case 3:
                    var g = this._bb._getCellConditionalFormat1(d.row, d.column);
                    if (g == null || g.iconInfo == null || g.iconInfo.icon == -1) {
                        e._r(0, Nullable$1.toNullable(Number_$type, null));
                    }
                    else {
                        e._r(ExcelUtils.ak(g.iconInfo.iconSet), Nullable$1.toNullable(Number_$type, intSToU(g.iconInfo.iconIndex)));
                    }
                    break;
                case 1:
                case 2:
                    {
                        var h = this._bb._rows$i._aj(d.row);
                        var i = this._bb._b4(h, d.column);
                        var j = this._bb._getCellConditionalFormat1(d.row, d.column);
                        if (a == 1) {
                            e._applyFontColorFilter(j != null && j.cellFormat != null && WorkbookColorInfo.l_op_Inequality(j.cellFormat.font.colorInfo, null) ? j.cellFormat.font.colorInfo : i._bh);
                        }
                        else {
                            e.applyFillFilter(j != null && j.cellFormat != null && j.cellFormat.fill != null ? j.cellFormat.fill : i._ar);
                        }
                    }
                    break;
                default:
                    e.clearFilter();
                    break;
            }
        }
        else {
            var k = this._bb.filterSettings;
            if (k.region == null || !k.region._q(d.row, d.column)) {
                var l_7;
                var m_3;
                var n = ((function () { var o = _this._ae(false, l_7, m_3); l_7 = o.p1; m_3 = o.p2; return o.ret; })());
                if (n.isEmpty) {
                    this._ea(new SpreadsheetUserPromptInfo(30, null, null, null, false));
                    return;
                }
                if (k.region != null) {
                    k.clearRegion();
                }
                k._setRegion1(n._toString1(1), 1);
            }
            var o = d.column - k.region.firstColumn;
            switch (a) {
                case 0:
                    var p = this._fm(d);
                    if (stringIsNullOrEmpty(p)) {
                        k._k(o, true);
                    }
                    else {
                        k._k(o, false, p);
                    }
                    break;
                case 3:
                    var q = this._bb._getCellConditionalFormat1(d.row, d.column);
                    if (q == null || q.iconInfo == null || q.iconInfo.icon == -1) {
                        k._s(o, 0, Nullable$1.toNullable(Number_$type, null));
                    }
                    else {
                        k._s(o, ExcelUtils.ak(q.iconInfo.iconSet), Nullable$1.toNullable(Number_$type, intSToU(q.iconInfo.iconIndex)));
                    }
                    break;
                case 1:
                case 2:
                    {
                        var r = this._bb._rows$i._aj(d.row);
                        var s = this._bb._b4(r, d.column);
                        var t = this._bb._getCellConditionalFormat1(d.row, d.column);
                        if (a == 1) {
                            k._applyFontColorFilter(o, t != null && t.cellFormat != null && WorkbookColorInfo.l_op_Inequality(t.cellFormat.font.colorInfo, null) ? t.cellFormat.font.colorInfo : s._bh);
                        }
                        else {
                            k.applyFillFilter(o, t != null && t.cellFormat != null && t.cellFormat.fill != null ? t.cellFormat.fill : s._ar);
                        }
                    }
                    break;
                default:
                    k.clearFilter(o);
                    break;
            }
        }
    };
    SpreadsheetPaneManager.prototype._gm = function (a, b) {
        if (this._cv() == false) {
            return;
        }
        var c = this._bb.displayOptions;
        var d = c.frozenPaneSettings;
        d.frozenColumns = b;
        d.frozenRows = a;
        d.firstColumnInRightPane = this._dh.item(0).startIndex + b;
        d.firstRowInBottomPane = this._dn.item(0).startIndex + a;
        c.panesAreFrozen = true;
    };
    SpreadsheetPaneManager.prototype._z = function (a) {
        var b = a.firstRow;
        var c = a.firstColumn;
        var d = a.lastRow;
        var e = a.lastColumn;
        var f = this._bb._rows$i;
        do {
            var g = this._fi(b);
            var h = this._fh(c);
            var i = this._fe(d);
            var j = this._fc(e);
            if (nullableNotEquals(g, null)) {
                var k = this._ga(g.value, b, c, e, f, h, j);
                b = k.p1;
                c = k.p2;
                e = k.p3;
            }
            if (nullableNotEquals(i, null)) {
                var l = this._ga(i.value, d, c, e, f, h, j);
                d = l.p1;
                c = l.p2;
                e = l.p3;
            }
            if (h.hasValue && nullableNotEquals(h, c)) {
                var m = this._f8(h.value, c, b, d);
                c = m.p1;
            }
            if (j.hasValue && nullableNotEquals(j, e)) {
                var n = this._f8(j.value, e, b, d);
                e = n.p1;
            }
            var o = this._f9(b, c, d, e, g, h, i, j);
            b = o.p0;
            c = o.p1;
            d = o.p2;
            e = o.p3;
            if (nullableNotEquals(b, g) && nullableNotEquals(d, i) && nullableNotEquals(c, h) && nullableNotEquals(e, j)) {
                break;
            }
        } while (true);
        return new SpreadsheetCellRange(b, c, d, e);
    };
    SpreadsheetPaneManager.__dd = function (a, b, c) {
        var e_140, _0, _1, _2, d, e, f, g, h, i, e_140_1;
        return tslib_1.__generator(this, function (_3) {
            switch (_3.label) {
                case 0:
                    if (c === void 0) { c = null; }
                    _3.label = 1;
                case 1:
                    _3.trys.push([1, 11, 12, 13]);
                    _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next();
                    _3.label = 2;
                case 2:
                    if (!!_2.done) return [3 /*break*/, 10];
                    d = _2.value;
                    if (c != null) {
                        c(d);
                    }
                    e = d.firstRow;
                    _3.label = 3;
                case 3:
                    if (!(e <= d.lastRow)) return [3 /*break*/, 9];
                    f = d.firstColumn;
                    _3.label = 4;
                case 4:
                    if (!(f <= d.lastColumn)) return [3 /*break*/, 8];
                    g = SpreadsheetPaneManager._getCellRange2(e, f, a);
                    h = g._c;
                    if (!g.isSingleCell) {
                        i = SpreadsheetPaneManager._e2(g, a);
                        if (SpreadsheetCell._l_op_Inequality_Lifted$i(i, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            h = i.value;
                        }
                    }
                    if (!(h.row == e && h.column >= f)) return [3 /*break*/, 6];
                    return [4 /*yield*/, h];
                case 5:
                    _3.sent();
                    return [3 /*break*/, 7];
                case 6:
                    f = g.lastColumn;
                    _3.label = 7;
                case 7:
                    f++;
                    return [3 /*break*/, 4];
                case 8:
                    e++;
                    return [3 /*break*/, 3];
                case 9:
                    _2 = _1.next();
                    return [3 /*break*/, 2];
                case 10: return [3 /*break*/, 13];
                case 11:
                    e_140_1 = _3.sent();
                    e_140 = { error: e_140_1 };
                    return [3 /*break*/, 13];
                case 12:
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_140) throw e_140.error; }
                    return [7 /*endfinally*/];
                case 13: return [2 /*return*/];
            }
        });
    };
    SpreadsheetPaneManager._dd = function (a, b, c) {
        if (c === void 0) { c = null; }
        return toEnum(function () { return SpreadsheetPaneManager.__dd(a, b, c); });
    };
    SpreadsheetPaneManager.prototype._aa = function () {
        return this._u;
    };
    SpreadsheetPaneManager.prototype._es = function (a, b) {
        var c, d;
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && a._contains(b.value)) {
            d = b.value.column;
            c = this._getCellRange1(b.value.row, d).firstRow - 1;
        }
        else {
            c = a.lastRow;
            d = a.lastColumn;
        }
        do {
            if (d < a.firstColumn) {
                break;
            }
            if (c < a.firstRow) {
                if (d <= a.firstColumn) {
                    break;
                }
                d--;
                c = a.lastRow;
            }
            else if (this._bb._eg(c)) {
                c--;
            }
            else {
                var e = this._bb._cb(d);
                if (e.i) {
                    d = e.q - 1;
                }
                else {
                    var f = this._getCellRange1(c, d);
                    var g = f._c;
                    if (!f.isSingleCell) {
                        var h = this._e1(f);
                        if (SpreadsheetCell._l_op_Inequality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            g = h.value;
                        }
                    }
                    if (g.column == d && g.row == c) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, g);
                    }
                    else if (g.column == d) {
                        c = g.row;
                    }
                    else {
                        c = f.firstRow - 1;
                    }
                }
            }
        } while (true);
        return Nullable$1.toNullable(SpreadsheetCell.$, null);
    };
    SpreadsheetPaneManager.prototype._a8 = function (a) {
        var b = this._bd(this._bb._rows$i._aj(a.row), a.row, a.column);
        var c = b._ar;
        var d = this._bb._getCellConditionalFormat1(a.row, a.column);
        if (d != null && d._h != null && d._h.fill != null) {
            c = d._h.fill;
        }
        return SpreadsheetUtilities.bc(c) ? null : c;
    };
    SpreadsheetPaneManager.prototype._et = function (a, b) {
        var c, d;
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && a._contains(b.value)) {
            d = b.value.column;
            c = this._getCellRange1(b.value.row, d).lastRow + 1;
        }
        else {
            c = a.firstRow;
            d = a.firstColumn;
        }
        do {
            if (d > a.lastColumn) {
                break;
            }
            if (c > a.lastRow) {
                if (d >= a.lastColumn) {
                    break;
                }
                d++;
                c = a.firstRow;
            }
            else if (this._bb._eg(c)) {
                c++;
            }
            else {
                var e = this._bb._cb(d);
                if (e.i) {
                    d = e.r + 1;
                }
                else {
                    var f = this._getCellRange1(c, d);
                    var g = f._c;
                    if (!f.isSingleCell) {
                        var h = this._e1(f);
                        if (SpreadsheetCell._l_op_Inequality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            g = h.value;
                        }
                    }
                    if (g.row >= c && g.column >= d) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, g);
                    }
                    else {
                        c = f.lastRow + 1;
                    }
                }
            }
        } while (true);
        return Nullable$1.toNullable(SpreadsheetCell.$, null);
    };
    SpreadsheetPaneManager.prototype._eu = function (a, b, c, d, e, f) {
        if (d === void 0) { d = Nullable$1.toNullable(SpreadsheetCellRange.$, null); }
        if (e === void 0) { e = false; }
        if (f === void 0) { f = false; }
        var g = this._u;
        if (SpreadsheetCellRange._l_op_Inequality_Lifted$i(d, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
            g = g.intersect(d.value);
        }
        var h = e ? new SpreadsheetCellRange(a, b) : this._getCellRange1(a, b);
        switch (c) {
            case 0:
                {
                    do {
                        b--;
                        if (b < g.firstColumn) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        var i = this._bb._cb(b);
                        if (i.i) {
                            b = i.q;
                        }
                        else if (!h._contains2(a, b)) {
                            if (f == false || this._cr(a, b)) {
                                break;
                            }
                        }
                    } while (true);
                    break;
                }
            case 1:
                {
                    do {
                        b++;
                        if (b > g.lastColumn) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        var j = this._bb._cb(b);
                        if (j.i) {
                            b = j.r;
                        }
                        else if (!h._contains2(a, b)) {
                            if (f == false || this._cr(a, b)) {
                                break;
                            }
                        }
                    } while (true);
                    break;
                }
            case 2:
                {
                    do {
                        a--;
                        if (a < g.firstRow) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        if (!this._bb._eg(a) && !h._contains2(a, b)) {
                            if (f == false || this._cr(a, b)) {
                                break;
                            }
                        }
                    } while (true);
                    break;
                }
            case 3:
                {
                    do {
                        a++;
                        if (a > g.lastRow) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        if (!this._bb._eg(a) && !h._contains2(a, b)) {
                            if (f == false || this._cr(a, b)) {
                                break;
                            }
                        }
                    } while (true);
                    break;
                }
        }
        return Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(a, b));
    };
    SpreadsheetPaneManager.prototype.getCellRange = function (a) {
        return this._getCellRange1(a.row, a.column);
    };
    SpreadsheetPaneManager.prototype._getCellRange1 = function (a, b) {
        return SpreadsheetPaneManager._getCellRange2(a, b, this._bb);
    };
    SpreadsheetPaneManager._getCellRange2 = function (a, b, c) {
        var d = c._cr(a, b);
        if (d == null) {
            return new SpreadsheetCellRange(a, b);
        }
        else {
            var e = d._h;
            return new SpreadsheetCellRange(e._ac, e._w, e._ae, e._x);
        }
    };
    SpreadsheetPaneManager.prototype._fm = function (a, b) {
        if (b === void 0) { b = true; }
        var c = this._bb._rows$i._aj(a.row);
        if (c != null) {
            return c._getCellText1(a.column, b ? 1 : 0);
        }
        return null;
    };
    SpreadsheetPaneManager.prototype._fk = function (a) {
        var b = this._bb._rows$i._aj(a.row);
        var c = null;
        if (b != null) {
            c = b.getCellFormula(a.column);
            if (c == null) {
                c = b._getCellValue1(a.column);
            }
        }
        return c;
    };
    SpreadsheetPaneManager.prototype._ev = function (a, b, c, d, e, f) {
        if (d === void 0) { d = Nullable$1.toNullable(SpreadsheetCellRange.$, null); }
        if (e === void 0) { e = false; }
        if (f === void 0) { f = true; }
        var g = this._u;
        if (SpreadsheetCellRange._l_op_Inequality_Lifted$i(d, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
            g = g.intersect(d.value);
        }
        switch (c) {
            case 0:
            case 1:
                var h = c == 0;
                var i = this._bb._rows$i._aj(a);
                var j = Nullable$1.toNullable(Number_$type, null);
                if (i != null) {
                    do {
                        var k = i._c1(b, !h);
                        if (nullableEquals(k, null)) {
                            break;
                        }
                        if (h && nullableLessThan(k, g.firstColumn)) {
                            break;
                        }
                        if (!h && nullableGreaterThan(k, g.lastColumn)) {
                            break;
                        }
                        if (this._bb._cb(k.value).i || (e && this._cq(i, k.value) == false)) {
                            b = k.value;
                        }
                        else {
                            j = k;
                        }
                    } while (nullableEquals(j, null));
                }
                if (nullableEquals(j, null) || Math.abs(j.value - b) > 1) {
                    var l = nullableEquals(j, null) ? g : new SpreadsheetCellRange(g.firstRow, h ? Math.max(j.value - 1, g.firstColumn) : g.firstColumn, g.lastRow, !h ? Math.min(j.value - 1, g.lastColumn) : g.lastColumn);
                    var m = this._fb(a, b, c, l);
                    if (nullableNotEquals(m, null)) {
                        if (m.value._c(b)) {
                            j = Nullable$1.toNullable(Number_$type, h ? b - 1 : b + 1);
                        }
                        else if (nullableNotEquals(j, null)) {
                            j = Nullable$1.toNullable(Number_$type, h ? Math.max(m.value._h, j.value) : Math.min(m.value._i, j.value));
                        }
                        else {
                            j = Nullable$1.toNullable(Number_$type, h ? m.value._h : m.value._i);
                        }
                    }
                }
                if (nullableEquals(j, null)) {
                    if (!f) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, null);
                    }
                    if (h) {
                        var n = g.firstColumn;
                        do {
                            var o = this._bb._cb(n);
                            if (o.i) {
                                n = o.r + 1;
                            }
                            else if (e && this._cr(a, n) == false) {
                                n++;
                            }
                            else {
                                break;
                            }
                            if (n > g.lastColumn) {
                                return Nullable$1.toNullable(SpreadsheetCell.$, null);
                            }
                        } while (true);
                        j = Nullable$1.toNullable(Number_$type, n);
                    }
                    else {
                        var p = g.lastColumn;
                        do {
                            var q = this._bb._cb(p);
                            if (q.i) {
                                p = q.q - 1;
                            }
                            else if (e && this._cr(a, p) == false) {
                                p--;
                            }
                            else {
                                break;
                            }
                            if (p < g.firstColumn) {
                                return Nullable$1.toNullable(SpreadsheetCell.$, null);
                            }
                        } while (true);
                        j = Nullable$1.toNullable(Number_$type, p);
                    }
                }
                b = j.value;
                break;
            case 2:
            case 3:
                var r = c == 2;
                var s = Nullable$1.toNullable(Number_$type, null);
                do {
                    var t = this._bb._rows$i._ap(a, b, !r);
                    if (nullableEquals(t, null)) {
                        break;
                    }
                    if (r && nullableLessThan(t, g.firstRow)) {
                        break;
                    }
                    if (!r && nullableGreaterThan(t, g.lastRow)) {
                        break;
                    }
                    if (this._bb._eg(t.value) || (e && this._cr(t.value, b) == false)) {
                        a = t.value;
                    }
                    else {
                        s = t;
                    }
                } while (nullableEquals(s, null));
                if (nullableEquals(s, null) || Math.abs(s.value - a) > 1) {
                    var u = nullableEquals(s, null) ? g : new SpreadsheetCellRange(r ? Math.max(s.value - 1, g.firstRow) : g.firstRow, g.firstColumn, !r ? Math.min(s.value - 1, g.lastRow) : g.lastRow, g.lastColumn);
                    var v = this._fb(a, b, c, u);
                    if (nullableNotEquals(v, null)) {
                        if (v.value._c(a)) {
                            s = Nullable$1.toNullable(Number_$type, r ? a - 1 : a + 1);
                        }
                        else if (nullableNotEquals(s, null)) {
                            s = Nullable$1.toNullable(Number_$type, r ? Math.max(v.value._h, s.value) : Math.min(v.value._i, s.value));
                        }
                        else {
                            s = Nullable$1.toNullable(Number_$type, r ? v.value._h : v.value._i);
                        }
                    }
                }
                if (nullableEquals(s, null)) {
                    if (!f) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, null);
                    }
                    if (r) {
                        var w = g.firstRow;
                        do {
                            if (!this._bb._eg(w) && (e == false || this._cr(w, b))) {
                                break;
                            }
                            w++;
                            if (w > g.lastRow) {
                                return Nullable$1.toNullable(SpreadsheetCell.$, null);
                            }
                        } while (true);
                        s = Nullable$1.toNullable(Number_$type, w);
                    }
                    else {
                        var x = g.lastRow;
                        do {
                            if (!this._bb._eg(x) && (e == false || this._cr(x, b))) {
                                break;
                            }
                            x--;
                            if (x < g.firstRow) {
                                return Nullable$1.toNullable(SpreadsheetCell.$, null);
                            }
                        } while (true);
                        s = Nullable$1.toNullable(Number_$type, x);
                    }
                }
                a = s.value;
                break;
        }
        return Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(a, b));
    };
    SpreadsheetPaneManager.prototype._fp = function (a) {
        var b = this._bi(a.row, a.column);
        if (b != null) {
            if (b.isHeaderRowVisible) {
                return b._bz._getCellText1(a.column, 1);
            }
        }
        else {
            var c = this._bb.filterSettings.region;
            if (c != null && c._q(a.row, a.column)) {
                var d = this._bb._rows$i._aj(c.firstRow);
                if (d != null) {
                    var e = d._getCellText1(a.column, 1);
                    if (stringIsNullOrEmpty(e)) {
                        e = "(Column " + this.activePane.columnScrollRegion._b6(a.column) + ")";
                    }
                    return e;
                }
            }
        }
        return null;
    };
    SpreadsheetPaneManager.prototype._e1 = function (a) {
        return SpreadsheetPaneManager._e2(a, this._bb);
    };
    SpreadsheetPaneManager._e2 = function (a, b) {
        var c = SpreadsheetPaneManager._e3(a.firstColumn, a.lastColumn, b);
        if (nullableEquals(c, null)) {
            return Nullable$1.toNullable(SpreadsheetCell.$, null);
        }
        var d = SpreadsheetPaneManager._e4(a.firstRow, a.lastRow, b);
        if (nullableEquals(d, null)) {
            return Nullable$1.toNullable(SpreadsheetCell.$, null);
        }
        return Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(d.value, c.value));
    };
    SpreadsheetPaneManager._e3 = function (a, b, c) {
        var d = a;
        while (d <= b) {
            var e = c._cb(d);
            if (!e.i) {
                return Nullable$1.toNullable(Number_$type, d);
            }
            d = e.r + 1;
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager._e4 = function (a, b, c) {
        if (a <= b) {
            for (var d = a; d <= b; d++) {
                if (!c._eg(d)) {
                    return Nullable$1.toNullable(Number_$type, d);
                }
            }
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._e6 = function (a, b, c) {
        var d = a._aj(c);
        return d._j(b);
    };
    SpreadsheetPaneManager.prototype._e8 = function (a, b) {
        var c = b;
        while (c >= a) {
            var d = this._bb._cb(c);
            if (!d.i) {
                return Nullable$1.toNullable(Number_$type, c);
            }
            c = d.q - 1;
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._e7 = function (a) {
        var b = this._e8(a.firstColumn, a.lastColumn);
        if (nullableEquals(b, null)) {
            return Nullable$1.toNullable(SpreadsheetCell.$, null);
        }
        var c = this._e9(a.firstRow, a.lastRow);
        if (nullableEquals(c, null)) {
            return Nullable$1.toNullable(SpreadsheetCell.$, null);
        }
        return Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(c.value, b.value));
    };
    SpreadsheetPaneManager.prototype._e9 = function (a, b) {
        for (var c = b; c >= a; c--) {
            if (!this._bb._eg(c)) {
                return Nullable$1.toNullable(Number_$type, c);
            }
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._fa = function (a, b) {
        var c, d;
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && a._contains(b.value)) {
            c = b.value.row;
            d = this._getCellRange1(c, b.value.column).lastColumn + 1;
        }
        else {
            c = a.firstRow;
            d = a.firstColumn;
        }
        do {
            if (c > a.lastRow) {
                break;
            }
            if (d > a.lastColumn) {
                if (c >= a.lastRow) {
                    break;
                }
                c++;
                d = a.firstColumn;
            }
            else if (this._bb._eg(c)) {
                c++;
            }
            else {
                var e = this._bb._cb(d);
                if (e.i) {
                    d = e.r + 1;
                }
                else {
                    var f = this._getCellRange1(c, d);
                    var g = f._c;
                    if (!f.isSingleCell) {
                        var h = this._e1(f);
                        if (SpreadsheetCell._l_op_Inequality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            g = h.value;
                        }
                    }
                    if (g.row == c && g.column >= d) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, g);
                    }
                    else {
                        d = f.lastColumn + 1;
                    }
                }
            }
        } while (true);
        return Nullable$1.toNullable(SpreadsheetCell.$, null);
    };
    SpreadsheetPaneManager.prototype._fc = function (a) {
        var b = this._bb._columns$i.maxCount - 1;
        return this._fd(a, b);
    };
    SpreadsheetPaneManager.prototype._fd = function (a, b) {
        var c = a + 1;
        while (c <= b) {
            var d = this._bb._cb(c);
            if (!d.i) {
                return Nullable$1.toNullable(Number_$type, c);
            }
            c = d.r + 1;
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._fe = function (a) {
        var e_141, _0;
        var b = this._bb._rows$i.maxCount - 1;
        if (this._bb._dv && a + 1 <= b) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._bb._rows$i._m(a + 1, b))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    if (!c.hidden) {
                        return Nullable$1.toNullable(Number_$type, c.index);
                    }
                }
            }
            catch (e_141_1) { e_141 = { error: e_141_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_141) throw e_141.error; }
            }
        }
        else {
            for (var d = a + 1; d <= b; d++) {
                if (!this._bb._eg(d)) {
                    return Nullable$1.toNullable(Number_$type, d);
                }
            }
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._ei = function (a, b, c, d) {
        if (b <= 0 || b >= c) {
            return 0;
        }
        var e = a ? this._dm : this._dg;
        if (e.count < 2) {
            return 0;
        }
        b /= this._d8;
        var f = e.item(0);
        var g = f._ag(b);
        var h = f._bm(g, true);
        var i = f._bm(g, false);
        var j = b > h + (i - h) / 2 ? i : h;
        if (j < 1 || j >= c) {
            return 0;
        }
        else {
            return this._ef(j * this._d8 + d);
        }
    };
    SpreadsheetPaneManager.prototype._getPane2 = function (a, b) {
        var c = a * this._dh.count + b;
        if (c < 0 || c >= this._dl.count) {
            throw new ArgumentOutOfRangeException(0);
        }
        return this._dl.item(c);
    };
    SpreadsheetPaneManager.prototype._ar = function (a) {
        var b = this.activePane;
        if (b != null && this._b9) {
            var c = this._dn.count * this._dh.count - 1;
            if (this._dn.count > 1 && this._dn.item(0).isFrozen && this._dn.item(0).endIndex >= a.row) {
                c -= this._dh.count;
            }
            if (this._dh.count > 1 && this._dh.item(0).isFrozen && this._dh.item(0).endIndex >= a.column) {
                c -= 1;
            }
            b = this._dl.item(c);
        }
        return b;
    };
    SpreadsheetPaneManager.prototype._fg = function (a, b) {
        var c, d;
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(b, Nullable$1.toNullable(SpreadsheetCell.$, null)) && a._contains(b.value)) {
            c = b.value.row;
            d = this._getCellRange1(c, b.value.column).firstColumn - 1;
        }
        else {
            c = a.lastRow;
            d = a.lastColumn;
        }
        do {
            if (c < a.firstRow) {
                break;
            }
            if (d < a.firstColumn) {
                if (c <= a.firstRow) {
                    break;
                }
                c--;
                d = a.lastColumn;
            }
            else if (this._bb._eg(c)) {
                c--;
            }
            else {
                var e = this._bb._cb(d);
                if (e.i) {
                    d = e.q - 1;
                }
                else {
                    var f = this._getCellRange1(c, d);
                    var g = f._c;
                    if (!f.isSingleCell) {
                        var h = this._e1(f);
                        if (SpreadsheetCell._l_op_Inequality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            g = h.value;
                        }
                    }
                    if (g.column == d && g.row == c) {
                        return Nullable$1.toNullable(SpreadsheetCell.$, g);
                    }
                    else if (g.row == c) {
                        d = g.column;
                    }
                    else {
                        d = f.firstColumn - 1;
                    }
                }
            }
        } while (true);
        return Nullable$1.toNullable(SpreadsheetCell.$, null);
    };
    SpreadsheetPaneManager.prototype._fh = function (a) {
        var b = a - 1;
        while (b >= 0) {
            var c = this._bb._cb(b);
            if (!c.i) {
                return Nullable$1.toNullable(Number_$type, b);
            }
            b = c.q - 1;
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._fi = function (a) {
        var e_142, _0;
        if (this._bb._dv && a > 0) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._bb._rows$i._n(0, a - 1, false))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var b = _2.value;
                    if (!b.hidden) {
                        return Nullable$1.toNullable(Number_$type, b.index);
                    }
                }
            }
            catch (e_142_1) { e_142 = { error: e_142_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_142) throw e_142.error; }
            }
        }
        else {
            for (var c = a - 1; c >= 0; c--) {
                if (!this._bb._eg(c)) {
                    return Nullable$1.toNullable(Number_$type, c);
                }
            }
        }
        return Nullable$1.toNullable(Number_$type, null);
    };
    SpreadsheetPaneManager.prototype._ae = function (a, b, c) {
        c = Nullable$1.toNullable(SortContext_$type, null);
        b = 0;
        if (this._bh == null && this.activePane != null) {
            var d = true;
            var e = this.activePane.selection;
            var f = this._af(false);
            var g = SpreadsheetCellRange.empty;
            var h = e.activeCell;
            var i = this.getCellRange(h);
            if (e._s()._equals(i)) {
                g = this._z(i);
                var j = this._bb._tables$i;
                for (var k = 0; k < j.count; k++) {
                    var l = j._item(k)._by;
                    if (SpreadsheetUtilities.a9(g, l)) {
                        if (l._ac > i.lastRow) {
                            g = new SpreadsheetCellRange(g.firstRow, g.firstColumn, l._ac - 1, g.lastColumn);
                        }
                        else if (l._ae < i.firstRow) {
                            g = new SpreadsheetCellRange(l._ae + 1, g.firstColumn, g.lastRow, g.lastColumn);
                        }
                        else if (l._w > i.lastColumn) {
                            g = new SpreadsheetCellRange(g.firstRow, g.firstColumn, g.lastRow, l._w - 1);
                        }
                        else if (l._x < i.firstColumn) {
                            g = new SpreadsheetCellRange(g.firstRow, l._x + 1, g.lastRow, g.lastColumn);
                        }
                    }
                }
                g = g.intersect(f);
                if (g.isEmpty || !g._contains2(h.row, h.column)) {
                    c = Nullable$1.toNullable(SortContext_$type, null);
                    return {
                        ret: SpreadsheetCellRange.empty,
                        p1: b,
                        p2: c
                    };
                }
                if (a && this._bb.filterSettings.region != null && WorksheetRegionAddress._o(SpreadsheetUtilities.ay(g), this._bb.filterSettings.region._h)) {
                    c = Nullable$1.toNullable(SortContext_$type, 2);
                }
                else if (a && SpreadsheetPaneManager._cm(this._bb, g, 0)) {
                    c = Nullable$1.toNullable(SortContext_$type, 1);
                }
                else {
                    if (a && this._bb.sortSettings.region != null) {
                        if (g.intersectsWith(SpreadsheetUtilities.z(this._bb.sortSettings.region._h))) {
                            c = Nullable$1.toNullable(SortContext_$type, 1);
                            d = this._bb.sortSettings.sortType == 0;
                        }
                    }
                    if (d) {
                        var m = SpreadsheetUtilities.cr(a, g, this._bb);
                        if (!a) {
                            m--;
                        }
                        if (m > 0) {
                            b = m;
                            g = new SpreadsheetCellRange(g.firstRow + m, g.firstColumn, g.lastRow, g.lastColumn);
                        }
                    }
                }
            }
            else {
                var n = e.cellRanges.item(e.activeCellRangeIndex);
                g = f.intersect(n);
                if (g.isEmpty) {
                    c = Nullable$1.toNullable(SortContext_$type, null);
                    return {
                        ret: SpreadsheetCellRange.empty,
                        p1: b,
                        p2: c
                    };
                }
                var o = a ? SpreadsheetUtilities.cr(a, g, this._bb) : 0;
                if (a) {
                    if (n._ad == 1 || n._aa == 1) {
                        var p = this._z(n);
                        if ((n._ad == 1 && p._ad > 1) || (n._aa == 1 && p._aa > 1)) {
                            if (this._bb.sortSettings.region != null) {
                                if (p.intersectsWith(SpreadsheetUtilities.z(this._bb.sortSettings.region._h))) {
                                    c = Nullable$1.toNullable(SortContext_$type, 1);
                                    d = this._bb.sortSettings.sortType == 0;
                                }
                            }
                            if (d) {
                                g = p;
                                o = SpreadsheetUtilities.cr(a, g, this._bb);
                            }
                        }
                    }
                    else if (this._bb.sortSettings.region != null && WorksheetRegionAddress._o(SpreadsheetUtilities.ay(g), this._bb.sortSettings.region._h)) {
                        var q = this._z(n);
                        if (n._aa < q._aa) {
                            g = q;
                            o = SpreadsheetUtilities.cr(a, g, this._bb);
                        }
                    }
                    if (this._bb.filterSettings.region != null && WorksheetRegionAddress._o(SpreadsheetUtilities.ay(g), this._bb.filterSettings.region._h)) {
                        c = Nullable$1.toNullable(SortContext_$type, 2);
                        return {
                            ret: g,
                            p1: b,
                            p2: c
                        };
                    }
                }
                else if (!g._contains2(h.row, h.column)) {
                    c = Nullable$1.toNullable(SortContext_$type, null);
                    return {
                        ret: SpreadsheetCellRange.empty,
                        p1: b,
                        p2: c
                    };
                }
                if (o > 0 && g._aa > o) {
                    b = o;
                    g = new SpreadsheetCellRange(g.firstRow + o, g.firstColumn, g.lastRow, g.lastColumn);
                }
            }
            if (SpreadsheetPaneManager._cm(this._bb, g, b)) {
                c = Nullable$1.toNullable(SortContext_$type, 1);
            }
            return {
                ret: g,
                p1: b,
                p2: c
            };
        }
        c = Nullable$1.toNullable(SortContext_$type, null);
        return {
            ret: SpreadsheetCellRange.empty,
            p1: b,
            p2: c
        };
    };
    SpreadsheetPaneManager.prototype._fj = function (a) {
        var e_143, _0;
        var b = this._bb.isProtected == false || (this._bb.protection._m & a) == a;
        if (this._a2._j.count > 1) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var c = _2.value;
                    var d = c._j;
                    var e = d.isProtected == false || (d.protection._m & a) == a;
                    if (e != b) {
                        return Nullable$1.toNullable(Boolean_$type, null);
                    }
                }
            }
            catch (e_143_1) { e_143 = { error: e_143_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_143) throw e_143.error; }
            }
        }
        return Nullable$1.toNullable(Boolean_$type, b);
    };
    SpreadsheetPaneManager.prototype._q = function (a) {
        var _this = this;
        var b = new SpreadsheetCellRange();
        var c = new SpreadsheetCell();
        if (SpreadsheetCell._l_op_Equality_Lifted$i(a, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            if (this.activePane == null) {
                return null;
            }
            var d = this.activePane.selection;
            if (d.cellRanges.count > 1) {
                this._ea(new SpreadsheetUserPromptInfo(7, null, null, null, false));
                return null;
            }
            c = d.activeCell;
            b = d.cellRanges.item(0);
        }
        else {
            c = a.value;
            b = new SpreadsheetCellRange(c.row, c.column);
        }
        var e = new WorksheetCellAddress(1, c.row, c.column);
        var f = this._bi(c.row, c.column);
        if (f != null) {
            return new SortTargetResult(f, this._bb, f.wholeTableRegion._h, e, 0, 3);
        }
        if (this._bb.filterSettings.region != null && this._bb.filterSettings.region._q(c.row, c.column) && a.hasValue) {
            return new SortTargetResult(f, this._bb, this._bb.filterSettings.region._h, e, 0, 2);
        }
        else if (this._bb.sortSettings.region != null && this._bb.sortSettings.region._q(c.row, c.column) && a.hasValue) {
            return new SortTargetResult(f, this._bb, this._bb.sortSettings.region._h, e, 0, 1);
        }
        var g;
        var h;
        var i = ((function () { var j = _this._ae(true, g, h); g = j.p1; h = j.p2; return j.ret; })());
        if (i.isEmpty) {
            this._ea(new SpreadsheetUserPromptInfo(30, null, null, null, false));
            return null;
        }
        if (h.hasValue) {
            switch (h.value) {
                case 1: return new SortTargetResult(f, this._bb, SpreadsheetUtilities.ay(i), e, g, 1);
                case 3: return new SortTargetResult(f, this._bb, f.wholeTableRegion._h, e, 0, 3);
            }
        }
        if (this._bb.filterSettings.region != null && WorksheetRegionAddress._o(SpreadsheetUtilities.ay(i), this._bb.filterSettings.region._h)) {
            if (i._contains1(b)) {
                return new SortTargetResult(f, this._bb, this._bb.filterSettings.region._h, e, 0, 2);
            }
            i = i.union(b).intersect(this._af(false));
        }
        return new SortTargetResult(f, this._bb, SpreadsheetUtilities.ay(i), e, g, 0);
    };
    SpreadsheetPaneManager.prototype._af = function (a, b, c) {
        if (a === void 0) { a = false; }
        if (b === void 0) { b = 1; }
        if (c === void 0) { c = 1; }
        var d = this._bb._c4(this._u.firstRow, this._u.lastRow, this._u.firstColumn, this._u.lastColumn, a);
        if (b < 1) {
            b = 1;
        }
        if (c < 1) {
            c = 1;
        }
        return new SpreadsheetCellRange(d._ac, d._w, Math.max(d._ae, d._ac + b - 1), Math.max(d._x, d._w + c - 1));
    };
    SpreadsheetPaneManager._cf = function (a, b) {
        var e_144, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._tables$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                for (var e = 0; e < b.length; e++) {
                    var d = b[e];
                    if (c._by._j(d)) {
                        return true;
                    }
                }
            }
        }
        catch (e_144_1) { e_144 = { error: e_144_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_144) throw e_144.error; }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._b8 = function (a) {
        if (a === void 0) { a = false; }
        this._jc();
        var b = this.activePane != null ? this.activePane.selection : null;
        if (b != null) {
            var c = this._bh;
            if (c != null) {
                if (!a && c.sortSettings._sortConditions$i.count > 0) {
                    return true;
                }
                for (var d = 0; d < c._columns$i.count; d++) {
                    if (c._columns$i._item(d).filter != null) {
                        return true;
                    }
                }
            }
            else {
                var e = this._bb.filterSettings;
                if (e.region != null) {
                    if (!a || e.region._q(b.activeCell.row, b.activeCell.column)) {
                        if (!a && e.sortSettings._sortConditions$i.count > 0) {
                            return true;
                        }
                        for (var f = 0, g = e.region._ad; f < g; f++) {
                            if (e.getFilter(f) != null) {
                                return true;
                            }
                        }
                    }
                }
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._cb = function () {
        var a = this.activePane != null ? this.activePane.selection : null;
        if (this._bh != null) {
            var b = this._bh._by;
            for (var c = 0; c < a.cellRanges.count; c++) {
                var d = a.cellRanges.item(c);
                if (!b._i(d.firstRow, d.firstColumn) || !b._i(d.lastRow, d.lastColumn)) {
                    return true;
                }
            }
        }
        else if (a.cellRanges.count > 1 || !a.cellRanges.item(0).isSingleCell) {
            var e = this._bb._tables$i;
            if (e.count > 0) {
                for (var f = 0; f < e.count; f++) {
                    var g = e._item(f);
                    for (var h = 0; h < a.cellRanges.count; h++) {
                        var i = a.cellRanges.item(h);
                        if (SpreadsheetUtilities.a9(i, g._by)) {
                            return true;
                        }
                    }
                }
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._gp = function (a, b) {
        if (b) {
            this._go(a);
        }
        else {
            this._gn(a);
        }
    };
    SpreadsheetPaneManager.prototype._gt = function () {
        var e_145, _0;
        var a = this._bb.displayOptions;
        a._br();
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._dl)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = this._ff(b);
                var d = a._af.a(c.value);
                if (d == null) {
                    d = new WorksheetPaneSelection();
                    d.a = c.value;
                    d.f = 0;
                    var e = b.rowScrollRegion.startIndex;
                    var f = b.columnScrollRegion.startIndex;
                    d.b = new WorksheetCellAddress(1, e, f);
                    var g = new WorksheetRegionAddress(1, e, e, f, f);
                    var h = this._bb._hi(g);
                    g = h.p0;
                    d.d.add(g);
                    a._af.b.add(d);
                }
                var i = b.selection;
                if (i._resetSelection(SpreadsheetUtilities.g(d.d), SpreadsheetUtilities.y(d.b), d.f, false)) {
                    i._bz();
                }
                b._am = false;
            }
        }
        catch (e_145_1) { e_145 = { error: e_145_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_145) throw e_145.error; }
        }
    };
    SpreadsheetPaneManager.prototype._gw = function (a) {
        var e_146, _0;
        var b = this.activePane;
        if (b == null) {
            return;
        }
        var c = b.selection;
        if (c._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 147), false));
        }
        else if (c._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 147), false));
        }
        else if (nullableEquals(a, true) && c._bj.count > 0) {
            return;
        }
        else if (nullableEquals(a, false) && c._bi.count > 0) {
            return;
        }
        else {
            if (nullableEquals(a, null)) {
                if (c._bj.count > 0) {
                    this._gy();
                    return;
                }
                else if (c._bi.count > 0) {
                    this._gx();
                    return;
                }
                else if (this._bh != null && !this._cb() && c.cellRanges.count == 1) {
                    var d = c.cellRanges.item(0);
                    var e = this._bh.dataAreaRegion._h;
                    var f = d._aa > d._ad;
                    if (d._ad == e._af) {
                        f = false;
                    }
                    else if (d.firstRow <= e._ac && d.lastRow >= e._ae) {
                        f = true;
                    }
                    this._gz(f);
                    return;
                }
                else {
                    var g = c.cellRanges.item(0);
                    if (g._aa > g._ad) {
                        a = Nullable$1.toNullable(Boolean_$type, true);
                    }
                    else if (g._ad > g._aa) {
                        a = Nullable$1.toNullable(Boolean_$type, false);
                    }
                    else {
                        for (var h = g.firstColumn; h <= g.lastColumn; h++) {
                            if (SpreadsheetCell._l_op_Inequality_Lifted$i(Nullable$1.toNullable(SpreadsheetCell.$, null), this._ev(g.lastRow, h, 3))) {
                                a = Nullable$1.toNullable(Boolean_$type, false);
                                break;
                            }
                        }
                        if (nullableEquals(a, null)) {
                            a = Nullable$1.toNullable(Boolean_$type, true);
                        }
                    }
                }
            }
            if (nullableNotEquals(this._en(), false)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var i = Enumerable.a(SpreadsheetCellRange.$, c.cellRanges);
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var j = _2.value;
                    for (var l = 0; l < i.length; l++) {
                        var k = i[l];
                        j._j._hr(SpreadsheetUtilities.ay(k), nullableEquals(a, true));
                    }
                }
            }
            catch (e_146_1) { e_146 = { error: e_146_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_146) throw e_146.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gx = function () {
        var e_147, _0;
        var a = this.activePane;
        if (a == null) {
            return;
        }
        var b = a.selection;
        if (b._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 147), false));
        }
        else if (b._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 147), false));
        }
        else {
            if (nullableNotEquals(this._fj(32), true)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var c = Enumerable.a(IntRange.$, Enumerable.n(IntRange.$, b._bf));
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    for (var f = 0; f < c.length; f++) {
                        var e = c[f];
                        d._j._columns$i.insert(e._i, (e._h - e._i) + 1);
                    }
                }
            }
            catch (e_147_1) { e_147 = { error: e_147_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_147) throw e_147.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gy = function () {
        var e_148, _0;
        var a = this.activePane;
        if (a == null) {
            return;
        }
        var b = a.selection;
        if (b._aw) {
            this._ea(new SpreadsheetUserPromptInfo(8, null, null, enumGetBox(SpreadsheetAction_$type, 145), false));
        }
        else if (b._ax) {
            this._ea(new SpreadsheetUserPromptInfo(6, null, null, enumGetBox(SpreadsheetAction_$type, 145), false));
        }
        else {
            if (nullableNotEquals(this._fj(64), true)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            var c = Enumerable.a(IntRange.$, Enumerable.n(IntRange.$, b._bg));
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    for (var f = 0; f < c.length; f++) {
                        var e = c[f];
                        d._j._rows$i.insert(e._i, (e._h - e._i) + 1);
                    }
                }
            }
            catch (e_148_1) { e_148 = { error: e_148_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_148) throw e_148.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._gz = function (a) {
        if (this._bh == null) {
            return;
        }
        var b = this.activePane.selection;
        var c = this._bh;
        var d = b._s();
        if (a) {
            c.insertColumns(d.firstColumn - c._by._w, d._ad);
        }
        else {
            c.insertDataRows(d.firstRow - c.dataAreaRegion.firstRow, d._aa);
        }
    };
    SpreadsheetPaneManager.prototype._g0 = function () {
        this._cj = true;
    };
    SpreadsheetPaneManager.prototype._cg = function () {
        var a = this._bh;
        if (a != null) {
            if (a.isHeaderRowVisible && a.isFilterUIVisible) {
                return true;
            }
            for (var b = 0; b < a._columns$i.count; b++) {
                if (a._columns$i._item(b).filter != null) {
                    return true;
                }
            }
            return false;
        }
        else {
            return this._bb.filterSettings.region != null;
        }
    };
    SpreadsheetPaneManager.prototype._ck = function (a) {
        return a == this._n || a == this._h;
    };
    SpreadsheetPaneManager.prototype._cl = function (a) {
        return a == this._i || a == this._g || a == this._o || a == this._m;
    };
    SpreadsheetPaneManager.prototype._jn = function (a) {
        var e_149, _0, e_150, _1;
        this._i9();
        if (a.isEmpty) {
            a = new Size(0);
        }
        if (isInfinity(a.height)) {
            a.height = this._dz(truncate(this._jl.height));
        }
        if (isInfinity(a.width)) {
            a.width = this._dy(truncate(this._jl.width));
        }
        var b = false;
        if (Size.l_op_Inequality(a, this._ji) || this._cj) {
            b = true;
            {
                var c = Workbook._fc(this._bb.workbook);
                try {
                    if (a.width != this._ji.width) {
                        this._g1(this._dh);
                    }
                    if (a.height != this._ji.height) {
                        this._g1(this._dn);
                    }
                    this._i5();
                    this._i7();
                    this._cj = false;
                    this._ji = a;
                    this._ek(this._dh, a.width, this._d4, this._bb.workbook.maxColumnCount - 1, false, runOn(this, this._di), runOn(this, this._dy), runOn(this, this._el), runOn(this, this._fh), runOn(this, this._fc));
                    this._ek(this._dn, a.height, this._d3, this._bb.workbook.maxRowCount - 1, false, runOn(this._bb, this._bb._e2), runOn(this, this._dz), runOn(this, this._em), runOn(this, this._fi), runOn(this, this._fe));
                    this._jb();
                    this._i8();
                    try {
                        for (var _2 = tslib_1.__values(fromEnum(this._dh)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                            var d = _3.value;
                            d._z = this._dn.item(0);
                        }
                    }
                    catch (e_149_1) { e_149 = { error: e_149_1 }; }
                    finally {
                        try {
                            if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                        }
                        finally { if (e_149) throw e_149.error; }
                    }
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(this._dn)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var e = _5.value;
                            e._z = this._dh.item(0);
                        }
                    }
                    catch (e_150_1) { e_150 = { error: e_150_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_150) throw e_150.error; }
                    }
                    this._i3();
                    this._i1();
                }
                finally {
                    if (c != null) {
                        c.dispose();
                    }
                }
            }
        }
        if (b) {
            if (this._al._o != null) {
                this._al._o();
            }
        }
        return a;
    };
    SpreadsheetPaneManager.prototype._g2 = function (a) {
        var _this = this;
        var e_151, _0, e_152, _1, e_153, _2, e_154, _3, e_155, _4;
        var b = this.activePane;
        if (b == null) {
            return;
        }
        var c = b.selection;
        switch (a) {
            case 1:
            case 2:
                if (c._ax) {
                    return;
                }
                break;
        }
        if (nullableNotEquals(this._en(), false)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        var d = new Array(this._a2._j.count);
        var e = Enumerable.a(SpreadsheetCellRange.$, c.cellRanges);
        var f = Enumerable.a(SpreadsheetCellRange.$, c.cellRanges);
        var g = false;
        var h = false;
        for (var i = 0; i < d.length; i++) {
            d[i] = new SpreadsheetPaneManager_MergedCellOperationInfo(this._a2._j.item(i)._j, e);
            if (d[i].d) {
                g = true;
                for (var j = 0; j < f.length; j++) {
                    f[j] = f[j].union(d[i].a[j]);
                }
                h = h || d[i].c;
            }
        }
        if (g) {
            c._resetSelection(f, c.activeCell, c.activeCellRangeIndex, false);
            switch (a) {
                case 1:
                case 2:
                case 3:
                    if (!this._bu()) {
                        return;
                    }
                    break;
            }
        }
        var k = a == 3 && Enumerable.c(SpreadsheetPaneManager_MergedCellOperationInfo.$, Enumerable.u(SpreadsheetPaneManager_MergedCellOperationInfo.$, d, function (l) { return l.b == _this._a2._o._j && l.e.count > 0; }));
        for (var m = 0; m < d.length; m++) {
            var l = d[m];
            var n = l.b;
            var o = n._mergedCellsRegions$i;
            try {
                for (var _5 = tslib_1.__values(fromEnum(l.e)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                    var p = _6.value;
                    o.remove_1(p);
                }
            }
            catch (e_151_1) { e_151 = { error: e_151_1 }; }
            finally {
                try {
                    if (_6 && !_6.done && (_0 = _5.return)) _0.call(_5);
                }
                finally { if (e_151) throw e_151.error; }
            }
            if (a != 0) {
                var q = Enumerable.n(SpreadsheetCellRange.$, l.a);
                switch (a) {
                    case 3:
                        if (k) {
                            try {
                                for (var _7 = tslib_1.__values(fromEnum(l.e)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                    var r = _8.value;
                                    var s = r._h;
                                    for (var t = s._ac, u = s._ae; t <= u; t++) {
                                        var v = n._rows$i.item(t);
                                        for (var w = s._w, x = s._x; w <= x; w++) {
                                            v._bc(w).alignment = 0;
                                        }
                                    }
                                }
                            }
                            catch (e_152_1) { e_152 = { error: e_152_1 }; }
                            finally {
                                try {
                                    if (_8 && !_8.done && (_1 = _7.return)) _1.call(_7);
                                }
                                finally { if (e_152) throw e_152.error; }
                            }
                            continue;
                        }
                        try {
                            for (var _9 = tslib_1.__values(fromEnum(q)), _10 = _9.next(); !_10.done; _10 = _9.next()) {
                                var y = _10.value;
                                if (y.isSingleCell) {
                                    n._rows$i.item(y.firstRow).getCellFormat(y.firstColumn).alignment = 2;
                                }
                                else {
                                    var z = o._add1(y.firstRow, y.firstColumn, y.lastRow, y.lastColumn);
                                    z.cellFormat.alignment = 2;
                                }
                            }
                        }
                        catch (e_153_1) { e_153 = { error: e_153_1 }; }
                        finally {
                            try {
                                if (_10 && !_10.done && (_2 = _9.return)) _2.call(_9);
                            }
                            finally { if (e_153) throw e_153.error; }
                        }
                        break;
                    case 1:
                        try {
                            for (var _11 = tslib_1.__values(fromEnum(q)), _12 = _11.next(); !_12.done; _12 = _11.next()) {
                                var aa = _12.value;
                                if (!aa.isSingleCell) {
                                    o._add1(aa.firstRow, aa.firstColumn, aa.lastRow, aa.lastColumn);
                                }
                            }
                        }
                        catch (e_154_1) { e_154 = { error: e_154_1 }; }
                        finally {
                            try {
                                if (_12 && !_12.done && (_3 = _11.return)) _3.call(_11);
                            }
                            finally { if (e_154) throw e_154.error; }
                        }
                        break;
                    case 2:
                        try {
                            for (var _13 = tslib_1.__values(fromEnum(q)), _14 = _13.next(); !_14.done; _14 = _13.next()) {
                                var ab = _14.value;
                                if (ab.firstColumn == ab.lastColumn) {
                                    continue;
                                }
                                for (var ac = ab.firstRow; ac <= ab.lastRow; ac++) {
                                    o._add1(ac, ab.firstColumn, ac, ab.lastColumn);
                                }
                            }
                        }
                        catch (e_155_1) { e_155 = { error: e_155_1 }; }
                        finally {
                            try {
                                if (_14 && !_14.done && (_4 = _13.return)) _4.call(_13);
                            }
                            finally { if (e_155) throw e_155.error; }
                        }
                        break;
                }
            }
        }
        if (g) {
            var ad = c.activeCell;
            for (var af = 0; af < d.length; af++) {
                var ae = d[af];
                ad = SpreadsheetPaneManager._getCellRange2(ad.row, ad.column, ae.b)._c;
            }
            c._setActiveCell(ad);
        }
    };
    SpreadsheetPaneManager.prototype._g3 = function (a, b, c) {
        var d = this.activePane;
        var e = d != null ? d.selection : null;
        if (e != null) {
            var f = e.activeCell;
            var g = f;
            var h = this._getCellRange1(f.row, f.column);
            var i = e._s();
            var j = c == false && this._bb.isProtected && this._bb.protection.selectionMode == 1 && b != 2;
            if (c) {
                if (a == 0 || a == 1) {
                    h = new SpreadsheetCellRange(i.firstRow, h.firstColumn, i.lastRow, h.lastColumn);
                }
                else {
                    h = new SpreadsheetCellRange(h.firstRow, i.firstColumn, h.lastRow, i.lastColumn);
                }
                h = this.extendRangeForMergedCells(h);
                var k = b == 2 || b == 1;
                var l = k ? f.row : i.firstRow < f.row ? i.firstRow : i.lastRow;
                var m = k ? f.column : i.firstColumn < f.column ? i.firstColumn : i.lastColumn;
                switch (a) {
                    case 1:
                        if (h.firstColumn <= i.firstColumn) {
                            g = new SpreadsheetCell(l, i.lastColumn);
                        }
                        else {
                            g = new SpreadsheetCell(l, i.firstColumn);
                        }
                        break;
                    case 0:
                        if (h.lastColumn >= i.lastColumn) {
                            g = new SpreadsheetCell(l, i.firstColumn);
                        }
                        else {
                            g = new SpreadsheetCell(l, i.lastColumn);
                        }
                        break;
                    case 3:
                        if (h.firstRow <= i.firstRow) {
                            g = new SpreadsheetCell(i.lastRow, m);
                        }
                        else {
                            g = new SpreadsheetCell(i.firstRow, m);
                        }
                        break;
                    case 2:
                        if (h.lastRow >= i.lastRow) {
                            g = new SpreadsheetCell(i.firstRow, m);
                        }
                        else {
                            g = new SpreadsheetCell(i.lastRow, m);
                        }
                        break;
                    default: return;
                }
            }
            var n = this._eo(g, a, b, j);
            var o = !nullableIsNull(n) ? n.value : g;
            if (c == false) {
                this._ij(o);
            }
            else {
                this._hz(a, f, i, o);
            }
        }
    };
    SpreadsheetPaneManager.prototype._g4 = function (a, b) {
        if (!this._ji.isEmpty) {
            this._jn(this._ji);
        }
        var c = this.activePane;
        if (c != null) {
            var d = c.selection;
            var e = d.activeCell;
            var f = this._jo;
            if (!f.isEmpty) {
                var g = d._s();
                var h = void 0;
                var i = void 0;
                switch (a) {
                    default:
                        h = c.rowScrollRegion;
                        i = e.row;
                        break;
                    case 0:
                    case 1:
                        h = c.columnScrollRegion;
                        i = e.column;
                        break;
                }
                if (b) {
                    var j = this._getCellRange1(e.row, e.column);
                    switch (a) {
                        case 2:
                            i = g.lastRow;
                            break;
                        case 0:
                            i = g.lastColumn;
                            break;
                        case 3:
                            i = Math.max(g.lastRow, j.lastRow);
                            break;
                        case 1:
                            i = Math.max(g.lastColumn, j.lastColumn);
                            break;
                    }
                }
                var k = i - h.startIndex;
                this._ia(a);
                this._jn(f);
                var l = h.startIndex + k;
                if (l < h.startIndex) {
                    l = h.startIndex;
                }
                else if (l > h.endIndex) {
                    l = h.endIndex;
                }
                var m = new SpreadsheetCell();
                switch (a) {
                    default:
                    case 2:
                    case 3:
                        m = new SpreadsheetCell(l, e.column);
                        break;
                    case 0:
                    case 1:
                        m = new SpreadsheetCell(e.row, l);
                        break;
                }
                if (!b) {
                    this._ij(m);
                }
                else {
                    this._hz(a, e, g, m);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._g5 = function (a, b) {
        var c = this.activePane;
        if (c != null) {
            var d = c.columnScrollRegion._aj(true);
            var e = c.rowScrollRegion._aj(true);
            var f = new SpreadsheetCellRange(e._i, d._i, e._h, d._h);
            var g = a ? this._e1(f) : this._e7(f);
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(g, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                if (!b) {
                    this._ij(g.value);
                }
                else {
                    this._cs(g.value);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._g6 = function (a, b) {
        var c = 0;
        if (b && this._b9) {
            var d = Enumerable.af(SpreadsheetColumnScrollRegion.$, this._dh);
            if (d != null && d.isFrozen) {
                c = d.endIndex + 1;
            }
        }
        var e = SpreadsheetPaneManager._e3(c, this._bc._columns$i.maxCount - 1, this._bb);
        if (nullableNotEquals(e, null)) {
            var f = new SpreadsheetCell(this.activePane.selection.activeCell.row, e.value);
            if (!a) {
                this._ij(f);
            }
            else {
                this._hz(0, this.activePane.selection.activeCell, this.activePane.selection._s(), f);
            }
        }
    };
    SpreadsheetPaneManager.prototype._g7 = function (a, b) {
        var c = this._aa();
        if (b && this._b9) {
            var d = 0;
            var e = 0;
            var f = Enumerable.af(SpreadsheetColumnScrollRegion.$, this._dh);
            var g = Enumerable.af(SpreadsheetRowScrollRegion.$, this._dn);
            if (f != null && f.isFrozen) {
                d = f.endIndex + 1;
            }
            if (g != null && g.isFrozen) {
                e = g.endIndex + 1;
            }
            c = new SpreadsheetCellRange(Math.max(Math.min(e, c.lastRow), c.firstRow), Math.max(Math.min(d, c.lastColumn), c.firstColumn), c.lastRow, c.lastColumn);
        }
        var h = this._e1(c);
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            if (!a) {
                this._ij(h.value);
            }
            else {
                if (this._cs(h.value)) {
                    this._b2(null, h.value, true);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._g8 = function (a) {
        this._jd();
        var b = new SpreadsheetCellRange(this._t.firstRow, this._t.firstColumn, this._t.lastRow + 1, this._t.lastColumn + 1);
        var c = a ? this._e1(b) : this._e7(b);
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(c, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            while (SpreadsheetCell._l_op_Inequality_Lifted$i(c, Nullable$1.toNullable(SpreadsheetCell.$, null)) && this._cr(c.value.row, c.value.column) == false) {
                c = a ? this._fa(b, c) : this._fg(b, c);
            }
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(c, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                this._ij(c.value);
            }
        }
    };
    SpreadsheetPaneManager.prototype._g9 = function (a) {
        var b = this.activePane.visibleRange;
        var c = this.activePane.selection;
        var d = c._s();
        d = b.intersect(d);
        if (!d.isEmpty) {
            var e = a ? this._e1(d) : this._e7(d);
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCell.$, null)) && this._canSelect(e.value)) {
                c._setActiveCell(e.value, Nullable$1.toNullable(Number_$type, c.activeCellRangeIndex));
            }
        }
    };
    SpreadsheetPaneManager.prototype._ha = function (a) {
        var b = this._af(false, 1, 1);
        var c = this._e7(b);
        if (SpreadsheetCell._l_op_Inequality_Lifted$i(c, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
            var d = this._getCellRange1(c.value.row, c.value.column);
            c = this._e1(d);
            if (!a) {
                this._ij(c.value);
            }
            else {
                if (this._cs(c.value)) {
                    this._b2(null, c.value, true);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._hb = function (a) {
        var b = this._af(false, 1, 1);
        var c = this._e8(b.firstColumn, b.lastColumn);
        var d = this.activePane;
        if (nullableNotEquals(c, null) && d != null) {
            var e = d.selection;
            var f = e.activeCell;
            var g = this._getCellRange1(f.row, c.value);
            var h = SpreadsheetPaneManager._e4(g.firstRow, g.lastRow, this._bb);
            var i = new SpreadsheetCell(!nullableIsNull(h) ? h.value : f.row, c.value);
            if (!a) {
                this._ij(i);
            }
            else {
                this._hz(1, f, e._s(), i);
            }
        }
    };
    SpreadsheetPaneManager.prototype._ct = function (a) {
        if (!this._b9) {
            var b = this._bb.displayOptions.unfrozenPaneSettings;
            var c = a ? b.topPaneHeight : b.leftPaneWidth;
            var d = a ? this._dm : this._dg;
            if (c > 0 && d.count > 1) {
                var e = d.item(0);
                var f = e._bk;
                if (f < 0.5 || e._m.count == 0) {
                    return false;
                }
                var g = Enumerable.ah(WorksheetItemPosition.$, e._m);
                var h = a ? this._dz(g._i) : this._dy(g._i);
                if (Math.abs(h - f) < 0.5) {
                    return false;
                }
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._hc = function (a, b) {
        if (b === void 0) { b = Nullable$1.toNullable(Boolean_$type, null); }
        var c = this.activePane.selection;
        if (c != null) {
            var d = c.cellRanges;
            c._by();
            var e = c.activeCell;
            var f = this._getCellRange1(e.row, e.column);
            var g = e;
            var h = c.activeCellRangeIndex;
            var i = !nullableIsNull(b) ? b.value : this._bb.isProtected;
            if (d.count == 1 && f._contains1(d.item(0))) {
                if (i) {
                    var j = this._eo(e, a, 0, true);
                    g = !nullableIsNull(j) ? j.value : e;
                }
                else {
                    var k = e.row;
                    var l = e.column;
                    switch (a) {
                        case 1:
                            l = f.lastColumn;
                            break;
                        case 0:
                            l = f.firstColumn;
                            break;
                        case 3:
                            k = f.lastRow;
                            break;
                        case 2:
                            k = f.firstRow;
                            break;
                    }
                    var m = this._eu(k, l, a);
                    g = !nullableIsNull(m) ? m.value : e;
                }
                this._ik(g, false, Nullable$1.toNullable(SpreadsheetCellRange.$, new SpreadsheetCellRange(g.row, g.column)));
            }
            else {
                var n = c.activeCellRangeIndex;
                var o = d.count;
                var p = a == 0 || a == 2 ? -1 : 1;
                for (var q = 0; q <= o; q++) {
                    var r = (q * p + n + o) % o;
                    var s = d.item(r);
                    var t = q == 0 ? Nullable$1.toNullable(SpreadsheetCell.$, e) : Nullable$1.toNullable(SpreadsheetCell.$, null);
                    var u = Nullable$1.toNullable(SpreadsheetCell.$, null);
                    if (i) {
                        if (q != 0) {
                            switch (a) {
                                case 2:
                                case 0:
                                    t = Nullable$1.toNullable(SpreadsheetCell.$, s._b);
                                    break;
                                case 3:
                                case 1:
                                    t = Nullable$1.toNullable(SpreadsheetCell.$, s._c);
                                    break;
                            }
                        }
                        u = this._eo(t.value, a, 0, true, Nullable$1.toNullable(SpreadsheetCellRange.$, s), q != 0);
                    }
                    else {
                        switch (a) {
                            case 2:
                                u = this._es(s, t);
                                break;
                            case 3:
                                u = this._et(s, t);
                                break;
                            case 0:
                                u = this._fg(s, t);
                                break;
                            case 1:
                                u = this._fa(s, t);
                                break;
                        }
                    }
                    if (SpreadsheetCell._l_op_Inequality_Lifted$i(u, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                        g = u.value;
                        h = r;
                        break;
                    }
                }
                if (this._canSelect(g) && c._setActiveCell(g, Nullable$1.toNullable(Number_$type, h))) {
                    this._b3(null, new SpreadsheetCellRange(g.row, g.column), true);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._hd = function ($tContext, $tValue, a, b) {
        if (this._b7(1048576) && SpreadsheetPaneManager._ch(b)) {
            return;
        }
        var c = 0;
        switch (b.a) {
            case 28:
                switch (b.c) {
                    case "Remove":
                        c = 5 | 32768 | 3;
                        break;
                }
                break;
            case 7:
                if (this._p.n) {
                    if (b.c == "ChartShift") {
                        this._p.ab(a);
                    }
                    else {
                        this._p.aa(a.source);
                    }
                }
                break;
            case 6:
            case 8:
                c = 515;
                break;
            case 66:
            case 68:
            case 69:
            case 67:
            case 70:
            case 71: break;
            case 4:
            case 61:
            case 85:
            case 27:
                switch (b.c) {
                    case "Alignment":
                    case "FontBold":
                    case "FontColorInfo":
                    case "FontHeight":
                    case "FontItalic":
                    case "FontName":
                    case "FontStrikeout":
                    case "FontSuperscriptSubscriptStyle":
                    case "FontUnderlineStyle":
                    case "FormatString":
                    case "Indent":
                    case "Rotation":
                    case "ShrinkToFit":
                    case "Style":
                    case "VerticalAlignment":
                    case "WrapText":
                    case "FormatOptions":
                    case "SetFormatting":
                    case "SetFontFormatting":
                        c = 5 | 3;
                        break;
                    case "Locked":
                        c = 3;
                        break;
                    case "BottomBorderColorInfo":
                    case "BottomBorderStyle":
                    case "DiagonalBorderColorInfo":
                    case "DiagonalBorders":
                    case "DiagonalBorderStyle":
                    case "Fill":
                    case "LeftBorderColorInfo":
                    case "LeftBorderStyle":
                    case "RightBorderColorInfo":
                    case "RightBorderStyle":
                    case "TopBorderColorInfo":
                    case "TopBorderStyle":
                        c = 3;
                        break;
                    default: break;
                }
                break;
            case 47:
                switch (b.c) {
                    case "OnVisited":
                    case "DisplayText":
                        c = 5;
                        break;
                }
                break;
            case 48:
            case 49:
            case 16:
                c = 5 | 3;
                break;
            case 5:
                c = 5 | 3;
                break;
            case 26:
                switch (b.c) {
                    case "Width":
                        c = 5 | 9;
                        break;
                    case "Hidden":
                        c = 5 | 9;
                        if (this._p.n) {
                            this._p.g.m(b.k(a), a);
                            this._ht(268435456);
                        }
                        break;
                }
                break;
            case 60:
                switch (b.c) {
                    case "Height":
                        c = 5 | 9;
                        break;
                    case "Hidden":
                        c = 5 | 9;
                        if (this._p.n) {
                            this._p.g.m(b.k(a), a);
                            this._ht(268435456);
                        }
                        break;
                }
                break;
            case 65:
            case 9:
            case 90:
                switch (b.c) {
                    case "DefaultColumnWidth":
                    case "DefaultRowHeight":
                    case "DefaultRowHidden":
                        c = 5 | 9;
                        break;
                    case "ImageBackground":
                        c = 1;
                        break;
                    case "IsProtected":
                        c = this._au() | 128;
                        break;
                    case "ValidationInputMessagePosition":
                        c = 1024;
                        break;
                    case "ResizeColumns":
                    case "ResizeRows":
                        c = 5 | 9;
                        if (this._p.n) {
                            if (a.hasHiddenChanges) {
                                this._p.g.m(b.k(a), a);
                                this._ht(268435456);
                            }
                        }
                        break;
                }
                break;
            case 35:
                switch (b.c) {
                    case "Reset":
                        c = 1 | 5 | 3 | 17 | 128 | 1024;
                        break;
                    case "ShowGridlines":
                    case "GridlineColor":
                        this._p.ac();
                        c = 1;
                        break;
                    case "ShowRowAndColumnHeaders":
                    case "MagnificationInNormalView":
                        c = 1 | 128;
                        break;
                    case "ShowZeroValues":
                    case "ShowFormulasInCells":
                        c = 5 | 3 | 1024;
                        break;
                    case "FirstColumnInRightPane":
                    case "FirstRowInBottomPane":
                    case "FirstColumnInLeftPane":
                    case "FirstRowInTopPane":
                    case "FrozenColumns":
                    case "FrozenRows":
                    case "LeftPaneWidth":
                    case "TopPaneHeight":
                    case "PanesAreFrozen":
                        c = 17;
                        break;
                }
                break;
            case 86:
                switch (b.c) {
                    case "ScrollBars":
                    case "ObjectDisplayStyle":
                        c = 1;
                        break;
                    case "Reset":
                        c = 1;
                        break;
                }
                break;
            case 99:
                c = 49;
                break;
            case 89:
                c = 257;
                break;
            case 87:
                switch (b.c) {
                    case "CellReferenceMode":
                        c = 17;
                        break;
                    case "Culture":
                    case "EditingCulture":
                    case "DateSystem":
                    case "Precision":
                    case "VolatileFormulaDirtied":
                        c = 5;
                        break;
                }
                break;
            case 93:
            case 94:
            case 95:
            case 96:
            case 97:
            case 98:
                c = 32768 | 1 | 5 | 3 | 8192;
                break;
            case 50:
                c = 5 | 3 | 64 | 17;
                break;
            case 18:
            case 51:
                c = 5 | 3 | 64;
                break;
            case 62:
                c = 515;
                break;
            case 21:
            case 63:
            case 64:
                c = 5 | 3;
                break;
            case 25:
            case 73:
            case 75:
            case 76:
            case 77:
            case 78:
            case 84:
            case 79:
                c = 5 | 3 | 8192;
                break;
            case 72:
                c = 5 | 8192;
                break;
            case 103:
                switch (b.c) {
                    case "SelectionMode":
                        c = this._au() | 128;
                        break;
                }
                break;
            case 74:
                switch (b.c) {
                    case "Filter":
                        c = 16384;
                        break;
                }
                break;
            case 12:
            case 31:
            case 32:
            case 33:
                c = 4096 | 16384;
                break;
            case 38:
            case 23:
            case 22:
            case 80:
                c = 16384;
                break;
            case 3:
            case 88:
            case 91:
            case 92:
            case 17:
            case 53:
            case 54:
            case 11:
            case 29:
            case 30:
            case 13:
            case 36:
            case 37:
            case 10:
            case 0:
            case 59:
            case 15:
            case 39:
            case 40:
            case 19:
            case 55:
            case 56:
            case 20:
            case 57:
            case 58:
            case 24:
            case 81:
            case 82:
            case 83:
            case 41:
            case 42:
            case 43:
            case 44:
            case 45:
            case 14:
            case 34:
            case 46:
            case 52: break;
            default: break;
        }
        if (c != 0) {
            this._at |= c;
            this._ht(65536);
        }
    };
    SpreadsheetPaneManager.prototype._he = function (a, b, c) {
        if (this._p.n) {
            this._p.g.k(a, b, c);
            this._ht(268435456);
        }
        if (a == this._bb && !this._b7(16384)) {
            if (b >= 0 && c >= 0) {
                this._p.af(b, c);
            }
            this._ip(8192, true);
            this._ht(16);
            this._cj = true;
        }
    };
    SpreadsheetPaneManager.prototype._hf = function (a) {
        this._p.k.n(true);
        this._p.z();
        if (!this._b7(16384)) {
            this._cj = true;
        }
    };
    SpreadsheetPaneManager.prototype._hg = function () {
        this._gs();
        this._ht(32 | 8 | 8192 | 1024 | 16);
        this._cj = true;
        this._jn(this._jo);
    };
    SpreadsheetPaneManager.prototype._hh = function () {
        this._p.ag();
    };
    SpreadsheetPaneManager.prototype._cu = function (a, b) {
        var e_156, _0;
        if (b) {
            var c = this._bb.displayOptions.magnificationInNormalView;
            var d = Math.max(10, Math.min(400, truncate(MathUtilities.f(c - a * 5))));
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var e = _2.value;
                    e._j.displayOptions.magnificationInNormalView = d;
                }
            }
            catch (e_156_1) { e_156 = { error: e_156_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_156) throw e_156.error; }
            }
        }
        else {
            var f = this.activePane != null ? this.getScrollableRegion(this.activePane.rowScrollRegion) : null;
            if (f != null) {
                var g = a < 0;
                var h = truncate(Math.max(1, MathUtilities.f(Math.abs(a)))) * (g ? -1 : 1);
                var i = f.startIndex + h;
                if (i < 0) {
                    i = 0;
                }
                else if (i >= this._bb._rows$i.maxCount) {
                    i = this._bb._rows$i.maxCount - 1;
                }
                else if (this._bb._eg(i)) {
                    var j = this._er(i, !g);
                    if (nullableNotEquals(j, null)) {
                        i = j.value;
                    }
                }
                return this._c2(f, i, this._ee, this._bb.workbook.maxRowCount, this._jj.height, runOn(this._bb, this._bb._cq), runOn(this._bb, this._bb._cp));
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._hk = function () {
        this._p.ah();
        this._cj = true;
    };
    SpreadsheetPaneManager.prototype._hm = function (a) {
        if (this._bb.isProtected && this._bb.protection.selectionMode == 1) {
            this._g3(a, 0, false);
        }
        else {
            this._hc(a, Nullable$1.toNullable(Boolean_$type, false));
        }
    };
    SpreadsheetPaneManager.prototype._hr = function () {
        if (this._cc) {
            this._jf(true);
        }
    };
    SpreadsheetPaneManager.prototype.queueExpensiveOperation = function (a) {
        var b = new DisposableAction(a);
        this._dp.g(b);
        this._iv();
        return b;
    };
    SpreadsheetPaneManager.prototype._hu = function () {
        var a = this._bh;
        if (a != null) {
            a.reapplyFilters();
            a.reapplySortConditions();
        }
        else if (this._bb.filterSettings.region != null) {
            this._bb.filterSettings.reapplyFilters();
            this._bb.filterSettings.reapplySortConditions();
        }
    };
    SpreadsheetPaneManager.prototype._ag = function (a) {
        var b = SpreadsheetUtilities.ay(a);
        var c = this._bb._ic(b);
        b = c.p0;
        if (!b._n) {
            return a;
        }
        return SpreadsheetUtilities.z(b);
    };
    SpreadsheetPaneManager.prototype._hv = function () {
        this._p.z();
        this._al._j.al();
    };
    SpreadsheetPaneManager.prototype._cx = function (a, b) {
        this._jc();
        var c = SpreadsheetUtilities.w(this._bb, b.row, b.column);
        if (c != null) {
            if (a) {
                return c.g;
            }
            return c.n();
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._hw = function (a, b) {
        if (b === void 0) { b = true; }
        if (a == false && this._b1(true, true)) {
            return;
        }
        if (nullableNotEquals(this._en(), false)) {
            var c = this._fj(128);
            if (nullableNotEquals(c, true)) {
                this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
                return;
            }
            else {
                var d = new LockedEditRangeInfoForOperation();
                var e = void 0;
                var f = this._cy(a, true, e, d, true);
                e = f.p2;
                var g = this._aw(d, e, b);
                switch (g) {
                    case 0: return;
                    case 1: break;
                    case 2:
                        this._hw(a, false);
                        return;
                }
            }
        }
        var h;
        var i = this._cy(a, false, h, null);
        h = i.p2;
    };
    SpreadsheetPaneManager.prototype._hy = function (a, b) {
        var c = this._bb.displayOptions;
        if (c.panesAreFrozen) {
            if (a) {
                c.frozenPaneSettings.frozenRows = 0;
            }
            if (b) {
                c.frozenPaneSettings.frozenColumns = 0;
            }
        }
        else {
            if (a) {
                c.unfrozenPaneSettings.topPaneHeight = 0;
            }
            if (b) {
                c.unfrozenPaneSettings.leftPaneWidth = 0;
            }
        }
    };
    SpreadsheetPaneManager.prototype._h0 = function (a) {
        var e_157, _0;
        var b = this.activePane;
        var c = b != null ? b.selection : null;
        if (c != null) {
            var d = a ? c._bi : c._bf;
            if (d.count > 0) {
                var e = new List$1(IndexRange.$, 2, d.count);
                for (var f = 0; f < d.count; f++) {
                    e.add(new IndexRange(1, d.item(f)._i, d.item(f)._h));
                }
                try {
                    for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var g = _2.value;
                        var h = g._j;
                        var i = h.defaultColumnWidth;
                        h._ik(e, i);
                    }
                }
                catch (e_157_1) { e_157 = { error: e_157_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_157) throw e_157.error; }
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._h1 = function (a) {
        var e_158, _0, e_159, _1, e_160, _2;
        var b = this.activePane;
        var c = b != null ? b.selection : null;
        if (c != null) {
            var d = a ? c._bj : c._bg;
            if (d.count > 0) {
                var e = false;
                try {
                    for (var _3 = tslib_1.__values(fromEnum(this._a2._j)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                        var f = _4.value;
                        var g = f._j;
                        var h = g._d4 ? g.defaultRowHeight : -1;
                        try {
                            for (var _5 = tslib_1.__values(fromEnum(d)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                var i = _6.value;
                                try {
                                    for (var _7 = tslib_1.__values(fromEnum(g._rows$i._m(i._i, i._h))), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                        var j = _8.value;
                                        if (this._c6(j, h)) {
                                            e = true;
                                        }
                                    }
                                }
                                catch (e_160_1) { e_160 = { error: e_160_1 }; }
                                finally {
                                    try {
                                        if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                    }
                                    finally { if (e_160) throw e_160.error; }
                                }
                            }
                        }
                        catch (e_159_1) { e_159 = { error: e_159_1 }; }
                        finally {
                            try {
                                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                            }
                            finally { if (e_159) throw e_159.error; }
                        }
                    }
                }
                catch (e_158_1) { e_158 = { error: e_158_1 }; }
                finally {
                    try {
                        if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                    }
                    finally { if (e_158) throw e_158.error; }
                }
                if (e) {
                    this._at |= 5 | 9;
                    this._ht(65536);
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._h9 = function (a) {
        var b = this.activePane;
        if (null != b) {
            switch (a) {
                case 2:
                    this._c3(b.rowScrollRegion, 1, b.rowScrollRegion._x._ac);
                    break;
                case 3:
                    this._c3(b.rowScrollRegion, 4, b.rowScrollRegion._x._ac);
                    break;
                case 0:
                    this._c0(b.columnScrollRegion, 1, b.columnScrollRegion._x._ac);
                    break;
                case 1:
                    this._c0(b.columnScrollRegion, 4, b.columnScrollRegion._x._ac);
                    break;
            }
        }
    };
    SpreadsheetPaneManager.prototype._ia = function (a) {
        var b = this.activePane;
        if (null != b) {
            switch (a) {
                case 2:
                    this._c3(b.rowScrollRegion, 0, b.rowScrollRegion._x._ac);
                    break;
                case 3:
                    this._c3(b.rowScrollRegion, 3, b.rowScrollRegion._x._ac);
                    break;
                case 0:
                    this._c0(b.columnScrollRegion, 0, b.columnScrollRegion._x._ac);
                    break;
                case 1:
                    this._c0(b.columnScrollRegion, 3, b.columnScrollRegion._x._ac);
                    break;
            }
        }
    };
    SpreadsheetPaneManager.prototype._ib = function () {
        var a = this.activePane;
        if (a != null) {
            var b = a.selection;
            if (this._canSelect(b.activeCell)) {
                b.clearCellRanges();
            }
        }
    };
    SpreadsheetPaneManager.prototype._ic = function () {
        this._cz(this._aa());
    };
    SpreadsheetPaneManager.prototype._c4 = function () {
        var a = this.activePane;
        if (a == null) {
            return false;
        }
        var b = a.selection;
        var c = b.activeCell;
        var d = this._bb._rows$i._aj(c.row);
        if (d != null) {
            var e = typeCast(ArrayFormula.$, d.getCellFormula(c.column));
            if (e != null) {
                var f = e.blockedRegion;
                var g = SpreadsheetUtilities.z(f._h);
                if (this._canSelect1(g)) {
                    b._resetSelection2(g, c, false);
                }
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._id = function () {
        var a = this.activePane;
        if (a == null) {
            return;
        }
        var b = a.selection;
        var c = b.activeCell;
        var d = this._getCellRange1(c.row, c.column);
        var e = b._s();
        var f = false;
        var g = SpreadsheetUtilities.ay(e);
        var h = SpreadsheetCellRange.empty;
        var i = this._bj(g, c);
        if (i != null) {
            var j = i._by;
            if (!j._h(g) && j._i(c.row, c.column)) {
                h = SpreadsheetUtilities.z(j);
            }
            else if (WorksheetRegionAddress._o(j, g) || !j._h(g)) {
                f = true;
            }
            else {
                var k = i.dataAreaRegion;
                if (k == null) {
                    f = true;
                }
                else {
                    var l = k._h;
                    if (l._h(g) && WorksheetRegionAddress._q(l, g)) {
                        h = SpreadsheetUtilities.z(l);
                    }
                    else {
                        h = SpreadsheetUtilities.z(j);
                    }
                }
            }
        }
        if (f) {
            h = this._aa();
        }
        else if (h.isEmpty) {
            h = this._z(d);
            if (SpreadsheetCellRange.l_op_Equality(d, h) || !h._contains1(e) || SpreadsheetCellRange.l_op_Equality(e, h)) {
                h = this._aa();
            }
        }
        if (this._canSelect1(h)) {
            b._replaceActiveCellRange1(h, c);
        }
    };
    SpreadsheetPaneManager.prototype._ie = function (a) {
        var b = this.activePane.selection;
        var c = b._s();
        var d = this._aa();
        var e = SpreadsheetUtilities.ay(c);
        var f = this._bj(e, b.activeCell);
        if (f != null) {
            var g = f._by;
            if (g._h(e)) {
                var h = new IntRange(), i = new IntRange(), j = new IntRange();
                if (a == false) {
                    h = new IntRange(1, g._ac, g._ae);
                    i = new IntRange(1, e._ac, e._ae);
                }
                else {
                    h = new IntRange(1, g._w, g._x);
                    i = new IntRange(1, e._w, e._x);
                }
                if (!h.equals(i)) {
                    var k = f.dataAreaRegion;
                    if (k != null) {
                        var l = k._h;
                        j = a == false ? new IntRange(1, l._ac, l._ae) : new IntRange(1, l._w, l._x);
                        var m = new IntRange();
                        if (i._i < j._i || i._h > j._h || i.equals(j)) {
                            m = h;
                        }
                        else {
                            m = j;
                        }
                        if (a == false) {
                            d = new SpreadsheetCellRange(m._i, d.firstColumn, m._h, d.lastColumn);
                        }
                        else {
                            d = new SpreadsheetCellRange(d.firstRow, m._i, d.lastRow, m._h);
                        }
                    }
                }
            }
        }
        if (a) {
            c = new SpreadsheetCellRange(c.firstRow, d.firstColumn, c.lastRow, d.lastColumn);
        }
        else {
            c = new SpreadsheetCellRange(d.firstRow, c.firstColumn, d.lastRow, c.lastColumn);
        }
        c = this.extendRangeForMergedCells(c);
        if (this._canSelect1(c)) {
            b._replaceActiveCellRange1(c, b.activeCell);
        }
    };
    SpreadsheetPaneManager.prototype._ig = function (a) {
        var b = this._bh;
        if (b != null) {
            var c = this.activePane.selection;
            var d = c._s();
            var e = b._by;
            var f = b.dataAreaRegion._h;
            var g = new SpreadsheetCellRange(a ? e._ac : Math.min(c.activeCell.row, f._ac), Math.max(d.firstColumn, e._w), a ? e._ae : Math.max(c.activeCell.row, f._ae), Math.min(d.lastColumn, e._x));
            c._replaceActiveCellRange1(g, c.activeCell);
        }
    };
    SpreadsheetPaneManager.prototype._ih = function () {
        var a = this._bh;
        if (a != null) {
            var b = this.activePane.selection;
            var c = b._s();
            var d = a._by;
            var e = new SpreadsheetCellRange(Math.max(c.firstRow, d._ac), d._w, Math.min(c.lastRow, d._ae), d._x);
            b._replaceActiveCellRange1(e, b.activeCell);
        }
    };
    SpreadsheetPaneManager.prototype._ii = function () {
        var e_161, _0;
        var a = this.activePane;
        if (a != null) {
            var b = a.selection;
            var c = Enumerable.a(SpreadsheetCellRange.$, b.cellRanges);
            var d = new List$1(SpreadsheetCellRange.$, 0);
            var e = new List$1(IntRange.$, 0);
            var f = b.activeCellRangeIndex;
            var g = b.activeCell;
            var h = -1;
            for (var i = 0; i < c.length; i++) {
                var j = c[i];
                var k = void 0, l = void 0;
                k = l = Nullable$1.toNullable(Number_$type, null);
                e.clear();
                for (var m = j.firstColumn; m <= j.lastColumn; m++) {
                    var n = this._bb._cb(m);
                    if (n.i) {
                        if (nullableNotEquals(k, null)) {
                            e.add(new IntRange(1, k.value, l.value));
                            k = l = Nullable$1.toNullable(Number_$type, null);
                        }
                        m = n.r;
                    }
                    else {
                        if (nullableEquals(k, null)) {
                            k = Nullable$1.toNullable(Number_$type, Math.max(n.q, j.firstColumn));
                        }
                        l = Nullable$1.toNullable(Number_$type, Math.min(n.r, j.lastColumn));
                    }
                }
                if (nullableNotEquals(k, null)) {
                    e.add(new IntRange(1, k.value, l.value));
                }
                if (e.count == 0) {
                    continue;
                }
                var o = SpreadsheetPaneManager._e4(j.firstRow, j.lastRow, this._bb);
                var p = this._bb._dv;
                var q = void 0;
                var r = this._bb._rows$i;
                while (nullableNotEquals(o, null)) {
                    q = Nullable$1.toNullable(Number_$type, null);
                    var s = false;
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(r._m(o.value + 1, j.lastRow))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var t = _2.value;
                            if (t.hidden) {
                                s = true;
                                if (p == false) {
                                    q = Nullable$1.toNullable(Number_$type, t.index - 1);
                                }
                                break;
                            }
                            else {
                                if (p == false) {
                                    q = Nullable$1.toNullable(Number_$type, t.index);
                                }
                                else if (nullableNotEquals(q, t.index - 1)) {
                                    s = true;
                                    break;
                                }
                            }
                        }
                    }
                    catch (e_161_1) { e_161 = { error: e_161_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_161) throw e_161.error; }
                    }
                    if (nullableEquals(q, null)) {
                        if (p) {
                            q = o;
                        }
                        else {
                            q = Nullable$1.toNullable(Number_$type, j.lastRow);
                        }
                    }
                    else if (!s && !p) {
                        q = Nullable$1.toNullable(Number_$type, j.lastRow);
                    }
                    for (var u = 0; u < e.count; u++) {
                        d.add(new SpreadsheetCellRange(o.value, e._inner[u]._i, q.value, e._inner[u]._h));
                        if (i == f && d._inner[d.count - 1]._contains(g)) {
                            h = d.count - 1;
                        }
                    }
                    o = SpreadsheetPaneManager._e4(q.value + 2, j.lastRow, this._bb);
                }
            }
            if (d.count > 0) {
                if (h < 0) {
                    h = 0;
                    g = d._inner[0]._c;
                }
                b._resetSelection(d.toArray(), g, h);
            }
        }
    };
    SpreadsheetPaneManager.prototype._il = function (a) {
        var _this = this;
        var b = this._bh;
        if (b != null) {
            if (a) {
                b.isHeaderRowVisible = true;
                b.isFilterUIVisible = true;
            }
            else {
                b.clearFilters();
                b.clearSortConditions();
                b.isFilterUIVisible = false;
            }
        }
        else {
            var c = this._bb.filterSettings;
            if (c.region != null) {
                if (!a) {
                    c.clearRegion();
                }
            }
            else if (a) {
                var d = this.activePane.selection;
                if (d.cellRanges.count > 1) {
                    this._ea(new SpreadsheetUserPromptInfo(7, null, null, null, false));
                }
                else {
                    var e_162;
                    var f_7;
                    var g = ((function () { var h = _this._ae(false, e_162, f_7); e_162 = h.p1; f_7 = h.p2; return h.ret; })());
                    if (g.isEmpty) {
                        this._ea(new SpreadsheetUserPromptInfo(30, null, null, null, false));
                    }
                    else {
                        c._setRegion1(g._toString1(1), 1);
                    }
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._im = function (a, b, c, d) {
        var e_163, _0, e_164, _1, e_165, _2, e_166, _3, e_167, _4;
        if (nullableNotEquals(this._fj(4), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        var e = this._aa();
        var f = new SpreadsheetPaneManager_SetBorderHelper(b, c, d);
        var g = (b & (64 | 128)) != 0;
        var h = d == 0;
        try {
            for (var _5 = tslib_1.__values(fromEnum(this._a2._j)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                var i = _6.value;
                var j = i._j;
                var k = new Array(1);
                try {
                    for (var _7 = tslib_1.__values(fromEnum(a)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                        var l = _8.value;
                        k[0] = l;
                        var m = SpreadsheetUtilities.ay(l);
                        var n = l.firstRow <= e.firstRow && l.lastRow >= e.lastRow;
                        if (n) {
                            var o = j._columns$i;
                            if ((b & 16) == 16) {
                                for (var p = l.firstColumn; p <= l.lastColumn; p++) {
                                    f.o(o.item(p).cellFormat);
                                }
                            }
                            if ((b & 32) == 32) {
                                for (var q = l.firstColumn + 1; q <= l.lastColumn; q++) {
                                    f.j(o.item(q).cellFormat);
                                }
                            }
                            if ((b & 1) == 1) {
                                f.j(o.item(l.firstColumn).cellFormat);
                            }
                            if ((b & 4) == 4) {
                                f.m(o.item(l.lastColumn).cellFormat);
                            }
                            try {
                                for (var _9 = tslib_1.__values(fromEnum(j._mergedCellsRegions$i)), _10 = _9.next(); !_10.done; _10 = _9.next()) {
                                    var r = _10.value;
                                    if (r._ad > 1 && m._h(r._h)) {
                                        f.l(r, m, false, true);
                                    }
                                }
                            }
                            catch (e_165_1) { e_165 = { error: e_165_1 }; }
                            finally {
                                try {
                                    if (_10 && !_10.done && (_2 = _9.return)) _2.call(_9);
                                }
                                finally { if (e_165) throw e_165.error; }
                            }
                            if (g) {
                                for (var s = l.firstColumn; s <= l.lastColumn; s++) {
                                    f.h(o.item(s)._cellFormatInternal);
                                }
                                var t = l.firstColumn;
                                var u = l.lastColumn;
                                try {
                                    for (var _11 = tslib_1.__values(fromEnum(j._rows$i)), _12 = _11.next(); !_12.done; _12 = _11.next()) {
                                        var v = _12.value;
                                        if (v._hasCellFormat && (h == false || v._cellFormatInternal.d._aw != 1)) {
                                            for (var w = l.firstColumn; w <= l.lastColumn; w++) {
                                                f.h(v._bc(w));
                                            }
                                        }
                                        else {
                                            v._dj(t, u, runOn(f, f.i));
                                        }
                                    }
                                }
                                catch (e_166_1) { e_166 = { error: e_166_1 }; }
                                finally {
                                    try {
                                        if (_12 && !_12.done && (_3 = _11.return)) _3.call(_11);
                                    }
                                    finally { if (e_166) throw e_166.error; }
                                }
                            }
                        }
                        else {
                            var x = l.firstColumn <= e.firstColumn && l.lastColumn >= e.lastColumn;
                            var y = j._rows$i;
                            if (x) {
                                if ((b & 16) == 16) {
                                    for (var z = l.firstRow + 1; z <= l.lastRow; z++) {
                                        f.n(y.item(z).cellFormat);
                                    }
                                }
                                if ((b & 32) == 32) {
                                    for (var aa = l.firstRow; aa <= l.lastRow; aa++) {
                                        f.k(y.item(aa).cellFormat);
                                    }
                                }
                                if ((b & 2) == 2) {
                                    f.n(y.item(l.firstRow).cellFormat);
                                }
                                if ((b & 8) == 8) {
                                    f.g(y.item(l.lastRow).cellFormat);
                                }
                                try {
                                    for (var _13 = tslib_1.__values(fromEnum(j._mergedCellsRegions$i)), _14 = _13.next(); !_14.done; _14 = _13.next()) {
                                        var ab = _14.value;
                                        if (ab._aa > 1 && m._h(ab._h)) {
                                            f.l(ab, m, true, false);
                                        }
                                    }
                                }
                                catch (e_167_1) { e_167 = { error: e_167_1 }; }
                                finally {
                                    try {
                                        if (_14 && !_14.done && (_4 = _13.return)) _4.call(_13);
                                    }
                                    finally { if (e_167) throw e_167.error; }
                                }
                                if (g) {
                                    var ac = j._columns$i.maxCount;
                                    for (var ad = l.firstRow; ad <= l.lastRow; ad++) {
                                        var ae = y.item(ad);
                                        f.h(ae._cellFormatInternal);
                                        ae._dj(0, ac, runOn(f, f.i));
                                    }
                                }
                            }
                            else {
                                for (var af = l.firstRow; af <= l.lastRow; af++) {
                                    var ag = y.item(af);
                                    for (var ah = l.firstColumn; ah <= l.lastColumn; ah++) {
                                        var ai = ag.getCellAssociatedMergedCellsRegion(ah);
                                        if (ai == null) {
                                            var aj = ag._bc(ah);
                                            if (af == l.firstRow) {
                                                if ((b & 2) == 2) {
                                                    f.n(aj);
                                                }
                                            }
                                            else if ((b & 16) == 16) {
                                                f.n(aj);
                                            }
                                            if (l.lastRow == af) {
                                                if ((b & 8) == 8) {
                                                    f.g(aj);
                                                }
                                            }
                                            else if ((b & 16) == 16) {
                                                f.g(aj);
                                            }
                                            if (ah == l.firstColumn) {
                                                if ((b & 1) == 1) {
                                                    f.j(aj);
                                                }
                                            }
                                            else if ((b & 32) == 32) {
                                                f.j(aj);
                                            }
                                            if (l.lastColumn == ah) {
                                                if ((b & 4) == 4) {
                                                    f.m(aj);
                                                }
                                            }
                                            else if ((b & 32) == 32) {
                                                f.m(aj);
                                            }
                                            if (g) {
                                                f.h(aj);
                                            }
                                        }
                                        else if (m._h(ai._h) && af == ai.firstRow) {
                                            f.l(ai, m, true, true);
                                            if (g) {
                                                f.h(ai._cellFormatInternal);
                                            }
                                            ah = ai.lastColumn;
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                catch (e_164_1) { e_164 = { error: e_164_1 }; }
                finally {
                    try {
                        if (_8 && !_8.done && (_1 = _7.return)) _1.call(_7);
                    }
                    finally { if (e_164) throw e_164.error; }
                }
            }
        }
        catch (e_163_1) { e_163 = { error: e_163_1 }; }
        finally {
            try {
                if (_6 && !_6.done && (_0 = _5.return)) _0.call(_5);
            }
            finally { if (e_163) throw e_163.error; }
        }
    };
    SpreadsheetPaneManager.prototype._io = function ($t, a, b, c, d, e) {
        var e_168, _0, e_169, _1, e_170, _2, e_171, _3;
        if (e === void 0) { e = false; }
        var f = this._aa();
        if ((d & 1048576) == 1048576) {
            var g = this._ez(c);
            if (nullableNotEquals(null, g)) {
                this._ea(new SpreadsheetUserPromptInfo(g.value, null, null, null, false));
                return;
            }
        }
        if (nullableNotEquals(this._fj(4), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this._a2._j)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var h = _5.value;
                var i = h._j;
                var j = e ? new HashSet$1(Number_$type, 0) : null;
                try {
                    for (var _6 = tslib_1.__values(fromEnum(c)), _7 = _6.next(); !_7.done; _7 = _6.next()) {
                        var k = _7.value;
                        var l = SpreadsheetUtilities.ay(k);
                        var m = k.firstRow <= f.firstRow && k.lastRow >= f.lastRow;
                        if (m) {
                            var n = i._columns$i;
                            for (var o = k.firstColumn; o <= k.lastColumn; o++) {
                                b(n.item(o)._cellFormatInternal, a);
                            }
                            try {
                                for (var _8 = tslib_1.__values(fromEnum(i._mergedCellsRegions$i)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                                    var p = _9.value;
                                    if (p._ad > 1) {
                                        if (l._h(p._h)) {
                                            b(p._cellFormatInternal, a);
                                        }
                                    }
                                }
                            }
                            catch (e_170_1) { e_170 = { error: e_170_1 }; }
                            finally {
                                try {
                                    if (_9 && !_9.done && (_2 = _8.return)) _2.call(_8);
                                }
                                finally { if (e_170) throw e_170.error; }
                            }
                        }
                        else {
                            var q = k.firstColumn <= f.firstColumn && k.lastColumn >= f.lastColumn;
                            var r = i._rows$i;
                            if (q) {
                                for (var s = k.firstRow; s <= k.lastRow; s++) {
                                    b(r.item(s)._cellFormatInternal, a);
                                }
                                try {
                                    for (var _10 = tslib_1.__values(fromEnum(i._mergedCellsRegions$i)), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                                        var t = _11.value;
                                        if (t._aa > 1) {
                                            if (l._h(t._h)) {
                                                b(t._cellFormatInternal, a);
                                            }
                                        }
                                    }
                                }
                                catch (e_171_1) { e_171 = { error: e_171_1 }; }
                                finally {
                                    try {
                                        if (_11 && !_11.done && (_3 = _10.return)) _3.call(_10);
                                    }
                                    finally { if (e_171) throw e_171.error; }
                                }
                            }
                            else {
                                for (var u = k.firstRow; u <= k.lastRow; u++) {
                                    var v = r.item(u);
                                    for (var w = k.firstColumn; w <= k.lastColumn; w++) {
                                        if (j == null || j.add_1((v.index << 32) + w)) {
                                            var x = v.getCellAssociatedMergedCellsRegion(w);
                                            if (x != null && !l._h(x._h)) {
                                                continue;
                                            }
                                            b(v._bc(w), a);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                catch (e_169_1) { e_169 = { error: e_169_1 }; }
                finally {
                    try {
                        if (_7 && !_7.done && (_1 = _6.return)) _1.call(_6);
                    }
                    finally { if (e_169) throw e_169.error; }
                }
            }
        }
        catch (e_168_1) { e_168 = { error: e_168_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_0 = _4.return)) _0.call(_4);
            }
            finally { if (e_168) throw e_168.error; }
        }
    };
    SpreadsheetPaneManager.prototype._is = function (a) {
        var e_172, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                b._j.displayOptions.magnificationInNormalView = a;
            }
        }
        catch (e_172_1) { e_172 = { error: e_172_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_172) throw e_172.error; }
        }
    };
    SpreadsheetPaneManager.prototype._iq = function (a) {
        var e_173, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                b._j.displayOptions.showGridlines = a;
            }
        }
        catch (e_173_1) { e_173 = { error: e_173_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_173) throw e_173.error; }
        }
    };
    SpreadsheetPaneManager.prototype._ir = function (a) {
        var e_174, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                b._j.displayOptions.showRowAndColumnHeaders = a;
            }
        }
        catch (e_174_1) { e_174 = { error: e_174_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_174) throw e_174.error; }
        }
    };
    SpreadsheetPaneManager.prototype._it = function (a, b) {
        if (!this._b9) {
            var c = this._bb.displayOptions.unfrozenPaneSettings;
            if (this._cv()) {
                this._jn(this._ji);
                if (a && c.topPaneHeight > 0) {
                    var d = this._dn.item(0)._bk;
                    if (CoreUtilities.c(d, 0) == false) {
                        var e = Enumerable.ah(WorksheetItemPosition.$, this._dn.item(0)._m);
                        var f = this._dz(e._i);
                        var g = d < f / 2 ? d : d - f;
                        c.topPaneHeight += this._ef(g);
                    }
                }
                if (b && c.leftPaneWidth > 0) {
                    var h = this._dh.item(0)._bk;
                    if (CoreUtilities.c(h, 0) == false) {
                        var i = Enumerable.ah(WorksheetItemPosition.$, this._dh.item(0)._m);
                        var j = this._dy(i._i);
                        var k = h < j / 2 ? h : h - j;
                        c.leftPaneWidth += this._ef(k);
                    }
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._iu = function (a, b, c) {
        var d = b ? 0 : 1;
        var e = this._q(c);
        if (e == null) {
            return;
        }
        var f = e.c;
        var g;
        switch (a) {
            case 0:
                g = new OrderedSortCondition(d);
                break;
            case 3:
                var h = this._bb._getCellConditionalFormat1(f.o, f.m);
                g = h == null || h.iconInfo == null || h.iconInfo.icon == -1 ? new IconSortCondition(true, 0, Nullable$1.toNullable(Number_$type, null)) : new IconSortCondition(true, ExcelUtils.ak(h.iconInfo.iconSet), Nullable$1.toNullable(Number_$type, intSToU(h.iconInfo.iconIndex)));
                break;
            case 1:
            case 2:
                {
                    var i = this._bb._rows$i._aj(f.o);
                    var j = this._bb._b4(i, f.m);
                    var k = this._bb._getCellConditionalFormat1(f.o, f.m);
                    if (a == 1) {
                        g = new FontColorSortCondition(k != null && k.cellFormat != null && WorkbookColorInfo.l_op_Inequality(k.cellFormat.font.colorInfo, null) ? k.cellFormat.font.colorInfo : j._bh);
                    }
                    else {
                        g = new FillSortCondition(k != null && k.cellFormat != null && k.cellFormat.fill != null ? k.cellFormat.fill : j._ar);
                    }
                }
                break;
            default: return;
        }
        var l = e.e;
        var m = e.d;
        if (l != null) {
            var n = l._columns$i._item(f.m - l._by._w);
            l.clearSortConditions();
            l.sortSettings._sortConditions$i._addItem$i(n, g);
        }
        else if (this._bb.filterSettings.region != null && WorksheetRegionAddress._o(m, this._bb.filterSettings.region._h)) {
            var o = this._bb.filterSettings.sortSettings._sortConditions$i;
            o.clear();
            o._addItem$i(new RelativeIndex(f.m - this._bb.filterSettings.region.firstColumn), g);
        }
        else {
            var p = m._ah(true, true, this._bb.workbook.currentFormat, 1);
            var q = this._bb.sortSettings;
            q.clearRegion();
            q._setRegion1(p, 1);
            q.sortType = 0;
            q._sortConditions$i._addItem$i(new RelativeIndex(f.m - m._w), g);
        }
    };
    SpreadsheetPaneManager.prototype._ix = function () {
        var e_175, _0;
        var a = !this._bb.displayOptions.showFormulasInCells;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                b._j.displayOptions.showFormulasInCells = a;
            }
        }
        catch (e_175_1) { e_175 = { error: e_175_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_175) throw e_175.error; }
        }
    };
    SpreadsheetPaneManager.prototype._iy = function (a) {
        if (this._cv() == false) {
            return;
        }
        var b = this._bb.displayOptions;
        var c = b.frozenPaneSettings;
        var d = b.unfrozenPaneSettings;
        var e = this._dn.count > 1;
        var f = this._dh.count > 1;
        var g = f || e;
        var h = b.panesAreFrozen && g;
        var i = !h && g;
        var j = false;
        if (a) {
            d.firstColumnInLeftPane = this._dh.item(0).startIndex;
            d.firstRowInTopPane = this._dn.item(0).startIndex;
            if (h) {
                if (c._z) {
                    c._z = false;
                    if (e) {
                        d.topPaneHeight = this._ef(this._dx + this._dn.item(0).actualExtent);
                        d.firstRowInBottomPane = this._dn.item(1).startIndex;
                    }
                    else {
                        d.topPaneHeight = 0;
                    }
                    if (f) {
                        d.leftPaneWidth = this._ef(this._d2 + this._dh.item(0).actualExtent);
                        d.firstColumnInRightPane = this._dh.item(1).startIndex;
                    }
                    else {
                        d.leftPaneWidth = 0;
                    }
                }
                else {
                    d.leftPaneWidth = 0;
                    d.topPaneHeight = 0;
                    j = true;
                }
                b.panesAreFrozen = false;
            }
            else if (i) {
                if (f) {
                    var k = this._dh.item(0).endIndex - this._dh.item(0).startIndex;
                    if (k == 0 || this._dh.item(0)._bk < this._dy(Enumerable.ah(WorksheetItemPosition.$, this._dh.item(0)._m)._i) / 2) {
                        k++;
                    }
                    c.frozenColumns = k;
                    c.firstColumnInRightPane = this._dh.item(1).startIndex;
                }
                else {
                    c.frozenColumns = 0;
                }
                if (e) {
                    var l = this._dn.item(0).endIndex - this._dn.item(0).startIndex;
                    if (l == 0 || this._dn.item(0)._bk < this._dz(Enumerable.ah(WorksheetItemPosition.$, this._dn.item(0)._m)._i) / 2) {
                        l++;
                    }
                    c.frozenRows = l;
                    c.firstRowInBottomPane = this._dn.item(1).startIndex;
                }
                else {
                    c.frozenRows = 0;
                }
                c._z = true;
                b.panesAreFrozen = true;
            }
            else {
                var m = this._r();
                var n = Math.max(m.column - this._dh.item(0).startIndex, 0);
                var o = Math.max(m.row - this._dn.item(0).startIndex, 0);
                if (n > 0 || o > 0) {
                    c.frozenRows = o;
                    c.frozenColumns = n;
                    c.firstRowInBottomPane = m.row;
                    c.firstColumnInRightPane = m.column;
                    b.panesAreFrozen = true;
                }
            }
        }
        else {
            if (h) {
                c._z = true;
                this._iy(true);
            }
            else if (i) {
                d.firstColumnInLeftPane = this._dh.item(0).startIndex;
                d.firstRowInTopPane = this._dn.item(0).startIndex;
                d.leftPaneWidth = 0;
                d.topPaneHeight = 0;
                j = true;
            }
            else {
                var p = this._r();
                var q = this._bb._cp(p.row)._m - this._bb._cp(this._dn.item(0).startIndex)._m;
                var r = this._bb._cn(p.column)._m - this._bb._cn(this._dh.item(0).startIndex)._m;
                d.firstColumnInLeftPane = this._dh.item(0).startIndex;
                d.firstRowInTopPane = this._dn.item(0).startIndex;
                if (q > 0) {
                    d.firstRowInBottomPane = p.row;
                }
                if (r > 0) {
                    d.firstColumnInRightPane = p.column;
                }
                var s = this._d8;
                d.leftPaneWidth = r > 0 ? truncate(MathUtilities.f(this._bb._fl(r, 5, true) * s)) + this._ef(this._d2) : 0;
                d.topPaneHeight = q > 0 ? truncate(MathUtilities.f(q * s)) + this._ef(this._dx) : 0;
            }
        }
        if (j && b._z != 3) {
            var t = b._af.a(b._z);
            if (t != null) {
                var u = b._af.a(3);
                if (u != null) {
                    b._af.b.remove(u);
                }
                t.a = 3;
            }
        }
    };
    SpreadsheetPaneManager.prototype._i3 = function (a) {
        if (a === void 0) { a = true; }
        var b = this._dl.count > 0;
        if (!b) {
            this.activePane = null;
        }
        else {
            this.activePane = this._as(Nullable$1.toNullable(Boolean_$type, null));
        }
        if (a && this.activePane != null) {
            this.activePane.selection._by();
        }
    };
    SpreadsheetPaneManager.prototype._i5 = function () {
        this._jc();
    };
    SpreadsheetPaneManager.prototype._c7 = function (a, b, c, d) {
        var e_176, _0, e_177, _1;
        if (a != null && this._a2._j.count > 1) {
            try {
                for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var e = _3.value;
                    if (e._j == this._bb || e._j.isProtected == false) {
                        continue;
                    }
                    var f = a.a(e._j);
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(b)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var g = _5.value;
                            if (SpreadsheetPaneManager._cp(e._j, g.firstRow, g.firstColumn, g.lastRow, g.lastColumn, f) == false) {
                                if (this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, c))) {
                                    d = 1;
                                }
                                else {
                                    d = 0;
                                }
                                return {
                                    ret: false,
                                    p3: d
                                };
                            }
                        }
                    }
                    catch (e_177_1) { e_177 = { error: e_177_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_177) throw e_177.error; }
                    }
                }
            }
            catch (e_176_1) { e_176 = { error: e_176_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_176) throw e_176.error; }
            }
        }
        d = 2;
        return {
            ret: true,
            p3: d
        };
    };
    SpreadsheetPaneManager.prototype._c8 = function (a, b, c) {
        var e_178, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(b)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                if (d._ac < 0 || d._w < 0 || d._ae >= this._bb._rows$i.maxCount || d._x >= this._bb._columns$i.maxCount) {
                    return this._ea(new SpreadsheetUserPromptInfo(10, null, null, null, false));
                }
            }
        }
        catch (e_178_1) { e_178 = { error: e_178_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_178) throw e_178.error; }
        }
        if (nullableNotEquals(this._en(), false)) {
            var e = this._ay(a, b, false, void 0, c);
            if (e == 2) {
                e = this._ay(a, b, false, void 0, false);
            }
            return e == 1;
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._c9 = function () {
        if (nullableEquals(this._en(), false)) {
            return true;
        }
        var a = this.activePane;
        if (a == null) {
            return false;
        }
        var b = a._ag;
        var c = this._ax(b, false);
        if (c == 2) {
            c = this._ax(b, false, void 0, false);
        }
        return c == 1;
    };
    SpreadsheetPaneManager.prototype._da = function () {
        if (nullableEquals(this._en(), false)) {
            return true;
        }
        var a = this.activePane;
        if (a == null) {
            return false;
        }
        var b = a._ag;
        return this._ax(b, true) != 0;
    };
    SpreadsheetPaneManager.prototype._je = function (a) {
        var e_179, _0, e_180, _1, e_181, _2;
        switch (a) {
            case 0:
                {
                    var b = this._bb.displayOptions.magnificationInNormalView + 10;
                    b = Math.min(b - (b % 10), 400);
                    try {
                        for (var _3 = tslib_1.__values(fromEnum(this._a2._j)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                            var c = _4.value;
                            c._j.displayOptions.magnificationInNormalView = b;
                        }
                    }
                    catch (e_179_1) { e_179 = { error: e_179_1 }; }
                    finally {
                        try {
                            if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                        }
                        finally { if (e_179) throw e_179.error; }
                    }
                }
                break;
            case 1:
                {
                    var d = this._bb.displayOptions.magnificationInNormalView - 1;
                    d = Math.max(d - (d % 10), 10);
                    try {
                        for (var _5 = tslib_1.__values(fromEnum(this._a2._j)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var e = _6.value;
                            e._j.displayOptions.magnificationInNormalView = d;
                        }
                    }
                    catch (e_180_1) { e_180 = { error: e_180_1 }; }
                    finally {
                        try {
                            if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                        }
                        finally { if (e_180) throw e_180.error; }
                    }
                }
                break;
            case 3:
                {
                    this._ip(524288, true);
                    try {
                        for (var _7 = tslib_1.__values(fromEnum(this._a2._j)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                            var f = _8.value;
                            f._j.displayOptions.magnificationInNormalView = 100;
                        }
                    }
                    catch (e_181_1) { e_181 = { error: e_181_1 }; }
                    finally {
                        try {
                            if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                        }
                        finally { if (e_181) throw e_181.error; }
                    }
                }
                break;
            case 2:
                this._jf(false);
                break;
        }
    };
    SpreadsheetPaneManager.prototype._fv = function (a) {
        this.activePane = this._as(Nullable$1.toNullable(Boolean_$type, a));
    };
    SpreadsheetPaneManager.prototype._bo = function (a, b, c, d, e, f) {
        var g = null;
        if (b != null) {
            for (var h = 0; h < b.count; h++) {
                var i = b.item(h);
                if (i.d == c && i.c == d && i.b == e) {
                    g = i;
                    break;
                }
            }
        }
        var j = false;
        if (g == null) {
            g = new SpreadsheetDropDownButton();
            g.d = c;
            g.c = d;
            g.b = e;
            j = true;
        }
        if (g.a != f) {
            g.a = f;
            j = true;
        }
        a.add(g);
        return j;
    };
    SpreadsheetPaneManager.prototype._fz = function () {
    };
    SpreadsheetPaneManager.prototype._f0 = function (a, b) {
        var e_182, _0;
        {
            var c = this._a9();
            try {
                var d = new CellSizeMeasurementContext(this._bb.workbook, c);
                var _loop_19 = function (e) {
                    var e_183, _0;
                    var f = e._j;
                    var g = new Dictionary$2(Number_$type, Number_$type, 0);
                    if (a.length <= 1) {
                        b = false;
                    }
                    for (var i = 0; i < a.length; i++) {
                        var h = a[i];
                        var _loop_20 = function (j) {
                            var k = f._columns$i.item(j);
                            var l = k._ay(h.firstRow, h.lastRow, d);
                            if (l.hasValue) {
                                var m = l.value;
                                if (b) {
                                    var n_4;
                                    if (((function () { var o = g.tryGetValue(j, n_4); n_4 = o.p1; return o.ret; })())) {
                                        m = Math.max(n_4, m);
                                    }
                                    g.item(j, m);
                                }
                                else {
                                    k.hidden = false;
                                    k.width = m;
                                }
                            }
                        };
                        for (var j = h.firstColumn; j <= h.lastColumn; j++) {
                            _loop_20(j);
                        }
                    }
                    if (b) {
                        try {
                            for (var _1 = tslib_1.__values(fromEnum(g)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                                var o = _2.value;
                                var p = f._columns$i.item(o.key);
                                p.hidden = false;
                                p.width = o.value;
                            }
                        }
                        catch (e_183_1) { e_183 = { error: e_183_1 }; }
                        finally {
                            try {
                                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                            }
                            finally { if (e_183) throw e_183.error; }
                        }
                    }
                };
                try {
                    for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var e = _2.value;
                        _loop_19(e);
                    }
                }
                catch (e_182_1) { e_182 = { error: e_182_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_182) throw e_182.error; }
                }
            }
            finally {
                if (c != null) {
                    c.dispose();
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._x = function () {
        return this._af(true);
    };
    SpreadsheetPaneManager.prototype._ax = function (a, b, c, d) {
        var e_184, _0;
        if (c === void 0) { c = true; }
        if (d === void 0) { d = true; }
        var e = b ? null : new LockedEditRangeInfoForOperation();
        var f = true;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var g = _2.value;
                if (false == (f = SpreadsheetPaneManager._co(g._j, a, e))) {
                    break;
                }
            }
        }
        catch (e_184_1) { e_184 = { error: e_184_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_184) throw e_184.error; }
        }
        if (b) {
            if (f) {
                return 1;
            }
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, e, false));
            return 0;
        }
        return this._aw(e, c, d);
    };
    SpreadsheetPaneManager.prototype._ay = function (a, b, c, d, e) {
        var e_185, _0, e_186, _1;
        if (d === void 0) { d = true; }
        if (e === void 0) { e = true; }
        var f = c ? null : new LockedEditRangeInfoForOperation();
        var g = true;
        try {
            for (var _2 = tslib_1.__values(fromEnum(a)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var h = _3.value;
                var i = f != null ? f.a(h) : null;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(b)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var j = _5.value;
                        if (false == (g = SpreadsheetPaneManager._cp(h, j._ac, j._w, j._ae, j._x, i))) {
                            break;
                        }
                    }
                }
                catch (e_186_1) { e_186 = { error: e_186_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_186) throw e_186.error; }
                }
                if (g == false) {
                    break;
                }
            }
        }
        catch (e_185_1) { e_185 = { error: e_185_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_185) throw e_185.error; }
        }
        if (c) {
            if (g) {
                return 1;
            }
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, f, false));
            return 0;
        }
        return this._aw(f, d, e);
    };
    SpreadsheetPaneManager.prototype._aw = function (a, b, c) {
        if (b === void 0) { b = true; }
        if (c === void 0) { c = true; }
        var d = a.b();
        var e;
        if (!d) {
            if (a.e(false).count > 0) {
                e = 24;
            }
            else {
                e = 23;
            }
        }
        else if (b == false && a.e(false).count == 0) {
            return 0;
        }
        else {
            var f = a.e(true);
            if (f.count == 0) {
                return 1;
            }
            var g = this._al._x;
            if (c && g != null) {
                var h = g(a);
                if (h == false) {
                    return 0;
                }
                var i = a.e(true);
                if (f.count == i.count) {
                    e = 24;
                }
                else if (i.count == 0) {
                    return 1;
                }
                else {
                    return 2;
                }
            }
            else {
                e = 23;
            }
        }
        this._ea(new SpreadsheetUserPromptInfo(e, null, null, a, false));
        return 0;
    };
    SpreadsheetPaneManager.prototype._f8 = function (a, b, c, d) {
        for (var e = c; e <= d; e++) {
            if (this._b0(e, a)) {
                b = a;
                return {
                    p1: b
                };
            }
        }
        return {
            p1: b
        };
    };
    SpreadsheetPaneManager.prototype._f9 = function (a, b, c, d, e, f, g, h) {
        var i = this._bb._es;
        var j;
        if (nullableGreaterThan(b, f)) {
            if (nullableNotEquals(e, null)) {
                if (((function () { var k = i.tryGetValue(new WorksheetCellAddress(1, e.value, f.value), j); j = k.p1; return k.ret; })()) && this._bz(j)) {
                    a = e.value;
                    b = f.value;
                }
            }
            if (nullableNotEquals(g, null)) {
                if (((function () { var k = i.tryGetValue(new WorksheetCellAddress(1, g.value, f.value), j); j = k.p1; return k.ret; })()) && this._bz(j)) {
                    c = g.value;
                    b = f.value;
                }
            }
        }
        if (nullableLessThan(d, h)) {
            if (nullableNotEquals(e, null)) {
                if (((function () { var k = i.tryGetValue(new WorksheetCellAddress(1, e.value, h.value), j); j = k.p1; return k.ret; })()) && this._bz(j)) {
                    a = e.value;
                    d = h.value;
                }
            }
            if (nullableNotEquals(g, null)) {
                if (((function () { var k = i.tryGetValue(new WorksheetCellAddress(1, g.value, h.value), j); j = k.p1; return k.ret; })()) && this._bz(j)) {
                    c = g.value;
                    d = h.value;
                }
            }
        }
        var k = a;
        var l = b;
        var m = c;
        var n = d;
        if (nullableEquals(a, e)) {
            var _loop_21 = function (o) {
                if (((function () { var p = i.tryGetValue(new WorksheetCellAddress(1, a, o), j); j = p.p1; return p.ret; })())) {
                    var p = j._h;
                    if (this_9._bz(j)) {
                        if (p._w < b) {
                            l = p._w;
                        }
                        if (p._x > d) {
                            n = p._x;
                        }
                        if (p._ac < a) {
                            k = p._ac;
                        }
                    }
                    o = p._x;
                }
                out_o_1 = o;
            };
            var this_9 = this, out_o_1;
            for (var o = b; o < d; o++) {
                _loop_21(o);
                o = out_o_1;
            }
        }
        if (nullableEquals(c, g)) {
            var _loop_22 = function (q) {
                if (((function () { var r = i.tryGetValue(new WorksheetCellAddress(1, c, q), j); j = r.p1; return r.ret; })())) {
                    var r = j._h;
                    if (this_10._bz(j)) {
                        if (r._w < b) {
                            l = r._w;
                        }
                        if (r._x > d) {
                            n = r._x;
                        }
                        if (r._ae > c) {
                            m = r._ae;
                        }
                    }
                    q = r._x;
                }
                out_q_1 = q;
            };
            var this_10 = this, out_q_1;
            for (var q = b; q < d; q++) {
                _loop_22(q);
                q = out_q_1;
            }
        }
        if (nullableEquals(b, f)) {
            var _loop_23 = function (s) {
                if (((function () { var t = i.tryGetValue(new WorksheetCellAddress(1, s, b), j); j = t.p1; return t.ret; })())) {
                    var t = j._h;
                    if (this_11._bz(j)) {
                        if (t._ac < a) {
                            k = t._ac;
                        }
                        if (t._ae > c) {
                            m = t._ae;
                        }
                        if (t._w < b) {
                            l = t._w;
                        }
                    }
                    s = t._ae;
                }
                out_s_1 = s;
            };
            var this_11 = this, out_s_1;
            for (var s = a; s < c; s++) {
                _loop_23(s);
                s = out_s_1;
            }
        }
        if (nullableEquals(d, h)) {
            var _loop_24 = function (u) {
                if (((function () { var v = i.tryGetValue(new WorksheetCellAddress(1, u, d), j); j = v.p1; return v.ret; })())) {
                    var v = j._h;
                    if (this_12._bz(j)) {
                        if (v._ac < a) {
                            k = v._ac;
                        }
                        if (v._ae > c) {
                            m = v._ae;
                        }
                        if (v._x > d) {
                            n = v._x;
                        }
                    }
                    u = v._ae;
                }
                out_u_1 = u;
            };
            var this_12 = this, out_u_1;
            for (var u = a; u < c; u++) {
                _loop_24(u);
                u = out_u_1;
            }
        }
        if (nullableLessThanOrEqual(k, e) || nullableGreaterThanOrEqual(m, g) || nullableLessThanOrEqual(l, f) || nullableGreaterThanOrEqual(n, h)) {
            var w = new WorksheetRegionAddress(1, k, m, l, n);
            var x = this._bb._hi(w);
            w = x.p0;
            k = w._ac;
            l = w._w;
            m = w._ae;
            n = w._x;
        }
        a = k;
        b = l;
        c = m;
        d = n;
        return {
            p0: a,
            p1: b,
            p2: c,
            p3: d
        };
    };
    SpreadsheetPaneManager.prototype._ga = function (a, b, c, d, e, f, g) {
        if (e._aj(a) != null) {
            if (nullableNotEquals(f, null) && this._b0(a, f.value)) {
                b = a;
                c = f.value;
            }
            if (nullableNotEquals(g, null) && this._b0(a, g.value)) {
                b = a;
                d = g.value;
            }
            if (b != a) {
                for (var h = c; h <= d; h++) {
                    if (this._b0(a, h)) {
                        b = a;
                        break;
                    }
                }
            }
        }
        return {
            p1: b,
            p2: c,
            p3: d
        };
    };
    SpreadsheetPaneManager.prototype._ef = function (a) {
        if (this._al._t) {
            return SpreadsheetUtilities.ck(Workbook._ey(this._bb.workbook, a, false, false));
        }
        return truncate(MathUtilities.f(Workbook._ep(this._bb.workbook, a, false)));
    };
    SpreadsheetPaneManager.prototype.convertTwipsToPixels = function (a, b) {
        if (this._al._t) {
            return Workbook._ey(this._bb.workbook, SpreadsheetUtilities.b4(a), b, true);
        }
        return Workbook._er(this._bb.workbook, a, b, false);
    };
    SpreadsheetPaneManager.prototype._a9 = function () {
        if (this._al._j != null) {
            return this._al._j.j();
        }
        return Workbook._br(this._bb.workbook);
    };
    SpreadsheetPaneManager._dc = function () {
        var e_187, _0;
        var a = new Dictionary$2(SpreadsheetPaneManager_InternalFlags_$type, String_$type, 0);
        try {
            for (var _1 = tslib_1.__values(fromEnum(CoreUtilities.k(SpreadsheetPaneManager_InternalFlags_$type))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                a.item(b, EnumUtil.getName(SpreadsheetPaneManager_InternalFlags_$type, b));
            }
        }
        catch (e_187_1) { e_187 = { error: e_187_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_187) throw e_187.error; }
        }
        return a;
    };
    SpreadsheetPaneManager.prototype._by = function (a, b, c, d, e) {
        if (!e._contains(a)) {
            return false;
        }
        if (d && !this._cr(a.row, a.column)) {
            return false;
        }
        if (b) {
            if (nullableEquals(SpreadsheetPaneManager._e3(a.column, a.column, this._bb), null)) {
                return false;
            }
        }
        else {
            if (nullableEquals(SpreadsheetPaneManager._e4(a.row, a.row, this._bb), null)) {
                return false;
            }
        }
        switch (c) {
            case 1: return this._b0(a.row, a.column);
            case 2: return this._b0(a.row, a.column) || this._bi(a.row, a.column) != null;
            case 0: return true;
            default: return true;
        }
    };
    SpreadsheetPaneManager.prototype._gk = function () {
        if (this._au() == 2048) {
            var a = this.activePane;
            var b = a != null ? a.selection : null;
            if (b != null) {
                this._g3(1, 0, false);
            }
        }
    };
    SpreadsheetPaneManager._b5 = function (a, b, c, d, e, f) {
        var e_188, _0, e_189, _1;
        var g = b;
        var h = false;
        try {
            for (var _2 = tslib_1.__values(fromEnum(a._rows$i._m(b, d))), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var i = _3.value;
                var j = i.index;
                if (g != j) {
                    h = true;
                }
                else {
                    g++;
                }
                var k = void 0;
                var l = c;
                var m = i._hasCellFormat;
                var n = false;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(i._ch(c, e, true))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var o = _5.value;
                        if (o.n == false) {
                            continue;
                        }
                        if (l != o.r) {
                            if (m) {
                                n = true;
                            }
                            else {
                                for (var p = l, q = o.r; p < q; p++) {
                                    k = a._cb(p);
                                    if (!f(k.b)) {
                                        return false;
                                    }
                                    p = k.r;
                                }
                            }
                        }
                        if (!f(o.j)) {
                            return false;
                        }
                        l = o.r + 1;
                    }
                }
                catch (e_189_1) { e_189 = { error: e_189_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_189) throw e_189.error; }
                }
                if (l <= e) {
                    if (m) {
                        n = true;
                    }
                    else {
                        for (var r = l; r <= e; r++) {
                            k = a._cb(r);
                            if (!f(k.b)) {
                                return false;
                            }
                            r = k.r;
                        }
                    }
                }
                if (n && !f(i._cellFormatInternal.d)) {
                    return false;
                }
            }
        }
        catch (e_188_1) { e_188 = { error: e_188_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_188) throw e_188.error; }
        }
        if (g != d + 1) {
            h = true;
        }
        if (h) {
            var s = a._f9(c);
            var t = a._ff;
            var u = t._inner[s];
            for (var v = s; v < t.count; v++) {
                u = t._inner[v];
                if (!f(u.b)) {
                    return false;
                }
                if (u.r >= e) {
                    break;
                }
            }
        }
        return true;
    };
    SpreadsheetPaneManager._extendRangeForMergedCells1 = function (a, b, c) {
        if (c === void 0) { c = null; }
        var d = SpreadsheetUtilities.ay(b);
        var e = a._hi(d, c);
        d = e.p0;
        return SpreadsheetUtilities.z(d);
    };
    SpreadsheetPaneManager.prototype._eo = function (a, b, c, d, e, f) {
        if (e === void 0) { e = Nullable$1.toNullable(SpreadsheetCellRange.$, null); }
        if (f === void 0) { f = false; }
        var g = Nullable$1.toNullable(SpreadsheetCellRange.$, null);
        if (SpreadsheetCellRange._l_op_Inequality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
            g = e;
        }
        else if (d) {
            this._jd();
            var h = this._bb.protection.selectionMode == 0;
            g = Nullable$1.toNullable(SpreadsheetCellRange.$, new SpreadsheetCellRange(h ? 0 : this._t.firstRow, h ? 0 : this._t.firstColumn, this._t.lastRow + (h ? 0 : 1), this._t.lastColumn + (h ? 0 : 1)));
        }
        var i = !nullableIsNull(g) ? g.value : new SpreadsheetCellRange(a.row, a.column);
        var j = b == 0 || b == 1;
        var k;
        if (f && this._by(a, j, c, d, i)) {
            return Nullable$1.toNullable(SpreadsheetCell.$, a);
        }
        do {
            k = this._ep(a, b, c, g, d);
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(k, Nullable$1.toNullable(SpreadsheetCell.$, null)) && d && !i._contains(k.value)) {
                k = Nullable$1.toNullable(SpreadsheetCell.$, null);
            }
            if (SpreadsheetCell._l_op_Inequality_Lifted$i(k, Nullable$1.toNullable(SpreadsheetCell.$, null)) || d == false) {
                break;
            }
            switch (b) {
                case 1:
                    {
                        var l = SpreadsheetPaneManager._e4(a.row + 1, i.lastRow, this._bb);
                        if (nullableEquals(l, null) && SpreadsheetCellRange._l_op_Equality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
                            l = SpreadsheetPaneManager._e4(i.firstRow, a.row, this._bb);
                        }
                        if (nullableEquals(l, null) || (nullableEquals(l, a.row) && a.column <= i.firstColumn)) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        a = new SpreadsheetCell(l.value, i.firstColumn);
                        break;
                    }
                case 0:
                    {
                        var m = this._e9(i.firstRow, a.row - 1);
                        if (nullableEquals(m, null) && SpreadsheetCellRange._l_op_Equality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
                            m = this._e9(a.row, i.lastRow);
                        }
                        if (nullableEquals(m, null) || (nullableEquals(m, a.row) && a.column >= i.lastColumn)) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        a = new SpreadsheetCell(m.value, i.lastColumn);
                        break;
                    }
                case 3:
                    {
                        var n = SpreadsheetPaneManager._e3(a.column + 1, i.lastColumn, this._bb);
                        if (nullableEquals(n, null) && SpreadsheetCellRange._l_op_Equality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
                            n = SpreadsheetPaneManager._e3(i.firstColumn, a.column, this._bb);
                        }
                        if (nullableEquals(n, null) || (nullableEquals(n, a.column) && a.row <= i.firstRow)) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        a = new SpreadsheetCell(i.firstRow, n.value);
                        break;
                    }
                case 2:
                    {
                        var o = this._e8(i.firstColumn, a.column - 1);
                        if (nullableEquals(o, null) && SpreadsheetCellRange._l_op_Equality_Lifted$i(e, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
                            o = this._e8(a.column, i.lastColumn);
                        }
                        if (nullableEquals(o, null) || (nullableEquals(o, a.column) && a.row >= i.lastRow)) {
                            return Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        a = new SpreadsheetCell(i.lastRow, o.value);
                        break;
                    }
            }
            if (this._by(a, j, c, true, i)) {
                return Nullable$1.toNullable(SpreadsheetCell.$, a);
            }
        } while (d);
        return k;
    };
    SpreadsheetPaneManager.prototype._ep = function (a, b, c, d, e) {
        var f;
        switch (c) {
            default:
            case 0:
                f = this._eu(a.row, a.column, b, d, void 0, e);
                break;
            case 1:
                f = this._ev(a.row, a.column, b, d, e, !e);
                break;
            case 2:
                {
                    var g = this._bi(a.row, a.column);
                    if (!this._b0(a.row, a.column) && g == null) {
                        f = this._ev(a.row, a.column, b, d, e);
                    }
                    else {
                        var h = this._eu(a.row, a.column, b, d, true, e);
                        if (SpreadsheetCell._l_op_Equality_Lifted$i(h, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                            f = Nullable$1.toNullable(SpreadsheetCell.$, null);
                        }
                        else {
                            var i = h.value.row;
                            var j = h.value.column;
                            var k = this._bi(i, j);
                            var l = this._b0(i, j);
                            if (!l && (g != k || g == null)) {
                                if (k != null) {
                                    f = h;
                                }
                                else {
                                    f = this._ev(i, j, b, d, e);
                                }
                            }
                            else {
                                var m = false;
                                do {
                                    f = this._eu(i, j, b, d, true, e);
                                    if (SpreadsheetCell._l_op_Equality_Lifted$i(f, Nullable$1.toNullable(SpreadsheetCell.$, null))) {
                                        break;
                                    }
                                    k = this._bi(f.value.row, f.value.column);
                                    if (g != k) {
                                        break;
                                    }
                                    m = this._b0(f.value.row, f.value.column);
                                    if (!m && l) {
                                        break;
                                    }
                                    i = f.value.row;
                                    j = f.value.column;
                                    if (m && !l) {
                                        break;
                                    }
                                } while (true);
                                f = Nullable$1.toNullable(SpreadsheetCell.$, new SpreadsheetCell(i, j));
                            }
                        }
                    }
                    break;
                }
        }
        return f;
    };
    SpreadsheetPaneManager.prototype._eq = function (a, b) {
        return b ? this._fc(a) : this._fh(a);
    };
    SpreadsheetPaneManager.prototype._er = function (a, b) {
        return b ? this._fe(a) : this._fi(a);
    };
    SpreadsheetPaneManager.prototype._r = function () {
        var a = this.activePane.selection.activeCell;
        var b = a.column;
        var c = a.row;
        var d = b == this._dh.item(0).startIndex && c == this._dn.item(0).startIndex;
        var e = b < this._dh.item(0).startIndex || b > this._dh.item(0).endIndex;
        var f = c < this._dn.item(0).startIndex || c > this._dn.item(0).endIndex;
        if (d || e || f) {
            if (e || d || (f && b != this._dh.item(0).startIndex)) {
                var g = truncate(MathUtilities.f(this._dh.item(0)._x._ac + this._dh.item(0)._x._af / 2));
                var h = this._be(g);
                if (g > (h._m + intDivide(h._i, 2))) {
                    h = this._be(h._l + 1);
                }
                b = h._j;
            }
            if (f || d || (e && c != this._dn.item(0).startIndex)) {
                var i = truncate(MathUtilities.f(this._dn.item(0)._x._ac + this._dn.item(0)._x._af / 2));
                var j = this._bb._cq(i);
                if (i > (j._m + intDivide(j._i, 2))) {
                    j = this._bb._cq(j._l + 1);
                }
                c = j._j;
            }
        }
        return new SpreadsheetCell(c, b);
    };
    SpreadsheetPaneManager.prototype._bd = function (a, b, c) {
        var d;
        d = this._bb._b4(a, c);
        d = this._bb._b5(d, b, c) || d;
        return d;
    };
    SpreadsheetPaneManager.prototype._ez = function (a) {
        var e_190, _0, e_191, _1, e_192, _2;
        var b = this.activePane;
        var c = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
        {
            try {
                for (var _3 = tslib_1.__values(fromEnum(this._a2._j)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var d = _4.value;
                    var e = d._j;
                    try {
                        for (var _5 = tslib_1.__values(fromEnum(a)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var f = _6.value;
                            var g = SpreadsheetUtilities.ay(f);
                            if (nullableNotEquals(null, (c = this._ew(e, f.firstRow, g)))) {
                                return c;
                            }
                            if (f._aa > 1 && nullableNotEquals(null, (c = this._ew(e, f.lastRow, g)))) {
                                return c;
                            }
                            var h = f._ad > 1;
                            try {
                                for (var _7 = tslib_1.__values(fromEnum(e._rows$i._m(f.firstRow, f.lastRow))), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                    var i = _8.value;
                                    if (nullableNotEquals(null, (c = this._ey(i, f.firstColumn, g)))) {
                                        return c;
                                    }
                                    if (h && nullableNotEquals(null, (c = this._ey(i, f.lastColumn, g)))) {
                                        return c;
                                    }
                                }
                            }
                            catch (e_192_1) { e_192 = { error: e_192_1 }; }
                            finally {
                                try {
                                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                }
                                finally { if (e_192) throw e_192.error; }
                            }
                        }
                    }
                    catch (e_191_1) { e_191 = { error: e_191_1 }; }
                    finally {
                        try {
                            if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                        }
                        finally { if (e_191) throw e_191.error; }
                    }
                }
            }
            catch (e_190_1) { e_190 = { error: e_190_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_190) throw e_190.error; }
            }
        }
        return c;
    };
    SpreadsheetPaneManager.prototype._ew = function (a, b, c) {
        var e_193, _0;
        var d = a._rows$i._aj(b);
        if (d != null) {
            var e = void 0;
            try {
                for (var _1 = tslib_1.__values(fromEnum(d._ch(c._w, c._x, true))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    if (nullableNotEquals(null, (e = this._ex(d, f, c)))) {
                        return e;
                    }
                }
            }
            catch (e_193_1) { e_193 = { error: e_193_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_193) throw e_193.error; }
            }
        }
        return Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
    };
    SpreadsheetPaneManager.prototype._ey = function (a, b, c) {
        var d = a._c6(b);
        return this._e0(d, c);
    };
    SpreadsheetPaneManager.prototype._e0 = function (a, b) {
        var c = typeCast(ArrayInteriorFormula.$, a);
        if (c != null) {
            if (!b._h(c._cz.cellRange._h)) {
                return Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 25);
            }
        }
        else {
            var d = typeCast(DataTableInteriorFormula.$, a);
            if (d != null) {
                if (!b._h(d._cz._h._h)) {
                    return Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, 26);
                }
            }
        }
        return Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
    };
    SpreadsheetPaneManager.prototype._ex = function (a, b, c) {
        var d = Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
        if (b.o && b.d.l(b.h, b.f)) {
            var e = b.d.ab(a, b.r, null, b.h, b.f);
            if (nullableNotEquals(null, (d = this._e0(e, c)))) {
                return d;
            }
        }
        return Nullable$1.toNullable(SpreadsheetUserPromptTrigger_$type, null);
    };
    SpreadsheetPaneManager._fn = function (a) {
        return CellAddress.w(a, true, 16384, -1, false, 1);
    };
    SpreadsheetPaneManager._fo = function (a) {
        return (a + 1).toString();
    };
    SpreadsheetPaneManager.prototype._be = function (a) {
        var b = Math.max(Math.min(a, 0x7FFFFFFF), 0);
        return this._bb._co(b);
    };
    SpreadsheetPaneManager.prototype._di = function (a, b, c) {
        if (c === void 0) { c = 0x7FFFFFFF; }
        return this._bb._e0(a, Math.min(b, 0x7FFFFFFF), c);
    };
    SpreadsheetPaneManager.prototype._bi = function (a, b) {
        return this._bb._de(a, b);
    };
    SpreadsheetPaneManager.prototype._b6 = function (a, b, c, d, e, f, g) {
        if (g === void 0) { g = null; }
        var h = false;
        var i = this._bb._tables$i;
        var j = new SpreadsheetCellRange(c, e, d, f);
        for (var k = i.count - 1; k >= 0; k--) {
            var l = i._item(k);
            if (!l.isFilterUIVisible) {
                continue;
            }
            var m = l._by;
            if (m._ac >= c && SpreadsheetUtilities.a9(j, m)) {
                for (var n = Math.max(j.firstColumn, m._w), o = Math.min(f, m._x); n <= o; n++) {
                    var p = 0;
                    if (l._columns$i._item(n - m._w).filter != null) {
                        p |= 16;
                    }
                    var q = l._columns$i._item(n - m._w).sortCondition;
                    if (q != null) {
                        p |= (q.sortDirection == 0 ? 4 : 8);
                    }
                    h = this._bo(a, g, m._ac, n, 1, p) || h;
                }
            }
        }
        var r = this._bb.filterSettings.region;
        if (r != null && r.firstRow >= c && r._t(c, e, d, f)) {
            var s = r._h;
            for (var t = Math.max(j.firstColumn, s._w), u = Math.min(f, s._x); t <= u; t++) {
                var v = 0;
                if (this._bb.filterSettings.getFilter(t - s._w) != null) {
                    v |= 16;
                }
                var w = this._bb.filterSettings.sortSettings._sortConditions$i._item(new RelativeIndex(t - s._w));
                if (w != null) {
                    v |= (w.sortDirection == 0 ? 4 : 8);
                }
                h = this._bo(a, g, s._ac, t, 0, v) || h;
            }
        }
        if (b == this._ao) {
            var x = b._ag._r;
            if (x.intersectsWith(j)) {
                var y = x._c;
                var z = this._bh;
                if (z != null && z.isTotalsRowVisible && z._by._ae == y.row) {
                    h = this._bo(a, g, y.row, y.column, 3, 0) || h;
                }
                else {
                    var aa = this._bb._dataValidationRules$i._e(new WorksheetRegionAddress(1, y.row, y.row, y.column, y.column));
                    if (typeCast(ListDataValidationRule.$, aa) !== null && aa.showDropdown) {
                        h = this._bo(a, g, y.row, y.column, 2, 0) || h;
                    }
                }
            }
        }
        return h;
    };
    SpreadsheetPaneManager.prototype._el = function (a) {
        a *= 1 / this._ds;
        var b = this._bb._fw(a, 3, false);
        return b;
    };
    SpreadsheetPaneManager.prototype._em = function (a) {
        a *= 1 / this._dt;
        if (this._al._t) {
            a = Workbook._ey(this._bb.workbook, a, true, false);
        }
        var b = truncate(MathUtilities.f(Workbook._ep(this._bb.workbook, a, true)));
        return b;
    };
    SpreadsheetPaneManager.prototype._bj = function (a, b) {
        var e_194, _0;
        var c = null;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._bb._tables$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                var e = d._by;
                if (e._j(a)) {
                    var f = d._cf(b.row, b.column);
                    if (c == null || f) {
                        c = d;
                    }
                    if (f) {
                        break;
                    }
                }
            }
        }
        catch (e_194_1) { e_194 = { error: e_194_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_194) throw e_194.error; }
        }
        return c;
    };
    SpreadsheetPaneManager.prototype._b7 = function (a) {
        return (this._av & a) != 0;
    };
    SpreadsheetPaneManager.prototype._a4 = function (a, b, c, d, e, f, g) {
        var h = this._al._j;
        var i = a.j || a.e == 4 ? b : 0;
        var j = TextMetricsProviderBase._c(f);
        var k;
        var l = null;
        if (typeCast(FormattedString.$, a.ap) !== null) {
            a.k = false;
            a.q = false;
            a.l = false;
            a.p = false;
            if (g) {
                l = SpreadsheetUtilities.au(this._bb.workbook);
            }
            var m = typeCast(FormattedString.$, a.ap);
            k = h.g(m, d, i, c, a.j, g, this._d8, SpreadsheetUtilities.e2(l, this._bb.workbook));
            if (WorkbookColorInfo.l_op_Equality(l, null)) {
                l = new FormattedStringFontResolved(m._getFont(0), d).colorInfo;
            }
        }
        else {
            var n = new GetCellTextParameters(a.w);
            n.b = 0;
            n.a = 0;
            n.d = runOn(h, h.k);
            n.f = a.ai + a.ah;
            var o = a.h._av(n);
            var p = o.g;
            a.q = isNaN_(o.e) == false && o.c && nullableEquals(ExcelCalcValue._be(this._bb.workbook, o.e, true, false), null);
            a.l = isNaN_(o.e) == false && o.d;
            if (a.d != null && a.d.cellFormat != null && (a.d.cellFormat.formatOptions & 1) != 0) {
                a.p = "General" == a.d.cellFormat.formatString;
            }
            else {
                a.p = d._cs == 0;
            }
            if (!a.j) {
                p = SpreadsheetUtilities.dl(p);
            }
            a.k = SpreadsheetUtilities.a2(p);
            if (o.f != null && e) {
                l = SpreadsheetUtilities.av(o.f, this._bb.workbook._palette$i);
            }
            else if (g && this._ci(d)) {
                l = SpreadsheetUtilities.au(this._bb.workbook);
            }
            var q = a.d != null ? a.d._h : null;
            if (q != null && q.font != null) {
                var r = 4096 | 16384 | 1024 | 128 | 256;
                var s = this._bb.workbook._cd(0);
                s.setFormatting(d);
                for (var t = 1; t != 1073741824; t = (t << 1)) {
                    if ((r & t) == 0) {
                        continue;
                    }
                    var u = q._dd(t);
                    if (WorksheetCellFormatData._cf(t, u) == false) {
                        s._dv(t, u);
                    }
                }
                d = s;
            }
            if (a.k && a.e == 4) {
                i = 0;
            }
            k = h.h(p, d, i, c, a.j, g, this._d8, SpreadsheetUtilities.e2(l, this._bb.workbook));
            if (WorkbookColorInfo.l_op_Equality(l, null)) {
                l = d._bh;
            }
        }
        if (j) {
            var v = truncate(h.ac(d, 1 / this._dt));
            AccountingUnderlineInfo.d(v, f == 33, this._bb, a, d);
            {
                var w = h.k();
                try {
                    a.u = w._g(d, "Wj", Nullable$1.toNullable(Size.$, null), true, true).height - v;
                }
                finally {
                    if (w != null) {
                        w.dispose();
                    }
                }
            }
        }
        else {
            a.a = null;
        }
        a.ar = WorkbookColorInfo.l_op_Equality(l, null) ? ExcelUtils.gv : SpreadsheetUtilities.e2(l, this._bb.workbook);
        a.g = l;
        return k;
    };
    SpreadsheetPaneManager.prototype._e5 = function (a) {
        if (a == null) {
            return Nullable$1.toNullable(Boolean_$type, null);
        }
        else {
            return Nullable$1.toNullable(Boolean_$type, a._s());
        }
    };
    SpreadsheetPaneManager.prototype._ad = function (a, b, c, d, e) {
        var f = this._getCellRange1(b.row, b.column);
        var g = this._getCellRange1(d.row, d.column);
        var h = c;
        var i = new SpreadsheetCellRange();
        var j;
        e = a;
        switch (a) {
            default:
            case 1:
                i = new SpreadsheetCellRange(c.firstRow, Math.min(f.firstColumn, g.firstColumn), c.lastRow, Math.max(c.lastColumn, g.lastColumn));
                j = i.lastColumn <= c.lastColumn;
                break;
            case 0:
                i = new SpreadsheetCellRange(c.firstRow, Math.min(c.firstColumn, g.firstColumn), c.lastRow, Math.max(f.lastColumn, g.lastColumn));
                j = i.firstColumn >= c.firstColumn;
                break;
            case 3:
                i = new SpreadsheetCellRange(Math.min(f.firstRow, g.firstRow), c.firstColumn, Math.max(c.lastRow, g.lastRow), c.lastColumn);
                j = i.lastRow <= c.lastRow;
                break;
            case 2:
                i = new SpreadsheetCellRange(Math.min(c.firstRow, g.firstRow), c.firstColumn, Math.max(f.lastRow, g.lastRow), c.lastColumn);
                j = i.firstRow >= c.firstRow;
                break;
        }
        if (j && SpreadsheetCellRange.l_op_Inequality(h, i)) {
            i = this._ag(i);
            i = i.union(this._getCellRange1(b.row, b.column));
            e = SpreadsheetUtilities.n(a);
        }
        else {
            i = this.extendRangeForMergedCells(i);
        }
        return {
            ret: i,
            p4: e
        };
    };
    SpreadsheetPaneManager.prototype._getPane1 = function (a) {
        if (this._dl.count == 0) {
            return null;
        }
        switch (a) {
            default:
            case 3: return this._getPane2(0, 0);
            case 1: return this._getPane2(0, this._dh.count - 1);
            case 2: return this._getPane2(this._dn.count - 1, 0);
            case 0: return this._getPane2(this._dn.count - 1, this._dh.count - 1);
        }
    };
    SpreadsheetPaneManager.prototype._ff = function (a) {
        if (a == null) {
            return Nullable$1.toNullable(PaneLocation_$type, null);
        }
        var b = this._dn.indexOf(a.rowScrollRegion);
        var c = this._dh.indexOf(a.columnScrollRegion);
        if (b == 1) {
            return Nullable$1.toNullable(PaneLocation_$type, c == 1 ? 0 : 2);
        }
        else if (c == 1) {
            return Nullable$1.toNullable(PaneLocation_$type, 1);
        }
        else {
            return Nullable$1.toNullable(PaneLocation_$type, 3);
        }
    };
    SpreadsheetPaneManager.prototype._as = function (a) {
        var b = this._dl.count;
        if (b == 0) {
            return null;
        }
        this._bb.displayOptions._br();
        var c = this._getPane1(this._bb.displayOptions._z);
        if (c != null && c != this.activePane) {
            return c;
        }
        var d = this._dl.indexOf(this.activePane);
        if (this._bb.displayOptions.panesAreFrozen) {
            d = b - 1;
        }
        else if (d < 0 || b == 1) {
            d = 0;
        }
        else if (nullableEquals(a, null)) {
        }
        else if (b == 2) {
            d = d == 0 ? 1 : 0;
        }
        else {
            var e = a.value ? [1, 3, 0, 2] : [2, 0, 3, 1];
            d = e[d];
        }
        return this._dl.item(d);
    };
    SpreadsheetPaneManager.prototype._dy = function (a) {
        var b = a < 0;
        var c = this._bb._fl(Math.abs(a), 3, false);
        c *= this._ds;
        if (b) {
            c = -c;
        }
        return c;
    };
    SpreadsheetPaneManager.prototype._dz = function (a) {
        var b = a < 0;
        var c = this._bb.workbook;
        var d = this.convertTwipsToPixels(Math.abs(a), true);
        if (b) {
            d = -d;
        }
        return d;
    };
    SpreadsheetPaneManager.prototype._ec = function (a, b, c, d) {
        if (d === void 0) { d = Nullable$1.toNullable(HorizontalCellAlignment_$type, null); }
        var e = Nullable$1.toNullable(Number_$type, a);
        do {
            e = b._c1(e.value, false);
            if (nullableEquals(e, null) || nullableLessThan(e, c)) {
                break;
            }
        } while (this._bb._cb(e.value).i);
        var f;
        if (nullableNotEquals(e, null)) {
            f = Math.max(e.value + 1, c);
        }
        else {
            f = c;
        }
        for (var g = (a - 1), h = f; g >= h; g--) {
            if (this._bb._cr(b.index, g) != null) {
                f = g + 1;
                break;
            }
            var i = this._bb._cb(g);
            if (i.i) {
                g = i.q;
            }
            else if (nullableNotEquals(d, null)) {
                var j = b._bc(g);
                if (nullableNotEquals(j.alignment, d)) {
                    f = g + 1;
                    break;
                }
            }
        }
        return f;
    };
    SpreadsheetPaneManager.prototype._jm = function (a) {
        if (a.isEmpty) {
            return Size.empty;
        }
        var b = this._bb._cn(a.firstColumn);
        var c = this._bb._cn(a.lastColumn);
        var d = c._l - b._m;
        var e = this._bb._cp(a.firstRow);
        var f = this._bb._cp(a.lastRow);
        var g = f._l - e._m;
        return new Size(1, d, g);
    };
    SpreadsheetPaneManager.prototype._bf = function () {
        if (this._bb.isProtected) {
            return this._bb.protection.selectionMode;
        }
        return 0;
    };
    SpreadsheetPaneManager.prototype._fq = function (a) {
        return CellAddress.y(a, true, 1048576, -1, false, 1);
    };
    SpreadsheetPaneManager.prototype._fr = function (a) {
        return (a + 1).toString();
    };
    SpreadsheetPaneManager.prototype._fb = function (a, b, c, d) {
        var e_195, _0;
        var e = c == 0 || c == 1;
        var f = c == 0 || c == 2;
        var g = Nullable$1.toNullable(IntRange.$, null);
        var h = 0x7FFFFFFF;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._bb._tables$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var i = _2.value;
                var j = i._by;
                if (e) {
                    if (j._ac > a || j._ae < a) {
                        continue;
                    }
                    if (f && j._w >= b) {
                        continue;
                    }
                    else if (!f && j._x <= b) {
                        continue;
                    }
                    if (f && j._x < d.firstColumn) {
                        continue;
                    }
                    else if (!f && j._w > d.lastColumn) {
                        continue;
                    }
                    var k = SpreadsheetPaneManager._e3(j._w, j._x, this._bb);
                    if (nullableEquals(k, null)) {
                        continue;
                    }
                    if (f && nullableGreaterThanOrEqual(k, b)) {
                        continue;
                    }
                    var l = (f ? b - j._x : j._w - b);
                    if (l < h) {
                        var m = this._e8(k.value, j._x);
                        if (!f && nullableLessThanOrEqual(m, b)) {
                            continue;
                        }
                        h = l;
                        g = Nullable$1.toNullable(IntRange.$, new IntRange(1, k.value, m.value));
                    }
                }
                else {
                    if (j._w > b || j._x < b) {
                        continue;
                    }
                    if (f && j._ac >= a) {
                        continue;
                    }
                    else if (!f && j._ae <= a) {
                        continue;
                    }
                    if (f && j._ae < d.firstRow) {
                        continue;
                    }
                    else if (!f && j._ac > d.lastRow) {
                        continue;
                    }
                    var n = SpreadsheetPaneManager._e4(j._ac, j._ae, this._bb);
                    if (nullableEquals(n, null)) {
                        continue;
                    }
                    if (f && nullableGreaterThanOrEqual(n, a)) {
                        continue;
                    }
                    var o = (f ? a - j._ae : j._ac - a);
                    if (o < h) {
                        var p = this._e9(n.value, j._ae);
                        if (!f && nullableLessThanOrEqual(p, a)) {
                            continue;
                        }
                        h = o;
                        g = Nullable$1.toNullable(IntRange.$, new IntRange(1, n.value, p.value));
                    }
                }
            }
        }
        catch (e_195_1) { e_195 = { error: e_195_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_195) throw e_195.error; }
        }
        return g;
    };
    SpreadsheetPaneManager.prototype._au = function () {
        if (this._bb.isProtected && this._bb.protection.selectionMode == 1) {
            var a = this.activePane;
            var b = a != null ? a.selection : null;
            if (b != null && !this._canSelect(b.activeCell)) {
                return 2048;
            }
        }
        return 0;
    };
    SpreadsheetPaneManager.prototype._dj = function (a, b) {
        return this._bb._e0(a, b);
    };
    SpreadsheetPaneManager.prototype._dk = function (a, b) {
        return this._bb._e2(a, b);
    };
    SpreadsheetPaneManager.prototype._gn = function (a) {
        var e_196, _0, e_197, _1;
        var b = this.activePane;
        var c = b.selection;
        var d = c._bf;
        if (nullableNotEquals(this._fj(8), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var e = _3.value;
                var f = e._j;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(d)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var g = _5.value;
                        var h = (g._h - g._i) + 1;
                        if (a) {
                            f._hideColumns$i(Nullable$1.toNullable(Number_$type, g._i), Nullable$1.toNullable(Number_$type, h));
                        }
                        else {
                            f._unhideColumns$i(Nullable$1.toNullable(Number_$type, g._i), Nullable$1.toNullable(Number_$type, h));
                        }
                    }
                }
                catch (e_197_1) { e_197 = { error: e_197_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_197) throw e_197.error; }
                }
            }
        }
        catch (e_196_1) { e_196 = { error: e_196_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_196) throw e_196.error; }
        }
        this._b2(b, c.activeCell, true);
    };
    SpreadsheetPaneManager.prototype._go = function (a) {
        var e_198, _0, e_199, _1;
        var b = this.activePane;
        var c = b.selection;
        if (nullableNotEquals(this._fj(16), true)) {
            this._ea(new SpreadsheetUserPromptInfo(23, null, null, null, false));
            return;
        }
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var d = _3.value;
                var e = d._j;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(c._bg)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var f = _5.value;
                        var g = (f._h - f._i) + 1;
                        if (a) {
                            e._hideRows$i(Nullable$1.toNullable(Number_$type, f._i), Nullable$1.toNullable(Number_$type, g));
                        }
                        else {
                            e._unhideRows$i(Nullable$1.toNullable(Number_$type, f._i), Nullable$1.toNullable(Number_$type, g));
                        }
                    }
                }
                catch (e_199_1) { e_199 = { error: e_199_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_199) throw e_199.error; }
                }
            }
        }
        catch (e_198_1) { e_198 = { error: e_198_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_198) throw e_198.error; }
        }
        this._b2(b, c.activeCell, true);
    };
    SpreadsheetPaneManager.prototype._gq = function () {
        this._dq = Workbook._et(this._bb.workbook, false);
        this._dr = Workbook._et(this._bb.workbook, true);
        if (this._al._t) {
            this._ds = 96 / this._dq;
            this._dt = 96 / this._dr;
        }
        else {
            this._dt = this._ds = 1;
        }
    };
    SpreadsheetPaneManager.prototype._aj = function (a, b, c, d) {
        if (d === void 0) { d = true; }
        var e = c._a4;
        if (e == 0) {
            e = SpreadsheetUtilities.ap(a.ao, c, this._bb, a.h, a.ab);
        }
        a.e = e;
        a.v = c._cl;
        a.y = c._cm;
        a.z = c._cn;
        a.ac = c._cp;
        a.aa = c._co;
        a.s = c._b7;
        a.f = c._a8;
        a.j = c._b8;
        a.t = nullableEquals(c._c7, true);
        if (a.d != null && ((a.d.dataBarInfo != null && !a.d.dataBarInfo.showValue) || (a.d.iconInfo != null && !a.d.iconInfo.showValue))) {
            a.ap = null;
        }
        else if (this._bn) {
            a.ap = a.h.getCellFormula(a.w) || a.h._getCellValue1(a.w);
        }
        else {
            a.ap = a.h._getCellValue1(a.w);
        }
        if (e == 4 && typeCast(FormattedString.$, a.ap) !== null) {
            a.ap = a.ap.unformattedString;
        }
        a.ae = a.ab;
        a.ad = a.x;
        a.n = b.hasValue;
        if (this._bn) {
            if (a.ap != null && typeof a.ap === 'string' == false) {
                e = 1;
            }
            else {
                if (e == 4) {
                    e = 1;
                }
            }
            a.e = e;
        }
        if (!a.r) {
            switch (a.e) {
                case 4:
                case 6:
                    a.x = a.h._ck(a.w, this._u.lastColumn, Nullable$1.toNullable(HorizontalCellAlignment_$type, a.e));
                    a.ad = a.x;
                    break;
            }
        }
        var f;
        var g = this._bb._cn(a.ae);
        var h = g;
        var i = this._bb._gl;
        a.y *= i;
        a.z *= i;
        var j = a.y;
        var k = a.z;
        var l = this._bb._ge();
        var m = intDivide(l, 2);
        if (a.j) {
            a.y += m;
            a.z += (l - m);
        }
        else {
            switch (e) {
                case 1:
                case 4:
                    a.y += m;
                    break;
                case 3:
                    a.z += (l - m);
                    break;
                case 7:
                case 5:
                    a.y += m;
                    a.z += (l - m);
                    break;
                case 6:
                case 2: break;
            }
        }
        var n = ExcelUtils.dc(a.d, c);
        var o = n == 0 ? 0 : ExcelUtils.db(c._cq);
        a.ai = o;
        a.ah = ExcelUtils.dc(a.d, c) - o;
        var p = a.y + a.z + a.ah + a.ai;
        if (a.ad == a.ae) {
            f = this._dy(g._i) - p;
        }
        else {
            h = this._bb._cn(a.ad);
            var q = h._l - g._m;
            f = this._dy(q) - p;
        }
        f -= this._ds;
        var r = f;
        if (f < 1) {
            f = 1;
        }
        var s = SpreadsheetUtilities.ac(a.e);
        var t = this._a4(a, f, s, c, d, c._a1, nullableEquals(b, true));
        a.c = t;
        if (a.j && a.e == 7 && f < t.b) {
            var u = (r + (j + k)) - t.b;
            var v = truncate((u / 2));
            var w = truncate((u - v));
            a.y -= Math.max(j - v, 0);
            a.z -= Math.max(k - w, 0);
        }
        a.am = a.al = Nullable$1.toNullable(Number_$type, null);
        if (this._bn) {
            a.am = Nullable$1.toNullable(Number_$type, a.ae);
            a.al = Nullable$1.toNullable(Number_$type, a.ad);
        }
        else if (!a.j && !a.s) {
            switch (a.e) {
                case 4:
                    if (f < t.b) {
                        a.am = Nullable$1.toNullable(Number_$type, a.ae);
                        a.al = Nullable$1.toNullable(Number_$type, a.ad);
                    }
                    break;
                case 1:
                    if (f < t.b) {
                        var x = this._el(t.b);
                        a.ad = this._be(g._m + this._el(a.aj) + x)._j;
                        if (a.r) {
                            if (a.ad > a.x) {
                                a.al = Nullable$1.toNullable(Number_$type, a.x);
                            }
                        }
                        else {
                            var y = a.h._ck(a.x, a.ad, Nullable$1.toNullable(HorizontalCellAlignment_$type, null));
                            if (y < a.ad) {
                                a.al = Nullable$1.toNullable(Number_$type, y);
                            }
                        }
                    }
                    break;
                case 3:
                    if (f < t.b) {
                        var z = this._el(t.b);
                        var aa = h._l - this._el(a.z);
                        a.ae = this._be(Math.max(aa - z, 0))._j;
                        if (a.r) {
                            if (a.ae < a.ab) {
                                a.am = Nullable$1.toNullable(Number_$type, a.ab);
                            }
                        }
                        else {
                            var ab = this._ec(a.ab, a.h, a.ae, Nullable$1.toNullable(HorizontalCellAlignment_$type, null));
                            if (ab > a.ae) {
                                a.am = Nullable$1.toNullable(Number_$type, ab);
                            }
                        }
                    }
                    break;
                case 6:
                case 2:
                    if (f < t.b) {
                        var ac = this._el(t.b);
                        var ad = h._l - this._el(a.z);
                        var ae = g._m + this._el(a.y);
                        var af = ae + intDivide((ad - ae), 2);
                        a.ae = this._be(Math.max(af - intDivide(ac, 2), 0))._j;
                        a.ad = this._be(af + intDivide(ac, 2))._j;
                        if (a.r) {
                            if (a.ad > a.x) {
                                a.al = Nullable$1.toNullable(Number_$type, a.x);
                            }
                            if (a.ae < a.ab) {
                                a.am = Nullable$1.toNullable(Number_$type, a.ab);
                            }
                        }
                        else {
                            var ag = a.h._ck(a.x, a.ad, Nullable$1.toNullable(HorizontalCellAlignment_$type, null));
                            if (ag < a.ad) {
                                a.al = Nullable$1.toNullable(Number_$type, ag);
                            }
                            var ah = this._ec(a.ab, a.h, a.ae, Nullable$1.toNullable(HorizontalCellAlignment_$type, null));
                            if (ah > a.ae) {
                                a.am = Nullable$1.toNullable(Number_$type, ah);
                            }
                        }
                    }
                    break;
            }
        }
        var ai = this._bb._cp(a.ak);
        var aj = a.ak != a.ag ? this._bb._cp(a.ag) : ai;
        var ak = aj._l - ai._m;
        var al = Math.max(this._dz(ak) - (a.ac + a.v), 0);
        a.i = al < t.a;
        return a;
    };
    SpreadsheetPaneManager.prototype._gr = function () {
        var e_200, _0;
        this._ip(4194304, false);
        var a = this._bb.displayOptions.showRowAndColumnHeaders;
        this._d8 = this._bb.displayOptions.magnificationInNormalView / 100;
        var b = this._bb.workbook;
        var c = this._ba = this._ba._d(b._styles$i.normalStyle._i);
        var d = this._bf();
        for (var e = 0; e < 2; e++) {
            var f = e == 0 ? this._dm : this._dg;
            try {
                for (var _1 = tslib_1.__values(fromEnum(f)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var g = _2.value;
                    g._ap = a;
                    g._af = c;
                    g._bx = this._d8;
                    g._ai = d;
                }
            }
            catch (e_200_1) { e_200 = { error: e_200_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_200) throw e_200.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._ej = function (a, b, c, d, e, f, g, h, i, j) {
        var k;
        var l;
        if (a.isFrozen) {
            k = 1.7976931348623157E+308;
            l = a.endIndex;
        }
        else {
            var m = !isNaN_(j) ? j : a._bu;
            k = m + c;
            l = h;
        }
        if (k > b) {
            k = b;
        }
        if (k != 1.7976931348623157E+308) {
            k += a._bw * this._dw;
            k /= this._dw;
        }
        var n = e(k);
        var o = d(a.startIndex, n, l);
        if (!i) {
            var p = o == null || o.count == 0 || o.item(0)._j == 0 ? Nullable$1.toNullable(Number_$type, null) : f(o.item(0)._j);
            a._cr = p;
            var q = o == null || o.count == 0 || o.item(o.count - 1)._j == h ? Nullable$1.toNullable(Number_$type, null) : g(o.item(o.count - 1)._j);
            a._cq = q;
            if (!CoreUtilities.d(WorksheetItemPosition.$, a._m, o)) {
                a._m._a3(o);
            }
        }
        return o == null || o.count == 0 ? 0 : o.item(o.count - 1)._j;
    };
    SpreadsheetPaneManager.prototype._gu = function () {
        var e_201, _0, e_202, _1;
        this._i9();
        this._ip(8, false);
        this._ip(4194304, false);
        this._ip(16777216, true);
        var a = this._bb;
        var b = a.workbook;
        var c = this._bb.displayOptions;
        var d = c.panesAreFrozen;
        var e = c.frozenPaneSettings;
        var f = c.unfrozenPaneSettings;
        var g = d ? e : f;
        var h = g._h ? 2 : 1;
        var i = g._i ? 2 : 1;
        var j = this.activePane;
        var k = c.showRowAndColumnHeaders;
        var l = this._bb._rows$i.maxCount - 1;
        var m = this._bb._columns$i.maxCount - 1;
        var n = this._l;
        var o = this._j;
        var p = this._k;
        n.beginUpdate();
        o.beginUpdate();
        p.beginUpdate();
        this._d8 = c.magnificationInNormalView / 100;
        var q = b.cellReferenceMode == 1;
        var r = this._ba = this._ba._d(b._styles$i.normalStyle._i);
        var s = this._bf();
        try {
            var t = new Queue$1(SpreadsheetRowScrollRegion.$);
            try {
                for (var _2 = tslib_1.__values(fromEnum(n)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var u = _3.value;
                    t.g(u);
                }
            }
            catch (e_201_1) { e_201 = { error: e_201_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_201) throw e_201.error; }
            }
            n.clear();
            for (var v = 0; v < h; v++) {
                var w = t.count > 0 ? t.b() : new SpreadsheetRowScrollRegion();
                w._x._a4 = runOn(this, this._c3);
                w._x._a5 = runOn(this, this._d6);
                w._b4 = runOn(this, this._dz);
                w._b5 = runOn(this, this._em);
                w._b7 = runOn(a, a._cp);
                w._b8 = runOn(a, a._cq);
                w._b9 = runOn(this, this._dk);
                w._ak = runOn(this, this._h7);
                w._am = runOn(this, this._h8);
                w._al = runOn(this, this._h4);
                w._b6 = q ? runOn(this, this._fq) : runOn(this, this._fr);
                w._bx = this._d8;
                w._bj = this._dr;
                w._bi = this._dq;
                w._br = this._ds;
                w._bs = this._dt;
                w._ad = this._a6;
                w._ci = l;
                w._ch = 8192;
                w._bq = this._jj.height;
                w._af = r;
                w._o = this;
                w._ap = k;
                w._ai = s;
                n.add(w);
            }
            if (h > 1) {
                var x = n._inner[0];
                x._v = d ? 1 : 2;
                x.isFrozen = d;
                x.startIndex = Math.min(f.firstRowInTopPane, l);
                if (d) {
                    x.endIndex = Math.min(x.startIndex + e.frozenRows - 1, l);
                }
                else {
                    x._bt = this.convertTwipsToPixels(f.topPaneHeight, true);
                }
            }
            var y = Enumerable.ah(SpreadsheetRowScrollRegion.$, n);
            y._v = 0;
            y.isFrozen = false;
            y.startIndex = Math.min(h == 1 ? f.firstRowInTopPane : g.firstRowInBottomPane, l);
            if (h > 1 && d && y.startIndex <= n._inner[0].endIndex) {
                y.startIndex = n._inner[0].endIndex + 1;
            }
            var z = new Queue$1(SpreadsheetColumnScrollRegion.$);
            try {
                for (var _4 = tslib_1.__values(fromEnum(o)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var aa = _5.value;
                    z.g(aa);
                }
            }
            catch (e_202_1) { e_202 = { error: e_202_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_202) throw e_202.error; }
            }
            o.clear();
            for (var ab = 0; ab < i; ab++) {
                var ac = z.count > 0 ? z.b() : new SpreadsheetColumnScrollRegion();
                ac._x._a4 = runOn(this, this._c0);
                ac._x._a5 = runOn(this, this._d5);
                ac._b4 = runOn(this, this._dy);
                ac._b5 = runOn(this, this._el);
                ac._b7 = runOn(a, a._cn);
                ac._b8 = runOn(this, this._be);
                ac._b9 = runOn(this, this._dj);
                ac._ak = runOn(this, this._h5);
                ac._am = runOn(this, this._h6);
                ac._al = runOn(this, this._h3);
                ac._b6 = q ? SpreadsheetPaneManager._fn : SpreadsheetPaneManager._fo;
                ac._bx = this._d8;
                ac._bj = this._dr;
                ac._bi = this._dq;
                ac._br = this._ds;
                ac._bs = this._dt;
                ac._ad = this._a6;
                ac._ci = m;
                ac._ch = 65535;
                ac._bq = this._jj.width;
                ac._af = r;
                ac._o = this;
                ac._ap = k;
                ac._ai = s;
                o.add(ac);
            }
            if (i > 1) {
                var ad = o._inner[0];
                ad._v = d ? 1 : 2;
                ad.isFrozen = d;
                ad.startIndex = Math.min(f.firstColumnInLeftPane, m);
                if (d) {
                    ad.endIndex = Math.min(ad.startIndex + e.frozenColumns - 1, m);
                }
                else {
                    ad._bt = this.convertTwipsToPixels(f.leftPaneWidth, false);
                }
            }
            var ae = Enumerable.ah(SpreadsheetColumnScrollRegion.$, o);
            ae._v = 0;
            ae.isFrozen = false;
            ae.startIndex = Math.min(i == 1 ? f.firstColumnInLeftPane : g.firstColumnInRightPane, m);
            if (i > 1 && d && ae.startIndex <= o._inner[0].endIndex) {
                ae.startIndex = o._inner[0].endIndex + 1;
            }
            var af = p.toArray();
            p.clear();
            for (var ag = 0; ag < n.count; ag++) {
                var ah = n._inner[ag];
                for (var ai = 0; ai < o.count; ai++) {
                    var aj = o._inner[ai];
                    var ak = null;
                    for (var am = 0; am < af.length; am++) {
                        var al = af[am];
                        if (al.rowScrollRegion == ah && al.columnScrollRegion == aj) {
                            ak = al;
                            break;
                        }
                    }
                    if (ak == null) {
                        ak = new SpreadsheetPane(ah, o._inner[ai], this._eb, this);
                    }
                    var an = ak.selection;
                    an._ac = new IntRange(1, this._u.firstColumn, this._u.lastColumn);
                    an._ad = new IntRange(1, this._u.firstRow, this._u.lastRow);
                    p.add(ak);
                }
            }
            this._gt();
            if (j != null) {
                var ao = this._as(Nullable$1.toNullable(Boolean_$type, null));
                if (ao != j) {
                    var ap = j.selection;
                    ao.selection._resetSelection(Enumerable.a(SpreadsheetCellRange.$, ap.cellRanges), ap.activeCell, ap.activeCellRangeIndex, false);
                }
            }
        }
        finally {
            this._ip(4, true);
            this._ip(4096, true);
            this._i4();
            n.endUpdate();
            o.endUpdate();
            p.endUpdate();
            this._c5(2048, d);
        }
    };
    SpreadsheetPaneManager.prototype._gv = function (a, b, c, d, e, f, g, h, i) {
        var e_203, _0;
        var j = 0;
        i = 0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var k = _2.value;
                var l = k._x;
                var m = l._at;
                if (m) {
                    continue;
                }
                var n = l._ac;
                var o = n;
                var p = l._af;
                var q = f(k.actualExtent / this._dw);
                var r = q;
                if (l._a3) {
                    var s = d(k.startIndex);
                    n = s._m + f(k._bw);
                }
                else if (!m) {
                    var t = d(k.startIndex);
                    n = t._m;
                    if (!k.isFrozen) {
                        var u = e(truncate(MathUtilities.f(j + q)));
                        var v = u._l;
                        if (u._j < g - 1 && CoreUtilities.c(v, q)) {
                            u = e(u._j + 1);
                        }
                        r = v - j;
                    }
                }
                var w = Math.max(r, Math.max(b, n + q) - j);
                if (k.isFrozen) {
                    var x = k._m.count == 0 ? d(k.endIndex) : Enumerable.ah(WorksheetItemPosition.$, k._m);
                    i = x._j + 1;
                    j = x._l;
                }
                else {
                    if (n > j && w + j > b) {
                    }
                    else {
                        var y = k._r;
                        var z = w + j - q;
                        if (y != null && y.a == z && y.c == q) {
                            w = y.b;
                        }
                        else {
                            var aa = e(truncate(MathUtilities.f(z)));
                            var ab = aa._j;
                            if (z > aa._m) {
                                ab++;
                            }
                            var ac = w + aa._l - z;
                            k._r = new PageStartScrollCache(q, z, ac, ab);
                            w = ac;
                        }
                    }
                    l._ab = j;
                    l._ae = c;
                }
                l._aj(q, w, n);
                if (!this._b7(262144)) {
                    if (!CoreUtilities.c(o, l._ac) || !CoreUtilities.c(h, k._bh)) {
                        k._bg = l._ac + l._af / 2;
                        k._bh = h;
                    }
                }
            }
        }
        catch (e_203_1) { e_203 = { error: e_203_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_203) throw e_203.error; }
        }
        return {
            p8: i
        };
    };
    SpreadsheetPaneManager.prototype._gs = function () {
        var a = this._bb.workbook;
        this._u = new SpreadsheetCellRange(0, 0, a.maxRowCount - 1, a.maxColumnCount - 1);
    };
    SpreadsheetPaneManager.prototype._g1 = function (a) {
        var e_204, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                b._r = b._s = null;
            }
        }
        catch (e_204_1) { e_204 = { error: e_204_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_204) throw e_204.error; }
        }
    };
    SpreadsheetPaneManager._ch = function (a) {
        switch (a.a) {
            case 35:
                switch (a.c) {
                    case "FirstColumnInLeftPane":
                    case "FirstRowInTopPane":
                    case "FirstColumnInRightPane":
                    case "FirstRowInBottomPane": return true;
                }
                break;
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._ci = function (a) {
        var b = typeCast(WorkbookBuiltInStyle.$, a._bs);
        if (b != null && b._ac == 8) {
            var c = a._bh;
            var d = b._i._bh;
            if (WorkbookColorInfo.l_op_Equality(c, d)) {
                return true;
            }
            else {
                var e = this._bb.workbook;
                if (Color.b(c._aj(e, true, true), d._aj(e, true, true))) {
                    return true;
                }
            }
        }
        return false;
    };
    SpreadsheetPaneManager._cm = function (a, b, c) {
        var d = a.sortSettings.region;
        if (d == null) {
            return false;
        }
        var e = d._h;
        if (WorksheetRegionAddress._o(SpreadsheetUtilities.ay(b), e)) {
            return true;
        }
        if (c > 0) {
            var f = e._ac - c;
            e = e._d(f);
            if (WorksheetRegionAddress._o(SpreadsheetUtilities.ay(b), e)) {
                return true;
            }
        }
        return false;
    };
    SpreadsheetPaneManager._cn = function (a, b) {
        switch (a) {
            case 0: return false;
            default:
            case 3: return true;
            case 1: return !b;
            case 2: return b;
        }
    };
    SpreadsheetPaneManager.prototype._cr = function (a, b) {
        var c = this._bb._rows$i._aj(a);
        var d = this._bb._b4(c, b);
        return nullableEquals(d._c5, false);
    };
    SpreadsheetPaneManager.prototype._cq = function (a, b) {
        var c = this._bb._b4(a, b);
        return nullableEquals(c._c5, false);
    };
    SpreadsheetPaneManager._co = function (a, b, c) {
        var e_205, _0, e_206, _1, e_207, _2;
        if (c === void 0) { c = null; }
        if (a.isProtected) {
            var d = 0;
            var e = a._columns$i.maxCount;
            var f = c != null ? c.a(a) : null;
            try {
                for (var _3 = tslib_1.__values(fromEnum(b._bj)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var g = _4.value;
                    if (SpreadsheetPaneManager._cp(a, g._i, d, g._h, e, f) == false) {
                        return false;
                    }
                }
            }
            catch (e_205_1) { e_205 = { error: e_205_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_205) throw e_205.error; }
            }
            if (b._al == false || b._am == false) {
                if (b._bi.count > 0) {
                    var h = 0;
                    var i = a._rows$i.maxCount - 1;
                    try {
                        for (var _5 = tslib_1.__values(fromEnum(b._bi)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                            var j = _6.value;
                            if (SpreadsheetPaneManager._cp(a, h, j._i, i, j._h, f) == false) {
                                return false;
                            }
                        }
                    }
                    catch (e_206_1) { e_206 = { error: e_206_1 }; }
                    finally {
                        try {
                            if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                        }
                        finally { if (e_206) throw e_206.error; }
                    }
                }
                if ((b._bi.count == 0 && b._bj.count == 0) || b._aw) {
                    try {
                        for (var _7 = tslib_1.__values(fromEnum(b.cellRanges)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                            var k = _8.value;
                            if (b._az(k) == false && b._a0(k) == false) {
                                if (SpreadsheetPaneManager._cp(a, k.firstRow, k.firstColumn, k.lastRow, k.lastColumn, f) == false) {
                                    return false;
                                }
                            }
                        }
                    }
                    catch (e_207_1) { e_207 = { error: e_207_1 }; }
                    finally {
                        try {
                            if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                        }
                        finally { if (e_207) throw e_207.error; }
                    }
                }
            }
        }
        return true;
    };
    SpreadsheetPaneManager._cp = function (a, b, c, d, e, f) {
        var e_208, _0, e_209, _1;
        if (a.isProtected == false) {
            return true;
        }
        var g = b;
        var h = false;
        var i = LockedEditRangeInfoForCellRange.a(f, b, c, d, e);
        try {
            for (var _2 = tslib_1.__values(fromEnum(a._rows$i._m(b, d))), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var j = _3.value;
                var k = j.index;
                if (g != k) {
                    if (i != null) {
                        i.f(g, k - 1);
                    }
                    h = true;
                }
                else {
                    g++;
                }
                var l = void 0;
                var m = c;
                var n = j._hasCellFormat;
                var o = n && nullableEquals(j._cellFormatInternal.d._c5, true);
                try {
                    for (var _4 = tslib_1.__values(fromEnum(j._ch(c, e, true))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var p = _5.value;
                        if (p.n == false) {
                            continue;
                        }
                        if (m != p.r) {
                            if (n) {
                                if (o) {
                                    if (i == null || i.b(j, m, p.r - 1) == false) {
                                        return false;
                                    }
                                }
                            }
                            else {
                                for (var q = m, r = p.r; q < r; q++) {
                                    l = a._cb(q);
                                    if (nullableEquals(l.b._c5, true)) {
                                        if (i == null || i.b(j, Math.max(q, l.q), Math.min(p.r - 1, l.r)) == false) {
                                            return false;
                                        }
                                    }
                                    q = l.r;
                                }
                            }
                        }
                        if (nullableEquals(p.j._c5, true)) {
                            if (i == null || i.c(k, p.r) == false) {
                                return false;
                            }
                        }
                        m = p.r + 1;
                    }
                }
                catch (e_209_1) { e_209 = { error: e_209_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_209) throw e_209.error; }
                }
                if (m <= e) {
                    if (n) {
                        if (o) {
                            if (i == null || i.b(j, m, e) == false) {
                                return false;
                            }
                        }
                    }
                    else {
                        for (var s = m; s <= e; s++) {
                            l = a._cb(s);
                            if (nullableEquals(l.b._c5, true)) {
                                if (i == null || i.b(j, Math.max(m, l.q), Math.min(e, l.r)) == false) {
                                    return false;
                                }
                            }
                            s = l.r;
                        }
                    }
                }
            }
        }
        catch (e_208_1) { e_208 = { error: e_208_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_208) throw e_208.error; }
        }
        if (g != d + 1) {
            if (i != null) {
                i.f(g, d);
            }
            h = true;
        }
        if (h) {
            var t = a._f9(c);
            var u = a._ff;
            var v = u._inner[t];
            for (var w = t; w < u.count; w++) {
                v = u._inner[w];
                if (nullableEquals(v.b._c5, true)) {
                    if (i == null || i.d(Math.max(c, v.q), Math.min(e, v.r)) == false) {
                        return false;
                    }
                }
                if (v.r >= e) {
                    break;
                }
            }
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._eh = function (a) {
        if (isInfinity(a)) {
            a = this._dz(truncate(this._jl.height));
        }
        return this._ek(this._dn, a, this._d3, this._bb.workbook.maxRowCount - 1, true, runOn(this._bb, this._bb._e2), runOn(this, this._dz), runOn(this, this._em), runOn(this, this._fi), runOn(this, this._fe));
    };
    SpreadsheetPaneManager.prototype._ek = function (a, b, c, d, e, f, g, h, i, j) {
        var k = Enumerable.ad(SpreadsheetScrollRegion.$, a);
        var l = Enumerable.ah(SpreadsheetScrollRegion.$, a);
        var m = 0;
        var n = 0;
        if (k != l) {
            var o = 0;
            if (c > 0 && !k.isFrozen) {
                var p = k._bu;
                if (b > p && b - p < c) {
                    o = b - p;
                }
            }
            m = this._ej(k, b, o, f, h, i, j, d, e, NaN);
            if (!e && k.isFrozen) {
                k._bt = (g(truncate(Enumerable.ab(WorksheetItemPosition.$, k._m, function (q) { return q._i; }))) - k._bw) * this._dw;
            }
            var q = Math.min(k._bu + o, b);
            b -= q;
            if (!e) {
                k.actualExtent = q;
                this._i0(k, g);
            }
            if (!k.isFrozen) {
                k.endIndex = k._m.count == 0 ? k.startIndex : Enumerable.ah(WorksheetItemPosition.$, k._m)._j;
            }
            else {
                k._bk = 0;
            }
            b -= c;
            if (!e) {
            }
        }
        if (b < 0) {
            b = 0;
        }
        if (!e) {
            l._bt = b;
        }
        n = this._ej(l, b, 0, f, h, i, j, d, e, e ? b : NaN);
        if (!e) {
            if (l._m.count > 0) {
                l.startIndex = l._m._inner[0]._j;
            }
            l.actualExtent = b;
            l.endIndex = l._m.count == 0 ? l.startIndex : Enumerable.ah(WorksheetItemPosition.$, l._m)._j;
            this._i0(l, g);
        }
        return Math.max(m, n);
    };
    SpreadsheetPaneManager.prototype._cs = function (a) {
        var b = this.activePane.selection;
        var c = b._s();
        var d = this._getCellRange1(a.row, a.column);
        c = c.union(d);
        c = this.extendRangeForMergedCells(c);
        return this._cz(c);
    };
    SpreadsheetPaneManager.prototype._hi = function (a) {
    };
    SpreadsheetPaneManager.prototype._hj = function (a, b, c) {
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (this._a2._af(a)) {
                    if (this._a2._j.count > 1) {
                        this._ht(2097152);
                    }
                }
                break;
            case "ChartAdapter":
                this._cj = true;
                this._p.ad();
                break;
        }
    };
    SpreadsheetPaneManager.prototype._hl = function (a) {
        var b = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            b[_0 - 1] = arguments[_0];
        }
    };
    SpreadsheetPaneManager.prototype._hn = function () {
        this._bl = null;
        var a = dateNow();
        while (this._dp.count > 0) {
            var b = this._dp.b();
            if (b._b) {
                b._c();
                break;
            }
        }
        this._iv();
    };
    SpreadsheetPaneManager.prototype._cv = function () {
        this._ho(false);
        if (this._b7(8)) {
            this._gu();
        }
        if (this._dn.count == 0 || this._dh.count == 0) {
            return false;
        }
        return true;
    };
    SpreadsheetPaneManager.prototype._ho = function (a) {
        if (a === void 0) { a = true; }
        var b = this._b7(32768);
        if (b) {
            return;
        }
        try {
            this._ip(32768, true);
            this._hp();
        }
        finally {
            this._ip(32768, false);
        }
        if (this._cw() && a) {
            this._ho(false);
        }
        this._ip(65536, this._at != 0);
    };
    SpreadsheetPaneManager.prototype._hp = function () {
        var a = this._at;
        this._at = 0;
        if (a != 0) {
            if ((a & 5) == 5) {
                this._p.z();
            }
            if ((a & 3) == 3) {
                this._ht(16);
            }
            if ((a & 64) == 64) {
                this._ht(1024);
            }
            if ((a & 8192) == 8192) {
                this._ht(8388608);
            }
            if ((a & 128) == 128) {
                this._ht(4194304);
            }
            if ((a & 9) == 9) {
                this._ip(32, true);
            }
            if ((a & 17) == 17) {
                this._ip(8, true);
            }
            if ((a & 49) == 49) {
                this._ip(131072, true);
            }
            if ((a & 257) == 257) {
                this._ht(4194304);
            }
            if ((a & 515) == 515) {
                this._p.ad();
            }
            if ((a & 65536) == 65536) {
                this._p.g.l();
                this._ht(268435456);
            }
            if ((a & 4096) == 4096) {
                this._ip(33554432 | 67108864, true);
            }
            if ((a & 1024) == 1024) {
                this._iz();
            }
            if ((a & 2048) == 2048) {
                this._gk();
            }
            if ((a & 16384) == 16384) {
                this._ip(134217728, true);
            }
            if ((a & 32768) == 32768) {
                this._p.k.n(true);
            }
            if ((a & 1) == 1) {
                this._cj = true;
            }
        }
    };
    SpreadsheetPaneManager.prototype._cw = function () {
        var a = this._b7(131072);
        if (a) {
            this._hq();
        }
        this._ip(524288, false);
        return a;
    };
    SpreadsheetPaneManager.prototype._hq = function () {
        var e_210, _0, e_211, _1;
        this._ip(131072, false);
        var a = this._ji.height;
        var b = this._ji.width;
        var c = this._bb.displayOptions;
        var d = this._bb.displayOptions.magnificationInNormalView / 100;
        var e = d - this._d8;
        a -= this._dx * e;
        b -= this._d2 * e;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._dn)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var f = _3.value;
                if (f.isFrozen == false && f._ab != null) {
                    var g = f._ab;
                    var h = g._u(true);
                    var i = g.activeCell;
                    var j = f.startIndex <= i.row && i.row <= f.endIndex && h._contains(i);
                    var k = Math.max(Math.min(a, f.actualExtent) / (c.magnificationInNormalView / 100), 0);
                    var l = new WorksheetItemPosition();
                    if (this._b7(524288)) {
                        if (j) {
                            l = this._bb._cp(f.startIndex);
                        }
                        else {
                            l = this._bb._cp(h.firstRow);
                        }
                    }
                    else {
                        var m = Math.max(truncate(f._bg) - this._em(k / 2), 0);
                        l = this._bb._cq(m);
                        if (m > l._m + intDivide(l._i, 2) && l._j < this._u.lastRow) {
                            l = this._bb._cq(l._l + 1);
                        }
                    }
                    var n = l._j;
                    if (j) {
                        if (h.firstRow < n) {
                            n = h.firstRow;
                            l = this._bb._cp(n);
                        }
                        else if (h.firstRow > n) {
                            var o = l._m + this._em(k);
                            var p = this._bb._cq(o);
                            if (o < p._l && p._j > n) {
                                p = this._bb._cq(p._m - 1);
                            }
                            if (h.lastRow > p._j) {
                                p = this._bb._cp(h.lastRow);
                                var q = Math.max(p._l - this._em(k), 0);
                                l = this._bb._cq(q);
                                if (l._m < q) {
                                    l = this._bb._cq(l._l + 1);
                                }
                                n = l._j;
                            }
                        }
                        if (i.row < n) {
                            n = i.row;
                        }
                        else if (i.row > n) {
                            var r = l._m + this._em(k);
                            var s = this._bb._cq(r);
                            if (s._l < r && s._j > l._j) {
                                s = this._bb._cq(s._m - 1);
                            }
                            if (i.row > s._j) {
                                var t = Math.max(s._l - this._em(k), 0);
                                l = this._bb._cq(t);
                                if (l._m < t) {
                                    l = this._bb._cq(l._l + 1);
                                }
                                n = l._j;
                            }
                        }
                    }
                    if (f == this._dn.item(0)) {
                        c.unfrozenPaneSettings.firstRowInTopPane = n;
                    }
                    else if (this._dn.item(0).isFrozen) {
                        c.frozenPaneSettings.firstRowInBottomPane = n;
                    }
                    else {
                        c.unfrozenPaneSettings.firstRowInBottomPane = n;
                    }
                }
                a -= f.actualExtent;
                if (f.isFrozen) {
                    a -= f.actualExtent * e;
                }
            }
        }
        catch (e_210_1) { e_210 = { error: e_210_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_210) throw e_210.error; }
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this._dh)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var u = _5.value;
                if (u.isFrozen == false && u._ab != null) {
                    var v = u._ab;
                    var w = v._u(true);
                    var x = v.activeCell;
                    var y = u.startIndex <= x.column && x.column <= u.endIndex && w._contains(x);
                    var z = Math.max(Math.min(b, u.actualExtent) / (c.magnificationInNormalView / 100), 0);
                    var aa = new WorksheetItemPosition();
                    if (this._b7(524288)) {
                        if (y) {
                            aa = this._bb._cn(u.startIndex);
                        }
                        else {
                            aa = this._bb._cn(w.firstColumn);
                        }
                    }
                    else {
                        var ab = Math.max(truncate(u._bg) - this._el(z / 2), 0);
                        aa = this._bb._co(ab);
                        if (ab > aa._m + intDivide(aa._i, 2) && aa._j < this._u.lastColumn) {
                            aa = this._bb._co(aa._l + 1);
                        }
                    }
                    var ac = aa._j;
                    if (y) {
                        if (w.firstColumn < ac) {
                            ac = w.firstColumn;
                            aa = this._bb._cn(ac);
                        }
                        else if (w.firstColumn > ac) {
                            var ad = aa._m + this._el(z);
                            var ae = this._bb._co(ad);
                            if (ad < ae._l && ae._j > ac) {
                                ae = this._bb._co(ae._m - 1);
                            }
                            if (w.lastColumn > ae._j) {
                                ae = this._bb._cn(w.lastColumn);
                                var af = Math.max(ae._l - this._el(z), 0);
                                aa = this._bb._co(af);
                                if (aa._m < af) {
                                    aa = this._bb._co(aa._l + 1);
                                }
                                ac = aa._j;
                            }
                        }
                        if (x.column < ac) {
                            ac = x.column;
                        }
                        else if (x.column > ac) {
                            var ag = aa._m + this._el(z);
                            var ah = this._bb._co(ag);
                            if (ah._l < ag && ah._j > aa._j) {
                                ah = this._bb._co(ah._m - 1);
                            }
                            if (x.column > ah._j) {
                                var ai = Math.max(ah._l - this._el(z), 0);
                                aa = this._bb._co(ai);
                                if (aa._m < ai) {
                                    aa = this._bb._co(aa._l + 1);
                                }
                                ac = aa._j;
                            }
                        }
                    }
                    if (u == this._dh.item(0)) {
                        c.unfrozenPaneSettings.firstColumnInLeftPane = ac;
                    }
                    else if (this._dh.item(0).isFrozen) {
                        c.frozenPaneSettings.firstColumnInRightPane = ac;
                    }
                    else {
                        c.unfrozenPaneSettings.firstColumnInRightPane = ac;
                    }
                }
                b -= u.actualExtent;
                if (u.isFrozen) {
                    b -= u.actualExtent * e;
                }
            }
        }
        catch (e_211_1) { e_211 = { error: e_211_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_211) throw e_211.error; }
        }
        if (!this._b7(524288)) {
            this._ip(262144, true);
        }
    };
    SpreadsheetPaneManager.prototype._hs = function () {
        if (!this._b7(256)) {
            this._a7.m();
        }
    };
    SpreadsheetPaneManager.prototype._ht = function (a) {
        if ((this._av & a) != a) {
            this._ip(a, true);
            this._hs();
        }
    };
    SpreadsheetPaneManager.prototype._cy = function (a, b, c, d, e) {
        var e_212, _0;
        if (e === void 0) { e = false; }
        var f = this.activePane;
        var g = f != null ? f.selection : null;
        c = false;
        if (g != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var h = _2.value;
                    var i = h._j;
                    if (b && i.isProtected && i.protection.allowInsertingHyperlinks == false) {
                        continue;
                    }
                    var j = SpreadsheetPaneManager._hx(a, b, c, i, g.cellRanges);
                    c = j.p2;
                    if (b && (c || e)) {
                        if (SpreadsheetPaneManager._co(i, g, d) == false) {
                            return {
                                ret: false,
                                p2: c
                            };
                        }
                        else {
                            return {
                                ret: true,
                                p2: c
                            };
                        }
                    }
                }
            }
            catch (e_212_1) { e_212 = { error: e_212_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_212) throw e_212.error; }
            }
        }
        return {
            ret: c,
            p2: c
        };
    };
    SpreadsheetPaneManager._hx = function (a, b, c, d, e) {
        var e_213, _0;
        c = false;
        if (d._d8) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    var g = SpreadsheetUtilities.ay(f);
                    for (var h = d._hyperlinks$i.count - 1; h >= 0; h--) {
                        var i = d._hyperlinks$i.item(h);
                        var j = i.sourceRegion._h;
                        if (g._h(j) || j._h(g)) {
                            c = true;
                            if (b) {
                                return {
                                    p2: c
                                };
                            }
                            d._hyperlinks$i._s(h, a);
                        }
                    }
                }
            }
            catch (e_213_1) { e_213 = { error: e_213_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_213) throw e_213.error; }
            }
        }
        return {
            p2: c
        };
    };
    SpreadsheetPaneManager.prototype._cz = function (a) {
        var b = this.activePane.selection;
        if (b != null && this._canSelect1(a) && b._replaceActiveCellRange1(a, b.activeCell)) {
            return true;
        }
        return false;
    };
    SpreadsheetPaneManager.prototype._hz = function (a, b, c, d) {
        var _this = this;
        var e;
        var f = ((function () { var g = _this._ad(a, b, c, d, e); e = g.p4; return g.ret; })());
        this._cz(f);
        this._f2(e, f, null);
    };
    SpreadsheetPaneManager.prototype._h2 = function () {
        this._t = this._w = SpreadsheetCellRange.empty;
    };
    SpreadsheetPaneManager.prototype._h3 = function (a) {
        var e_214, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = b._j;
                var d = c._columns$i;
                if (a == 0) {
                    c._hideColumns$i();
                }
                else if (a < 0) {
                    {
                        var e = this._a9();
                        try {
                            var f = new CellSizeMeasurementContext(c.workbook, e);
                            var g = this._u;
                            var h = c._c4(g.firstRow, g.lastRow, g.firstColumn, g.lastColumn, false);
                            var i = false;
                            for (var j = h._w; j <= h._x; j++) {
                                var k = d.item(j);
                                var l = k._ay(h._ac, h._ae, f);
                                k.width = !nullableIsNull(l) ? l.value : k.width;
                                if (i) {
                                    k.hidden = false;
                                }
                            }
                        }
                        finally {
                            if (e != null) {
                                e.dispose();
                            }
                        }
                    }
                }
                else {
                    c.defaultColumnWidth = a;
                    var m = new List$1(IndexRange.$, 0);
                    m.add(new IndexRange(1, 0, c._columns$i.maxCount - 1));
                    c._ik(m, -1);
                }
            }
        }
        catch (e_214_1) { e_214 = { error: e_214_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_214) throw e_214.error; }
        }
    };
    SpreadsheetPaneManager.prototype._h4 = function (a) {
        var e_215, _0, e_216, _1;
        var b = false;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._a2._j)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var c = _3.value;
                var d = c._j;
                if (a == 0) {
                    d._dv = true;
                    d._hideRows$i();
                }
                else {
                    d._dv = false;
                    d.defaultRowHeight = a;
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(d._rows$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var e = _5.value;
                            e.hidden = false;
                            if (this._c6(e, a)) {
                                b = true;
                            }
                        }
                    }
                    catch (e_216_1) { e_216 = { error: e_216_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_216) throw e_216.error; }
                    }
                }
            }
        }
        catch (e_215_1) { e_215 = { error: e_215_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_215) throw e_215.error; }
        }
        if (b) {
            this._at |= 5 | 9;
            this._ht(65536);
        }
    };
    SpreadsheetPaneManager.prototype._h5 = function (a, b) {
        var e_217, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = a;
                var e = c._j;
                var f = e._columns$i.item(b);
                if (d == 0) {
                    f.hidden = true;
                }
                else {
                    if (d < 0) {
                        var g = void 0;
                        {
                            var h = this._a9();
                            try {
                                g = f._ay(0, e._rows$i.maxCount - 1, new CellSizeMeasurementContext(e.workbook, h));
                            }
                            finally {
                                if (h != null) {
                                    h.dispose();
                                }
                            }
                        }
                        if (!g.hasValue) {
                            continue;
                        }
                        d = g.value;
                    }
                    f.hidden = false;
                    f.width = d;
                }
            }
        }
        catch (e_217_1) { e_217 = { error: e_217_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_217) throw e_217.error; }
        }
    };
    SpreadsheetPaneManager.prototype._h6 = function (a, b) {
        var e_218, _0;
        if (a < 0) {
            var c = new Array(b.length);
            for (var d = 0; d < b.length; d++) {
                c[d] = new SpreadsheetCellRange(this._u.firstRow, b[d]._i, this._u.lastRow, b[d]._h);
            }
            this._f0(c, false);
        }
        else {
            var e = new List$1(IndexRange.$, 2, b.length);
            for (var f = 0; f < b.length; f++) {
                e.add(new IndexRange(1, b[f]._i, b[f]._h));
            }
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var g = _2.value;
                    g._j._ik(e, a);
                }
            }
            catch (e_218_1) { e_218 = { error: e_218_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_218) throw e_218.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._h7 = function (a, b) {
        var e_219, _0;
        var c = false;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var d = _2.value;
                var e = d._j;
                var f = e._rows$i.item(b);
                if (a == 0) {
                    f.hidden = true;
                }
                else {
                    f.hidden = false;
                    if (this._c6(f, a)) {
                        c = true;
                    }
                }
            }
        }
        catch (e_219_1) { e_219 = { error: e_219_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_219) throw e_219.error; }
        }
        if (c) {
            this._at |= 5 | 9;
            this._ht(65536);
        }
    };
    SpreadsheetPaneManager.prototype._h8 = function (a, b) {
        var e_220, _0;
        var c = new List$1(IndexRange.$, 2, b.length);
        for (var d = 0; d < b.length; d++) {
            c.add(new IndexRange(1, b[d]._i, b[d]._h));
        }
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var e = _2.value;
                e._j._im(c, a);
            }
        }
        catch (e_220_1) { e_220 = { error: e_220_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_220) throw e_220.error; }
        }
    };
    SpreadsheetPaneManager.prototype._c1 = function (a, b, c, d, e, f, g, h, i) {
        var j = a.startIndex;
        var k;
        switch (b) {
            case 4:
                k = g(a.startIndex, true);
                j = !nullableIsNull(k) ? k.value : a.startIndex;
                break;
            case 1:
                k = g(a.startIndex, false);
                j = !nullableIsNull(k) ? k.value : a.startIndex;
                break;
            case 3:
                var l = (a.endIndex - a.startIndex) + 1;
                if (!CoreUtilities.c(a._bk, 0) && a.endIndex != a.startIndex) {
                    l -= 1;
                }
                k = g(a.startIndex + l - 1, true);
                j = !nullableIsNull(k) ? k.value : a.startIndex + l;
                break;
            case 0:
                var m = i(a.startIndex);
                if (CoreUtilities.c(a._x._ac, m._m) && CoreUtilities.e(a._x._ac, a._x._ab)) {
                    m = i(a.startIndex - 1);
                }
                var n = Math.max(m._l - a._x._af, a._x._ab);
                var o = h(truncate(MathUtilities.f(n)));
                if (CoreUtilities.e(n, o._m)) {
                    o = i(Math.min(o._j + 1, a.startIndex - 1));
                }
                j = o._j;
                break;
            default: return false;
        }
        return this._c2(a, j, d, e, f, h, i);
    };
    SpreadsheetPaneManager.prototype._c2 = function (a, b, c, d, e, f, g) {
        a._bw = 0;
        if (b < 0) {
            b = c;
        }
        else {
            b = Math.max(Math.min(b, d - 1), c);
            if (b != a.startIndex) {
                var h = a._s;
                var i = a._x;
                if (h == null || h.c != i._af || h.a != e) {
                    var j = g(b);
                    if (j._m >= e - i._af) {
                        var k = e - i._af;
                        var l = f(truncate(MathUtilities.f(k)));
                        var m = l._j;
                        if (l._m < k) {
                            m++;
                            k = l._l;
                        }
                        a._s = h = new PageStartScrollCache(i._af, e, k, m);
                    }
                    else {
                        a._s = h = null;
                    }
                }
                if (h != null && b > h.d) {
                    b = h.d;
                }
            }
        }
        a.startIndex = b;
        return true;
    };
    SpreadsheetPaneManager.prototype._c0 = function (a, b, c) {
        return this._c1(a, b, c, this._ed, this._bb.workbook.maxColumnCount, this._jj.width, runOn(this, this._eq), runOn(this, this._be), runOn(this._bb, this._bb._cn));
    };
    SpreadsheetPaneManager.prototype._c3 = function (a, b, c) {
        return this._c1(a, b, c, this._ee, this._bb.workbook.maxRowCount, this._jj.height, runOn(this, this._er), runOn(this._bb, this._bb._cq), runOn(this._bb, this._bb._cp));
    };
    SpreadsheetPaneManager.prototype._ij = function (a, b) {
        if (b === void 0) { b = true; }
        var c = Nullable$1.toNullable(SpreadsheetCellRange.$, this._getCellRange1(a.row, a.column));
        this._ik(a, b, c);
    };
    SpreadsheetPaneManager.prototype._ik = function (a, b, c) {
        var d = this.activePane;
        var e = d != null ? d.selection : null;
        if (e != null && this._canSelect(a)) {
            var f = e._x == 2;
            var g = true;
            if (f) {
                if (b && !e._av) {
                    e._av = true;
                    g = e._ah(a);
                }
                else {
                    g = e._a4(a);
                }
            }
            else {
                g = e._a9(a);
            }
            if (g && SpreadsheetCellRange._l_op_Inequality_Lifted$i(c, Nullable$1.toNullable(SpreadsheetCellRange.$, null))) {
                this._b3(null, c.value, true);
            }
        }
    };
    SpreadsheetPaneManager.prototype._c5 = function (a, b) {
        var c = this._av;
        if (b) {
            c |= a;
        }
        else {
            c &= ~a;
        }
        if (c == this._av) {
            return false;
        }
        this._av = c;
        this.a(SpreadsheetPaneManager._db.item(a));
        return true;
    };
    SpreadsheetPaneManager.prototype._ip = function (a, b) {
        if (b) {
            this._av |= a;
        }
        else {
            this._av &= ~a;
        }
    };
    SpreadsheetPaneManager.prototype._c6 = function (a, b) {
        if (b < 0 && a.height < 0) {
            a._dx(true);
            return true;
        }
        else {
            a.height = b;
            return false;
        }
    };
    SpreadsheetPaneManager.prototype._iv = function () {
        if (this._dp.count > 0 && this._bl == null && (this._az == null || !this._az._i || !this._az._at)) {
            this._az = null;
            this._bl = new TimedOperation(runOn(this, this._hn), 50);
        }
    };
    SpreadsheetPaneManager.prototype._iw = function () {
        if (this._bl != null) {
            var a = this._bl;
            this._bl = null;
            a.c();
        }
    };
    SpreadsheetPaneManager.prototype._iz = function () {
        this._bn = this._bb.displayOptions.showFormulasInCells;
        this._jh = this._bb._jg;
    };
    SpreadsheetPaneManager.prototype._i0 = function (a, b) {
        if (a.isFrozen || a._m.count == 0) {
            a._bk = 0;
        }
        else {
            var c = Enumerable.ah(WorksheetItemPosition.$, a._m);
            var d = b(c._l) - (a._bw + b(a._m._inner[0]._m) + a.actualExtent / this._dw);
            a._bk = Math.max(d, 0);
        }
    };
    SpreadsheetPaneManager.prototype._i1 = function () {
        var a = this._bb.displayOptions;
        var b = a.unfrozenPaneSettings;
        var c = a.frozenPaneSettings;
        var d = a.panesAreFrozen ? c : b;
        var e = this._b7(1048576);
        try {
            this._ip(1048576, true);
            if (this._dh.count > 0) {
                b.firstColumnInLeftPane = this._dh.item(0).startIndex;
                if (this._dh.count > 1) {
                    d.firstColumnInRightPane = this._dh.item(1).startIndex;
                }
            }
            if (this._dn.count > 0) {
                b.firstRowInTopPane = this._dn.item(0).startIndex;
                if (this._dn.count > 1) {
                    d.firstRowInBottomPane = this._dn.item(1).startIndex;
                }
            }
        }
        finally {
            this._ip(1048576, e);
        }
    };
    SpreadsheetPaneManager.prototype._i2 = function () {
        var e_221, _0, e_222, _1, e_223, _2;
        if (this._b7(2097152)) {
            this._ip(2097152, false);
            var a = this._bb.displayOptions;
            var b = this._ff(this.activePane);
            if (nullableNotEquals(b, null)) {
                a._z = b.value;
            }
            var c = a._af.b;
            if (c.count != this._dl.count) {
                while (c.count > this._dl.count) {
                    c.removeAt(c.count - 1);
                }
                while (c.count < this._dl.count) {
                    c.add(new WorksheetPaneSelection());
                }
            }
            var d = null;
            for (var e = 0; e < this._dl.count; e++) {
                var f = this._dl.item(e);
                var g = f.selection;
                var h = c.item(e);
                if (f == this.activePane) {
                    d = h;
                }
                h.a = this._ff(f).value;
                h.b = SpreadsheetUtilities.aw(g.activeCell);
                h.f = g.activeCellRangeIndex;
                var i = g.cellRanges;
                var j = h.d;
                j.clear();
                try {
                    for (var _3 = tslib_1.__values(fromEnum(i)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                        var k = _4.value;
                        j.add(SpreadsheetUtilities.ay(k));
                    }
                }
                catch (e_221_1) { e_221 = { error: e_221_1 }; }
                finally {
                    try {
                        if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                    }
                    finally { if (e_221) throw e_221.error; }
                }
            }
            if (d != null) {
                try {
                    for (var _5 = tslib_1.__values(fromEnum(this._a2._j)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                        var l = _6.value;
                        if (l._j != this._bb) {
                            var m = l._j.displayOptions;
                            var n = m._af;
                            m._br();
                            try {
                                for (var _7 = tslib_1.__values(fromEnum(n.b)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                    var o = _8.value;
                                    o.g(d);
                                }
                            }
                            catch (e_223_1) { e_223 = { error: e_223_1 }; }
                            finally {
                                try {
                                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                                }
                                finally { if (e_223) throw e_223.error; }
                            }
                        }
                    }
                }
                catch (e_222_1) { e_222 = { error: e_222_1 }; }
                finally {
                    try {
                        if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                    }
                    finally { if (e_222) throw e_222.error; }
                }
            }
        }
    };
    SpreadsheetPaneManager.prototype._i4 = function () {
        var e_224, _0, e_225, _1;
        var a = this.activePane != null ? this.activePane.selection : null;
        if (this._a0 != null) {
            a = this._a0;
        }
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._dh)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var b = _3.value;
                b._ab = a;
            }
        }
        catch (e_224_1) { e_224 = { error: e_224_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_224) throw e_224.error; }
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this._dn)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var c = _5.value;
                c._ab = a;
            }
        }
        catch (e_225_1) { e_225 = { error: e_225_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_225) throw e_225.error; }
        }
        if (a != null) {
            a._by();
        }
    };
    SpreadsheetPaneManager.prototype._i6 = function () {
        var a = this._dl;
        for (var b = 0; b < a.count; b++) {
            var c = a.item(b);
            var d = c.rowScrollRegion.startIndex;
            var e = c.rowScrollRegion.endIndex;
            var f = !nullableIsNull(c.columnScrollRegion._cr) ? c.columnScrollRegion._cr.value : c.columnScrollRegion.startIndex;
            var g = c.columnScrollRegion.endIndex;
            var h = c._q;
            var i = new List$1(SpreadsheetDropDownButton.$, 0);
            var j = this._b6(i, c, d, e, f, g, h);
            if (j || !CoreUtilities.d(SpreadsheetDropDownButton.$, i, c._q)) {
                c._q._a3(i);
            }
        }
    };
    SpreadsheetPaneManager.prototype._i7 = function () {
        if (this._b7(8192)) {
            this._p.ae();
            this._ip(8192, false);
        }
    };
    SpreadsheetPaneManager.prototype._i8 = function () {
        var a = this._b7(16384);
        var b = this._al._j;
        this._ip(16384, true);
        b.ak();
        try {
            this._p.ak();
        }
        finally {
            b.an();
            this._ip(16384, a);
        }
    };
    SpreadsheetPaneManager.prototype._i9 = function () {
        this._jd();
        if (this._b7(32)) {
            this._ip(32, false);
            this._jl = this._jm(this._w);
            this._jk = this._jm(this._v);
            this._jj = this._jm(this._u);
        }
    };
    SpreadsheetPaneManager.prototype._jb = function () {
        this._i9();
        var a = this._b7(64);
        this._ip(64, true);
        try {
            var b = this._gv(this._dh, this._jl.width, this._bb.defaultColumnWidth, runOn(this._bb, this._bb._cn), runOn(this, this._be), runOn(this, this._el), this._bb.workbook.maxColumnCount, this._ji.width + this._d2, this._ed);
            this._ed = b.p8;
            var c = this._gv(this._dn, this._jl.height, this._bb.defaultRowHeight, runOn(this._bb, this._bb._cp), runOn(this._bb, this._bb._cq), runOn(this, this._em), this._bb.workbook.maxRowCount, this._ji.height + this._dx, this._ee);
            this._ee = c.p8;
        }
        finally {
            this._ip(64, a);
            this._ip(262144, false);
        }
    };
    SpreadsheetPaneManager.prototype._ja = function () {
        var e_226, _0, e_227, _1;
        var a = this._bb.workbook;
        if (a == null) {
            return;
        }
        var b = a.windowOptions.scrollBars;
        this._ca = SpreadsheetPaneManager._cn(b, false);
        this._ce = SpreadsheetPaneManager._cn(b, true);
        if (this._b7(4)) {
            this._ip(4, false);
            var c = this._ca ? 3 : 2;
            var d = this._ce ? 3 : 2;
            try {
                for (var _2 = tslib_1.__values(fromEnum(this._dh)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var e = _3.value;
                    e._x._b = c;
                }
            }
            catch (e_226_1) { e_226 = { error: e_226_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_226) throw e_226.error; }
            }
            try {
                for (var _4 = tslib_1.__values(fromEnum(this._dn)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var f = _5.value;
                    f._x._b = d;
                }
            }
            catch (e_227_1) { e_227 = { error: e_227_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_227) throw e_227.error; }
            }
        }
    };
    SpreadsheetPaneManager.prototype._d7 = function (a, b, c, d) {
        if (b < 0) {
            b = 0;
        }
        var e = d(truncate(MathUtilities.f(b)));
        var f;
        var g;
        if (a._x._a3) {
            f = e._j;
            g = a._b4(truncate(b) - e._m);
        }
        else {
            f = Math.min(b < (e._m + intDivide(e._i, 2)) ? e._j : e._j + 1, c - 1);
            g = 0;
        }
        a.startIndex = f;
        a._bw = g;
        this._cj = true;
        return b;
    };
    SpreadsheetPaneManager.prototype._d5 = function (a, b) {
        return this._d7(a, b, this._bb.workbook.maxColumnCount, runOn(this, this._be));
    };
    SpreadsheetPaneManager.prototype._d6 = function (a, b) {
        return this._d7(a, b, this._bb.workbook.maxRowCount, runOn(this._bb, this._bb._cq));
    };
    SpreadsheetPaneManager.prototype._jc = function () {
        var e_228, _0, e_229, _1;
        var a = this._b7(256);
        if (a) {
            return;
        }
        this._a7.i();
        this._ip(256, true);
        try {
            this._i2();
            if (this._b7(65536)) {
                this._ho();
            }
            if (this._b7(8)) {
                this._gu();
            }
            if (this._b7(4194304)) {
                this._gr();
            }
            this._ja();
            this._i2();
            if (this._b7(4096)) {
                this._ip(4096, false);
                try {
                    for (var _2 = tslib_1.__values(fromEnum(this._dn)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var b = _3.value;
                        b._ad = this._a6;
                    }
                }
                catch (e_228_1) { e_228 = { error: e_228_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_228) throw e_228.error; }
                }
                try {
                    for (var _4 = tslib_1.__values(fromEnum(this._dh)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var c = _5.value;
                        c._ad = this._a6;
                    }
                }
                catch (e_229_1) { e_229 = { error: e_229_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_229) throw e_229.error; }
                }
            }
            if (this._b7(1024)) {
                this._ip(1024, false);
                this._ip(8388608 | 134217728, true);
                var d = this.activePane;
                if (d != null) {
                    d.selection._bz();
                }
            }
            if (this._b7(512)) {
                this._ip(512, false);
                var e = this.activePane;
                var f = e != null ? e.selection : null;
                this._cd = f != null && f._bi.count == 1 && f._bi.item(0)._i <= this._u.firstColumn && f._bi.item(0)._h >= this._u.lastColumn && f._bj.count == 1 && f._bj.item(0)._i <= this._u.firstRow && f._bj.item(0)._h >= this._u.firstColumn;
            }
            if (this._b7(16777216)) {
                this._ip(16777216, false);
                this._ip(33554432 | 134217728, true);
                var g = this.activePane;
                var h = g != null ? g.selection : null;
                this._ao = h != null ? this._ar(h.activeCell) : null;
            }
            if (this._b7(33554432)) {
                this._ip(33554432, false);
                var i = this.activePane;
                var j = i != null ? i.selection : null;
                var k = j == null || this._bb._d6 == false ? null : this._bb._dataValidationRules$i._e(SpreadsheetUtilities.ax(j.activeCell));
                this._fu = k == null || k.showInputMessage == false || stringIsNullOrEmpty(k.inputMessageDescription) ? null : Tuple.a(String_$type, String_$type, k.inputMessageTitle, k.inputMessageDescription);
            }
            if (this._b7(67108864)) {
                this._ip(67108864, false);
                this._ip(134217728, true);
                var l = this._bb._fd;
                var m = l.count;
                for (var n = m - 1; n >= 0; n--) {
                    if (l._inner[n].dataValidationRule == null) {
                        l.removeAt(n);
                    }
                }
                if (m != l.count) {
                    this._cj = true;
                }
            }
            if (this._b7(8388608)) {
                this._ip(8388608, false);
                this._ip(134217728, true);
                var o = null;
                var p = this.activePane;
                var q = p != null ? p.selection : null;
                if (q != null) {
                    o = this._bi(q.activeCell.row, q.activeCell.column);
                }
                this._bh = o;
            }
            if (this._b7(134217728)) {
                this._ip(134217728, false);
                this._i6();
            }
            if (this._b7(268435456)) {
                this._ip(268435456, false);
                if (this._p.o()) {
                    this._cj = true;
                }
            }
        }
        finally {
            this._ip(256, a);
        }
    };
    SpreadsheetPaneManager.prototype._jd = function () {
        if (this._b7(16)) {
            this._ip(16, false);
            this._t = this._x();
            var a = 20;
            var b = 8;
            var c = this._v.isEmpty ? 0 : this._v.firstRow;
            var d = this._v.isEmpty ? 0 : this._v.firstColumn;
            this._w = new SpreadsheetCellRange(c, d, Math.max(this._t.lastRow, Math.min(this._u.lastRow, c + a)), Math.max(this._t.lastColumn, Math.min(this._u.lastColumn, d + b)));
            this._ip(32, true);
        }
    };
    SpreadsheetPaneManager.prototype._jf = function (a) {
        var e_230, _0;
        var b = this._bb.workbook;
        if (b == null) {
            return;
        }
        var c = this.activePane.selection._u(true);
        if (a) {
            if (WorksheetRegionAddress._p(this._bb._g1, Nullable$1.toNullable(WorksheetRegionAddress.$, null))) {
                return;
            }
            c = SpreadsheetUtilities.z(this._bb._g1.value);
        }
        else {
            var d = SpreadsheetUtilities.ay(c);
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._a2._j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var e = _2.value;
                    e._j._g1 = Nullable$1.toNullable(WorksheetRegionAddress.$, d);
                }
            }
            catch (e_230_1) { e_230 = { error: e_230_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_230) throw e_230.error; }
            }
        }
        this._bb._g1 = Nullable$1.toNullable(WorksheetRegionAddress.$, null);
        var f = this._dz(this._bb._cp(c.firstRow)._m);
        var g = this._dz(this._bb._cp(c.lastRow)._l);
        var h = this._dy(this._bb._cn(c.firstColumn)._m);
        var i = this._dy(this._bb._cn(c.lastColumn)._l);
        var j = i - h;
        var k = g - f;
        if (this._dn.item(0).isFrozen && this._dn.item(0).startIndex < c.firstRow) {
            var l = this._dz(this._bb._cp(this._dn.item(0).startIndex)._m);
            var m = this._dz(this._bb._cp(Math.min(this._dn.item(0).endIndex, c.firstRow - 1))._l);
            k += m - l;
        }
        if (this._dh.item(0).isFrozen && this._dh.item(0).startIndex < c.firstColumn) {
            var n = this._dy(this._bb._cn(this._dh.item(0).startIndex)._m);
            var o = this._dy(this._bb._cn(Math.min(this._dh.item(0).endIndex, c.firstColumn - 1))._l);
            j += o - n;
        }
        var p = this._bb.displayOptions.showRowAndColumnHeaders;
        var q = this._ji;
        if (p) {
            var r = Math.max(c.lastRow, 100);
            var s = void 0;
            if (b.cellReferenceMode == 1) {
                s = this._fq(r);
            }
            else {
                s = this._fr(r);
            }
            var t = this._al._j.z(this._dn.item(0), s);
            var u = this._al._j.w(b, 100, 0);
            var v = t;
            k += u;
            j += v;
            q.height += Math.max(0, this._dx - (3 * this._dt + this._dt));
            q.width += Math.max(0, this._d2 - (3 * this._ds + this._ds));
        }
        var w = Math.floor(q.width / j * 100);
        var x = Math.floor(q.height / k * 100);
        this._ip(524288, true);
        var y = truncate(CoreUtilities.l(Math.min(w, x), 10, 400));
        if (y != this._bb.displayOptions.magnificationInNormalView) {
            this._bb.displayOptions.magnificationInNormalView = y;
        }
        else if (!this._b7(131072)) {
            this._ip(131072, true);
            this._cw();
        }
    };
    SpreadsheetPaneManager.prototype.activatePane = function (a) {
        if (!this.canActivatePane(a)) {
            return false;
        }
        if (this.activePane != a) {
            if (this._d9 != null && !this._d9(a)) {
                return false;
            }
        }
        this.activePane = a;
        return true;
    };
    SpreadsheetPaneManager.prototype.scrollRangeIntoView = function (pane, rowRange, columnRange) {
        arguments[1] = wrapNullable(IntRange.$, arguments[1]);
        arguments[2] = wrapNullable(IntRange.$, arguments[2]);
        return this._scrollRangeIntoView$i.apply(this, arguments);
    };
    SpreadsheetPaneManager.prototype._scrollRangeIntoView$i = function (a, b, c) {
        this._b4(a, b, c, true);
    };
    SpreadsheetPaneManager.prototype.canActivatePane = function (a) {
        return !a.rowScrollRegion.isFrozen && !a.columnScrollRegion.isFrozen;
    };
    SpreadsheetPaneManager.prototype.canSelect = function (a) {
        return this._canSelect(a);
    };
    SpreadsheetPaneManager.prototype.canSelect1 = function (a) {
        return this._canSelect1(a);
    };
    SpreadsheetPaneManager.prototype.getFilter = function (a, b) {
        var c = this._bi(a, b);
        if (c != null) {
            return c._columns$i._item(b - c._by._w).filter;
        }
        var d = this._bb.filterSettings;
        if (d.region != null && d.region._q(a, b)) {
            var e = b - d.region.firstColumn;
            return d.getFilter(e);
        }
        return null;
    };
    SpreadsheetPaneManager.prototype.getHeaderCaption = function (a, b) {
        return this._fp(new SpreadsheetCell(a, b));
    };
    SpreadsheetPaneManager.prototype.getPane = function (a, b) {
        var e_231, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._dl)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                if (c.rowScrollRegion == a && c.columnScrollRegion == b) {
                    return c;
                }
            }
        }
        catch (e_231_1) { e_231 = { error: e_231_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_231) throw e_231.error; }
        }
        return null;
    };
    Object.defineProperty(SpreadsheetPaneManager.prototype, "renderCache", {
        get: function () {
            return this._al._j;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetPaneManager.prototype, "spreadsheetOwnerState", {
        get: function () {
            return this._al;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetPaneManager.prototype.verifyScrollPositions = function () {
        if (!this._ji.isEmpty) {
            this._jn(this._ji);
        }
    };
    SpreadsheetPaneManager.prototype.getScrollableRegion = function (a) {
        if (a != null && a.isFrozen) {
            var b = a._aw ? this._dm : this._dg;
            if (b.count > 1) {
                a = b.item(1);
            }
        }
        return a;
    };
    SpreadsheetPaneManager.$t = markType(SpreadsheetPaneManager, 'SpreadsheetPaneManager', PropertyChangeNotifierExtended.$, [ISpreadsheetPaneOwner_$type]);
    SpreadsheetPaneManager._db = SpreadsheetPaneManager._dc();
    return SpreadsheetPaneManager;
}(PropertyChangeNotifierExtended));
export { SpreadsheetPaneManager };
/**
 * @hidden
 */
var SpreadsheetPaneManager_IndentHelper = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneManager_IndentHelper, _super);
    function SpreadsheetPaneManager_IndentHelper(a, b) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.d = null;
        _this.k = 0x7FFFFFFF;
        _this.j = 0;
        _this.g = null;
        _this.m = Nullable$1.toNullable(HorizontalCellAlignment_$type, null);
        _this.h = -1;
        _this.i = 0;
        _this.f = null;
        _this.e = false;
        _this.c = null;
        _this.b = new SpreadsheetCellRange();
        _this.c = a.activePane;
        _this.b = a._aa();
        _this.i = b ? 1 : -1;
        _this.e = b;
        _this.a = Enumerable.a(Worksheet.$, Enumerable.o(SpreadsheetTabInfo.$, Worksheet.$, a._a3._j, function (c) { return c._j; }));
        _this.g = new HashSet$1(WorksheetCellFormatData.$, 0);
        return _this;
    }
    SpreadsheetPaneManager_IndentHelper.prototype.n = function () {
        var e_232, _0, e_233, _1, e_234, _2, e_235, _3;
        var a = this.c;
        if (a == null) {
            return;
        }
        var b = this.b;
        var e = this.a;
        for (var d = 0; d < e.length; d++) {
            var c = e[d];
            this.d = c;
            var f = runOn(this, this.r);
            try {
                for (var _4 = tslib_1.__values(fromEnum(a.selection.cellRanges)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var g = _5.value;
                    this.g.clear();
                    var h = g.firstRow <= b.firstRow && g.lastRow >= b.lastRow;
                    var i = g.firstColumn <= b.firstColumn && g.lastColumn >= b.lastColumn;
                    var j = Math.max(g.firstColumn, b.firstColumn);
                    var k = Math.min(g.lastColumn, b.lastColumn);
                    var l = Math.max(g.firstRow, b.firstRow);
                    var m = Math.min(g.lastRow, b.lastRow);
                    var n = 0;
                    try {
                        for (var _6 = tslib_1.__values(fromEnum(c._rows$i._m(l, m))), _7 = _6.next(); !_7.done; _7 = _6.next()) {
                            var o = _7.value;
                            n++;
                            this.h = j;
                            o._dj(j, k, f);
                            this.p(o, (k + 1));
                        }
                    }
                    catch (e_233_1) { e_233 = { error: e_233_1 }; }
                    finally {
                        try {
                            if (_7 && !_7.done && (_1 = _6.return)) _1.call(_6);
                        }
                        finally { if (e_233) throw e_233.error; }
                    }
                    if (n < (m + 1 - l)) {
                        this.h = j;
                        this.p(null, (k + 1));
                    }
                    if (this.k == 0 && this.e == false) {
                        return;
                    }
                    else if (this.j == 250 && this.e) {
                        return;
                    }
                }
            }
            catch (e_232_1) { e_232 = { error: e_232_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_0 = _4.return)) _0.call(_4);
                }
                finally { if (e_232) throw e_232.error; }
            }
            this.f = null;
            if (a.selection._ax) {
                this.f = new HashSet$1(SpreadsheetCell.$, 0);
            }
            var p = runOn(this, this.u);
            try {
                for (var _8 = tslib_1.__values(fromEnum(a.selection.cellRanges)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                    var q = _9.value;
                    var r = q.firstRow <= b.firstRow && q.lastRow >= b.lastRow;
                    var s = Math.max(q.firstColumn, b.firstColumn);
                    var t = Math.min(q.lastColumn, b.lastColumn);
                    var u = Math.max(q.firstRow, b.firstRow);
                    var v = Math.min(q.lastRow, b.lastRow);
                    if (r) {
                        for (var w = s; w <= t; w++) {
                            this.t(c._columns$i.item(w)._cellFormatInternal, true);
                        }
                        try {
                            for (var _10 = tslib_1.__values(fromEnum(c._rows$i._m(u, v))), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                                var x = _11.value;
                                x._dj(s, t, p);
                            }
                        }
                        catch (e_235_1) { e_235 = { error: e_235_1 }; }
                        finally {
                            try {
                                if (_11 && !_11.done && (_3 = _10.return)) _3.call(_10);
                            }
                            finally { if (e_235) throw e_235.error; }
                        }
                    }
                    else {
                        var y = q.firstColumn <= b.firstColumn && q.lastColumn >= b.lastColumn;
                        if (y) {
                            for (var z = q.firstRow; z <= q.lastRow; z++) {
                                var aa = c._rows$i.item(z);
                                this.t(aa._cellFormatInternal, true);
                                aa._dj(s, t, p);
                            }
                        }
                        else {
                            for (var ab = q.firstRow; ab <= q.lastRow; ab++) {
                                var ac = c._rows$i.item(ab);
                                for (var ad = q.firstColumn; ad <= q.lastColumn; ad++) {
                                    this.s(ac, ad);
                                }
                            }
                        }
                    }
                }
            }
            catch (e_234_1) { e_234 = { error: e_234_1 }; }
            finally {
                try {
                    if (_9 && !_9.done && (_2 = _8.return)) _2.call(_8);
                }
                finally { if (e_234) throw e_234.error; }
            }
        }
    };
    SpreadsheetPaneManager_IndentHelper.l = function (a, b) {
        var c = a._ct;
        if (c != 0) {
            var d = a._co;
            if (d == 0) {
                switch (b) {
                    case 1:
                    case 3:
                    case 7: break;
                    default:
                        c = 0;
                        break;
                }
            }
            else if (d == 255) {
                switch (a._a8) {
                    case 0:
                    case 2:
                    case 4: break;
                    default:
                        c = 0;
                        break;
                }
            }
            else {
                c = 0;
            }
        }
        return c;
    };
    SpreadsheetPaneManager_IndentHelper.prototype.p = function (a, b) {
        while (b > this.h) {
            var c = this.d._cb(this.h);
            if (a != null && a._hasCellFormat) {
                this.q(a._cellFormatInternal.d);
            }
            else if (c.b != null) {
                this.q(c.b);
            }
            else {
                this.q(this.d.workbook._ca._p);
            }
            this.h = (c.r + 1);
        }
    };
    SpreadsheetPaneManager_IndentHelper.prototype.q = function (a) {
        if (this.g.add_1(a)) {
            var b = a._a4;
            if (this.g.count == 1) {
                this.m = Nullable$1.toNullable(HorizontalCellAlignment_$type, b);
            }
            else if (nullableNotEquals(b, this.m)) {
                this.m = Nullable$1.toNullable(HorizontalCellAlignment_$type, null);
            }
            var c = SpreadsheetPaneManager_IndentHelper.l(a, b);
            if (c < this.k) {
                this.k = c;
            }
            if (c > this.j) {
                this.j = c;
            }
        }
    };
    SpreadsheetPaneManager_IndentHelper.prototype.r = function (a, b, c) {
        this.p(a, c);
        this.q(b);
        this.h = (c + 1);
    };
    SpreadsheetPaneManager_IndentHelper.prototype.s = function (a, b) {
        var c = new SpreadsheetCell(a.index, b);
        if (this.f == null || this.f.add_1(c)) {
            var d = a.worksheet;
            var e = SpreadsheetPaneManager._getCellRange2(c.row, c.column, d);
            if (e.isSingleCell == false) {
                if (SpreadsheetCell._l_op_Inequality_Lifted$i(SpreadsheetPaneManager._e2(e, d), Nullable$1.toNullable(SpreadsheetCell.$, c))) {
                    return;
                }
            }
            var f = a._bc(b);
            this.t(f, false);
        }
    };
    SpreadsheetPaneManager_IndentHelper.prototype.t = function (a, b) {
        var c = a.d;
        var d = c._cw;
        var e = nullableEquals(this.m, null);
        var f = c._ct;
        var g = b ? 8 : 0;
        if (d == 0) {
            switch (c._a4) {
                case 1:
                case 3:
                case 7: break;
                default:
                    f = 0;
                    e = true;
                    break;
            }
        }
        else if (d == 255) {
            switch (c._a8) {
                case 0:
                case 2:
                case 4: break;
                default:
                    f = 0;
                    a._bm(2, true, g);
                    break;
            }
        }
        else {
            c.rotation = 0;
            f = 0;
        }
        if (e) {
            a._au(d == 255 ? 0 : 1, true, g);
        }
        a._a8(f + this.i, true, g);
    };
    SpreadsheetPaneManager_IndentHelper.prototype.u = function (a, b, c) {
        this.s(a, c);
    };
    SpreadsheetPaneManager_IndentHelper.o = function (a, b) {
        var c = new SpreadsheetPaneManager_IndentHelper(a, b);
        c.n();
    };
    SpreadsheetPaneManager_IndentHelper.$t = markType(SpreadsheetPaneManager_IndentHelper, 'SpreadsheetPaneManager_IndentHelper');
    return SpreadsheetPaneManager_IndentHelper;
}(Base));
export { SpreadsheetPaneManager_IndentHelper };
/**
 * @hidden
 */
var SpreadsheetPaneManager_MergedCellOperationInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneManager_MergedCellOperationInfo, _super);
    function SpreadsheetPaneManager_MergedCellOperationInfo(a, b) {
        var _this = _super.call(this) || this;
        _this.e = new HashSet$1(WorksheetMergedCellsRegion.$, 0);
        _this.d = false;
        _this.a = null;
        _this.b = null;
        _this.c = false;
        var c = new HashSet$1(WorksheetMergedCellsRegion.$, 0);
        var d = false;
        var e = new Array(b.length);
        arrayCopyTo(b, e, 0);
        if (a._d9) {
            for (var f = e.length - 1; f >= 0; f--) {
                var g = e[f];
                var h = false;
                for (var i = f + 1; i < e.length; i++) {
                    if (g._contains1(e[i])) {
                        h = true;
                        break;
                    }
                }
                if (h) {
                    continue;
                }
                var j = SpreadsheetPaneManager._extendRangeForMergedCells1(a, g, c);
                if (SpreadsheetCellRange.l_op_Inequality(j, g)) {
                    e[f] = j;
                    d = true;
                }
            }
        }
        _this.d = d;
        _this.a = e;
        _this.c = SpreadsheetCellRange._j(boxArray$1(e));
        _this.e = c;
        _this.b = a;
        return _this;
    }
    SpreadsheetPaneManager_MergedCellOperationInfo.$t = markType(SpreadsheetPaneManager_MergedCellOperationInfo, 'SpreadsheetPaneManager_MergedCellOperationInfo');
    return SpreadsheetPaneManager_MergedCellOperationInfo;
}(Base));
export { SpreadsheetPaneManager_MergedCellOperationInfo };
/**
 * @hidden
 */
var InViewPaneInfo = /** @class */ (function (_super) {
    tslib_1.__extends(InViewPaneInfo, _super);
    function InViewPaneInfo(a) {
        var _this = _super.call(this) || this;
        _this.v = 1;
        _this.r = null;
        _this.h = null;
        _this.i = null;
        _this.aq = null;
        _this.l = null;
        _this.j = null;
        _this.m = false;
        _this.a = null;
        _this.p = null;
        _this.s = null;
        _this.b = SpreadsheetCellRange.empty;
        _this.k = null;
        _this.g = null;
        _this.q = null;
        _this.j = a;
        _this.l = a._bc;
        _this.a = new RotationHelper();
        _this.p = new Dictionary$2(String_$type, SpreadsheetCellValueInfo.$, 0);
        _this.s = new Dictionary$2(WorksheetMergedCellsRegion.$, SpreadsheetCellValueInfo.$, 0);
        _this.r = new HashSet$1(SpreadsheetCell.$, 0);
        _this.g = new SpreadsheetChartDataInfo(_this.l.workbook);
        _this.q = new Dictionary$2(WorksheetChart.$, InViewPaneInfo_ChartInfo.$, 0);
        _this.k = new SpreadsheetViewCache(a._bc);
        return _this;
    }
    InViewPaneInfo.prototype.w = function (a) {
        var _this = this;
        var e_236, _0;
        if (a.i) {
            var b_3 = a.d;
            var c_3;
            if (!((function () { var d = _this.q.tryGetValue(b_3, c_3); c_3 = d.p1; return d.ret; })())) {
                this.q.item(b_3, c_3 = new InViewPaneInfo_ChartInfo(a));
            }
            else {
                c_3.d(a);
            }
        }
        else if (a.j != null) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(a.j)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var d = _2.value;
                    this.w(d);
                }
            }
            catch (e_236_1) { e_236 = { error: e_236_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_236) throw e_236.error; }
            }
        }
    };
    InViewPaneInfo.x = function (a, b, c, d) {
        var e = Math.max(SpreadsheetUtilities.cm(b.item(c - 1, d).d), SpreadsheetUtilities.cm(b.item(c, d).d));
        var f = Math.max(SpreadsheetUtilities.cm(b.item(c, d - 1).e), SpreadsheetUtilities.cm(b.item(c, d).e));
        if (a) {
            if (e == 3) {
                b.item(c, d - 1).j = -1;
                b.item(c, d).i = 1;
            }
        }
        else {
            var g = e <= 1 ? -1 : -2;
            b.item(c, d).i = g;
            b.item(c, d - 1).j = -g;
        }
        b.item(c - 1, d).h = f == 1 ? 1 : 2;
        if (f == 3) {
            b.item(c, d).k = 1;
        }
    };
    InViewPaneInfo.y = function (a, b, c, d) {
        var e = Math.max(SpreadsheetUtilities.cm(b.item(c - 1, d).d), SpreadsheetUtilities.cm(b.item(c, d).d));
        var f = Math.max(SpreadsheetUtilities.cm(b.item(c, d - 1).e), SpreadsheetUtilities.cm(b.item(c, d).e));
        if (a) {
            if (f == 3) {
                b.item(c - 1, d).h = -1;
                b.item(c, d).k = 1;
            }
        }
        else {
            var g = f <= 1 ? -1 : -2;
            b.item(c, d).k = g;
            b.item(c - 1, d).h = -g;
        }
        b.item(c, d - 1).j = e == 1 ? 1 : 2;
        if (e == 3) {
            b.item(c, d).i = 1;
        }
    };
    InViewPaneInfo.prototype.z = function () {
        this.p.clear();
        this.s.clear();
    };
    InViewPaneInfo.prototype.aa = function (a) {
        var _this = this;
        var b = a.chart;
        var c;
        if (b != null && ((function () { var d = _this.q.tryGetValue(b, c); c = d.p1; return d.ret; })())) {
            c.e();
        }
    };
    InViewPaneInfo.prototype.ab = function (a) {
        var e_237, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a.charts())), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                this.aa(b);
            }
        }
        catch (e_237_1) { e_237 = { error: e_237_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_237) throw e_237.error; }
        }
    };
    InViewPaneInfo.prototype.ac = function () {
        this.h = null;
    };
    InViewPaneInfo.prototype.ad = function () {
        this.m = true;
    };
    InViewPaneInfo.prototype.c = function (a, b, c, d) {
        var _this = this;
        if (c === void 0) { c = true; }
        if (d === void 0) { d = true; }
        var e = null;
        var f = a.index + "-" + b;
        if (!((function () { var g = _this.p.tryGetValue(f, e); e = g.p1; return g.ret; })()) && c) {
            this.p.item(f, e = this.j._ai(a, b));
            e.af = this.v;
        }
        else if (e != null && (e.af < this.v || e.ao != e.h._c5(e.ab))) {
            e.af = this.v;
            if (e.e == 4 || e.e == 6) {
                if (e.x != e.h._ck(e.w, this.b.lastColumn, Nullable$1.toNullable(HorizontalCellAlignment_$type, e.e))) {
                    this.p.item(f, e = this.j._ai(a, b));
                    e.af = this.v;
                }
            }
        }
        if (e != null && d) {
            this.am(e);
        }
        return e;
    };
    InViewPaneInfo.prototype.d = function (a, b, c) {
        var d = c;
        do {
            var e = b._c1(d, !a);
            if (nullableEquals(e, null)) {
                return null;
            }
            d = e.value;
        } while (this.l._cb(d).i);
        if (a && d < this.b.firstColumn) {
            return null;
        }
        if (!a && d > this.b.lastColumn) {
            return null;
        }
        var f = this.c(b, d, false);
        if (f == null) {
            if (this.l._cr(b.index, d) != null) {
                return null;
            }
            var g = this.k.g(b, b.index, d);
            if (g._b8) {
                return null;
            }
            var h = g._a4;
            if (g._b7) {
                return null;
            }
            if (h == 0) {
                h = SpreadsheetUtilities.ap(b._getCellValue1(d), g, this.l, b, d);
            }
            switch (h) {
                case 5:
                case 7: return null;
                case 4:
                    if (!a) {
                        return null;
                    }
                    break;
                case 2:
                case 6: break;
                case 3:
                    if (a) {
                        return null;
                    }
                    break;
                case 1:
                    if (!a) {
                        return null;
                    }
                    break;
                default: break;
            }
            f = this.c(b, d, true);
        }
        if ((a && f.ad < c) || (!a && f.ae > c)) {
            return null;
        }
        return f;
    };
    InViewPaneInfo.prototype.e = function (a, b) {
        var _this = this;
        var c = this.l._cr(a, b);
        if (c != null) {
            var d_5;
            if (!((function () { var e = _this.s.tryGetValue(c, d_5); d_5 = e.p1; return e.ret; })())) {
                this.s.item(c, d_5 = this.j._ah(c));
            }
            else if (d_5.af != this.v) {
                d_5.af = this.v;
                if (d_5.ao != d_5.h._c5(d_5.w)) {
                    this.s.item(c, d_5 = this.j._ah(c));
                }
            }
            return d_5;
        }
        return null;
    };
    InViewPaneInfo.prototype.t = function (a, b) {
        var c = this.l._cn(a);
        var d;
        if (b <= 0) {
            d = c._m;
        }
        else if (b >= 100) {
            d = c._l;
        }
        else {
            d = truncate((c._m + c._i * b / 100));
        }
        return this.l._fl(d, 5, false);
    };
    InViewPaneInfo.prototype.u = function (a, b) {
        var c = this.l._cp(a);
        if (b <= 0) {
            return c._m;
        }
        else if (b >= 100) {
            return c._l;
        }
        else {
            return c._m + c._i * b / 100;
        }
    };
    InViewPaneInfo.prototype.ae = function () {
        var e_238, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.r)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var a = _2.value;
                this.l._rows$i.item(a.row)._getCellValue1(a.column);
            }
        }
        catch (e_238_1) { e_238 = { error: e_238_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_238) throw e_238.error; }
        }
        this.v++;
    };
    Object.defineProperty(InViewPaneInfo.prototype, "n", {
        get: function () {
            return this.q.count > 0;
        },
        enumerable: true,
        configurable: true
    });
    InViewPaneInfo.prototype.f = function (a, b) {
        var c = this.k.g(a.h, a.ak, a.ab);
        return this.j._aj(a, b, c);
    };
    InViewPaneInfo.prototype.af = function (a, b) {
        this.p.removeItem(a + "-" + b);
        this.k.o(a, b);
    };
    InViewPaneInfo.prototype.ag = function () {
        var e_239, _0, e_240, _1;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this.j._dl)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var a = _3.value;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(a._r)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var b = _5.value;
                        b.m = null;
                    }
                }
                catch (e_240_1) { e_240 = { error: e_240_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_240) throw e_240.error; }
                }
            }
        }
        catch (e_239_1) { e_239 = { error: e_239_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_239) throw e_239.error; }
        }
    };
    InViewPaneInfo.prototype.ah = function () {
        var e_241, _0, e_242, _1;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this.j._dl)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var a = _3.value;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(a._r)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var b = _5.value;
                        b.m = null;
                    }
                }
                catch (e_242_1) { e_242 = { error: e_242_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_242) throw e_242.error; }
                }
                a._r.clear();
            }
        }
        catch (e_241_1) { e_241 = { error: e_241_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_241) throw e_241.error; }
        }
    };
    InViewPaneInfo.prototype.ai = function (a, b, c, d, e, f, g, h, i) {
        var j = this.k.a(g, h, i);
        var k = j.d;
        var l = j.j;
        if (f >= 0) {
            var m = this.k.a(d, e, f);
            var n = m.e;
            if (SpreadsheetUtilities.bm(k, n)) {
                k = n;
                l = m.k;
            }
        }
        a.m(b, c, k, l);
    };
    InViewPaneInfo.prototype.aj = function (a, b, c, d, e, f, g, h, i) {
        var j = this.k.a(d, e, f);
        var k = j.f;
        var l = j.l;
        if (h >= 0) {
            var m = this.k.a(g, h, i);
            var n = m.b;
            if (SpreadsheetUtilities.bm(k, n)) {
                k = n;
                l = m.h;
            }
        }
        a.p(b, c, k, l);
    };
    InViewPaneInfo.prototype.ak = function () {
        try {
            this.ap();
        }
        finally {
            this.k.n(false);
        }
    };
    InViewPaneInfo.prototype.o = function () {
        var e_243, _0;
        var a = false;
        var b = this.g.e;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.q)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                if (c.value.b(b && this.g.f(c.key))) {
                    a = true;
                }
            }
        }
        catch (e_243_1) { e_243 = { error: e_243_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_243) throw e_243.error; }
        }
        this.g.j();
        return a;
    };
    InViewPaneInfo.prototype.ap = function () {
        var e_244, _0;
        this.ao();
        this.al();
        this.r.clear();
        var a = this.l.workbook;
        var b = a != null && a.windowOptions.objectDisplayStyle == 2;
        var c = !b && this.m;
        var d = this.j._al._l != null;
        this.m = false;
        this.b = this.j._aa();
        this.o();
        this.q.clear();
        var _loop_25 = function (e) {
            var e_245, _0, e_246, _1;
            var f = e._p;
            f.beginUpdate();
            f.clear();
            var g = e.columnScrollRegion._m;
            var h = e.rowScrollRegion._m;
            var i = h.count;
            var j = g.count;
            var k = j + 2;
            var l = i + 2;
            var m = e._k;
            if (m == null) {
                m = new MDList$1(SpreadsheetCellValueInfo.$, l, k);
            }
            else {
                m.j(l, k);
            }
            var n = e._l;
            if (n == null) {
                n = new MDList$1(WorksheetHyperlink.$, l, k);
            }
            else {
                n.j(l, k);
            }
            var o = e._h;
            if (o == null) {
                o = new MDBitArray(l, k);
            }
            else {
                o.i(l, k);
            }
            if (j > 0 && i > 0) {
                var p = null;
                var q = g._inner[0];
                var r = g._inner[j - 1];
                var s = void 0, t = void 0;
                if (q._m > 0) {
                    s = Nullable$1.toNullable(WorksheetItemPosition.$, this_13.j._be(q._m - 1));
                }
                else {
                    s = Nullable$1.toNullable(WorksheetItemPosition.$, null);
                }
                if (r._j < this_13.b.lastColumn) {
                    t = Nullable$1.toNullable(WorksheetItemPosition.$, this_13.j._be(r._l));
                }
                else {
                    t = Nullable$1.toNullable(WorksheetItemPosition.$, null);
                }
                var u = h._inner[0];
                var v = h._inner[i - 1];
                var w = void 0, x = void 0;
                if (u._m > 0) {
                    w = Nullable$1.toNullable(WorksheetItemPosition.$, this_13.l._cq(u._m - 1));
                }
                else {
                    w = Nullable$1.toNullable(WorksheetItemPosition.$, null);
                }
                if (v._j < this_13.b.lastRow) {
                    x = Nullable$1.toNullable(WorksheetItemPosition.$, this_13.l._cq(v._l));
                }
                else {
                    x = Nullable$1.toNullable(WorksheetItemPosition.$, null);
                }
                var y = new Array(k);
                if (WorksheetItemPosition._d(s, Nullable$1.toNullable(WorksheetItemPosition.$, null))) {
                    y[0] = s.value._j;
                }
                else {
                    y[0] = -1;
                }
                for (var z = 0; z < j; z++) {
                    y[z + 1] = g._inner[z]._j;
                }
                if (WorksheetItemPosition._d(t, Nullable$1.toNullable(WorksheetItemPosition.$, null))) {
                    y[j + 1] = t.value._j;
                }
                else {
                    y[j + 1] = -1;
                }
                var aa = new Array(l);
                if (WorksheetItemPosition._d(w, Nullable$1.toNullable(WorksheetItemPosition.$, null))) {
                    aa[0] = w.value._j;
                }
                else {
                    aa[0] = -1;
                }
                for (var ab = 0; ab < i; ab++) {
                    aa[ab + 1] = h._inner[ab]._j;
                }
                if (WorksheetItemPosition._d(x, Nullable$1.toNullable(WorksheetItemPosition.$, null))) {
                    aa[i + 1] = x.value._j;
                }
                else {
                    aa[i + 1] = -1;
                }
                var ac = this_13.l._hyperlinks$i;
                var ad = SpreadsheetUtilities.ay(new SpreadsheetCellRange(u._j, q._j, v._j, r._j));
                for (var ae = ac.count - 1; ae >= 0; ae--) {
                    var af = ac.item(ae);
                    var ag = af.sourceRegion._h;
                    if (ag._j(ad)) {
                        var ah = e.rowScrollRegion._cg(ag._ac, ag._ae);
                        if (ah >= 0) {
                            var ai = e.columnScrollRegion._cg(ag._w, ag._x);
                            if (ai >= 0) {
                                for (var aj = ah + 1; aj < l - 1; aj++) {
                                    if (aa[aj] > ag._ae) {
                                        break;
                                    }
                                    for (var ak = ai + 1; ak < k - 1; ak++) {
                                        if (y[ak] > ag._x) {
                                            break;
                                        }
                                        if (n.item(aj, ak) == null) {
                                            n.item(aj, ak, af);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                var al = this_13.l._fd;
                for (var am = 0, an = al.count; am < an; am++) {
                    var ao = al._inner[am];
                    if (ad._i(ao.rowIndex, ao._ab)) {
                        var ap = e.rowScrollRegion._cf(ao.rowIndex);
                        var aq = e.columnScrollRegion._cf(ao.columnIndex);
                        o.item(ap + 1, aq + 1, true);
                    }
                }
                for (var ar = 0; ar < l; ar++) {
                    var as = aa[ar];
                    if (as < 0) {
                        continue;
                    }
                    var at = this_13.l._rows$i._aj(as);
                    if (at == null && !this_13.l._d1) {
                        continue;
                    }
                    for (var au = 0; au < k; au++) {
                        var av = y[au];
                        if (av >= 0 && m.item(ar, au) == null) {
                            var aw = this_13.e(as, av);
                            if (aw != null) {
                                var ax = n.item(ar, au);
                                p = aw.h._a2(av);
                                if (p != null && p.m(av)) {
                                    this_13.r.add_1(new SpreadsheetCell(aw.ak, av));
                                    if (ax == null) {
                                        ax = aw.h._bi(av);
                                    }
                                }
                                this_13.an(aw, this_13.j._e5(ax));
                                var ay = au + 1;
                                while (ay < k && y[ay] <= aw.x && y[ay] >= 0) {
                                    ay++;
                                }
                                var az = ar + 1;
                                while (az < l && aa[az] <= aw.ag && aa[az] >= 0) {
                                    az++;
                                }
                                for (var a0 = ar; a0 < az; a0++) {
                                    for (var a1 = au; a1 < ay; a1++) {
                                        m.item(a0, a1, aw);
                                    }
                                }
                                if (ax != null) {
                                    for (var a2 = ar; a2 < az; a2++) {
                                        for (var a3 = au; a3 < ay; a3++) {
                                            if (n.item(a2, a3) == null) {
                                                n.item(a2, a3, ax);
                                            }
                                        }
                                    }
                                }
                                if (ay < k) {
                                    au = ay - 1;
                                }
                                else if (au == 0) {
                                    ar = az - 1;
                                    au = k;
                                }
                                else {
                                    au = k;
                                }
                            }
                            else if (at != null && ar > 0 && ar <= i) {
                                p = at._a2(av);
                                if (p != null && p.j(av)) {
                                    var a4 = null;
                                    if (p.m(av)) {
                                        this_13.r.add_1(new SpreadsheetCell(as, av));
                                        if (n.item(ar, au) == null) {
                                            a4 = at._bi(av);
                                        }
                                    }
                                    m.item(ar, au, aw = this_13.c(at, av, void 0, false));
                                    this_13.an(aw, this_13.j._e5(n.item(ar, au) || a4));
                                    if (a4 != null) {
                                        n.item(ar, au, a4);
                                    }
                                }
                            }
                        }
                    }
                }
                for (var a5 = 1; a5 <= i; a5++) {
                    var a6 = this_13.l._rows$i._aj(aa[a5]);
                    if (a6 != null) {
                        if (m.item(a5, 1) == null) {
                            m.item(a5, 0, this_13.d(true, a6, q._j));
                        }
                        if (m.item(a5, j) == null && WorksheetItemPosition._d(t, Nullable$1.toNullable(WorksheetItemPosition.$, null))) {
                            m.item(a5, j + 1, this_13.d(false, a6, r._j));
                        }
                    }
                }
                for (var a7 = 1; a7 <= i; a7++) {
                    for (var a8 = 0; a8 < k; a8++) {
                        var a9 = m.item(a7, a8);
                        if (a9 != null) {
                            if (a8 > 0 && m.item(a7, a8 - 1) == a9) {
                                continue;
                            }
                            if (a7 > 1 && m.item(a7 - 1, a8) == a9) {
                                continue;
                            }
                            f.add(a9);
                        }
                    }
                }
                for (var ba = 1; ba < l; ba++) {
                    for (var bb = 0; bb < k; bb++) {
                        var bc = m.item(ba, bb);
                        if (bc != null) {
                            if (bb == 0) {
                                var bd = !nullableIsNull(bc.al) ? bc.al.value : bc.ad;
                                for (var be = 1; be <= j; be++) {
                                    if (g._inner[be - 1]._j > bd || m.item(ba, be) != null) {
                                        break;
                                    }
                                    m.item(ba, be, bc);
                                }
                            }
                            else if (bb == j + 1) {
                                var bf = !nullableIsNull(bc.am) ? bc.am.value : bc.ae;
                                for (var bg = bb - 1; bg > 0; bg--) {
                                    if (g._inner[bg - 1]._j < bf || m.item(ba, bg) != null) {
                                        break;
                                    }
                                    m.item(ba, bg, bc);
                                }
                            }
                            else if (bc.ap != null) {
                                var bh = !nullableIsNull(bc.am) ? bc.am.value : bc.ae;
                                for (var bi = bb - 1; bi > 0; bi--) {
                                    if (g._inner[bi - 1]._j < bh || m.item(ba, bi) != null) {
                                        break;
                                    }
                                    m.item(ba, bi, bc);
                                }
                                var bj = !nullableIsNull(bc.al) ? bc.al.value : bc.ad;
                                for (var bk = bb + 1; bk <= j; bk++) {
                                    if (g._inner[bk - 1]._j > bj || m.item(ba, bk) != null) {
                                        break;
                                    }
                                    m.item(ba, bk, bc);
                                }
                            }
                        }
                    }
                }
                var bl = e._w;
                if (bl == null) {
                    bl = new SpreadsheetCellRenderInfoArray(l, k);
                }
                else {
                    bl.h(l, k);
                }
                e._w = bl;
                var bm = null;
                for (var bn = 0; bn < l; bn++) {
                    var bo = aa[bn];
                    var bp = bo >= 0 ? this_13.l._rows$i._aj(bo) : null;
                    for (var bq = 0; bq < k; bq++) {
                        var br = false;
                        var bs = m.item(bn, bq);
                        var bt = bs != null && bs.r;
                        var bu = y[bq];
                        var bv = null;
                        if (bo >= 0) {
                            if (bt) {
                                var bw = m.item(bn, bq);
                                if (bn > 0 && bw == m.item(bn - 1, bq)) {
                                    bl.g(bn - 1, bq, bn, bq);
                                    br = true;
                                }
                                else if (bq > 0 && bw == m.item(bn, bq - 1)) {
                                    bl.g(bn, bq - 1, bn, bq);
                                    br = true;
                                }
                                else {
                                    var bx = bw.ak;
                                    var by = bw.w;
                                    var bz = bx == bo ? bp : this_13.l._rows$i._aj(bx);
                                    bv = this_13.k.a(bz, bx, by);
                                }
                            }
                            if (!br && bu >= 0) {
                                if (bv == null) {
                                    bv = this_13.k.a(bp, bo, bu);
                                }
                                var b0 = this_13.k.c(bo, bu);
                                if (b0 != null) {
                                    bl.k(bn, bq, b0.dataBarInfo);
                                }
                                bl.i(bn, bq, bv.g);
                                var b1 = bv.a;
                                if (b1 != 0) {
                                    bl.l(bn, bq, b1, bv.c, bv.i);
                                }
                            }
                            if (bq > 0) {
                                if (bu < 0) {
                                    var b2 = this_13.k.a(bp, bo, y[bq - 1]);
                                    bl.m(bn, bq, b2.e, b2.k);
                                }
                                else if (bt == false || bu == bs.ab) {
                                    if (bs == null || bs != m.item(bn, bq - 1)) {
                                        this_13.ai(bl, bn, bq, bp, bo, y[bq - 1], bp, bo, bu);
                                    }
                                }
                            }
                            if (bn > 0) {
                                if (bt == false || bo == bs.ak) {
                                    if (y[bq] >= 0) {
                                        this_13.aj(bl, bn, bq, bp, bo, y[bq], bm, aa[bn - 1], y[bq]);
                                    }
                                }
                            }
                        }
                        else if (bn > 0 && bu >= 0) {
                            var b3 = this_13.k.a(bm, aa[bn - 1], bu);
                            bl.p(bn, bq, b3.b, b3.h);
                        }
                    }
                    bm = bp;
                }
                for (var b4 = 1; b4 < l; b4++) {
                    if (aa[b4] == 0) {
                        continue;
                    }
                    for (var b5 = 1; b5 < k; b5++) {
                        if (y[b5] == 0) {
                            continue;
                        }
                        var b6 = void 0, b7 = void 0;
                        var b8 = bl.item(b4, b5).d;
                        var b9 = bl.item(b4 - 1, b5).d;
                        var ca = bl.item(b4, b5 - 1).e;
                        var cb = bl.item(b4, b5).e;
                        if (b8 == b9 && ca == cb && b9 == ca) {
                            if (b8 == 0) {
                                continue;
                            }
                            else {
                                b7 = b6 = true;
                            }
                        }
                        else {
                            var cc = 0;
                            if (b8 == 6) {
                                cc++;
                            }
                            if (ca == 6) {
                                cc++;
                            }
                            if (cb == 6) {
                                cc++;
                            }
                            if (b9 == 6) {
                                cc++;
                            }
                            if (cc > 1) {
                                if (ca == 6) {
                                    b7 = b6 = true;
                                }
                                else if (b9 == 6) {
                                    b7 = true;
                                    b6 = false;
                                }
                                else if (b8 == 6) {
                                    b7 = b6 = false;
                                }
                                else {
                                    b7 = false;
                                    b6 = true;
                                }
                            }
                            else if (cc == 1) {
                                if (b8 == 6 || b9 == 6) {
                                    if (ca == 0 && cb == 0) {
                                        b6 = false;
                                        b7 = b8 == 0 || b9 != 0;
                                    }
                                    else {
                                        var cd = SpreadsheetUtilities.cn(ca);
                                        var ce = SpreadsheetUtilities.cn(cb);
                                        b6 = true;
                                        b7 = cd >= ce;
                                    }
                                }
                                else {
                                    if (b8 == 0 && b9 == 0) {
                                        b6 = true;
                                        b7 = cb == 0 || ca != 0;
                                    }
                                    else {
                                        var cf = SpreadsheetUtilities.cn(b9);
                                        var cg = SpreadsheetUtilities.cn(b8);
                                        b6 = false;
                                        b7 = cf >= cg;
                                    }
                                }
                            }
                            else {
                                var ch = SpreadsheetUtilities.cn(ca);
                                var ci = SpreadsheetUtilities.cn(cb);
                                var cj = SpreadsheetUtilities.cn(b9);
                                var ck = SpreadsheetUtilities.cn(b8);
                                var cl = ch >= ci;
                                var cm = cj >= ck;
                                b6 = (cl ? ch : ci) >= (cm ? cj : ck);
                                b7 = b6 ? cl : cm;
                            }
                        }
                        if (b6) {
                            InViewPaneInfo.x(b7, bl, b4, b5);
                        }
                        else {
                            InViewPaneInfo.y(b7, bl, b4, b5);
                        }
                    }
                }
                var cn = e._r;
                var co_1 = new Dictionary$2(WorksheetShape.$, SpreadsheetShape.$, 0);
                cn.beginUpdate();
                try {
                    for (var _2 = tslib_1.__values(fromEnum(cn)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var cp = _3.value;
                        co_1.item(cp.d, cp);
                        if (c) {
                            cp.p();
                        }
                    }
                }
                catch (e_245_1) { e_245 = { error: e_245_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_245) throw e_245.error; }
                }
                cn.clear();
                if (b == false && this_13.l._shapes$i.count > 0) {
                    var cq = 30;
                    var cr = h._inner[0]._m - cq;
                    var cs = v._l + cq;
                    var ct = this_13.l._fl(g._inner[0]._m, 5, false) - cq;
                    var cu = this_13.l._fl(r._l, 5, false) + cq;
                    var _loop_26 = function (cv) {
                        if (!cv.visible) {
                            return "continue";
                        }
                        if (!SpreadsheetUtilities.a4(cv, d)) {
                            return "continue";
                        }
                        if (nullableEquals(SpreadsheetPaneManager._e3(cv._ah.m, cv._ad.m, this_13.l), null)) {
                            return "continue";
                        }
                        if (nullableEquals(SpreadsheetPaneManager._e4(cv._ah.o, cv._ad.o, this_13.l), null)) {
                            return "continue";
                        }
                        var cw = SpreadsheetUtilities.b9(cv);
                        var cx = this_13.t(cv._ah.m, cv._topLeftCornerPosition$i.x) - cw;
                        var cy = this_13.t(cv._ad.m, cv._bottomRightCornerPosition$i.x) + cw;
                        var cz = this_13.u(cv._ah.o, cv._topLeftCornerPosition$i.y) - cw;
                        var c0 = this_13.u(cv._ad.o, cv._bottomRightCornerPosition$i.y) + cw;
                        if (cv._b6 % 90 != 0) {
                            var c1 = ExcelUtils.bd(cv._b6);
                            this_13.a.g(cx, cz, cy, c0, cv._b6, c1);
                            if (this_13.a.b(ct, cr, cu, cs)) {
                                return "continue";
                            }
                        }
                        else {
                            if (cy < ct || cx > cu) {
                                return "continue";
                            }
                            if (c0 < cr || cz > cs) {
                                return "continue";
                            }
                        }
                        var c2;
                        if (!((function () { var c3 = co_1.tryGetValue(cv, c2); c2 = c3.p1; return c3.ret; })())) {
                            c2 = new SpreadsheetShape(cv, null);
                        }
                        else {
                            co_1.removeItem(cv);
                        }
                        c2.r(d);
                        this_13.w(c2);
                        cn.add(c2);
                    };
                    try {
                        for (var _4 = tslib_1.__values(fromEnum(this_13.l._shapes$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                            var cv = _5.value;
                            _loop_26(cv);
                        }
                    }
                    catch (e_246_1) { e_246 = { error: e_246_1 }; }
                    finally {
                        try {
                            if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                        }
                        finally { if (e_246) throw e_246.error; }
                    }
                }
                cn.endUpdate();
            }
            else {
                var c3 = e._r;
                c3.clear();
            }
            e._k = m;
            e._l = n;
            e._h = o;
            f.endUpdate();
            e._aa = this_13.h;
            e._ac = this_13.i;
        };
        var this_13 = this;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.j._dl)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var e = _2.value;
                _loop_25(e);
            }
        }
        catch (e_244_1) { e_244 = { error: e_244_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_244) throw e_244.error; }
        }
    };
    InViewPaneInfo.prototype.al = function () {
        var a = this.l._je;
        var b = CoreUtilities.p(this.aq);
        if (b != a) {
            this.aq = a == null ? null : new WeakReference(a);
            this.i = new SpreadsheetImageBackground(a, this.l._dh);
        }
    };
    InViewPaneInfo.prototype.am = function (a) {
        if (a != null && a.ao != null && a.c == null) {
            var b = this.l._ck(a.h, a.ak, a.ab);
            this.f(a, this.j._e5(b));
        }
    };
    InViewPaneInfo.prototype.an = function (a, b) {
        if (a != null && a.ao != null && a.c == null) {
            this.f(a, b);
        }
    };
    InViewPaneInfo.prototype.ao = function () {
        var a = this.l.displayOptions;
        if (!a.showGridlines) {
            this.h = null;
        }
        else if (this.h == null) {
            var b = a._a2 ? Nullable$1.toNullable(Color.$, null) : Nullable$1.toNullable(Color.$, a._gridlineColor$i);
            this.h = new SpreadsheetGridLinePen(b);
        }
    };
    InViewPaneInfo.$t = markType(InViewPaneInfo, 'InViewPaneInfo');
    return InViewPaneInfo;
}(Base));
export { InViewPaneInfo };
/**
 * @hidden
 */
var InViewPaneInfo_ChartInfo = /** @class */ (function (_super) {
    tslib_1.__extends(InViewPaneInfo_ChartInfo, _super);
    function InViewPaneInfo_ChartInfo(a) {
        var _this = _super.call(this) || this;
        _this.c = null;
        _this.a = false;
        _this.c = a;
        return _this;
    }
    InViewPaneInfo_ChartInfo.prototype.d = function (a) {
        var b = typeCast(List$1.$.specialize(SpreadsheetShape.$), this.c);
        if (b == null) {
            b = new List$1(SpreadsheetShape.$, 0);
            b.add(this.c);
            this.c = b;
        }
        b.add(a);
    };
    InViewPaneInfo_ChartInfo.prototype.e = function () {
        this.a = true;
    };
    InViewPaneInfo_ChartInfo.f = function (a, b, c) {
        if (c) {
            a.h = true;
        }
        if (b) {
            a.g = true;
        }
        if (b || c) {
            var d = a;
            while (d != null) {
                d.n++;
                d = d.b;
            }
        }
    };
    InViewPaneInfo_ChartInfo.prototype.b = function (a) {
        if (this.a || a) {
            var b = typeCast(SpreadsheetShape.$, this.c);
            if (b != null) {
                InViewPaneInfo_ChartInfo.f(b, a, this.a);
            }
            else {
                var c = typeCast(List$1.$.specialize(SpreadsheetShape.$), this.c);
                for (var d = 0; d < c.count; d++) {
                    b = c._inner[d];
                    InViewPaneInfo_ChartInfo.f(b, a, this.a);
                }
            }
        }
        return this.a || a;
    };
    InViewPaneInfo_ChartInfo.$t = markType(InViewPaneInfo_ChartInfo, 'InViewPaneInfo_ChartInfo');
    return InViewPaneInfo_ChartInfo;
}(Base));
export { InViewPaneInfo_ChartInfo };
/**
 * @hidden
 */
var SpreadsheetViewCache = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetViewCache, _super);
    function SpreadsheetViewCache(a) {
        var _this = _super.call(this) || this;
        _this.h = null;
        _this.k = null;
        _this.i = null;
        _this.f = null;
        _this.j = null;
        _this.l = 0;
        _this.m = 0;
        _this.d = null;
        _this.f = a;
        _this.h = new Dictionary$2(String_$type, SpreadsheetResolvedRenderFormat.$, 0);
        _this.i = new Dictionary$2(WorksheetCellFormatData.$, SpreadsheetResolvedRenderFormat.$, 2, WorksheetCellFormatDataEqualityComparer._a);
        _this.k = new Dictionary$2(String_$type, CellConditionalFormat.$, 0);
        _this.j = new Dictionary$2(String_$type, WorksheetCellFormatData.$, 0);
        _this.d = new RegionLookupTable$1(WorksheetRegionAddress.$, a);
        _this.m = -1;
        return _this;
    }
    SpreadsheetViewCache.prototype.n = function (a) {
        this.h.clear();
        this.i.clear();
        this.j.clear();
        if (a) {
            this.k.clear();
            this.d.aa();
            this.l++;
        }
    };
    SpreadsheetViewCache.e = function (a, b, c) {
        var d = null;
        if (b != null) {
            switch (a) {
                case 8:
                    d = b.diagonalBorderColorInfo;
                    break;
                case 134217728:
                    d = b.topBorderColorInfo;
                    break;
                case 524288:
                    d = b.leftBorderColorInfo;
                    break;
                case 4:
                    d = b.bottomBorderColorInfo;
                    break;
                case 4194304:
                    d = b.rightBorderColorInfo;
                    break;
            }
        }
        if (WorkbookColorInfo.l_op_Equality(d, null)) {
            d = c._da(a, null);
        }
        return d;
    };
    SpreadsheetViewCache.b = function (a, b, c) {
        var d = -1;
        if (b != null) {
            switch (a) {
                case 32:
                    d = b.diagonalBorderStyle;
                    break;
                case 134217728:
                    d = b.topBorderStyle;
                    break;
                case 524288:
                    d = b.leftBorderStyle;
                    break;
                case 4:
                    d = b.bottomBorderStyle;
                    break;
                case 4194304:
                    d = b.rightBorderStyle;
                    break;
            }
        }
        if (d == -1) {
            d = EnumUtil.getEnumValue(CellBorderLineStyle_$type, c._da(a, null));
        }
        return d;
    };
    SpreadsheetViewCache.prototype.g = function (a, b, c) {
        var _this = this;
        var d;
        var e = b + "-" + c;
        if (!((function () { var f = _this.j.tryGetValue(e, d); d = f.p1; return f.ret; })())) {
            d = this.f._b4(a, c);
            var f = this.f._b5(d, b, c);
            if (f != null) {
                this.j.item(e, d = f);
            }
        }
        return d;
    };
    SpreadsheetViewCache.prototype.c = function (a, b) {
        var _this = this;
        var c = null;
        if (this.f._conditionalFormats$i.count > 0) {
            this.p();
            if (this.d.n(a, b)) {
                var d_6 = a + "-" + b;
                if (!((function () { var e = _this.k.tryGetValue(d_6, c); c = e.p1; return e.ret; })())) {
                    this.k.item(d_6, c = this.f._getCellConditionalFormat1(a, b));
                }
                if (c != null && c == CellConditionalFormat._a) {
                    c = null;
                }
            }
        }
        return c;
    };
    SpreadsheetViewCache.prototype.a = function (a, b, c) {
        var _this = this;
        var d = b + "-" + c;
        var e = null;
        if (((function () { var f = _this.h.tryGetValue(d, e); e = f.p1; return f.ret; })())) {
            return e;
        }
        var f = this.c(b, c);
        var g = this.g(a, b, c);
        if (f == null) {
            if (((function () { var h = _this.i.tryGetValue(g, e); e = h.p1; return h.ret; })())) {
                this.h.item(d, e);
                return e;
            }
        }
        e = new SpreadsheetResolvedRenderFormat();
        var h = null;
        if (f != null && f.cellFormat != null) {
            h = f.cellFormat;
        }
        e.g = h == null || h.fill == null ? g._ar : h.fill;
        if (SpreadsheetUtilities.bc(e.g)) {
            e.g = null;
        }
        else {
            e.g = e.g._c(this.f.workbook);
        }
        e.a = SpreadsheetUtilities.m(h == null || h.diagonalBorderStyle == -1 ? EnumUtil.getEnumValue(DiagonalBorders_$type, g._da(16, null)) : h.diagonalBorders);
        if (e.a != 0) {
            e.c = SpreadsheetViewCache.b(32, h, g);
            e.i = SpreadsheetViewCache.e(8, h, g)._getResolvedColor1(this.f.workbook);
        }
        else {
            e.i = ExcelUtils.gv;
        }
        e.d = SpreadsheetViewCache.b(524288, h, g);
        e.j = e.d == 0 ? ExcelUtils.gv : SpreadsheetViewCache.e(262144, h, g)._getResolvedColor1(this.f.workbook);
        e.f = SpreadsheetViewCache.b(134217728, h, g);
        e.l = e.f == 0 ? ExcelUtils.gv : SpreadsheetViewCache.e(67108864, h, g)._getResolvedColor1(this.f.workbook);
        e.e = SpreadsheetViewCache.b(4194304, h, g);
        e.k = e.e == 0 ? ExcelUtils.gv : SpreadsheetViewCache.e(2097152, h, g)._getResolvedColor1(this.f.workbook);
        e.b = SpreadsheetViewCache.b(4, h, g);
        e.h = e.b == 0 ? ExcelUtils.gv : SpreadsheetViewCache.e(2, h, g)._getResolvedColor1(this.f.workbook);
        if (h == null) {
            this.i.item(g, e);
        }
        this.h.item(d, e);
        return e;
    };
    SpreadsheetViewCache.prototype.o = function (a, b) {
        if (this.k.count > 0) {
            this.k.removeItem(a + "-" + b);
        }
    };
    SpreadsheetViewCache.prototype.p = function () {
        var e_247, _0;
        if (this.m != this.l) {
            this.m = this.l;
            this.d.aa();
            try {
                for (var _1 = tslib_1.__values(fromEnum(this.f._conditionalFormats$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var a = _2.value;
                    for (var b = 0; b < a.regions.count; b++) {
                        var c = a.regions.item(b);
                        this.d.x(c, c._h);
                    }
                }
            }
            catch (e_247_1) { e_247 = { error: e_247_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_247) throw e_247.error; }
            }
        }
    };
    SpreadsheetViewCache.$t = markType(SpreadsheetViewCache, 'SpreadsheetViewCache');
    return SpreadsheetViewCache;
}(Base));
export { SpreadsheetViewCache };
/**
 * Represents one or more [[SpreadsheetPane]] instances in a vertical column
 */
var SpreadsheetColumnScrollRegion = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetColumnScrollRegion, _super);
    function SpreadsheetColumnScrollRegion() {
        return _super.call(this) || this;
    }
    /**
     * @hidden
     */
    SpreadsheetColumnScrollRegion.prototype._a0 = function () {
        return this._ab != null ? this._ab._bi : null;
    };
    /**
     * @hidden
     */
    SpreadsheetColumnScrollRegion.prototype._a2 = function () {
        return this._ab != null ? this._ab._bf : null;
    };
    /**
     * @hidden
     */
    SpreadsheetColumnScrollRegion.prototype.get__aw = function () {
        return false;
    };
    Object.defineProperty(SpreadsheetColumnScrollRegion.prototype, "_aw", {
        /**
         * @hidden
         */
        get: function () {
            return this.get__aw();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetColumnScrollRegion.$t = markType(SpreadsheetColumnScrollRegion, 'SpreadsheetColumnScrollRegion', SpreadsheetScrollRegion.$);
    return SpreadsheetColumnScrollRegion;
}(SpreadsheetScrollRegion));
export { SpreadsheetColumnScrollRegion };
/**
 * Returns one or more [[SpreadsheetPane]] instances in a horizontal row.
 */
var SpreadsheetRowScrollRegion = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetRowScrollRegion, _super);
    function SpreadsheetRowScrollRegion() {
        return _super.call(this) || this;
    }
    /**
     * @hidden
     */
    SpreadsheetRowScrollRegion.prototype._a0 = function () {
        return this._ab != null ? this._ab._bj : null;
    };
    /**
     * @hidden
     */
    SpreadsheetRowScrollRegion.prototype._a2 = function () {
        return this._ab != null ? this._ab._bg : null;
    };
    /**
     * @hidden
     */
    SpreadsheetRowScrollRegion.prototype.get__aw = function () {
        return true;
    };
    Object.defineProperty(SpreadsheetRowScrollRegion.prototype, "_aw", {
        /**
         * @hidden
         */
        get: function () {
            return this.get__aw();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetRowScrollRegion.$t = markType(SpreadsheetRowScrollRegion, 'SpreadsheetRowScrollRegion', SpreadsheetScrollRegion.$);
    return SpreadsheetRowScrollRegion;
}(SpreadsheetScrollRegion));
export { SpreadsheetRowScrollRegion };
/**
 * @hidden
 */
var SpreadsheetScrollInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetScrollInfo, _super);
    function SpreadsheetScrollInfo(a) {
        var _this = _super.call(this) || this;
        _this._a1 = null;
        _this._a4 = null;
        _this._a5 = null;
        _this._a6 = 0;
        CoreUtilities.z(a, "owner");
        _this._a1 = a;
        return _this;
    }
    SpreadsheetScrollInfo.prototype._ao = function (a, b) {
        if (this._a4 != null && this._a4(this._a1, a, b)) {
            return;
        }
        _super.prototype._ao.call(this, a, b);
    };
    SpreadsheetScrollInfo.prototype._az = function (a) {
        this._au(a);
    };
    SpreadsheetScrollInfo.prototype._au = function (a) {
        if (this._a5 != null) {
            return this._a5(this._a1, a);
        }
        return a;
    };
    Object.defineProperty(SpreadsheetScrollInfo.prototype, "_a2", {
        get: function () {
            return this._a1;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetScrollInfo.prototype, "_a3", {
        get: function () {
            return this._a6 > 0;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetScrollInfo.prototype._a7 = function () {
        this._a6++;
    };
    SpreadsheetScrollInfo.prototype._a8 = function () {
        this._a6--;
        if (this._a6 == 0) {
            this._ac = this._au(this._ac);
        }
    };
    SpreadsheetScrollInfo.$t = markType(SpreadsheetScrollInfo, 'SpreadsheetScrollInfo', ExtendedRangeScrollInfo.$);
    return SpreadsheetScrollInfo;
}(ExtendedRangeScrollInfo));
export { SpreadsheetScrollInfo };
/**
 * @hidden
 */
var SpreadsheetOwnerState = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetOwnerState, _super);
    function SpreadsheetOwnerState() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this._q = false;
        _this._n = null;
        _this._u = null;
        _this._v = null;
        _this._i = null;
        _this._r = false;
        _this._m = null;
        _this._g = null;
        _this._k = null;
        return _this;
    }
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_l", {
        get: function () {
            return this._k;
        },
        set: function (a) {
            if (this._k != a) {
                this._k = a;
                this.a("ChartAdapter");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_w", {
        get: function () {
            return this._u;
        },
        set: function (a) {
            if (this._u != a) {
                this._u = a;
                this.a("GetCellText");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_s", {
        get: function () {
            return this._q;
        },
        set: function (a) {
            if (this._q != a) {
                this._q = a;
                this.a("IsInEditMode");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_o", {
        get: function () {
            return this._m;
        },
        set: function (a) {
            if (this._m != a) {
                this._m = a;
                this.a("AfterPaneManagerLayout");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_x", {
        get: function () {
            return this._v;
        },
        set: function (a) {
            if (this._v != a) {
                this._v = a;
                this.a("PasswordNeededAction");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_j", {
        get: function () {
            return this._i;
        },
        set: function (a) {
            if (this._i != a) {
                this._i = a;
                this.a("RenderCache");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_h", {
        get: function () {
            return this._g;
        },
        set: function (a) {
            if (this._g != a) {
                this._g = a;
                this.a("Spreadsheet");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_t", {
        get: function () {
            return this._r;
        },
        set: function (a) {
            if (this._r != a) {
                this._r = a;
                this.a("UsesLogicalPixels");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetOwnerState.prototype, "_p", {
        get: function () {
            return this._n;
        },
        set: function (a) {
            if (this._n != a) {
                this._n = a;
                this.a("VisitHyperlinkAction");
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetOwnerState.$t = markType(SpreadsheetOwnerState, 'SpreadsheetOwnerState', PropertyChangeNotifierExtended.$);
    return SpreadsheetOwnerState;
}(PropertyChangeNotifierExtended));
export { SpreadsheetOwnerState };
/**
 * @hidden
 */
var SpreadsheetRenderCache_DisposableCache = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetRenderCache_DisposableCache, _super);
    function SpreadsheetRenderCache_DisposableCache(a) {
        var _this = _super.call(this) || this;
        _this._a = null;
        _this._a = a;
        return _this;
    }
    SpreadsheetRenderCache_DisposableCache.prototype.dispose = function () {
        this._a.aq();
    };
    SpreadsheetRenderCache_DisposableCache.$t = markType(SpreadsheetRenderCache_DisposableCache, 'SpreadsheetRenderCache_DisposableCache', Base.$, [IDisposable_$type]);
    return SpreadsheetRenderCache_DisposableCache;
}(Base));
export { SpreadsheetRenderCache_DisposableCache };
/**
 * @hidden
 */
var ExcelWorkbookSerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(ExcelWorkbookSerializationProvider, _super);
    function ExcelWorkbookSerializationProvider(a) {
        var _rest = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            _rest[_0 - 1] = arguments[_0];
        }
        var _this = this;
        a = (a == void 0) ? 0 : a;
        switch (a) {
            case 0:
                {
                    var c = [];
                    for (var b = 0; b < _rest.length; b++) {
                        c[b - 0] = _rest[b];
                    }
                    _this = _super.apply(this, tslib_1.__spread([0], c)) || this;
                }
                break;
            case 1:
                {
                    var d = _rest[0];
                    var e = _rest[1];
                    _this = _super.call(this, 1, d, e) || this;
                }
                break;
        }
        return _this;
    }
    ExcelWorkbookSerializationProvider.q = function (a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q) {
        var r = f;
        if (r) {
            var s = k._de(n, q);
            if (s != null && !c.contains(s)) {
                r = false;
            }
        }
        var t = k._b4(o, q);
        if (r) {
            t = k._b5(t, n, q) || t;
        }
        if (!g) {
            var u = m.worksheet._b4(m, p);
            var v = l;
            if (d) {
                v |= 32640;
            }
            if (!WorksheetCellFormatProxy._y(u, t, v)) {
                if (!e || u.style.name == t.style.name) {
                    return;
                }
            }
        }
        var w = m._bc(p);
        ExcelWorkbookSerializationProvider.v(a, b, d, e, g, h, i, j, l, t, w, true);
    };
    ExcelWorkbookSerializationProvider.prototype.s = function (a, b, c, d, e, f, g) {
        var e_248, _0;
        var h = FormulaParser.bx(e._y).toString();
        if (f && e._conditionalFormats$i.count > 0) {
            SpreadsheetUtilities.eb(e, a);
        }
        if (d._conditionalFormats$i.count > 0) {
            var i = new WorksheetReferenceCollection(e);
            var j = c.l;
            var k = c.k;
            var l = c.b;
            var m = 0;
            try {
                for (var _1 = tslib_1.__values(fromEnum(d._conditionalFormats$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var n = _2.value;
                    if (!n._ab(l)) {
                        continue;
                    }
                    i.clear();
                    var o = n.regions;
                    for (var p = 0; p < l.length; p++) {
                        var q = l[p];
                        var r = c.j(p);
                        var s = c.i(p);
                        for (var t = 0; t < o.count; t++) {
                            if (o.item(t)._t(q._ac, q._w, q._ae, q._x)) {
                                var u = o.item(t)._h;
                                var v = new WorksheetRegionAddress(1, Math.max(q._ac, u._ac), Math.min(q._ae, u._ae), Math.max(q._w, u._w), Math.min(q._x, u._x));
                                var w = v._w - q._w + s;
                                var x = v._ac - q._ac + r;
                                var y = v._af;
                                var z = v._ad;
                                var aa = j;
                                var ab = k;
                                for (var ad = 0; ad < a.length; ad++) {
                                    var ac = a[ad];
                                    var ae = ac._af;
                                    var af = ac._ad;
                                    for (var ag = 0, ah = intDivide(ae, aa); ag < ah; ag++) {
                                        for (var ai = 0, aj = intDivide(af, ab); ai < aj; ai++) {
                                            var ak = ac._ac + ai * ab + x;
                                            var al = ac._w + ag * aa + w;
                                            var am = new WorksheetRegion(e, ak, al, ak + z - 1, al + y - 1);
                                            i._add(am);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    var an = n._g(i, b);
                    an._a9(g);
                    e._conditionalFormats$i._ax(m, an);
                    m++;
                }
            }
            catch (e_248_1) { e_248 = { error: e_248_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_248) throw e_248.error; }
            }
        }
    };
    ExcelWorkbookSerializationProvider.prototype.r = function (a, b, c, d) {
        var e_249, _0, e_250, _1, e_251, _2;
        if (d._eu.count > 0) {
            var e = new List$1(WorksheetCellComment.$, 0);
            try {
                for (var _3 = tslib_1.__values(fromEnum(d._eu)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var f = _4.value;
                    for (var g = 0; g < a.length; g++) {
                        if (a[g]._g(f.key)) {
                            e.add(f.value);
                            break;
                        }
                    }
                }
            }
            catch (e_249_1) { e_249 = { error: e_249_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_249) throw e_249.error; }
            }
            try {
                for (var _5 = tslib_1.__values(fromEnum(e)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                    var h = _6.value;
                    h.cell.comment = null;
                }
            }
            catch (e_250_1) { e_250 = { error: e_250_1 }; }
            finally {
                try {
                    if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                }
                finally { if (e_250) throw e_250.error; }
            }
        }
        if (c._eu.count > 0) {
            var i = d.workbook;
            var j = new List$1(WorksheetCellComment.$, 0);
            var k = b.l;
            var l = b.k;
            var m = b.b;
            try {
                for (var _7 = tslib_1.__values(fromEnum(c._eu)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                    var n = _8.value;
                    for (var o = 0; o < m.length; o++) {
                        var p = m[o];
                        if (p._g(n.key)) {
                            var q = b.j(o);
                            var r = b.i(o);
                            var s = n.value;
                            var t = n.key.o - p._ac + q;
                            var u = n.key.m - p._w + r;
                            var v = k;
                            var w = l;
                            for (var y = 0; y < a.length; y++) {
                                var x = a[y];
                                var z = x._af;
                                var aa = x._ad;
                                for (var ab = 0, ac = intDivide(z, v); ab < ac; ab++) {
                                    for (var ad = 0, ae = intDivide(aa, w); ad < ae; ad++) {
                                        var af = x._ac + ad * w + t;
                                        var ag = x._w + ab * v + u;
                                        var ah = new WorksheetCellComment();
                                        ah.author = s.author;
                                        ah.visible = s.visible;
                                        ah._ec = s._ec;
                                        if (s.text != null) {
                                            ah.text = new FormattedString(i, typeCast(StringElement.$, s.text._m.g(i)));
                                        }
                                        d._rows$i.item(af).setCellComment(ag, ah);
                                    }
                                }
                            }
                        }
                    }
                }
            }
            catch (e_251_1) { e_251 = { error: e_251_1 }; }
            finally {
                try {
                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                }
                finally { if (e_251) throw e_251.error; }
            }
        }
    };
    ExcelWorkbookSerializationProvider.t = function (a, b, c, d, e, f) {
        var g = b._bp;
        var h = g.d._am;
        if (h && (!d || !e)) {
            c.formatOptions &= ~4;
        }
        else {
            var i = void 0;
            var j = a.tryGetValue(g.d, i);
            i = j.p1;
            var k = i != null;
            if (i == null) {
                if (d && h) {
                    if (ExcelWorkbookSerializationProvider.k == null) {
                        i = ExcelWorkbookSerializationProvider.k = new ResolvedWorksheetCellFormatDataFont(b);
                    }
                    else {
                        ExcelWorkbookSerializationProvider.k._b(b);
                        i = ExcelWorkbookSerializationProvider.k;
                    }
                }
                else {
                    i = g;
                }
            }
            c._a1(i, false, f);
            if (!k) {
                if (d && WorkbookColorInfo.l_op_Inequality(i.colorInfo, null) && nullableNotEquals(i.colorInfo._themeColorType$i, null)) {
                    c.font.colorInfo = i.colorInfo._g(g.d.v);
                }
                if (i != ExcelWorkbookSerializationProvider.k) {
                    a.addItem(g.d, c.d._bp.d);
                }
            }
        }
    };
    ExcelWorkbookSerializationProvider.u = function (a, b, c, d, e, f, g) {
        var h = d;
        for (var i = 1; i != 1073741824; i = (i << 1)) {
            if ((h & i) == 0) {
                continue;
            }
            var j = e._dd(i);
            if (b && (i & 69470538) != 0) {
                if (j == null && c) {
                    var k = e.style;
                    if (k != null && k.isBuiltIn) {
                        j = k._i._dd(i);
                    }
                }
                if (j != null) {
                    switch (i) {
                        case 64:
                            {
                                j = ExcelUtils.j(j, a);
                                break;
                            }
                        case 2:
                        case 2097152:
                        case 262144:
                        case 67108864:
                        case 8:
                        case 256:
                            {
                                j = ExcelUtils.ah(j, a);
                                break;
                            }
                    }
                }
            }
            f._bl(i, j, false, g);
        }
    };
    ExcelWorkbookSerializationProvider.v = function (a, b, c, d, e, f, g, h, i, j, k, l) {
        var m = k.b(true);
        if (d) {
            ExcelWorkbookSerializationProvider.x(b, g, h, j, k, l ? 0 : -97);
        }
        if (c) {
            ExcelWorkbookSerializationProvider.t(f, j, k, e, l, l ? 0 : -97);
        }
        ExcelWorkbookSerializationProvider.u(a, e, l, i, j, k, l ? 1 : -97);
        k.g(m);
    };
    ExcelWorkbookSerializationProvider.w = function (a, b, c, d) {
        var e_252, _0;
        if (c._d8) {
            var e = d.workbook;
            var f = e.cellReferenceMode;
            var g = b.l;
            var h = b.k;
            var i = b.b;
            for (var j = 0; j < i.length; j++) {
                var k = i[j];
                var l = b.j(j);
                var m = b.i(j);
                try {
                    for (var _1 = tslib_1.__values(fromEnum(c._hyperlinks$i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var n = _2.value;
                        var o = n.sourceRegion._h;
                        if (o._j(k)) {
                            var p = new WorksheetRegionAddress(1, Math.max(k._ac, o._ac), Math.min(k._ae, o._ae), Math.max(k._w, o._w), Math.min(k._x, o._x));
                            var q = p._w - k._w + m;
                            var r = p._ac - k._ac + l;
                            var s = p._af;
                            var t = p._ad;
                            var u = g;
                            var v = h;
                            var w = false;
                            var x = null;
                            if (n.targetNamedReference != null) {
                                x = e._namedReferences$i._find1(n.targetNamedReference.name, d);
                                if (x == null) {
                                    x = e._namedReferences$i._find(n.targetNamedReference.name);
                                    if (x == null) {
                                        x = n.targetAddress;
                                        w = true;
                                    }
                                }
                            }
                            else if (WorksheetCell.l_op_Inequality(n.targetCell, null)) {
                                var y = n.targetCell._toString1(f, true);
                                try {
                                    x = d._getCell2(y, f, null);
                                }
                                catch (z) {
                                    x = y;
                                    w = true;
                                }
                            }
                            else if (n.targetRegion != null) {
                                var aa = n.targetRegion._toString1(f, true);
                                try {
                                    x = d._getRegion2(aa, f, null);
                                }
                                catch (ab) {
                                    x = aa;
                                    w = true;
                                }
                            }
                            else {
                                x = n.targetAddress;
                            }
                            for (var ad = 0; ad < a.length; ad++) {
                                var ac = a[ad];
                                var ae = ac._af;
                                var af = ac._ad;
                                for (var ag = 0, ah = intDivide(ae, u); ag < ah; ag++) {
                                    for (var ai = 0, aj = intDivide(af, v); ai < aj; ai++) {
                                        var ak = ac._ac + ai * v + r;
                                        var al = ac._w + ag * u + q;
                                        var am = new WorksheetRegion(d, ak, al, ak + t - 1, al + s - 1);
                                        var an = new WorksheetHyperlink(am, x, n.displayText, n.toolTip);
                                        an._t = w;
                                        d._hyperlinks$i.add(an);
                                    }
                                }
                            }
                        }
                    }
                }
                catch (e_252_1) { e_252 = { error: e_252_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_252) throw e_252.error; }
                }
            }
        }
    };
    ExcelWorkbookSerializationProvider.x = function (a, b, c, d, e, f) {
        var e_253, _0, e_254, _1;
        var g = d.style;
        var h = null;
        if (g != null && !((function () { var i = b.tryGetValue(g, h); h = i.p1; return i.ret; })())) {
            if (g.isBuiltIn) {
                var i = g;
                h = a._styles$i._item1(g.name);
            }
            if (h == null) {
                var j = g.name.length;
                var k = new List$1(Number_$type, 0);
                var _loop_27 = function (l) {
                    if (startsWith1(l.name, g.name, 0)) {
                        if (j != l.name.length) {
                            if (l.name.charAt(j) != ' ' || l.name.length == j + 1) {
                                return "continue";
                            }
                            var m_4 = l.name.substr(j + 1);
                            var n_5;
                            if (((function () { var o = tryParseInt32_2(m_4, 0, a._e6, n_5); n_5 = o.p3; return o.ret; })()) == false) {
                                return "continue";
                            }
                            k.add(n_5);
                        }
                        {
                            h = l;
                            return "break";
                        }
                    }
                };
                try {
                    for (var _2 = tslib_1.__values(fromEnum(c)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var l = _3.value;
                        var state_9 = _loop_27(l);
                        if (state_9 === "break")
                            break;
                    }
                }
                catch (e_253_1) { e_253 = { error: e_253_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_253) throw e_253.error; }
                }
                if (h == null) {
                    var o = g.name;
                    if (a._styles$i._item1(g.name) != null) {
                        k.y();
                        var p = 1;
                        try {
                            for (var _4 = tslib_1.__values(fromEnum(k)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                                var q = _5.value;
                                if (q != p) {
                                    break;
                                }
                                p++;
                            }
                        }
                        catch (e_254_1) { e_254 = { error: e_254_1 }; }
                        finally {
                            try {
                                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                            }
                            finally { if (e_254) throw e_254.error; }
                        }
                        o += " " + numberToString(p, a._e6);
                    }
                    h = a._styles$i._addUserDefinedStyle(g.styleFormat, o);
                }
            }
            b.item(g, h);
        }
        e._bh(h, false, f);
    };
    ExcelWorkbookSerializationProvider.prototype.y = function (a, b, c, d, e, f) {
        var e_255, _0, e_256, _1, e_257, _2, e_258, _3, e_259, _4;
        var g = a.c;
        var h = a.d;
        if (d._tables$i.count > 0) {
            for (var i = d._tables$i.count - 1; i >= 0; i--) {
                var j = d._tables$i._item(i);
                var k = j._by;
                for (var l = 0; l < g.length; l++) {
                    if (g[l]._h(k)) {
                        d._tables$i.removeAt(i, false);
                        break;
                    }
                }
            }
        }
        if (e.count > 0) {
            var m = new List$1(WorksheetTable.$, 1, d._tables$i);
            var n = new HashSet$1(String_$type, 0);
            var o = h.l;
            var p = h.k;
            var q = h.b;
            try {
                for (var _5 = tslib_1.__values(fromEnum(d.workbook._worksheets$i)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                    var r = _6.value;
                    try {
                        for (var _7 = tslib_1.__values(fromEnum(r._tables$i)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                            var s = _8.value;
                            var t = s.name;
                            n.add_1(t);
                        }
                    }
                    catch (e_256_1) { e_256 = { error: e_256_1 }; }
                    finally {
                        try {
                            if (_8 && !_8.done && (_1 = _7.return)) _1.call(_7);
                        }
                        finally { if (e_256) throw e_256.error; }
                    }
                }
            }
            catch (e_255_1) { e_255 = { error: e_255_1 }; }
            finally {
                try {
                    if (_6 && !_6.done && (_0 = _5.return)) _0.call(_5);
                }
                finally { if (e_255) throw e_255.error; }
            }
            for (var u = 0; u < q.length; u++) {
                var v = q[u];
                var w = h.j(u);
                var x = h.i(u);
                try {
                    for (var _9 = tslib_1.__values(fromEnum(e)), _10 = _9.next(); !_10.done; _10 = _9.next()) {
                        var y = _10.value;
                        var z = y.name;
                        var aa = y._by;
                        if (v._h(aa)) {
                            var ab = aa._w - v._w + x;
                            var ac = aa._ac - v._ac + w;
                            for (var ad = 0; ad < g.length; ad++) {
                                var ae = g[ad];
                                var af = ae._af;
                                var ag = ae._ad;
                                for (var ah = 0, ai = intDivide(af, o); ah < ai; ah++) {
                                    for (var aj = 0, ak = intDivide(ag, p); aj < ak; aj++) {
                                        var al = ae._ac + aj * p + ac;
                                        var am = ae._w + ah * o + ab;
                                        var an = new WorksheetRegionAddress(1, al, al + aa._ad - 1, am, (am + aa._af - 1));
                                        var ao = true;
                                        for (var ap = 0; ap < m.count; ap++) {
                                            if (m._inner[ap]._by._j(an)) {
                                                ao = false;
                                                break;
                                            }
                                        }
                                        if (ao) {
                                            var aq = void 0;
                                            if (!n.contains(z)) {
                                                aq = z;
                                            }
                                            else {
                                                var ar = n.count + 2;
                                                do {
                                                    aq = z + ar;
                                                    ar++;
                                                } while (n.contains(aq));
                                            }
                                            n.add_1(aq);
                                            var as = an._ah(true, true, d.workbook.currentFormat, 1);
                                            var at = d._dd(y, true, as, Nullable$1.toNullable(CellReferenceMode_$type, 1), b);
                                            at.name = aq;
                                            a.i(ad, aj, ah, y, aq);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
                catch (e_257_1) { e_257 = { error: e_257_1 }; }
                finally {
                    try {
                        if (_10 && !_10.done && (_2 = _9.return)) _2.call(_9);
                    }
                    finally { if (e_257) throw e_257.error; }
                }
            }
            for (var au = 0; au < g.length; au++) {
                var av = g[au];
                var aw = av._af;
                var ax = av._ad;
                for (var ay = 0, az = intDivide(aw, o); ay < az; ay++) {
                    for (var a0 = 0, a1 = intDivide(ax, p); a0 < a1; a0++) {
                        var a2 = a.g(au, a0, ay);
                        if (a2 != null) {
                            try {
                                for (var _11 = tslib_1.__values(fromEnum(a2)), _12 = _11.next(); !_12.done; _12 = _11.next()) {
                                    var a3 = _12.value;
                                    var a4 = d._tables$i._item1(a3);
                                    try {
                                        for (var _13 = tslib_1.__values(fromEnum(a4._columns$i)), _14 = _13.next(); !_14.done; _14 = _13.next()) {
                                            var a5 = _14.value;
                                            var a6 = a5.columnFormula;
                                            if (a6 != null) {
                                                f(au, ay, a0, a6);
                                            }
                                            if (a5._aa != null) {
                                                f(au, ay, a0, a5._aa);
                                            }
                                        }
                                    }
                                    catch (e_259_1) { e_259 = { error: e_259_1 }; }
                                    finally {
                                        try {
                                            if (_14 && !_14.done && (_4 = _13.return)) _4.call(_13);
                                        }
                                        finally { if (e_259) throw e_259.error; }
                                    }
                                }
                            }
                            catch (e_258_1) { e_258 = { error: e_258_1 }; }
                            finally {
                                try {
                                    if (_12 && !_12.done && (_3 = _11.return)) _3.call(_11);
                                }
                                finally { if (e_258) throw e_258.error; }
                            }
                        }
                    }
                }
            }
        }
    };
    ExcelWorkbookSerializationProvider.prototype.z = function (a, b, c, d, e) {
        var e_260, _0, e_261, _1, e_262, _2;
        if (d._d6) {
            for (var g = 0; g < a.length; g++) {
                var f = a[g];
                d._dataValidationRules$i._remove5(f);
            }
        }
        if (c._d6) {
            try {
                for (var _3 = tslib_1.__values(fromEnum(c._dataValidationRules$i)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var h = _4.value;
                    var i = null;
                    var j = b.l;
                    var k = b.k;
                    var l = b.b;
                    for (var m = 0; m < l.length; m++) {
                        var n = l[m];
                        var o = b.j(m);
                        var p = b.i(m);
                        if (h.value._k(n)) {
                            try {
                                for (var _5 = tslib_1.__values(fromEnum(h.value._t)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                                    var q = _6.value;
                                    if (q._j(n)) {
                                        if (i == null) {
                                            i = new WorksheetReferenceCollection(d);
                                        }
                                        var r = new WorksheetRegionAddress(1, Math.max(n._ac, q._ac), Math.min(n._ae, q._ae), Math.max(n._w, q._w), Math.min(n._x, q._x));
                                        var s = r._w - n._w + p;
                                        var t = r._ac - n._ac + o;
                                        var u = r._af;
                                        var v = r._ad;
                                        var w = j;
                                        var x = k;
                                        for (var z = 0; z < a.length; z++) {
                                            var y = a[z];
                                            var aa = y._af;
                                            var ab = y._ad;
                                            for (var ac = 0, ad = intDivide(aa, w); ac < ad; ac++) {
                                                for (var ae = 0, af = intDivide(ab, x); ae < af; ae++) {
                                                    var ag = y._ac + ae * x + t;
                                                    var ah = y._w + ac * w + s;
                                                    var ai = new WorksheetRegion(d, ag, ah, ag + v - 1, ah + u - 1);
                                                    i._add(ai);
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                            catch (e_261_1) { e_261 = { error: e_261_1 }; }
                            finally {
                                try {
                                    if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                                }
                                finally { if (e_261) throw e_261.error; }
                            }
                        }
                    }
                    if (i != null) {
                        var aj = h.key;
                        var ak = null;
                        try {
                            for (var _7 = tslib_1.__values(fromEnum(d._dataValidationRules$i)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                                var al = _8.value;
                                if (al.key.isEquivalentTo(aj)) {
                                    ak = al.key;
                                    break;
                                }
                            }
                        }
                        catch (e_262_1) { e_262 = { error: e_262_1 }; }
                        finally {
                            try {
                                if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                            }
                            finally { if (e_262) throw e_262.error; }
                        }
                        if (ak == null) {
                            ak = aj.clone();
                            var am = ak._l(null);
                            var an = ak._m(null);
                            if (am != null) {
                                e(am);
                            }
                            if (an != null) {
                                e(an);
                            }
                        }
                        d._dataValidationRules$i._add5(ak, i);
                    }
                }
            }
            catch (e_260_1) { e_260 = { error: e_260_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_260) throw e_260.error; }
            }
        }
    };
    ExcelWorkbookSerializationProvider.o = function (a, b) {
        var c = b.workbook;
        var d = a.workbook;
        var e = new Dictionary$2(NamedReferenceBase.$, NamedReferenceBase.$, 0);
        var f = function (g, h) {
            var i;
            if (!((function () { var j = e.tryGetValue(g, i); i = j.p1; return j.ret; })())) {
                var j = typeCast(Worksheet.$, g.scope);
                if (j == a) {
                    i = c._a2(g.name, b);
                }
                else if (j != null) {
                    i = new NamedReferenceUnconnected(1, j.name, c._bf(d._gw), g._p, c.currentFormat, true);
                }
                else {
                    i = c._a3(g.name);
                }
                if (i == null) {
                    if (typeCast(NamedReference.$, g) !== null) {
                        var k = j != null ? b : c;
                        var l = new NamedReference(1, c._namedReferences$i, k, g._p);
                        l._be(g.name, "Name", c.currentFormat);
                        l._v = g._v;
                        l.comment = g.comment;
                        if (g._j != null && !g._r) {
                            var m = g._j._g();
                            h(m);
                            l._j = m;
                        }
                        c._namedReferences$i._x(l);
                        i = l;
                    }
                    else {
                        i = null;
                    }
                }
                e.item(g, i);
            }
            return i;
        };
        return f;
    };
    ExcelWorkbookSerializationProvider.l = function (a, b, c) {
        var d = c._af;
        var e = c._ad;
        if (d % a != 0 || e % b != 0) {
            var f = e % b != 0 || d != 1 ? b : e;
            var g = d % a != 0 || e != 1 ? a : d;
            c = new WorksheetRegionAddress(1, c._ac, c._ac + f - 1, c._w, (c._w + g - 1));
            return {
                ret: true,
                p2: c
            };
        }
        return {
            ret: false,
            p2: c
        };
    };
    ExcelWorkbookSerializationProvider._n = function (a, b, c) {
        var d;
        return tslib_1.__generator(this, function (_0) {
            switch (_0.label) {
                case 0:
                    d = b;
                    _0.label = 1;
                case 1:
                    if (!(d <= c)) return [3 /*break*/, 4];
                    return [4 /*yield*/, a.item(d)];
                case 2:
                    _0.sent();
                    _0.label = 3;
                case 3:
                    d++;
                    return [3 /*break*/, 1];
                case 4: return [2 /*return*/];
            }
        });
    };
    ExcelWorkbookSerializationProvider.n = function (a, b, c) {
        return toEnum(function () { return ExcelWorkbookSerializationProvider._n(a, b, c); });
    };
    ExcelWorkbookSerializationProvider.prototype.p = function (a, b, c) {
        if (c === void 0) { c = 1; }
        var d = 0;
        var g = a.b;
        for (var f = 0; f < g.length; f++) {
            var e = g[f];
            for (var i = 0; i < b.length; i++) {
                var h = b[i];
                var j = h._c4(e._ac, e._ae, e._w, e._x, false);
                if (j._n) {
                    d += (j._af * j._ad) * c;
                }
            }
        }
        return d;
    };
    ExcelWorkbookSerializationProvider.prototype.m = function (a, b, c, d) {
        var e_263, _0, e_264, _1;
        if (d === void 0) { d = null; }
        var e = a.workbook;
        if (b != e) {
            b.suspendCalculations();
        }
        if (c && WorksheetRegionAddress._p(b._gn, Nullable$1.toNullable(WorksheetRegionAddress.$, null))) {
            c = false;
        }
        var f = c ? [b.windowOptions.selectedWorksheet] : Enumerable.a(Worksheet.$, Enumerable.u(Worksheet.$, b._worksheets$i, function (g) { return g._w; }));
        var g = SpreadsheetUtilities.e(e);
        if (g.length % f.length != 0) {
            a.m(0);
            return false;
        }
        var h = a.b;
        var i = a.g;
        var j = a.a;
        var k = b.windowOptions.selectedWorksheet;
        var l = e.windowOptions.selectedWorksheet;
        var m;
        if (c) {
            m = new WorksheetPaneSelection();
            m.b = new WorksheetCellAddress(1, b._gn.value._ac, b._gn.value._w);
            m.f = 0;
            m.a = 3;
            m.d.add(b._gn.value);
        }
        else {
            m = k.displayOptions._af.a(k.displayOptions._z);
        }
        var n = l.displayOptions._af.a(l.displayOptions._z);
        if (m == null || m.d.count == 0) {
            a.m(3);
            return false;
        }
        var o = Enumerable.a(WorksheetRegionAddress.$, m.d);
        var p = (h & 2097152) != 0;
        var q = (h & 8192) != 0;
        var r = new HashSet$1(WorksheetTable.$, 0);
        var s = new HashSet$1(WorksheetTable.$, 0);
        var t = false;
        for (var v = 0; v < f.length; v++) {
            var u = f[v];
            try {
                for (var _2 = tslib_1.__values(fromEnum(u._tables$i)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var w = _3.value;
                    for (var y = 0; y < o.length; y++) {
                        var x = o[y];
                        var z = w._by;
                        var aa = false;
                        if (x._h(z)) {
                            if (r.add_1(w) && !p) {
                                aa = true;
                            }
                        }
                        else if (q && z._h(x)) {
                            s.add_1(w);
                            aa = true;
                        }
                        if (aa) {
                            t = true;
                            var ab = Math.max(x._ac, z._ac);
                            var ac = Math.min(x._ae, z._ae);
                            for (var ad = ab; ad <= ac; ad++) {
                                var ae = u._rows$i.item(ad);
                            }
                        }
                    }
                }
            }
            catch (e_263_1) { e_263 = { error: e_263_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_263) throw e_263.error; }
            }
            if (r.count > 0 && f.length > 1) {
                a.m(4);
                return false;
            }
        }
        if (!p) {
            r.clear();
        }
        var af = true;
        var ag = true;
        for (var ai = 0; ai < o.length; ai++) {
            var ah = o[ai];
            if (ah._ac > 0 || ah._ae < b.maxRowCount - 1) {
                af = false;
            }
            if (ah._w > 0 || ah._x < b.maxColumnCount - 1) {
                ag = false;
            }
        }
        var aj = Enumerable.a(WorksheetRegionAddress.$, n.d);
        var ak = false;
        var al;
        if (o.length > 1) {
            if (aj.length > 1) {
                a.m(1);
                return false;
            }
            al = new CellRegionMapMany(o);
        }
        else {
            al = new CellRegionMapSingle(o[0]);
            if (aj.length > 1) {
                var am = o[0]._af;
                var an = o[0]._ad;
                for (var ao = 0; ao < aj.length; ao++) {
                    var ap = aj[ao];
                    var aq = ap._af;
                    var ar = ap._ad;
                    if ((aq > 1 && aq % am != 0) || (ar > 1 && ar % an != 0)) {
                        a.m(2);
                        return false;
                    }
                    if ((aq == 1 && am != 1) || (ar == 1 && an != 1)) {
                        ak = true;
                        aj[ao] = new WorksheetRegionAddress(1, aj[ao]._ac, ar == 1 ? aj[ao]._ac + an - 1 : aj[ao]._ae, aj[ao]._w, aq == 1 ? (aj[ao]._w + am - 1) : aj[ao]._x);
                    }
                }
            }
        }
        if (af || ag) {
            for (var at = 0; at < aj.length; at++) {
                var as = aj[at];
                if ((ag && as._w != 0) || (af && as._ac != 0)) {
                    a.m(2);
                    return false;
                }
            }
        }
        if (aj.length == 1) {
            ak = ((function () { var au = ExcelWorkbookSerializationProvider.l(al.l, al.k, aj[0]); aj[0] = au.p2; return au.ret; })());
        }
        if (a.i(boxArray$1(g), boxArray$1(aj), true) == false) {
            return false;
        }
        var au = 0;
        for (var aw = 0; aw < aj.length; aw++) {
            var av = aj[aw];
            au += (intDivide(av._af, al.l)) * (intDivide(av._ad, al.k));
        }
        var ax = this.p(al, f, au);
        if (!a.h(ax)) {
            return false;
        }
        var ay = Nullable$1.toNullable(WorksheetRegionAddress.$, null);
        if (ak) {
            ay = WorkbookSerializationProviderBase.h(g, aj);
        }
        if (WorksheetRegionAddress._r(ay, Nullable$1.toNullable(WorksheetRegionAddress.$, null))) {
            a.m(5);
            return false;
        }
        var az = new Array(aj.length);
        var a0 = new HashSet$1(IRegionBlockingValue_$type, 0);
        for (var a1 = 0; a1 < g.length; a1++) {
            var a2 = g[a1];
            for (var a3 = 0; a3 < aj.length; a3++) {
                az[a3] = a2._cw(aj[a3]);
            }
            ExcelUtils.gf(az, a0);
        }
        if (a.a == 0) {
            try {
                for (var _4 = tslib_1.__values(fromEnum(a0)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                    var a4 = _5.value;
                    a4.removeFromRegion();
                }
            }
            catch (e_264_1) { e_264 = { error: e_264_1 }; }
            finally {
                try {
                    if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                }
                finally { if (e_264) throw e_264.error; }
            }
        }
        var a5 = (h & 1) != 0;
        var a6 = (h & 2) != 0;
        if (o.length > 1 && (h & 4) != 0) {
            a6 = false;
        }
        var a7 = (h & 64) != 0;
        var a8 = (h & 128) != 0;
        var a9 = (h & 1024) != 0;
        var ba = (h & 8) != 0;
        var bb = (h & 16384) != 0;
        var bc = (h & 8192) != 0 && s.count > 0;
        var bd = (h & 2048) != 0;
        var be = (h & 4096) != 0;
        var bf = (h & 131072) != 0;
        var bg = (h & 262144) != 0;
        var bh = (h & 524288) != 0;
        var bi = (h & 1048576) != 0;
        var bj = (h & 4194304) != 0;
        var bk = (h & 8388608) != 0;
        if (!ba && af && (h & 32768) != 0) {
            ba = true;
        }
        if (!bb && ag && (h & 65536) != 0) {
            bb = true;
        }
        var bl = new HashSet$1(WorksheetMergedCellsRegion.$, 0);
        var bm = new Dictionary$2(WorkbookFontData.$, IWorkbookFont_$type, 0);
        var bn = new Dictionary$2(WorkbookStyle.$, WorkbookStyle.$, 0);
        var bo = Enumerable.z(WorkbookStyle.$, Enumerable.x(WorkbookStyle.$, String_$type, e._styles$i, function (bp) { return bp.name; }));
        var bp = SpreadsheetUtilities.g(boxArray$1(aj));
        var bq = 0;
        if ((h & 32) != 0) {
            bq |= 830603265;
        }
        if ((h & 256) != 0) {
            bq |= 1073741888;
        }
        if ((h & 512) != 0) {
            bq |= 1074790400;
        }
        if ((h & 16) != 0) {
            bq |= 1073807360;
        }
        if (a7) {
            bq |= 208404542;
        }
        var br = al.k;
        var bs = al.l;
        var bt = new ExcelWorkbookSerializationProvider_CellRangeTargetInfo(e, aj, al);
        var _loop_28 = function (bu) {
            var e_265, _0, e_266, _1, e_267, _2, e_268, _3;
            var bv = f[bu % f.length];
            var bw = g[bu];
            bl.clear();
            var bx = ExcelWorkbookSerializationProvider.o(bv, bw);
            var by = bw._eh;
            var bz = bq;
            if (bw.isProtected) {
                bz &= ~1048576;
            }
            var b0 = bz != 0 || a8;
            try {
                bw._eh = true;
                if (bf) {
                    var b1 = void 0;
                    var b2 = SpreadsheetPaneManager._hx(false, false, b1, bw, boxArray$1(bp));
                    b1 = b2.p2;
                    ExcelWorkbookSerializationProvider.w(aj, al, bv, bw);
                }
                if (p) {
                    this_14.y(bt, bd, bv, bw, r, function (b3, b4, b5, b6) { return b6._bv(bv, d, bw, Nullable$1.toNullable(Boolean_$type, true), bt.h(b3, b4, b5), bx); });
                }
                if (bg) {
                    this_14.z(aj, al, bv, bw, function (b3) { return b3._bv(bv, d, bw, Nullable$1.toNullable(Boolean_$type, false), null, bx); });
                }
                if (bj) {
                    this_14.s(aj, bd, al, bv, bw, !bk, function (b3, b4) { return b4._bv(bv, d, bw, Nullable$1.toNullable(Boolean_$type, false), null, bx); });
                }
                if (bh) {
                    this_14.r(aj, al, bv, bw);
                }
                for (var b3 = 0; b3 < aj.length; b3++) {
                    var b4 = aj[b3];
                    var b5 = b4._ac;
                    var b6 = b4._w;
                    var b7 = bw._rows$i;
                    var b8 = void 0;
                    if (af) {
                        b8 = true;
                    }
                    else {
                        if (bb && bv.defaultRowHeight != bw.defaultRowHeight) {
                            b8 = false;
                        }
                        else {
                            b8 = true;
                            var b9 = new ReadOnlyResolvedWorksheetCellFormatData(bv.workbook._styles$i.normalStyle._i);
                            var ca = new ReadOnlyResolvedWorksheetCellFormatData(bw.workbook._styles$i.normalStyle._i);
                            var cb = bz;
                            if (a8) {
                                cb |= 32640;
                            }
                            var cc = null;
                            var cd = null;
                            for (var ce = b4._w; ce <= b4._x; ce++) {
                                var cf = false;
                                if (cd == null || !cd.g(ce)) {
                                    cd = bw._cb(ce);
                                    cf = true;
                                }
                                var cg = al.g(ce - b4._w);
                                if (cc == null || !cc.g(cg)) {
                                    cc = bv._cb(cg);
                                    cf = true;
                                }
                                if (cf) {
                                    b9._c(cc.b);
                                    ca._c(cd.b);
                                    if (WorksheetCellFormatProxy._y(b9, ca, cb)) {
                                        b8 = false;
                                        break;
                                    }
                                    else if (a9 && !bd) {
                                        if (b9.style.name != ca.style.name) {
                                            b8 = false;
                                            break;
                                        }
                                    }
                                }
                            }
                        }
                    }
                    if (af && ag) {
                        try {
                            for (var _4 = tslib_1.__values(fromEnum(bv._rows$i._m(0, Math.min(al.k, b4._ae)))), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                                var ch = _5.value;
                                var ci = b7.item(ch.index);
                            }
                        }
                        catch (e_265_1) { e_265 = { error: e_265_1 }; }
                        finally {
                            try {
                                if (_5 && !_5.done && (_0 = _4.return)) _0.call(_4);
                            }
                            finally { if (e_265) throw e_265.error; }
                        }
                    }
                    else if (b8) {
                        var cj = al.k;
                        var ck = (b4._ae - b4._ac) + 1;
                        var cl = intDivide(ck, cj);
                        var cm = al.c;
                        var cn = b4._ac;
                        for (var co = 0; co < cm.length; co++) {
                            var cp = cm[co]._i;
                            try {
                                for (var _6 = tslib_1.__values(fromEnum(bv._rows$i._m(cp, cm[co]._h))), _7 = _6.next(); !_7.done; _7 = _6.next()) {
                                    var cq = _7.value;
                                    var cr = cq.index - cp;
                                    for (var cs = 0; cs < cl; cs++) {
                                        var ct = b7.item((cs * cj) + cn + cr);
                                    }
                                }
                            }
                            catch (e_266_1) { e_266 = { error: e_266_1 }; }
                            finally {
                                try {
                                    if (_7 && !_7.done && (_1 = _6.return)) _1.call(_6);
                                }
                                finally { if (e_266) throw e_266.error; }
                            }
                            cn += (cm[co]._h - cp) + 1;
                        }
                    }
                    if (ba) {
                        var cu = null;
                        var cv = null;
                        for (var cw = b4._w; cw <= b4._x; cw++) {
                            var cx = al.g(cw - b6);
                            if (cu == null || cx > cu.r) {
                                cu = bv._cb(cx);
                            }
                            var cy = cu.v;
                            if (cy < 0) {
                                cy = bv.defaultColumnWidth;
                            }
                            if (cv == null || cw > cv.r) {
                                cv = bw._cb(cw);
                            }
                            var cz = cv.v;
                            if (cz < 0) {
                                cz = bw.defaultColumnWidth;
                            }
                            if (cy != cz || cu.i != cv.i) {
                                bw._columns$i.item(cw).width = cy;
                                bw._columns$i.item(cw).hidden = cu.i;
                            }
                        }
                    }
                    if (af && b0) {
                        var c0 = null;
                        for (var c1 = b4._w; c1 <= b4._x; c1++) {
                            var c2 = al.g(c1 - b6);
                            if (c0 == null || !c0.g(c2)) {
                                c0 = bv._cb(c2);
                            }
                            var c3 = c0.b;
                            var c4 = bw._columns$i.item(c1)._cellFormatInternal;
                            if (!i) {
                                ExcelWorkbookSerializationProvider.v(b, e, a8, a9, bd, bm, bn, bo, bz, c3, c4, false);
                            }
                        }
                    }
                    var c5 = b8 ? b7._m(b4._ac, b4._ae) : ExcelWorkbookSerializationProvider.n(b7, b4._ac, b4._ae);
                    var c6 = new ExcelWorkbookSerializationProvider_TargetColumnIndexHelper(SpreadsheetUtilities.z(b4), al, b0, t);
                    try {
                        for (var _8 = tslib_1.__values(fromEnum(c5)), _9 = _8.next(); !_9.done; _9 = _8.next()) {
                            var c7 = _9.value;
                            var c8 = c7.index;
                            var c9 = c8 - b5;
                            var da = al.h(c9);
                            var db = (intDivide(c9, br));
                            var dc = bv._rows$i.item(da);
                            if (bb) {
                                c7.height = dc.height;
                                c7.hidden = dc.hidden;
                            }
                            if (ag && b0) {
                                var dd = dc._hasCellFormat ? dc._cellFormatInternal.d : bv.workbook._ca._p;
                                var de = c7._cellFormatInternal;
                                if (!i) {
                                    ExcelWorkbookSerializationProvider.v(b, e, a8, a9, bd, bm, bn, bo, bz, dd, de, false);
                                }
                            }
                            var df = ag ? Enumerable.z(IntRange.$, c6.f(dc, c7)) : c6.h();
                            for (var dg = 0; dg < df.count; dg++) {
                                for (var dh = df.item(dg)._i; dh <= df.item(dg)._h; dh++) {
                                    var di = dh - b6;
                                    var dj = al.g(di);
                                    var dk = (intDivide(di, bs));
                                    var dl = c7.getCellAssociatedMergedCellsRegion(dh);
                                    var dm = null;
                                    if (dl != null) {
                                        if (false == bl.add_1(dl)) {
                                            if (b0 && b4._h(dl._h)) {
                                                ExcelWorkbookSerializationProvider.q(b, e, s, a8, a9, bc, bd, bm, bn, bo, bv, bz, c7, da, dc, dh, dj);
                                            }
                                            continue;
                                        }
                                        if (false == b4._h(dl._h)) {
                                            continue;
                                        }
                                    }
                                    if (be) {
                                        dm = dc.getCellAssociatedMergedCellsRegion(dj);
                                        if (dm == null) {
                                            if (dl != null) {
                                                if (WorksheetRegionAddress._o(dl._h, b4) && al.b.length == 1 && al.b[0]._m) {
                                                }
                                                else {
                                                    bw._mergedCellsRegions$i.remove_1(dl);
                                                }
                                            }
                                        }
                                        else if (dl != null && WorksheetRegionAddress._o(dl._h, b4) && al.b.length == 1 && WorksheetRegionAddress._o(al.b[0], dm._h)) {
                                        }
                                        else {
                                            if (!al.e(da, dj)._h(dm._h)) {
                                                continue;
                                            }
                                            var dn = dl;
                                            if (dl != null) {
                                                if (dl._ad != dm._ad || dl._aa != dm._aa) {
                                                    bw._mergedCellsRegions$i.remove_1(dl);
                                                    dl = null;
                                                }
                                            }
                                            if (dl == null) {
                                                if (dn == null || dm._ad > dn._ad || dm._aa > dn._aa) {
                                                    bw._ih(new WorksheetRegionAddress(1, c8, c8 + dm._aa - 1, dh, (dh + dm._ad - 1)), bl);
                                                }
                                                dl = bw._mergedCellsRegions$i._add1(c8, dh, c8 + dm._aa - 1, dh + dm._ad - 1);
                                                bl.add_1(dl);
                                            }
                                        }
                                    }
                                    if (i && dc._c6(dj) == null) {
                                        continue;
                                    }
                                    if (b0) {
                                        if (dm != null && dm._hasCellFormat && dl != null) {
                                            ExcelWorkbookSerializationProvider.v(b, e, a8, a9, bd, bm, bn, bo, bz, dm._cellFormatInternal.d, dl._cellFormatInternal, true);
                                        }
                                        var dp = bc;
                                        if (dp) {
                                            if (bw._de(c8, dh) != null) {
                                                dp = false;
                                            }
                                        }
                                        ExcelWorkbookSerializationProvider.q(b, e, s, a8, a9, dp, bd, bm, bn, bo, bv, bz, c7, da, dc, dh, dj);
                                    }
                                    var dq = a5;
                                    if (a6) {
                                        var dr = dc.getCellFormula(dj);
                                        if (dr != null) {
                                            dq = false;
                                            if (dr._s == 1) {
                                                if (j == 0) {
                                                    var ds = dr;
                                                    var dt = al.e(da, dj);
                                                    var du = ds.cellRange._h;
                                                    if (da != Math.max(dt._ac, du._ac)) {
                                                        continue;
                                                    }
                                                    if (dj != Math.max(dt._w, du._w)) {
                                                        continue;
                                                    }
                                                    var dv = ds._g();
                                                    dv._bv(bv, d, bw, SpreadsheetUtilities.cz, bt.h(b3, db, dk), bx);
                                                    dv._bw(e, dc, dj, { $type: Point_$type, x: dh - du._w, y: c8 - du._ac });
                                                    var dw = bw._cx(c8, dh, c8 + Math.min(dt._ae, du._ae) - da, dh + Math.min(dt._x, du._x) - dj);
                                                    dv._applyTo3(dw);
                                                }
                                                else {
                                                    dq = a5;
                                                }
                                            }
                                            else {
                                                if (dr._as) {
                                                    bv._h3(dr, false);
                                                    dr._bt(b);
                                                }
                                                var dx = dr._g();
                                                dx._bv(bv, d, bw, SpreadsheetUtilities.cz, bt.h(b3, db, dk), bx);
                                                dx._bw(e, dc, dj, { $type: Point_$type, x: dh - dj, y: c8 - da });
                                                if (j != 0) {
                                                    this_14.b(j, NaN, dx, c7, dh);
                                                }
                                                else {
                                                    dx._bp(c7, dh);
                                                }
                                                if (a5 && dx._ae()) {
                                                    var dy = dc._getCellValue1(dj);
                                                    if (dy != null && typeCast(FormattedString.$, dy) !== null == false) {
                                                        c7._d0(dh, CalcUtilities.c(dy), true);
                                                    }
                                                }
                                            }
                                        }
                                    }
                                    if (dq) {
                                        var dz = dc._getCellValue1(dj);
                                        if (i == false || dz != null) {
                                            if (j != 0) {
                                                this_14.b(j, WorkbookSerializationProviderBase.g(b, dz), null, c7, dh);
                                                continue;
                                            }
                                            if (typeCast(FormattedString.$, dz) !== null) {
                                                if (bi) {
                                                    var d0 = typeCast(StringElement.$, dz._m.g(e));
                                                    if (bd && typeCast(FormattedStringElement.$, d0) !== null) {
                                                        var d1 = d0;
                                                        if (d1._u) {
                                                            try {
                                                                for (var _10 = tslib_1.__values(fromEnum(d1._ah)), _11 = _10.next(); !_11.done; _11 = _10.next()) {
                                                                    var d2 = _11.value;
                                                                    if (d2.h) {
                                                                        var d3 = d2.e();
                                                                        if (WorkbookColorInfo.l_op_Inequality(d3.colorInfo, null)) {
                                                                            d3.colorInfo = ExcelUtils.ah(d3.colorInfo, b);
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            catch (e_268_1) { e_268 = { error: e_268_1 }; }
                                                            finally {
                                                                try {
                                                                    if (_11 && !_11.done && (_3 = _10.return)) _3.call(_10);
                                                                }
                                                                finally { if (e_268) throw e_268.error; }
                                                            }
                                                        }
                                                    }
                                                    dz = new FormattedString(e, d0);
                                                }
                                                else {
                                                    dz = dz.unformattedString;
                                                }
                                            }
                                            c7.setCellValue(dh, dz);
                                        }
                                    }
                                }
                            }
                        }
                    }
                    catch (e_267_1) { e_267 = { error: e_267_1 }; }
                    finally {
                        try {
                            if (_9 && !_9.done && (_2 = _8.return)) _2.call(_8);
                        }
                        finally { if (e_267) throw e_267.error; }
                    }
                }
            }
            finally {
                bw._eh = by;
            }
            var d4 = bt.f();
            SpreadsheetUtilities.e0(bw, aj, d4);
        };
        var this_14 = this;
        for (var bu = 0; bu < g.length; bu++) {
            _loop_28(bu);
        }
        return true;
    };
    ExcelWorkbookSerializationProvider.$t = markType(ExcelWorkbookSerializationProvider, 'ExcelWorkbookSerializationProvider', WorkbookSerializationProviderBase.$);
    ExcelWorkbookSerializationProvider.k = null;
    return ExcelWorkbookSerializationProvider;
}(WorkbookSerializationProviderBase));
export { ExcelWorkbookSerializationProvider };
/**
 * @hidden
 */
var BIFF8SerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(BIFF8SerializationProvider, _super);
    function BIFF8SerializationProvider() {
        return _super.call(this, 1, ["BIFF8"], null) || this;
    }
    BIFF8SerializationProvider.prototype.j = function (a) {
        var b = _super.prototype.j.call(this, a);
        if (b != null) {
            var c = a.l("Link");
            if (!stringIsNullOrEmpty(c)) {
                var d_7 = 2;
                var e = c.split('\0');
                var f = void 0, g = void 0;
                var h = void 0, i = void 0;
                var _loop_29 = function (k) {
                    var j = e[k];
                    if (stringIsNullOrWhiteSpace(j)) {
                        return "continue";
                    }
                    var l = j.trim();
                    if (startsWith1(l, "R", 1) == false && startsWith1(l, "C", 1) == false) {
                        return "continue";
                    }
                    var m = ExcelUtils.fu(l, d_7, null, 0, f, h, g, i);
                    f = m.p4;
                    h = m.p5;
                    g = m.p6;
                    i = m.p7;
                    if (f >= 0 && f < 65536 && g >= 0 && g < 65536 && h >= 0 && h < 256 && i >= 0 && i < 256) {
                        return { value: b };
                    }
                    if (startsWith1(l, "R", 1)) {
                        var n_6, o_3;
                        n_6 = o_3 = 0;
                        var p_4 = false;
                        var q_4;
                        if (((function () { var r = FormulaParser.bc(l, 0, d_7, n_6, p_4, q_4); n_6 = r.p3; p_4 = r.p4; q_4 = r.p5; return r.ret; })()) == false || p_4) {
                            return "continue";
                        }
                        if (l.length == q_4) {
                            o_3 = n_6;
                        }
                        else if (l.length == q_4 + 1 || l.charAt(q_4) != ":") {
                            return "continue";
                        }
                        else if (((function () { var r = FormulaParser.bc(l, q_4 + 1, d_7, o_3, p_4, q_4); o_3 = r.p3; p_4 = r.p4; q_4 = r.p5; return r.ret; })()) == false || p_4) {
                            return "continue";
                        }
                        return { value: b };
                    }
                    if (startsWith1(l, "C", 1)) {
                        var r_4, s_3;
                        r_4 = s_3 = 0;
                        var t_4 = false;
                        var u_3;
                        if (((function () { var v = FormulaParser.ap(l, 0, d_7, r_4, t_4, u_3); r_4 = v.p3; t_4 = v.p4; u_3 = v.p5; return v.ret; })()) == false || t_4) {
                            return "continue";
                        }
                        if (l.length == u_3) {
                            s_3 = r_4;
                        }
                        else if (l.length == u_3 + 1 || l.charAt(u_3) != ":") {
                            return "continue";
                        }
                        else if (((function () { var v = FormulaParser.ap(l, u_3 + 1, d_7, s_3, t_4, u_3); s_3 = v.p3; t_4 = v.p4; u_3 = v.p5; return v.ret; })()) == false || t_4) {
                            return "continue";
                        }
                        return { value: b };
                    }
                };
                for (var k = 0; k < e.length; k++) {
                    var state_10 = _loop_29(k);
                    if (typeof state_10 === "object")
                        return state_10.value;
                }
                return null;
            }
        }
        return b;
    };
    BIFF8SerializationProvider.prototype.c = function (a) {
        if (a.e("BIFF8")) {
            var b = typeCast(Stream.$, a.j("BIFF8"));
            if (b != null) {
                var c = null;
                var d = a.l("LINK");
                if (!stringIsNullOrEmpty(d)) {
                    var e = d.split('\0');
                    var f = e.length > 1 ? e[1] : null;
                    if (!stringIsNullOrEmpty(f)) {
                        var g = f.indexOf('[');
                        var h = f.lastIndexOf(']');
                        if (g >= 0 && h > g) {
                            var i = f.substr(g + 1, h - g - 1);
                            var j = g > 1 ? f.substr(0, g) : null;
                            var k = j != null ? IOPath.combine1(j, i) : i;
                            c = a.workbook._bf(k);
                            if (c == a.workbook._bb) {
                                c = null;
                            }
                        }
                    }
                }
                var l = Workbook._bs(b);
                return this.m(a, l, true, c);
            }
        }
        return false;
    };
    BIFF8SerializationProvider.prototype.d = function (a) {
        throw new NotSupportedException(0);
    };
    BIFF8SerializationProvider.$t = markType(BIFF8SerializationProvider, 'BIFF8SerializationProvider', ExcelWorkbookSerializationProvider.$);
    return BIFF8SerializationProvider;
}(ExcelWorkbookSerializationProvider));
export { BIFF8SerializationProvider };
/**
 * @hidden
 */
var PlainTextWorkbookSerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(PlainTextWorkbookSerializationProvider, _super);
    function PlainTextWorkbookSerializationProvider() {
        var a = [];
        for (var _0 = 0; _0 < arguments.length; _0++) {
            a[_0] = arguments[_0];
        }
        return _super.apply(this, tslib_1.__spread([0], a)) || this;
    }
    PlainTextWorkbookSerializationProvider.prototype.c = function (a) {
        var b = a.k;
        var c = a.e(b) ? a.j(b) : null;
        if (c == null) {
            return false;
        }
        var d = typeCast(String_$type, c);
        if (d != null) {
            {
                var e = new StringReader(d);
                try {
                    return this.m(a, e, this.k);
                }
                finally {
                    if (e != null) {
                        e.dispose();
                    }
                }
            }
        }
        var f = typeCast(Stream.$, c);
        if (null == f) {
            return false;
        }
        {
            var g = new StreamReader(f);
            try {
                return this.m(a, g, this.k);
            }
            finally {
                if (g != null) {
                    g.dispose();
                }
            }
        }
    };
    PlainTextWorkbookSerializationProvider.l = function (a, b) {
        var e_269, _0;
        var c = a.a;
        if (c.length > 1) {
            var d = new SortedIntRangeList();
            for (var e = 0; e < c.length; e++) {
                var f = c[e];
                d.n(f._i, f._h);
                if (e < c.length - 1) {
                    var g = c[e + 1]._i;
                    var h = f._h + 1;
                    while (h < g) {
                        var i = b._cb(h);
                        if (!i.i) {
                            d.n(h, Math.min(g - 1, i.r));
                        }
                        h = i.r + 1;
                    }
                }
            }
            c = new Array(d.k);
            for (var j = 0; j < c.length; j++) {
                c[j] = new IntRange(1, d.i(j), d.h(j));
            }
        }
        var k = a.c;
        if (k.length > 1) {
            var l = !b._dv;
            var m = new SortedIntRangeList();
            for (var n = 0; n < k.length; n++) {
                var o = k[n];
                m.n(o._i, o._h);
                if (n < k.length - 1) {
                    var p = k[n + 1]._i;
                    var q = o._h + 1;
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(b._rows$i._m(q, p - 1))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var r = _2.value;
                            var s = r.index;
                            if (q < s && l) {
                                m.n(q, s - 1);
                            }
                            if (!r.hidden) {
                                m.m(s);
                            }
                            q = s + 1;
                        }
                    }
                    catch (e_269_1) { e_269 = { error: e_269_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_269) throw e_269.error; }
                    }
                    if (q < p && l) {
                        m.n(q, p - 1);
                    }
                }
            }
            k = new Array(m.k);
            for (var t = 0; t < k.length; t++) {
                k[t] = new IntRange(1, m.i(t), m.h(t));
            }
        }
        if (c != a.a || k != a.c) {
            var u = new Array(c.length * k.length);
            for (var v = 0; v < k.length; v++) {
                for (var w = 0; w < c.length; w++) {
                    u[v * c.length + w] = new WorksheetRegionAddress(1, k[v]._i, k[v]._h, c[w]._i, c[w]._h);
                }
            }
            if (u.length == 1) {
                a = new CellRegionMapSingle(u[0]);
            }
            else {
                a = new CellRegionMapMany(u);
            }
        }
        return a;
    };
    PlainTextWorkbookSerializationProvider.o = function (a, b) {
        var c = 0;
        for (var d = 0; d < b; d++) {
            c = Math.max(a._inner[d].length, c);
        }
        return c;
    };
    PlainTextWorkbookSerializationProvider.prototype.m = function (a, b, c, d) {
        var e_270, _0;
        if (d === void 0) { d = Nullable$1.toNullable(String_$type, '\"'); }
        var e = a.workbook;
        var f = SpreadsheetUtilities.e(e);
        var g = e.windowOptions.selectedWorksheet;
        var h = g.displayOptions._af.a(g.displayOptions._z);
        var i = Enumerable.a(WorksheetRegionAddress.$, h.d);
        if (i.length > 1) {
            a.m(6);
            return false;
        }
        var j = i[0];
        var k = 32759;
        var l = PlainTextReader.a(b, false, d, c, k);
        var m = l.count;
        if (m == 0) {
            return false;
        }
        if (j._ad > 1 && j._ad < m) {
            m = j._ad;
        }
        var n = PlainTextWorkbookSerializationProvider.o(l, m);
        if (j._af > 1 && j._af < n) {
            n = j._af;
        }
        if (j._af > n || j._ad > m) {
        }
        var o = j._af != n;
        var p = j._ad != m;
        if (o || p) {
            j = new WorksheetRegionAddress(1, j._ac, p ? (j._ac + m - 1) : j._ae, j._w, o ? (j._w + n - 1) : j._x);
        }
        if (j._ae >= e.maxRowCount || j._x >= e.maxColumnCount) {
            j = new WorksheetRegionAddress(1, j._ac, Math.min(j._ae, e.maxRowCount - 1), j._w, Math.min(j._x, e.maxColumnCount - 1));
            m = j._ae - j._ac + 1;
            n = j._x - j._w + 1;
        }
        var q = j;
        var r = new HashSet$1(IRegionBlockingValue_$type, 0);
        for (var t = 0; t < f.length; t++) {
            var s = f[t];
            var u = s._hi(j);
            j = u.p0;
            if (WorksheetRegionAddress._q(j, q)) {
                a.m(5);
                return false;
            }
            ExcelUtils.gf([new WorksheetRegion(s, j._ac, j._w, j._ae, j._x, false)], r);
        }
        if (a.i(boxArray$1(f), boxArray$1([j]), false) == false) {
            return false;
        }
        if (!a.h(n * m)) {
            return false;
        }
        if (a.a == 0) {
            try {
                for (var _1 = tslib_1.__values(fromEnum(r)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var v = _2.value;
                    v.removeFromRegion();
                }
            }
            catch (e_270_1) { e_270 = { error: e_270_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_270) throw e_270.error; }
            }
        }
        if (WorksheetRegionAddress._q(i[0], j)) {
            i[0] = j;
            WorkbookSerializationProviderBase.h(f, i);
        }
        var w = a.b;
        var x = a.g;
        var y = (w & 1) != 0;
        var z = (w & 2) != 0;
        var aa = (w & 16) != 0;
        var ab = (w & 4096) != 0;
        var ac = (w & 131072) != 0;
        var ad = new PlainTextWorkbookSerializationProvider_ParseEditValue();
        var ae = new HashSet$1(WorksheetMergedCellsRegion.$, 0);
        var af = [SpreadsheetUtilities.z(j)];
        var ag = new ParseEditValueCache(a);
        var ah = a.a;
        for (var aj = 0; aj < f.length; aj++) {
            var ai = f[aj];
            var ak = j._ac;
            var al = j._w;
            for (var am = 0; am < m; am++) {
                var an = l._inner[am];
                var ao = x ? an.length : n;
                var ap = ai._rows$i.item(ak + am);
                var _loop_30 = function (aq) {
                    var ar = aq >= an.length ? null : an[aq];
                    var as = al + aq;
                    var at;
                    var au = 0;
                    var av = false;
                    var aw = null;
                    if (stringIsNullOrEmpty(ar)) {
                        at = null;
                    }
                    else {
                        ad.b = ar;
                        ad.a = ai._b4(ap, as);
                        at = ((function () { var ax = SpreadsheetEditHelper.ad(ag, ad, false, true, au); au = ax.p4; return ax.ret; })());
                        if (at == ad || (z == false && typeCast(Formula.$, at) !== null)) {
                            at = ar;
                            av = stringContains(ar, "\n");
                        }
                        aw = typeCast(Formula.$, at);
                        if (aa && aw != null && au == -1) {
                            au = SpreadsheetEditHelper.aa(aw, ai, ap.index, as);
                        }
                    }
                    var ax = ap.getCellAssociatedMergedCellsRegion(as);
                    if (ax != null) {
                        if (ab) {
                            ai._mergedCellsRegions$i.remove_1(ax);
                        }
                        else if (ae.add_1(ax) == false) {
                            return "continue";
                        }
                    }
                    if (ah != 0) {
                        if (typeCast(Formula.$, at) !== null) {
                            this_15.b(ah, NaN, at, ap, as);
                            return "continue";
                        }
                        else {
                            var ay_1 = WorkbookSerializationProviderBase.g(e, at);
                            if (isNaN_(ay_1) && typeof at === 'string') {
                                if (!((function () { var az = ExcelUtils.by(at, e, e._e6, false, ay_1); ay_1 = az.p4; return az.ret; })())) {
                                    return "continue";
                                }
                            }
                            this_15.b(ah, ay_1, null, ap, as);
                            return "continue";
                        }
                    }
                    if (at == null) {
                        if (x == false) {
                            ap.setCellValue(as, at);
                        }
                    }
                    else if (aw != null) {
                        aw._bp(ap, as, 1);
                        if (aa && au != -1) {
                            SpreadsheetEditHelper.ai(ap, as, au, ai._b4(ap, as));
                        }
                    }
                    else if (aa) {
                        SpreadsheetEditHelper.ak(ap, as, ad.editCellFormat, at, au, av);
                    }
                    else {
                        ap.setCellValue(as, at);
                        if (av) {
                            ap.getCellFormat(as)._wrapText$i = Nullable$1.toNullable(Boolean_$type, true);
                        }
                    }
                };
                var this_15 = this;
                for (var aq = 0; aq < ao; aq++) {
                    _loop_30(aq);
                }
            }
            if (ac) {
                var az = void 0;
                var a0 = SpreadsheetPaneManager._hx(false, false, az, ai, boxArray$1(af));
                az = a0.p2;
            }
        }
        return true;
    };
    PlainTextWorkbookSerializationProvider.prototype.n = function (a, b, c, d) {
        var e_271, _0;
        if (d === void 0) { d = Nullable$1.toNullable(String_$type, '\"'); }
        var e = new PlainTextWriter(b, d, c);
        var f = a.b.windowOptions.selectedWorksheet;
        var g = f._rows$i;
        var h = f._c4(0, a.b.maxRowCount - 1, 0, (a.b.maxColumnCount - 1), false);
        var i = a.a;
        i = PlainTextWorkbookSerializationProvider.l(i, f);
        var j = Math.max(Math.min(Enumerable.ah(IntRange.$, i.c)._h, h._ae), i.c[0]._i);
        var k = Math.max(Math.min(Enumerable.ah(IntRange.$, i.a)._h, h._x), i.a[0]._i);
        var l = 0;
        var o = i.a;
        for (var n = 0; n < o.length; n++) {
            var m = o[n];
            if (m._i > k) {
                break;
            }
            l += (Math.min(m._h, k) - m._i) + 1;
        }
        var p = 0;
        var s = i.c;
        for (var r = 0; r < s.length; r++) {
            var q = s[r];
            if (q._i > j) {
                break;
            }
            p += (Math.min(q._h, j) - q._i) + 1;
        }
        if ((p * l) > 16384000) {
            if (!a.h()) {
                return false;
            }
        }
        var v = i.c;
        for (var u = 0; u < v.length; u++) {
            var t = v[u];
            var w = t._i;
            try {
                for (var _1 = tslib_1.__values(fromEnum(g._m(t._i, Math.min(t._h, j)))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var x = _2.value;
                    var y = x.index;
                    for (; w < y; w++) {
                        e.l(l - 1);
                        e.k();
                    }
                    var ab = i.a;
                    for (var aa = 0; aa < ab.length; aa++) {
                        var z = ab[aa];
                        for (var ac = z._i, ad = Math.min(z._h, k); ac <= ad; ac++) {
                            var ae = x._getCellText1(ac, 1);
                            e.m(ae);
                        }
                    }
                    e.k();
                    w = y + 1;
                }
            }
            catch (e_271_1) { e_271 = { error: e_271_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_271) throw e_271.error; }
            }
            for (; w < Math.min(t._h, j); w++) {
                e.l(l - 1);
                e.k();
            }
        }
        return true;
    };
    PlainTextWorkbookSerializationProvider.$t = markType(PlainTextWorkbookSerializationProvider, 'PlainTextWorkbookSerializationProvider', WorkbookSerializationProviderBase.$);
    return PlainTextWorkbookSerializationProvider;
}(WorkbookSerializationProviderBase));
export { PlainTextWorkbookSerializationProvider };
/**
 * @hidden
 */
var CSVWorkbookSerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(CSVWorkbookSerializationProvider, _super);
    function CSVWorkbookSerializationProvider() {
        return _super.call(this, DataFormats.a) || this;
    }
    CSVWorkbookSerializationProvider.prototype.get_k = function () {
        return [','];
    };
    Object.defineProperty(CSVWorkbookSerializationProvider.prototype, "k", {
        get: function () {
            return this.get_k();
        },
        enumerable: true,
        configurable: true
    });
    CSVWorkbookSerializationProvider.prototype.d = function (a) {
        var b = new MemoryStream(0);
        var c = new StreamWriter(1, b, Encoding.uTF8);
        var d = this.n(a, c, ',');
        c.k();
        b.position = 0;
        if (d) {
            a.p(DataFormats.a, b);
        }
        return d;
    };
    CSVWorkbookSerializationProvider.$t = markType(CSVWorkbookSerializationProvider, 'CSVWorkbookSerializationProvider', PlainTextWorkbookSerializationProvider.$);
    return CSVWorkbookSerializationProvider;
}(PlainTextWorkbookSerializationProvider));
export { CSVWorkbookSerializationProvider };
/**
 * @hidden
 */
var IGExcelSerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(IGExcelSerializationProvider, _super);
    function IGExcelSerializationProvider() {
        return _super.call(this, 0, "IGExcel") || this;
    }
    IGExcelSerializationProvider.prototype.c = function (a) {
        if (a.e("IGExcel")) {
            var b = typeCast(Stream.$, a.j("IGExcel"));
            if (b != null) {
                var c = null;
                var d = null;
                d = new WorkbookLoadOptions();
                var e = null;
                e = new IGExcelSerializationProvider_SyncPackageFactory();
                d._c = e;
                var f = Workbook._bs(b, d);
                var g = a.l("IGExcelId");
                if (!stringIsNullOrEmpty(g)) {
                    var h = g.indexOf(';');
                    if (h > 0) {
                        var i = new Guid(3, g.substr(0, h));
                        var j = h < g.length - 1 ? g.substr(h + 1) : null;
                        f._fb = i;
                        f._gw = j;
                        if (Guid.l_op_Inequality(i, a.workbook._fb)) {
                            c = a.workbook._bf(j != null ? j : "Book1");
                            if (c == a.workbook._bb) {
                                c = null;
                            }
                        }
                    }
                }
                return this.m(a, f, false, c);
            }
        }
        return false;
    };
    IGExcelSerializationProvider.prototype.d = function (a) {
        var b = new MemoryStream(0);
        var c = new WorkbookSaveOptions();
        var d = new IGExcelSerializationProvider_SelectionWorkbookSaveFilter(a);
        c._g = d;
        var e = this.p(a.a, Enumerable.a(Worksheet.$, a.m), 1);
        if (e > 16384000 && !a.h()) {
            return false;
        }
        var f = null;
        f = new IGExcelSerializationProvider_SyncPackageFactory();
        c._c = f;
        var g = a.b._gw;
        a.b._ix(b, c);
        a.b._gw = g;
        b.position = 0;
        a.p("IGExcel", b);
        var h = a.b._fb.toString2("D") + ";" + g;
        a.p("IGExcelId", h);
        return true;
    };
    IGExcelSerializationProvider.$t = markType(IGExcelSerializationProvider, 'IGExcelSerializationProvider', ExcelWorkbookSerializationProvider.$);
    return IGExcelSerializationProvider;
}(ExcelWorkbookSerializationProvider));
export { IGExcelSerializationProvider };
/**
 * @hidden
 */
var TSVWorkbookSerializationProvider = /** @class */ (function (_super) {
    tslib_1.__extends(TSVWorkbookSerializationProvider, _super);
    function TSVWorkbookSerializationProvider() {
        return _super.call(this, DataFormats.e, DataFormats.d, DataFormats.c) || this;
    }
    TSVWorkbookSerializationProvider.prototype.get_k = function () {
        return ['\t'];
    };
    Object.defineProperty(TSVWorkbookSerializationProvider.prototype, "k", {
        get: function () {
            return this.get_k();
        },
        enumerable: true,
        configurable: true
    });
    TSVWorkbookSerializationProvider.prototype.d = function (a) {
        var e_272, _0;
        var b = new StringBuilder(0);
        var c = false;
        {
            var d = new StringWriter(2, b);
            try {
                c = this.n(a, d, '\t');
            }
            finally {
                if (d != null) {
                    d.dispose();
                }
            }
        }
        if (c) {
            var e = b.toString();
            try {
                for (var _1 = tslib_1.__values(fromEnum(this.f)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var f = _2.value;
                    a.p(f, e);
                }
            }
            catch (e_272_1) { e_272 = { error: e_272_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_272) throw e_272.error; }
            }
        }
        return c;
    };
    TSVWorkbookSerializationProvider.$t = markType(TSVWorkbookSerializationProvider, 'TSVWorkbookSerializationProvider', PlainTextWorkbookSerializationProvider.$);
    return TSVWorkbookSerializationProvider;
}(PlainTextWorkbookSerializationProvider));
export { TSVWorkbookSerializationProvider };
/**
 * @hidden
 */
var WorkbookDataObjectManager = /** @class */ (function (_super) {
    tslib_1.__extends(WorkbookDataObjectManager, _super);
    function WorkbookDataObjectManager(a) {
        var _this = _super.call(this) || this;
        _this.h = null;
        _this.b = null;
        _this.settingData = null;
        _this.pasting = null;
        _this.copying = null;
        _this.beforeCopying = null;
        _this.error = null;
        CoreUtilities.z(a, "workbook");
        _this.b = a;
        _this.h = new List$1(WorkbookSerializationProviderBase.$, 0);
        var b = ExcelUtils.au(a.currentFormat) ? Workbook._ez != null && Workbook._e2 != null : Workbook._e1 != null && Workbook._e3 != null;
        if (b) {
            _this.h.add(new IGExcelSerializationProvider());
        }
        if (Workbook._ez != null) {
            _this.h.add(new BIFF8SerializationProvider());
        }
        _this.h.add(new TSVWorkbookSerializationProvider());
        _this.h.add(new CSVWorkbookSerializationProvider());
        return _this;
    }
    WorkbookDataObjectManager.prototype.c = function (a) {
        var b = this.p(false, a);
        if (null == b) {
            return false;
        }
        try {
            return ClipboardHelper.c(b, true);
        }
        catch (c) {
            this.o(false, c);
            return false;
        }
    };
    WorkbookDataObjectManager.d = function (a) {
        return a != null && (a.getDataPresent(DataFormats.d) || a.getDataPresent(DataFormats.e) || a.getDataPresent(DataFormats.c) || a.getDataPresent(DataFormats.a) || a.getDataPresent("IGExcel") || a.getDataPresent("BIFF8"));
    };
    WorkbookDataObjectManager.prototype.e = function (a) {
        var b = null;
        try {
            b = ClipboardHelper.e();
        }
        catch (c) {
            this.o(true, c);
            return false;
        }
        return this.f(a, b, null);
    };
    WorkbookDataObjectManager.prototype.f = function (a, b, c) {
        if (c === void 0) { c = null; }
        var d = WorksheetCell.l_op_Inequality(c, null);
        if (null == b) {
            return false;
        }
        var e = new WorkbookDataObjectLoadContext(this.b, b, a);
        var f = this.n(e);
        if (stringIsNullOrEmpty(f)) {
            return false;
        }
        e.k = f;
        var g = this.pasting;
        if (g != null) {
            var h = new WorkbookDataObjectPastingEventArgs(b, f, d);
            g(this, h);
            if (h._cancel) {
                return false;
            }
            b = h._dataObject;
            if (b == null) {
                return false;
            }
            e.o = b;
            f = h._formatToApply;
            e.k = f;
        }
        if (stringIsNullOrWhiteSpace(f) || !e.e(f)) {
            return false;
        }
        var i = this.a(f, true);
        if (i == null) {
            return false;
        }
        try {
            return i.c(e);
        }
        catch (j) {
            this.o(true, j);
            return false;
        }
    };
    WorkbookDataObjectManager.prototype.p = function (a, b) {
        var _this = this;
        var e_273, _0;
        var c = ClipboardHelper.d();
        if (null == c) {
            return null;
        }
        var d = this.beforeCopying;
        if (d != null) {
            d(this, EventArgs.empty);
        }
        var e;
        var f = SpreadsheetUtilities.cz;
        var g = function () {
            if (!f.hasValue) {
                f = Nullable$1.toNullable(Boolean_$type, b());
            }
            return f.value;
        };
        try {
            e = new WorkbookDataObjectSaveContext(this.b, c, function (h) { return _this.g(c, h); }, g);
        }
        catch (h) {
            this.o(true, h);
            return null;
        }
        var i = 0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.h)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var j = _2.value;
                if (j.f.count > 0) {
                    if (j.d(e)) {
                        i++;
                    }
                    else if (f.hasValue) {
                        return null;
                    }
                }
            }
        }
        catch (e_273_1) { e_273 = { error: e_273_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_273) throw e_273.error; }
        }
        if (i == 0) {
            return null;
        }
        var k = this.copying;
        if (k != null) {
            var l = new WorkbookDataObjectCopyingEventArgs(c, a);
            k(this, l);
            if (l._cancel) {
                return null;
            }
        }
        return c;
    };
    WorkbookDataObjectManager.prototype.n = function (a) {
        var e_274, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.h)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = b.j(a);
                if (c != null) {
                    return c;
                }
            }
        }
        catch (e_274_1) { e_274 = { error: e_274_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_274) throw e_274.error; }
        }
        return null;
    };
    WorkbookDataObjectManager.prototype.a = function (a, b) {
        var e_275, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.h)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = b ? c.e : c.f;
                if (d.contains(a)) {
                    return c;
                }
            }
        }
        catch (e_275_1) { e_275 = { error: e_275_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_275) throw e_275.error; }
        }
        return null;
    };
    WorkbookDataObjectManager.prototype.o = function (a, b) {
        var c = this.error;
        if (c != null) {
            var d = new WorkbookSerializationErrorEventArgs(a, b);
            c(this, d);
        }
    };
    WorkbookDataObjectManager.prototype.g = function (a, b) {
        var c = this.settingData;
        if (c != null) {
            var d = new WorkbookDataObjectSettingDataEventArgs(a, b, false);
            c(this, d);
            return !d._cancel;
        }
        return true;
    };
    WorkbookDataObjectManager.$t = markType(WorkbookDataObjectManager, 'WorkbookDataObjectManager');
    return WorkbookDataObjectManager;
}(Base));
export { WorkbookDataObjectManager };
/**
 * @hidden
 */
var SpreadsheetShape = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetShape, _super);
    function SpreadsheetShape(a, b) {
        var _this = _super.call(this) || this;
        _this.b = null;
        _this.d = null;
        _this.j = null;
        _this.i = false;
        _this.g = false;
        _this.h = false;
        _this.n = 0;
        _this.a = null;
        _this.o = null;
        _this.v = null;
        _this.s = null;
        _this.u = null;
        _this.t = null;
        _this.k = 0;
        _this.e = false;
        _this.f = false;
        _this.l = null;
        _this.d = a;
        _this.i = typeCast(WorksheetChart.$, a) !== null;
        _this.b = b;
        if (typeCast(WorksheetShapeGroupBase.$, a) !== null) {
            _this.j = new List$1(SpreadsheetShape.$, 0);
        }
        return _this;
    }
    SpreadsheetShape.prototype.p = function () {
        this.n++;
        if (this.j != null) {
            for (var a = 0; a < this.j.count; a++) {
                this.j._inner[a].p();
            }
        }
    };
    Object.defineProperty(SpreadsheetShape.prototype, "c", {
        get: function () {
            var a = this;
            while (a.b != null) {
                a = a.b;
            }
            return a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetShape.prototype, "m", {
        get: function () {
            return this.l;
        },
        set: function (a) {
            if (a != this.l) {
                if (this.l != null) {
                    this.l.dispose();
                    this.l = null;
                }
                this.l = a;
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetShape.prototype.q = function () {
        if (this.a != null) {
            if (this.h || this.g) {
                this.a.e(this.d, this.h, this.g);
                this.h = false;
                this.g = false;
            }
        }
    };
    SpreadsheetShape.prototype.r = function (a) {
        var e_276, _0, e_277, _1, e_278, _2;
        if (this.j != null) {
            var b = this.d;
            var c = false;
            var d = 0;
            for (var e = 0; e < b._shapes$i.count; e++) {
                var f = b._shapes$i.item(e);
                if (!f.visible || !SpreadsheetUtilities.a4(f, a)) {
                    continue;
                }
                if (d >= this.j.count) {
                    c = true;
                    break;
                }
                if (this.j._inner[d].d != b._shapes$i.item(e)) {
                    c = true;
                    break;
                }
                d++;
            }
            if (!c && d != this.j.count) {
                c = true;
            }
            if (c) {
                var g_8 = new Dictionary$2(WorksheetShape.$, SpreadsheetShape.$, 0);
                try {
                    for (var _3 = tslib_1.__values(fromEnum(this.j)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                        var h = _4.value;
                        g_8.item(h.d, h);
                    }
                }
                catch (e_276_1) { e_276 = { error: e_276_1 }; }
                finally {
                    try {
                        if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                    }
                    finally { if (e_276) throw e_276.error; }
                }
                this.j.clear();
                var _loop_31 = function (i) {
                    if (!i.visible || !SpreadsheetUtilities.a4(i, a)) {
                        return "continue";
                    }
                    var j;
                    if (!((function () { var k = g_8.tryGetValue(i, j); j = k.p1; return k.ret; })())) {
                        j = new SpreadsheetShape(i, this_16);
                    }
                    else {
                        g_8.removeItem(i);
                    }
                    this_16.j.add(j);
                };
                var this_16 = this;
                try {
                    for (var _5 = tslib_1.__values(fromEnum(b._shapes$i)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                        var i = _6.value;
                        _loop_31(i);
                    }
                }
                catch (e_277_1) { e_277 = { error: e_277_1 }; }
                finally {
                    try {
                        if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                    }
                    finally { if (e_277) throw e_277.error; }
                }
            }
            try {
                for (var _7 = tslib_1.__values(fromEnum(this.j)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                    var k = _8.value;
                    k.r(a);
                }
            }
            catch (e_278_1) { e_278 = { error: e_278_1 }; }
            finally {
                try {
                    if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
                }
                finally { if (e_278) throw e_278.error; }
            }
        }
    };
    SpreadsheetShape.$t = markType(SpreadsheetShape, 'SpreadsheetShape');
    return SpreadsheetShape;
}(Base));
export { SpreadsheetShape };
/**
 * @hidden
 */
var SpreadsheetAreaLayoutManager_RowColumnInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetAreaLayoutManager_RowColumnInfo, _super);
    function SpreadsheetAreaLayoutManager_RowColumnInfo(a) {
        var _this = _super.call(this) || this;
        _this.g = 0;
        _this.h = 0;
        _this.i = 0;
        _this.a = null;
        _this.b = false;
        _this.e = null;
        _this.c = false;
        _this.d = false;
        _this.f = new List$1(SpreadsheetAreaLayoutManager_SheetLayerInfo$1.$.specialize(SpreadsheetScrollRegion.$), 0);
        _this.b = a;
        _this.e = boxArray$1(new Array(0));
        return _this;
    }
    SpreadsheetAreaLayoutManager_RowColumnInfo.$t = markType(SpreadsheetAreaLayoutManager_RowColumnInfo, 'SpreadsheetAreaLayoutManager_RowColumnInfo');
    return SpreadsheetAreaLayoutManager_RowColumnInfo;
}(Base));
export { SpreadsheetAreaLayoutManager_RowColumnInfo };
/**
 * @hidden
 */
var SpreadsheetUserPromptInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetUserPromptInfo, _super);
    function SpreadsheetUserPromptInfo(a, b, c, d, e) {
        var _this = _super.call(this) || this;
        _this.b = false;
        _this.c = false;
        _this.h = null;
        _this.g = null;
        _this.d = false;
        _this.f = null;
        _this.i = null;
        _this.a = 0;
        _this.a = a;
        _this.f = c;
        _this.g = d;
        _this.d = true;
        _this.b = e;
        if (b == null) {
            var f = null;
            switch (a) {
                case 5:
                    f = "DeleteWorksheets_Message";
                    break;
                case 8:
                    f = "InvalidCommand_MixedSelection_Message";
                    break;
                case 6:
                    f = "InvalidCommand_OverlappingSelection_Message";
                    break;
                case 9:
                    f = "InvalidNameBoxValue_Message";
                    break;
                case 10:
                    f = "PasteError_CellRangeSize_Message";
                    break;
                case 11:
                    f = "PasteError_MultipleSourceAndTargetRanges_Message";
                    break;
                case 12:
                    f = "PasteError_InvalidSourceRanges_Message";
                    break;
                case 13:
                    f = "PasteError_InvalidSelectedSheetCount_Message";
                    break;
                case 15:
                    f = "PasteError_IntersectsMergedCells_Message";
                    break;
                case 16:
                    f = "PasteError_MultipleSheetTables_Message";
                    break;
                case 17:
                    f = "Error_IntersectsMergedCells_Message";
                    break;
                case 18:
                    f = "CopyError_InvalidSelection_Message";
                    break;
                case 7:
                    f = "InvalidCommand_MultipleSelection_Message";
                    break;
                case 20:
                    f = "InvalidCommand_TableChangeWithMultipleSheetSelection_Message";
                    break;
                case 21:
                    f = "Error_InvalidHyperlinkAddress_Message";
                    break;
                case 22:
                    f = "Error_InvalidHyperlinkReference_Message";
                    break;
                case 23:
                    f = "Error_InvalidProtectedWorksheetChange_Message";
                    break;
                case 24:
                    f = "Error_NoSingleAllowedEditRange_Message";
                    break;
                case 25:
                    f = "Error_InvalidArrayFormulaLockedState_Message";
                    break;
                case 26:
                    f = "Error_ChangePartOfDataTableError_Message";
                    break;
                case 27:
                    f = "Error_DeletingLockedColumnCells_Message";
                    break;
                case 28:
                    f = "Error_DeletingLockedRowCells_Message";
                    break;
                case 29:
                    f = "Error_LargePasteOperation_Message";
                    break;
                case 30:
                    f = "Error_InvalidSortOrFilterRange_Message";
                    break;
                case 31:
                    f = "Error_LargeOperation_Message";
                    break;
            }
            if (f != null) {
                b = SpreadsheetUtilities.di(null, f);
            }
            else if (c != null) {
                b = c.message;
            }
        }
        _this.i = b;
        return _this;
    }
    Object.defineProperty(SpreadsheetUserPromptInfo.prototype, "e", {
        get: function () {
            return this.d && !stringIsNullOrEmpty(this.i);
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetUserPromptInfo.$t = markType(SpreadsheetUserPromptInfo, 'SpreadsheetUserPromptInfo');
    return SpreadsheetUserPromptInfo;
}(Base));
export { SpreadsheetUserPromptInfo };
/**
 * @hidden
 */
var RotationHelper = /** @class */ (function (_super) {
    tslib_1.__extends(RotationHelper, _super);
    function RotationHelper() {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.k = null;
        _this.l = null;
        _this.c = 0;
        _this.d = 0;
        _this.a = new Array(8);
        _this.k = new Rect(4);
        _this.l = new Rect(4);
        return _this;
    }
    Object.defineProperty(RotationHelper.prototype, "n", {
        get: function () {
            return this.l;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotationHelper.prototype, "e", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotationHelper.prototype, "f", {
        get: function () {
            return this.d;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(RotationHelper.prototype, "m", {
        get: function () {
            return this.k;
        },
        enumerable: true,
        configurable: true
    });
    RotationHelper.prototype.g = function (a, b, c, d, e, f) {
        if (f === void 0) { f = false; }
        this.i(a, b, c, d, e, 0, 0, true, f);
    };
    RotationHelper.prototype.h = function (a, b, c, d, e, f, g, h) {
        if (h === void 0) { h = false; }
        this.i(a, b, c, d, e, f, g, false, h);
    };
    RotationHelper.prototype.i = function (a, b, c, d, e, f, g, h, i) {
        var j = Math.max(c - a, 0);
        var k = Math.max(d - b, 0);
        if (i) {
            a = (a + j / 2) - k / 2;
            b = (b + k / 2) - j / 2;
            var l = k;
            k = j;
            j = l;
        }
        c = a + j;
        d = b + k;
        this.l.x = a;
        this.l.y = b;
        this.l.width = j;
        this.l.height = k;
        this.c = a + j / 2;
        this.d = b + k / 2;
        var m = h ? this.c : f;
        var n = h ? this.d : g;
        var o = this.a;
        o[0] = o[2] = a;
        o[1] = o[5] = b;
        o[4] = o[6] = c;
        o[3] = o[7] = d;
        if (e != 0) {
            var p = SpreadsheetUtilities.cc(e);
            var q = Math.cos(p);
            var r = Math.sin(p);
            var s = void 0, t = void 0, u = void 0, v = void 0;
            s = u = t = v = 0;
            for (var w = 0; w < 7; w += 2) {
                var x = (q * (o[w] - m) - r * (o[w + 1] - n) + m);
                o[w + 1] = (r * (o[w] - m) + q * (o[w + 1] - n) + n);
                o[w] = x;
                if (w == 0) {
                    s = t = o[0];
                    u = v = o[1];
                }
                else {
                    if (t < o[w]) {
                        t = o[w];
                    }
                    else if (s > o[w]) {
                        s = o[w];
                    }
                    if (v < o[w + 1]) {
                        v = o[w + 1];
                    }
                    else if (u > o[w + 1]) {
                        u = o[w + 1];
                    }
                }
            }
            this.k.x = s;
            this.k.y = u;
            this.k.width = t - s;
            this.k.height = v - u;
        }
        else {
            this.k.x = a;
            this.k.y = b;
            this.k.width = j;
            this.k.height = k;
        }
    };
    RotationHelper.prototype.b = function (a, b, c, d) {
        return this.k.left > c || this.k.top > d || this.k.right < a || this.k.bottom < b;
    };
    RotationHelper.prototype.j = function (a, b, c) {
        if (c != 0) {
            var d = this.a;
            var e = SpreadsheetUtilities.cc(c);
            var f = Math.cos(e);
            var g = Math.sin(e);
            var h = void 0, i = void 0, j = void 0, k = void 0;
            h = j = i = k = 0;
            for (var l = 0; l < 7; l += 2) {
                var m = (f * (d[l] - a) - g * (d[l + 1] - b) + a);
                d[l + 1] = (g * (d[l] - a) + f * (d[l + 1] - b) + b);
                d[l] = m;
                if (l == 0) {
                    h = i = d[0];
                    j = k = d[1];
                }
                else {
                    if (i < d[l]) {
                        i = d[l];
                    }
                    else if (h > d[l]) {
                        h = d[l];
                    }
                    if (k < d[l + 1]) {
                        k = d[l + 1];
                    }
                    else if (j > d[l + 1]) {
                        j = d[l + 1];
                    }
                }
            }
            var n = (f * (this.c - a) - g * (this.d - b) + a);
            this.d = (g * (this.c - a) + f * (this.d - b) + b);
            this.c = n;
            this.k.x = h;
            this.k.y = j;
            this.k.width = i - h;
            this.k.height = k - j;
        }
    };
    RotationHelper.$t = markType(RotationHelper, 'RotationHelper');
    return RotationHelper;
}(Base));
export { RotationHelper };
/**
 * @hidden
 */
var SpreadsheetTabInfo = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabInfo, _super);
    function SpreadsheetTabInfo(a) {
        var _this = _super.call(this) || this;
        _this._ad = null;
        _this._i = null;
        _this._g = null;
        _this._k = 0;
        _this._aj = ColorsInternal.c;
        _this._o = false;
        _this._p = false;
        _this._m = false;
        _this._y = 0;
        _this._w = 0;
        _this._ai = null;
        _this._n = false;
        _this._q = false;
        _this._z = 0;
        CoreUtilities.z(a, "worksheet");
        _this._i = a;
        _this._ah();
        return _this;
    }
    SpreadsheetTabInfo.prototype.e = function (a, b, c) {
        if (a == this) {
            switch (b) {
                case "IsActive":
                case "IsSelected":
                case "ReverseZIndex":
                case "Index":
                    this._af();
                    break;
            }
        }
        _super.prototype.e.call(this, a, b, c);
    };
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_x", {
        get: function () {
            return this._w;
        },
        set: function (a) {
            if (this._w != a) {
                this._w = a;
                this.a("ActualWidth");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_ak", {
        get: function () {
            return this._aj;
        },
        set: function (a) {
            if (Color.d(this._aj, a)) {
                this._aj = a;
                this.a("Color");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_h", {
        get: function () {
            return this._g;
        },
        set: function (a) {
            if (WorkbookColorInfo.l_op_Inequality(this._g, a)) {
                this._g = a;
                this._ak = WorkbookColorInfo.l_op_Equality(this._g, null) ? ColorsInternal.c : this._g._getResolvedColor1(this._i.workbook);
                this.a("ColorInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_ac", {
        get: function () {
            return CoreUtilities.p(this._ai);
        },
        set: function (a) {
            this._ai = a == null ? null : new WeakReference(a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_aa", {
        get: function () {
            return this._y;
        },
        set: function (a) {
            if (this._y != a) {
                this._y = a;
                this.a("Index");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_r", {
        get: function () {
            return this._m;
        },
        set: function (a) {
            if (this._m != a) {
                this._m = a;
                this.a("IsActive");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_s", {
        get: function () {
            return this._n;
        },
        set: function (a) {
            if (this._n != a) {
                this._n = a;
                this.a("IsEditing");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_t", {
        get: function () {
            return this._o;
        },
        set: function (a) {
            if (this._o != a) {
                this._o = a;
                this.a("IsProtected");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_u", {
        get: function () {
            return this._p;
        },
        set: function (a) {
            if (this._p != a) {
                this._p = a;
                this.a("IsSelected");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_ae", {
        get: function () {
            return this._ad;
        },
        set: function (a) {
            if (this._ad != a) {
                this._ad = a;
                this.a("Name");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_v", {
        get: function () {
            return this._q;
        },
        set: function (a) {
            if (this._q != a) {
                this._q = a;
                this.a("ReverseZIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_l", {
        get: function () {
            return this._k;
        },
        set: function (a) {
            if (this._k != a) {
                this._k = a;
                this.a("Visibility");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_j", {
        get: function () {
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabInfo.prototype, "_ab", {
        get: function () {
            return this._z;
        },
        set: function (a) {
            if (this._z != a) {
                this._z = a;
                this.a("ZIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabInfo.prototype._af = function () {
        var a = this._aa;
        if (this._q) {
            a *= -1;
        }
        if (this._u) {
            a += 10000;
        }
        if (this._r) {
            a += 50000;
        }
        this._ab = a;
    };
    SpreadsheetTabInfo.prototype._ag = function (a, b, c) {
        var d = this._i.workbook;
        if (d != null) {
            if (a) {
                if (d.windowOptions.selectedWorksheet != this._i && this._u) {
                    this._i._w = false;
                }
                else {
                    this._i._w = true;
                }
            }
            else if (b) {
                var e = this._i.index;
                var f = d.windowOptions.selectedWorksheet == null ? e : d.windowOptions.selectedWorksheet.index;
                var g = Math.min(e, f);
                var h = g == e ? f : e;
                for (var i = 0; i < d._worksheets$i.count; i++) {
                    var j = d._worksheets$i._item(i);
                    j._w = j.displayOptions.visibility == 0 && i >= g && i <= h;
                }
            }
            else if (c == false && this._i._w) {
                d.windowOptions._ae(this._i, false);
            }
            else {
                var k = d.windowOptions.selectedWorksheet != this._i && SpreadsheetUtilities.a3(this._i.workbook);
                d.windowOptions._ae(this._i, k);
            }
        }
    };
    SpreadsheetTabInfo.prototype._ah = function () {
        this._ae = this._i.name;
        this._h = this._i.displayOptions.tabColorInfo;
        this._l = this._i.displayOptions.visibility;
        this._t = this._i.isProtected;
    };
    SpreadsheetTabInfo.$t = markType(SpreadsheetTabInfo, 'SpreadsheetTabInfo', PropertyChangeNotifierExtended.$);
    return SpreadsheetTabInfo;
}(PropertyChangeNotifierExtended));
export { SpreadsheetTabInfo };
/**
 * @hidden
 */
var SpreadsheetTabItemLayoutManager$1 = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabItemLayoutManager$1, _super);
    function SpreadsheetTabItemLayoutManager$1($tVisual) {
        var _this = _super.call(this) || this;
        _this.$tVisual = null;
        _this.g = null;
        _this.i = null;
        _this.x = null;
        _this.k = false;
        _this.c = null;
        _this.ab = 0;
        _this.a = null;
        _this.l = false;
        _this.m = false;
        _this.j = null;
        _this.a5 = null;
        _this.$tVisual = $tVisual;
        _this.$type = _this.$type.specialize(_this.$tVisual);
        _this.i = new PropertyChangeListener$1(SpreadsheetTabItemLayoutManager$1.$.specialize(_this.$tVisual), _this, runOn(_this, _this.ar), false);
        _this.x = new List$1(_this.$tVisual, 0);
        return _this;
    }
    Object.defineProperty(SpreadsheetTabItemLayoutManager$1.prototype, "e", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemLayoutManager$1.prototype, "h", {
        get: function () {
            return this.g;
        },
        set: function (a) {
            if (a != this.g) {
                var b = this.g;
                this.ah(true);
                var c = PropertyChangeListenerList.e(SpreadsheetTabManager.$, this.g, a, this.i, true);
                this.g = c.p0;
                this.au(b, a);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemLayoutManager$1.prototype, "w", {
        get: function () {
            return this.x;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabItemLayoutManager$1.prototype.ad = function (a, b) {
        var c = new Rect(0, 0, 0, 0, b);
        if (this.g != null) {
            this.g._aq = a;
        }
        if (this.x.count > 0) {
            if (this.k && this.g._o != null) {
                this.g._a4(this.g._o._aa);
            }
            var d = Math.min(this.g._aw, this.x.count - 1);
            var e = this.x.count;
            var f = a;
            var g = 0;
            var h = 0;
            for (var i = d; i < e; i++) {
                if (c.width > 0) {
                    c.x += Math.max(c.width + this.g._at, 0);
                }
                var j = this.x._inner[i];
                c.width = this.d(j)._x;
                this.ae(j, c);
                if (c.width > 0) {
                    h++;
                    if (f < 0) {
                        g++;
                    }
                }
                f -= c.width;
            }
            var k = c.right > a && (g > 0 || h > 1);
            this.g._ac = k;
            c.x = 0;
            for (var l = d - 1; l >= 0; l--) {
                var m = this.x._inner[l];
                c.width = this.d(m)._x;
                c.x -= Math.max(c.width + this.g._at, 0);
                this.ae(m, c);
            }
            this.g._ae = c.x < 0;
        }
        if (this.m) {
            this.aw();
        }
        this.k = false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.aj = function () {
        this.ak();
        this.ai();
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a8 = function () {
        var _this = this;
        var e_279, _0, e_280, _1, e_281, _2;
        var a = new Size(0);
        var b = Enumerable.g(this.$tVisual, SpreadsheetTabInfo.$, this.x, function (c) { return _this.d(c); });
        this.x.clear();
        if (this.g != null) {
            var c = this.g._aw;
            var _loop_32 = function (d) {
                var e;
                if (((function () { var f = b.tryGetValue(d, e); e = f.p1; return f.ret; })())) {
                    b.removeItem(d);
                }
                else {
                    e = this_17.f(d);
                    d._ac = getBoxIfEnum(this_17.$tVisual, e);
                }
                this_17.x.add(e);
            };
            var this_17 = this;
            try {
                for (var _3 = tslib_1.__values(fromEnum(this.g._k)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                    var d = _4.value;
                    _loop_32(d);
                }
            }
            catch (e_279_1) { e_279 = { error: e_279_1 }; }
            finally {
                try {
                    if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
                }
                finally { if (e_279) throw e_279.error; }
            }
            this.a4();
            try {
                for (var _5 = tslib_1.__values(fromEnum(this.x)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                    var f = _6.value;
                    var g = this.d(f);
                    var h = g._l == 0 ? this.z(f) : 0;
                    g._x = h;
                    if (g._aa >= c) {
                        if (a.width > 0) {
                            a.width += Math.max(h + this.g._at, 0);
                        }
                        else {
                            a.width += h;
                        }
                    }
                }
            }
            catch (e_280_1) { e_280 = { error: e_280_1 }; }
            finally {
                try {
                    if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
                }
                finally { if (e_280) throw e_280.error; }
            }
            a.height = this.y();
        }
        try {
            for (var _7 = tslib_1.__values(fromEnum(b)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                var i = _8.value;
                this.az(i.value);
                if (Base.equalsStatic(getBoxIfEnum(this.$tVisual, i.value), i.key._ac)) {
                    i.key._ac = null;
                }
            }
        }
        catch (e_281_1) { e_281 = { error: e_281_1 }; }
        finally {
            try {
                if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
            }
            finally { if (e_281) throw e_281.error; }
        }
        return a;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ao = function () {
        this.ah(true);
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ap = function () {
        this.ag();
        this.af();
    };
    SpreadsheetTabItemLayoutManager$1.prototype.aq = function (a) {
        this.ah(true);
    };
    SpreadsheetTabItemLayoutManager$1.prototype.q = function (a, b) {
        var _this = this;
        this.af();
        var c = this.b;
        var d = this.d(b);
        if (c != null && d != null) {
            switch (a.a()) {
                case 2:
                    {
                        if (!this.p(b) && c != null && c._d7(true) && c._v.focus()) {
                            d._ag(false, false, false);
                            c._v._ShowTabContextMenu$i(d, a.h());
                        }
                        return true;
                    }
                case 1:
                    {
                        this.ag();
                        if (a.e() == 2 && c._bc.i && d._r) {
                            this.ay(b);
                            c._cz(113, null, getBoxIfEnum(this.$tVisual, b));
                        }
                        else if (!this.p(b) && !c._d7(true)) {
                        }
                        else if (!c._v.focus()) {
                        }
                        else {
                            var e = a.g();
                            var f = (e & 2) == 2;
                            var g = (e & 4) == 4;
                            if (f == false && a.c()) {
                                this.a5 = a.h();
                                if (!this.o(b)) {
                                    this.ag();
                                }
                                else {
                                    this.j = new TimedOperation(function () { return _this.at(b); }, SpreadsheetUtilities.cl);
                                }
                            }
                            d._ag(f, g, true);
                        }
                        return true;
                    }
            }
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.r = function (a) {
        if (this.c != null) {
            this.ah(false);
            return true;
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.s = function (a) {
        if (this.c != null) {
            var b = a.h();
            this.m = true;
            var c = this.ab;
            if (b.x < 0) {
                this.a1(true);
                this.ab = this.g._aw;
            }
            else if (b.x > this.aa()) {
                this.a1(false);
                this.ab = this.g._ay() + 1;
            }
            else {
                this.a3();
                this.ab = this.ac(b.x);
            }
            if (c != this.ab) {
                this.aw();
            }
            return true;
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.t = function (a, b) {
        if (this.j != null && PointUtil.notEquals(this.a5, null)) {
            var c = a.h();
            var d = this.a5;
            if (Math.abs(c.x - d.x) > 16 || Math.abs(c.y - d.y) > 16) {
                this.a2(b);
            }
            return true;
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.u = function (a, b) {
        if (this.j != null || PointUtil.notEquals(this.a5, null)) {
            this.af();
            this.ay(b);
            return true;
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a7 = function (a, b) {
        var c;
        var d = 0;
        if (this.ab < this.g._aw) {
            c = this.x._inner[this.g._aw];
        }
        else if (this.ab >= this.x.count) {
            c = Enumerable.ah(this.$tVisual, this.x);
            d = this.d(c)._x;
        }
        else {
            c = this.x._inner[this.ab];
        }
        var e = this.a6(c, d, 0).x;
        return new Rect(0, e - a / 2, -b, a, b);
    };
    SpreadsheetTabItemLayoutManager$1.prototype.af = function () {
        if (this.j != null) {
            this.j.c();
            this.j = null;
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ag = function () {
        this.a5 = null;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ah = function (a) {
        if (this.c != null) {
            var b = this.ab;
            var c = this.c;
            this.ab = -1;
            this.m = false;
            this.c = null;
            this.ax();
            this.a3();
            this.al();
            if (!a) {
                var d = this.g._y;
                if (d != null) {
                    var e = Enumerable.a(SpreadsheetTabInfo.$, Enumerable.y(SpreadsheetTabInfo.$, Number_$type, this.g._j, function (f) { return f._aa; }));
                    var f = b != c._aa && b != (c._aa + 1);
                    if (f) {
                        for (var h = 0; h < e.length; h++) {
                            var g = e[h];
                            if (g._aa < b) {
                                b--;
                            }
                            g._j.moveToIndex(b);
                        }
                        var i = this.g._o;
                        if (i != null) {
                            if (this.g._j.count > 1) {
                                var j = Enumerable.a(SpreadsheetTabInfo.$, this.g._j);
                                for (var l = 0; l < j.length; l++) {
                                    var k = j[l];
                                    if (k != i) {
                                        k._j._w = false;
                                    }
                                }
                            }
                            this.v(i);
                        }
                    }
                }
            }
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ac = function (a) {
        var b = Math.min(this.g._aw, this.x.count - 1);
        var c = this.x.count;
        var d = 0;
        var e = 0;
        for (var f = b; f < c; f++) {
            e += Math.max(d + this.g._at, 0);
            var g = this.x._inner[f];
            d = this.d(g)._x;
            if (d > 0 && a <= e + d) {
                return f;
            }
        }
        return this.x.count;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.p = function (a) {
        var b = this.d(a);
        return b != null && b == this.g._p;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.am = function (a, b) {
        if (this.l && this.g._ae) {
            this.b._cz(106, null, null);
            this.m = true;
            this.ab = this.g._aw;
        }
        else if (!this.l && this.g._ac) {
            this.b._cz(105, null, null);
            this.m = true;
            this.ab = this.g._ay() + 1;
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.as = function (a, b, c) {
        switch (b != null ? b : "") {
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (this.g._af(a) || this.g._ag(a)) {
                    this.ak();
                    this.ai();
                }
                break;
            case "FirstVisibleTabIndex":
            case "InterTabSpacing":
                if (a == this.h) {
                    this.af();
                    this.ak();
                    this.ai();
                }
                break;
            case "ActiveTab":
                if (a == this.h) {
                    this.k = true;
                    this.ai();
                }
                break;
            case "Visibility":
                if (typeCast(SpreadsheetTabInfo.$, a) !== null) {
                    this.ak();
                    this.ai();
                }
                break;
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.ar = function (a, b, c, d) {
        a.as(b, c, d);
    };
    SpreadsheetTabItemLayoutManager$1.prototype.at = function (a) {
        this.a2(a);
    };
    SpreadsheetTabItemLayoutManager$1.prototype.aw = function () {
        this.m = false;
        this.av();
    };
    SpreadsheetTabItemLayoutManager$1.prototype.v = function (a) {
        if (a != null) {
            if (a._r) {
                this.k = true;
                this.ai();
                return true;
            }
            else if (a != null) {
                this.g._a4(a._aa);
            }
        }
        return false;
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a0 = function (a, b) {
        this.ah(true);
        this.c = this.d(a);
        this.ab = this.c._aa;
        if (!this.n()) {
            this.c = null;
        }
        else if (this.c != null) {
            this.an();
            this.aw();
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a1 = function (a) {
        this.l = a;
        if (this.a == null) {
            this.a = new PlatformTimer();
            this.a.g = 250;
            var b = this.a;
            b.tick = delegateCombine(b.tick, runOn(this, this.am));
        }
        if (this.a.b == false) {
            this.a.k();
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a2 = function (a) {
        var b = this.a5;
        this.af();
        this.ay(a);
        var c = this.d(a);
        if (c != null) {
            if (c._j.workbook == null || c._j.workbook.protection.allowEditStructure == false) {
                return;
            }
        }
        var d = this.b;
        if (d != null && d._d7(true)) {
            this.a0(a, b);
        }
    };
    SpreadsheetTabItemLayoutManager$1.prototype.a3 = function () {
        if (this.a != null) {
            this.a.l();
        }
    };
    SpreadsheetTabItemLayoutManager$1.$t = markType(SpreadsheetTabItemLayoutManager$1, 'SpreadsheetTabItemLayoutManager$1');
    return SpreadsheetTabItemLayoutManager$1;
}(Base));
export { SpreadsheetTabItemLayoutManager$1 };
/**
 * @hidden
 */
var SpreadsheetTabManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabManager, _super);
    function SpreadsheetTabManager(a) {
        var _this = _super.call(this) || this;
        _this._l = null;
        _this._x = null;
        _this._u = null;
        _this._am = null;
        _this._g = null;
        _this._i = null;
        _this._m = null;
        _this._r = null;
        _this._h = null;
        _this._s = null;
        _this._n = null;
        _this._t = null;
        _this._v = 0;
        _this._z = false;
        _this._av = 0;
        _this._au = 0;
        _this._ap = -1;
        _this._an = 0;
        _this._ao = 0;
        _this._q = 0;
        _this._l = a;
        var b = PropertyChangeListenerList.e(ObservableCollectionExtended$1.$.specialize(SpreadsheetTabInfo.$), _this._g, new ObservableCollectionExtended$1(SpreadsheetTabInfo.$, 0), _this, false);
        _this._g = b.p0;
        _this._i = new ReadOnlyNotifyCollection$1(SpreadsheetTabInfo.$, _this._g);
        _this._u = new DeferredOperation(runOn(_this, _this._bd));
        _this._am = new List$1(ChangeInfo.$, 0);
        var c = PropertyChangeListenerList.e(SpreadsheetTabManager_SelectedTabsCollection.$, _this._r, new SpreadsheetTabManager_SelectedTabsCollection(_this), _this, false);
        _this._r = c.p0;
        _this._h = new ReadOnlyNotifyCollection$1(SpreadsheetTabInfo.$, _this._r);
        _this._s = new SpreadsheetTabManager_VisibleTabsCollection(_this._i);
        _this._t = new SpreadsheetTabManager_ZIndexTabsCollection(_this._i);
        return _this;
    }
    SpreadsheetTabManager.prototype.e = function (a, b, c) {
        switch (b != null ? b : "") {
            case "FirstVisibleTabIndex":
                if (a == this && this._x != null) {
                    this._x.windowOptions.firstVisibleTabIndex = this._aw;
                }
                break;
            case "Width":
                if (a == this && this._x != null) {
                    this._x.windowOptions.tabBarWidth = this._a1;
                }
                break;
            case "Add":
            case "Remove":
            case "Replace":
            case "Move":
            case "Reset":
                if (a == this._g) {
                    this._t._q();
                }
                break;
            case "ZIndex":
                if (typeCast(SpreadsheetTabInfo.$, a) !== null) {
                    this._t._q();
                }
                break;
        }
        _super.prototype.e.call(this, a, b, c);
    };
    Object.defineProperty(SpreadsheetTabManager.prototype, "_o", {
        get: function () {
            return this._m;
        },
        set: function (a) {
            if (this._m != a) {
                if (this._m != null) {
                    this._m._r = false;
                }
                this._m = a;
                if (this._m != null) {
                    this._m._r = true;
                }
                this.a("ActiveTab");
                if (this._x != null) {
                    if (a != null) {
                        this._x.windowOptions._ae(a._j, false);
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_aq", {
        get: function () {
            return this._an;
        },
        set: function (a) {
            if (this._an != a) {
                this._an = a;
                this.a("ActualWidth");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_as", {
        get: function () {
            return this._ao;
        },
        set: function (a) {
            if (this._ao != a) {
                this._ao = a;
                this.a("ExtraAvailableWidth");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_aw", {
        get: function () {
            return this._au;
        },
        set: function (a) {
            if (this._au != a) {
                this._au = a;
                this.a("FirstVisibleTabIndex");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_at", {
        get: function () {
            return this._ap;
        },
        set: function (a) {
            if (!isNaN_(a)) {
                if (this._ap != a) {
                    this._ap = a;
                    this.a("InterTabSpacing");
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_ac", {
        get: function () {
            return this._aa(32);
        },
        set: function (a) {
            this._aj(32, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_ae", {
        get: function () {
            return this._aa(64);
        },
        set: function (a) {
            this._aj(64, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_ah", {
        get: function () {
            return this._z;
        },
        set: function (a) {
            if (this._z != a) {
                this._z = a;
                this.a("IsVisible");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_ai", {
        get: function () {
            return this._aa(256);
        },
        set: function (a) {
            if (this._aj(256, a)) {
                this._ba(16);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_j", {
        get: function () {
            return this._h;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_w", {
        get: function () {
            return this._v;
        },
        set: function (a) {
            if (this._v != a) {
                this._v = a;
                this.a("ScrollBars");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_p", {
        get: function () {
            return this._n;
        },
        set: function (a) {
            if (a != this._n) {
                var b = this._n;
                this._n = a;
                if (b != null) {
                    b._s = false;
                }
                if (this._n != null) {
                    this._n._s = true;
                }
                this.a("TabInEdit");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_k", {
        get: function () {
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_ak", {
        get: function () {
            return this._s;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_a1", {
        get: function () {
            return this._av;
        },
        set: function (a) {
            if (this._av != a) {
                this._av = a;
                this.a("Width");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_y", {
        get: function () {
            return this._x;
        },
        set: function (a) {
            if (a != this._x) {
                this._x = a;
                this._ba(15);
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabManager.prototype, "_al", {
        get: function () {
            return this._t;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabManager.prototype._a4 = function (a) {
        if (a < this._aw) {
            this._aw = a;
        }
        else {
            var b = this._az(this._aq + this._as);
            if (b < a) {
                this._aw = this._ax(a);
            }
        }
    };
    SpreadsheetTabManager.prototype._a5 = function (a) {
        var e_282, _0;
        if (this._x == null) {
            return;
        }
        this._bd();
        var b = this._au;
        var c = this._m != null ? this._m._aa : -1;
        switch (a) {
            case 5:
                this._aw = this._a0(b + 1, true, b);
                break;
            case 4:
                this._aw = this._a0(b - 1, false, b);
                break;
            case 2:
                this._aw = this._a0(0, true, b);
                break;
            case 3:
                var d = this._ax(this._k.count - 1);
                if (this._aw < d || this._aw >= this._k.count) {
                    this._aw = d;
                }
                break;
            case 7:
                this._a2(this._az(this._aq) + 1, true);
                break;
            case 6:
                this._a2(this._aw - 1, false);
                break;
            case 8:
                this._a2(c + 1, true);
                break;
            case 9:
                this._a2(c - 1, false);
                break;
            case 10:
                this._a2(c + 1, true, true);
                break;
            case 11:
                this._a2(c - 1, false, true);
                break;
            case 0:
                this._a3(1, c + 1);
                break;
            case 1:
                this._a3(Math.max(this._r.count, 1), Math.max(c, 0));
                break;
            case 12:
                {
                    this._r.beginUpdate();
                    this._r.clear();
                    try {
                        for (var _1 = tslib_1.__values(fromEnum(this._i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                            var e = _2.value;
                            if (e._l == 0) {
                                this._r.add(e);
                            }
                        }
                    }
                    catch (e_282_1) { e_282 = { error: e_282_1 }; }
                    finally {
                        try {
                            if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                        }
                        finally { if (e_282) throw e_282.error; }
                    }
                    this._r.endUpdate();
                    this._bb(4, true);
                }
                break;
            case 13:
                {
                    var f = this._m;
                    this._r.beginUpdate();
                    this._r.clear();
                    if (this._m != null) {
                        this._r.add(this._m);
                    }
                    this._r.endUpdate();
                    this._bb(4, true);
                }
                break;
            case 14:
                {
                    var g = this._x._worksheets$i;
                    var h = Enumerable.a(Worksheet.$, Enumerable.o(SpreadsheetTabInfo.$, Worksheet.$, this._h, function (i) { return i._j; }));
                    var i = c;
                    var j = i;
                    for (var l = 0; l < h.length; l++) {
                        var k = h[l];
                        if (k.index < i) {
                            j--;
                        }
                    }
                    for (var n = 0; n < h.length; n++) {
                        var m = h[n];
                        g.remove_1(m);
                    }
                    if (g.count > 0) {
                        var o = Enumerable.ag(Worksheet.$, Enumerable.r(Worksheet.$, g, j), function (p) { return p.displayOptions.visibility == 0; });
                        if (o == null) {
                            for (var p = j - 1; p >= 0; p--) {
                                if (g._item(p).displayOptions.visibility == 0) {
                                    o = g._item(p);
                                    break;
                                }
                            }
                        }
                        if (o != null) {
                            this._x.windowOptions.selectedWorksheet = o;
                        }
                    }
                    break;
                }
        }
    };
    SpreadsheetTabManager.prototype._ay = function () {
        return this._az(this._aq);
    };
    SpreadsheetTabManager.prototype._a0 = function (a, b, c) {
        if (a >= 0 && a < this._i.count) {
            var d = b ? this._i.count : -1;
            var e = b ? 1 : -1;
            for (var f = a; f != d; f += e) {
                if (this._i.item(f)._l == 0) {
                    return f;
                }
            }
        }
        return c;
    };
    SpreadsheetTabManager.prototype._af = function (a) {
        return a == this._r || a == this._h;
    };
    SpreadsheetTabManager.prototype._ag = function (a) {
        return a == this._i || a == this._g;
    };
    SpreadsheetTabManager.prototype._a6 = function (a) {
        if (SpreadsheetTabManager._ad(a.a)) {
            this._am.add(a);
            this._u.m();
        }
    };
    SpreadsheetTabManager.prototype._a7 = function (a) {
        this._p = a;
    };
    SpreadsheetTabManager.prototype._a8 = function () {
        this._p = null;
    };
    SpreadsheetTabManager.prototype._bd = function () {
        var _this = this;
        var e_283, _0;
        this._u.i();
        this._a9();
        this._g.beginUpdate();
        this._r.beginUpdate();
        if (this._aa(1)) {
            this._bb(1, false);
            this._bb(2 | 4 | 16, true);
            this._be();
        }
        if (this._aa(2)) {
            if (this._x == null) {
                this._o = null;
            }
            else {
                this._l._ix();
                this._o = Enumerable.ag(SpreadsheetTabInfo.$, this._i, function (a) { return a._j == _this._x.windowOptions.selectedWorksheet; });
            }
            this._bb(4, true);
            this._bb(2, false);
        }
        if (this._aa(4)) {
            this._bb(4, false);
            var a = false;
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._i)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var b = _2.value;
                    if (b._u != b._j._w) {
                        a = true;
                        break;
                    }
                }
            }
            catch (e_283_1) { e_283 = { error: e_283_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_283) throw e_283.error; }
            }
            if (a) {
                var c = Enumerable.a(SpreadsheetTabInfo.$, Enumerable.u(SpreadsheetTabInfo.$, this._i, function (d) { return d._j._w; }));
                this._r._a3(c);
            }
            else {
                var d = Enumerable.a(SpreadsheetTabInfo.$, Enumerable.x(SpreadsheetTabInfo.$, Number_$type, this._r, function (e) { return e._j.index; }));
                if (!CoreUtilities.d(SpreadsheetTabInfo.$, boxArray$1(d), this._r)) {
                    this._r._a3(d);
                }
            }
            if (this._m != null && !this._r.contains(this._m)) {
                this._r.clear();
                if (this._m != null) {
                    this._r.add(this._m);
                }
            }
        }
        if (this._aa(16)) {
            for (var e = 0, f = this._i.count; e < f; e++) {
                var g = this._i.item(e);
                g._ah();
                g._aa = e;
                g._v = this._ai;
            }
            this._bb(16, false);
        }
        if (this._aa(8)) {
            this._bc();
        }
        this._g.endUpdate();
        this._r.endUpdate();
    };
    SpreadsheetTabManager.prototype._a2 = function (a, b, c) {
        if (c === void 0) { c = false; }
        var d = this._a0(a, b, -1);
        if (d < 0) {
            return;
        }
        this._x.windowOptions._ae(this._i.item(d)._j, false);
        if (c) {
            var e = this._i.item(d);
            if (!e._u) {
                this._r.add(e);
                this._ba(4);
            }
        }
        this._a4(d);
    };
    SpreadsheetTabManager.prototype._a3 = function (a, b) {
        var e_284, _0;
        var c = 0;
        var d = this._x._sheets$i;
        var e = this._x._worksheets$i;
        try {
            for (var _1 = tslib_1.__values(fromEnum(d)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var f = _2.value;
                c = Math.max(c, f._am);
            }
        }
        catch (e_284_1) { e_284 = { error: e_284_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_284) throw e_284.error; }
        }
        var g = b;
        var h = 1;
        if (b >= 0 && b < e.count) {
            b = e._item(b).sheetIndex;
        }
        else if (b > 0 && b == e.count) {
            b = e._item(b - 1).sheetIndex + 1;
        }
        for (var i = 0; i < a; i++) {
            c++;
            var j = null;
            do {
                h++;
                j = this._l._fs("NewSheetName", h);
            } while (d.exists(j));
            d._insert1(b, j, c, 0);
            b++;
        }
        this._bd();
        this._a2(g, true);
    };
    SpreadsheetTabManager.prototype._aa = function (a) {
        return (this._q & a) != 0;
    };
    SpreadsheetTabManager.prototype._ax = function (a) {
        var b = this._aq;
        var c = a;
        for (var d = a; d >= 0; d--) {
            var e = this._k.item(d)._x;
            if (c != a) {
                e = Math.max(e + this._at, 0);
            }
            if (e > b) {
                break;
            }
            if (e > 0) {
                b -= e;
                a = d;
            }
        }
        return a;
    };
    SpreadsheetTabManager.prototype._az = function (a) {
        var b = this._i.count;
        var c = this._aw;
        for (; c < b; c++) {
            var d = Math.max(this._i.item(c)._x + this._at, 0);
            if (d > a) {
                return Math.max(c - 1, this._aw);
            }
            a -= d;
        }
        return Math.min(c, b - 1);
    };
    SpreadsheetTabManager.prototype._ab = function () {
        var a = this._x != null ? this._x._worksheets$i.count : 0;
        if (this._g.count != a) {
            return true;
        }
        if (a == 0) {
            return false;
        }
        var b = this._x._worksheets$i;
        for (var c = 0, d = this._g.count; c < d; c++) {
            if (this._g._inner[c]._j != b._item(c)) {
                return true;
            }
        }
        return false;
    };
    SpreadsheetTabManager._ad = function (a) {
        switch (a) {
            case 91:
            case 92:
            case 35:
            case 87:
            case 9:
            case 90:
            case 65:
            case 86: return true;
            default: return false;
        }
    };
    SpreadsheetTabManager.prototype._a9 = function () {
        var e_285, _0;
        var a = false;
        var b = false;
        var c = false;
        var d = false;
        var e = false;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._am)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var f = _2.value;
                switch (f.a) {
                    case 91:
                    case 92:
                        e = a = true;
                        break;
                    case 35:
                        switch (f.c) {
                            case "Reset":
                            case "Visibility":
                                e = b = c = true;
                                break;
                            case "TabColorInfo":
                                b = true;
                                break;
                            case "IsTabSelected":
                                c = true;
                                break;
                        }
                        break;
                    case 87:
                        if (f.c == "WorksheetMoved") {
                            e = a = true;
                        }
                        break;
                    case 90:
                    case 9:
                    case 65:
                        switch (f.c) {
                            case "Name":
                            case "IsProtected":
                                b = true;
                                break;
                            case "IsTabSelected":
                                c = true;
                                break;
                            case "TabColorInfo":
                                b = true;
                                break;
                        }
                        break;
                    case 86:
                        switch (f.c) {
                            case "Reset":
                                d = c = true;
                                break;
                            case "SelectedSheet":
                                c = true;
                                this._bb(128, true);
                                break;
                            case "ScrollBars":
                            case "TabBarVisible":
                            case "TabBarWidth":
                            case "FirstVisibleTabIndex":
                                d = true;
                                break;
                        }
                        break;
                }
            }
        }
        catch (e_285_1) { e_285 = { error: e_285_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_285) throw e_285.error; }
        }
        this._am.clear();
        if (a) {
            this._bb(1, true);
        }
        if (c) {
            this._bb(2 | 4, true);
        }
        if (b) {
            this._bb(16, true);
        }
        if (d) {
            this._bb(8, true);
        }
        if (e) {
            this._s._q();
        }
    };
    SpreadsheetTabManager.prototype._ba = function (a) {
        if ((this._q & a) != a) {
            this._bb(a, true);
            this._u.m();
        }
    };
    SpreadsheetTabManager.prototype._bb = function (a, b) {
        if (b) {
            this._q |= a;
        }
        else {
            this._q &= ~a;
        }
    };
    SpreadsheetTabManager.prototype._aj = function (a, b) {
        var c = this._q;
        if (b) {
            c |= a;
        }
        else {
            c &= ~a;
        }
        if (c == this._q) {
            return false;
        }
        this._q = c;
        this.a(EnumUtil.getName(SpreadsheetTabManager_InternalFlags_$type, a));
        return true;
    };
    SpreadsheetTabManager.prototype._bc = function () {
        this._bb(8, false);
        this._w = this._x != null ? this._x.windowOptions.scrollBars : 0;
        this._ah = this._x != null && this._x.windowOptions.tabBarVisible;
        if (this._x != null) {
            this._a1 = this._x.windowOptions.tabBarWidth;
            this._aw = this._x.windowOptions.firstVisibleTabIndex;
        }
    };
    SpreadsheetTabManager.prototype._be = function () {
        var e_286, _0, e_287, _1;
        this._g.beginUpdate();
        if (this._ab()) {
            var a_1 = new Dictionary$2(Worksheet.$, SpreadsheetTabInfo.$, 0);
            try {
                for (var _2 = tslib_1.__values(fromEnum(this._g)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var b = _3.value;
                    a_1.item(b._j, b);
                }
            }
            catch (e_286_1) { e_286 = { error: e_286_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_286) throw e_286.error; }
            }
            this._g.clear();
            if (this._x != null) {
                var _loop_33 = function (c) {
                    var d;
                    if (!((function () { var e = a_1.tryGetValue(c, d); d = e.p1; return e.ret; })())) {
                        d = new SpreadsheetTabInfo(c);
                    }
                    this_18._g.add(d);
                };
                var this_18 = this;
                try {
                    for (var _4 = tslib_1.__values(fromEnum(this._x._worksheets$i)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var c = _5.value;
                        _loop_33(c);
                    }
                }
                catch (e_287_1) { e_287 = { error: e_287_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_287) throw e_287.error; }
                }
            }
        }
        this._g.endUpdate();
    };
    SpreadsheetTabManager.$t = markType(SpreadsheetTabManager, 'SpreadsheetTabManager', PropertyChangeNotifierExtended.$);
    return SpreadsheetTabManager;
}(PropertyChangeNotifierExtended));
export { SpreadsheetTabManager };
/**
 * @hidden
 */
var SpreadsheetTabManager_SelectedTabsCollection = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabManager_SelectedTabsCollection, _super);
    function SpreadsheetTabManager_SelectedTabsCollection(a) {
        var _this = _super.call(this, SpreadsheetTabInfo.$, 0) || this;
        _this._a5 = null;
        _this._a5 = a;
        return _this;
    }
    SpreadsheetTabManager_SelectedTabsCollection.prototype.get__ai = function () {
        return true;
    };
    SpreadsheetTabManager_SelectedTabsCollection.prototype._au = function (a) {
        a._j._w = true;
        a._u = true;
        _super.prototype._au.call(this, a);
    };
    SpreadsheetTabManager_SelectedTabsCollection.prototype._ax = function (a) {
        if (this._a5._y != null) {
            a._j._w = false;
        }
        a._u = false;
        _super.prototype._ax.call(this, a);
    };
    SpreadsheetTabManager_SelectedTabsCollection.$t = markType(SpreadsheetTabManager_SelectedTabsCollection, 'SpreadsheetTabManager_SelectedTabsCollection', ObservableCollectionExtended$1.$.specialize(SpreadsheetTabInfo.$));
    return SpreadsheetTabManager_SelectedTabsCollection;
}(ObservableCollectionExtended$1));
export { SpreadsheetTabManager_SelectedTabsCollection };
/**
 * @hidden
 */
var SpreadsheetTabManager_VisibleTabsCollection = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabManager_VisibleTabsCollection, _super);
    function SpreadsheetTabManager_VisibleTabsCollection(a) {
        var _this = _super.call(this, SpreadsheetTabInfo.$) || this;
        _this._p = null;
        _this._p = a;
        return _this;
    }
    SpreadsheetTabManager_VisibleTabsCollection.prototype._o = function (a) {
        var e_288, _0;
        a.clear();
        try {
            for (var _1 = tslib_1.__values(fromEnum(this._p)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                if (b._l == 0) {
                    a.add(b);
                }
            }
        }
        catch (e_288_1) { e_288 = { error: e_288_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_288) throw e_288.error; }
        }
    };
    SpreadsheetTabManager_VisibleTabsCollection.prototype._q = function () {
        this._h();
    };
    SpreadsheetTabManager_VisibleTabsCollection.$t = markType(SpreadsheetTabManager_VisibleTabsCollection, 'SpreadsheetTabManager_VisibleTabsCollection', LazyReadOnlyNotifyCollection$1.$.specialize(SpreadsheetTabInfo.$));
    return SpreadsheetTabManager_VisibleTabsCollection;
}(LazyReadOnlyNotifyCollection$1));
export { SpreadsheetTabManager_VisibleTabsCollection };
/**
 * @hidden
 */
var SpreadsheetTabManager_ZIndexTabsCollection = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabManager_ZIndexTabsCollection, _super);
    function SpreadsheetTabManager_ZIndexTabsCollection(a) {
        var _this = _super.call(this, SpreadsheetTabInfo.$) || this;
        _this._p = null;
        _this._p = a;
        return _this;
    }
    SpreadsheetTabManager_ZIndexTabsCollection.prototype._o = function (a) {
        var e_289, _0;
        a.clear();
        try {
            for (var _1 = tslib_1.__values(fromEnum(Enumerable.x(SpreadsheetTabInfo.$, Number_$type, this._p, function (c) { return c._ab; }))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                a.add(b);
            }
        }
        catch (e_289_1) { e_289 = { error: e_289_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_289) throw e_289.error; }
        }
    };
    SpreadsheetTabManager_ZIndexTabsCollection.prototype._q = function () {
        this._h();
    };
    SpreadsheetTabManager_ZIndexTabsCollection.$t = markType(SpreadsheetTabManager_ZIndexTabsCollection, 'SpreadsheetTabManager_ZIndexTabsCollection', LazyReadOnlyNotifyCollection$1.$.specialize(SpreadsheetTabInfo.$));
    return SpreadsheetTabManager_ZIndexTabsCollection;
}(LazyReadOnlyNotifyCollection$1));
export { SpreadsheetTabManager_ZIndexTabsCollection };
/**
 * @hidden
 */
var SpreadsheetUndoTransaction = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetUndoTransaction, _super);
    function SpreadsheetUndoTransaction(a, b, c, d, e) {
        var _this = _super.call(this, null, null) || this;
        _this._an = null;
        _this._ah = null;
        _this._ak = null;
        _this._aj = 0;
        _this._al = null;
        CoreUtilities.z(b, "sheet");
        _this._an = a == null ? null : new WeakReference(a);
        _this._al = d;
        _this._aj = c;
        _this._ah = e;
        _this._ak = b;
        return _this;
    }
    SpreadsheetUndoTransaction.prototype.k = function (a) {
        return new SpreadsheetUndoTransaction(this._ai, this._ak, this._aj, this._al, this._ah);
    };
    SpreadsheetUndoTransaction.prototype.b = function (a) {
        var b = this._ai;
        if (b != null) {
            b._ir();
        }
        try {
            var c = _super.prototype.b.call(this, a);
            var d = this._ak.workbook;
            if (d != null) {
                d.windowOptions.selectedSheet = this._ak;
            }
            return c;
        }
        finally {
            if (b != null) {
                b._ia();
            }
        }
    };
    SpreadsheetUndoTransaction.prototype.e = function (a, b) {
        var c = "Undo_" + enumGetBox(SpreadsheetTransactionOperation_$type, this._aj);
        var d = this._am(this._ah);
        return SpreadsheetUtilities.di(this._ai, c, d, this._al);
    };
    Object.defineProperty(SpreadsheetUndoTransaction.prototype, "_ai", {
        get: function () {
            return typeCast(Spreadsheet.$, CoreUtilities.p(this._an));
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetUndoTransaction.prototype._am = function (a) {
        var b = this._ak.workbook;
        var c = b != null ? b.cellReferenceMode : 1;
        return SpreadsheetCellRange._ag(boxArray$1(a), c);
    };
    Object.defineProperty(SpreadsheetUndoTransaction.prototype, "sheet", {
        get: function () {
            return this._ak;
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetUndoTransaction.$t = markType(SpreadsheetUndoTransaction, 'SpreadsheetUndoTransaction', UndoTransaction.$, [IWorksheetUndoUnit_$type]);
    return SpreadsheetUndoTransaction;
}(UndoTransaction));
export { SpreadsheetUndoTransaction };
/**
 * @hidden
 */
var SpreadsheetSelectionUndoTransaction = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSelectionUndoTransaction, _super);
    function SpreadsheetSelectionUndoTransaction(a, b, c, d, e, f, g) {
        var _this = _super.call(this, a, b, c, d, e) || this;
        _this._ap = null;
        _this._ao = null;
        CoreUtilities.z(g, "setSelection");
        _this._ap = g;
        _this._ao = f;
        return _this;
    }
    SpreadsheetSelectionUndoTransaction.prototype.k = function (a) {
        return new SpreadsheetSelectionUndoTransaction(this._ai, this._ak, this._aj, this._al, this._ah, this._ao, this._ap);
    };
    SpreadsheetSelectionUndoTransaction.prototype.b = function (a) {
        var b = this._ai;
        if (b != null) {
            b._ir();
        }
        try {
            var c = _super.prototype.b.call(this, a);
            this._ap(this._ao, false);
            return c;
        }
        finally {
            if (b != null) {
                b._ia();
            }
        }
    };
    SpreadsheetSelectionUndoTransaction.$t = markType(SpreadsheetSelectionUndoTransaction, 'SpreadsheetSelectionUndoTransaction', SpreadsheetUndoTransaction.$);
    return SpreadsheetSelectionUndoTransaction;
}(SpreadsheetUndoTransaction));
export { SpreadsheetSelectionUndoTransaction };
/**
 * @hidden
 */
var WorkbookUndoUnit$2 = /** @class */ (function (_super) {
    tslib_1.__extends(WorkbookUndoUnit$2, _super);
    function WorkbookUndoUnit$2($tContext, $tValue, a, b, c) {
        var _this = _super.call(this) || this;
        _this.$tContext = null;
        _this.$tValue = null;
        _this._g = null;
        _this._h = null;
        _this._k = null;
        _this._i = null;
        _this._j = null;
        _this.$tContext = $tContext;
        _this.$tValue = $tValue;
        _this.$type = _this.$type.specialize(_this.$tContext, _this.$tValue);
        _this._g = a;
        _this._h = b;
        _this._i = c;
        _this._k = c.l(a);
        _this._j = c.k(a);
        return _this;
    }
    WorkbookUndoUnit$2.prototype.b = function (a) {
        this._i.y(this._g, this._h);
        return false;
    };
    WorkbookUndoUnit$2.prototype.e = function (a, b) {
        return SpreadsheetUtilities.da(SpreadsheetUtilities.x(this._k), this._i.a, this._i.c);
    };
    WorkbookUndoUnit$2.prototype.get_d = function () {
        return this._k;
    };
    Object.defineProperty(WorkbookUndoUnit$2.prototype, "d", {
        get: function () {
            return this.get_d();
        },
        enumerable: true,
        configurable: true
    });
    WorkbookUndoUnit$2.prototype.get_sheet = function () {
        return this._j;
    };
    Object.defineProperty(WorkbookUndoUnit$2.prototype, "sheet", {
        get: function () {
            return this.get_sheet();
        },
        enumerable: true,
        configurable: true
    });
    WorkbookUndoUnit$2.$t = markType(WorkbookUndoUnit$2, 'WorkbookUndoUnit$2', WorkbookUndoUnitBase.$);
    return WorkbookUndoUnit$2;
}(WorkbookUndoUnitBase));
export { WorkbookUndoUnit$2 };
/**
 * @hidden
 */
export var ISpreadsheetVisualDataManager_$type = new Type(null, 'ISpreadsheetVisualDataManager');
/**
 * @hidden
 */
var SpreadsheetVisualDataManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetVisualDataManager, _super);
    function SpreadsheetVisualDataManager() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetVisualDataManager.prototype.exportVisualData = function (a) {
        var e_290, _0, e_291, _1, e_292, _2;
        var b = new SpreadsheetVisualData();
        var c = a._a8;
        var d = a._v.getLayoutManager();
        try {
            for (var _3 = tslib_1.__values(fromEnum(c._dm)), _4 = _3.next(); !_4.done; _4 = _3.next()) {
                var e = _4.value;
                b.rowHeaderAreas.add(this.b(a, e));
            }
        }
        catch (e_290_1) { e_290 = { error: e_290_1 }; }
        finally {
            try {
                if (_4 && !_4.done && (_0 = _3.return)) _0.call(_3);
            }
            finally { if (e_290) throw e_290.error; }
        }
        try {
            for (var _5 = tslib_1.__values(fromEnum(c._dg)), _6 = _5.next(); !_6.done; _6 = _5.next()) {
                var f = _6.value;
                b.columnHeaderAreas.add(this.b(a, f));
            }
        }
        catch (e_291_1) { e_291 = { error: e_291_1 }; }
        finally {
            try {
                if (_6 && !_6.done && (_1 = _5.return)) _1.call(_5);
            }
            finally { if (e_291) throw e_291.error; }
        }
        try {
            for (var _7 = tslib_1.__values(fromEnum(c._dl)), _8 = _7.next(); !_8.done; _8 = _7.next()) {
                var g = _8.value;
                b.cellAreas.add(this.a(a, g));
            }
        }
        catch (e_292_1) { e_292 = { error: e_292_1 }; }
        finally {
            try {
                if (_8 && !_8.done && (_2 = _7.return)) _2.call(_7);
            }
            finally { if (e_292) throw e_292.error; }
        }
        return b;
    };
    SpreadsheetVisualDataManager.prototype.a = function (a, b) {
        var c = new SpreadsheetCellAreaVisualData();
        var d = a._v._getPaneRect$i(b);
        c.relativeBounds = new RectData(d.x, d.y, d.width, d.height);
        this.c(b.columnScrollRegion, false, c.columns);
        this.c(b.rowScrollRegion, false, c.rows);
        return c;
    };
    SpreadsheetVisualDataManager.prototype.b = function (a, b) {
        var c = new SpreadsheetHeaderAreaVisualData();
        var d = a._v._getRect$i(b);
        c.relativeBounds = new RectData(d.x, d.y, d.width, d.height);
        this.c(b, true, c.items);
        return c;
    };
    SpreadsheetVisualDataManager.prototype.c = function (a, b, c) {
        var e_293, _0;
        var d = b ? a._l : a._m;
        try {
            for (var _1 = tslib_1.__values(fromEnum(d)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var e = _2.value;
                var f = new SpreadsheetRowColumnVisualData();
                f.index = e._j;
                f.offset = a._b4(e._m) * a._bx;
                f.extent = a._b4(e._i) * a._bx;
                c.add(f);
            }
        }
        catch (e_293_1) { e_293 = { error: e_293_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_293) throw e_293.error; }
        }
    };
    SpreadsheetVisualDataManager.$t = markType(SpreadsheetVisualDataManager, 'SpreadsheetVisualDataManager', Base.$, [ISpreadsheetVisualDataManager_$type]);
    return SpreadsheetVisualDataManager;
}(Base));
export { SpreadsheetVisualDataManager };
/**
 * @hidden
 */
var FormulaBarButtonAreaElement = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarButtonAreaElement, _super);
    function FormulaBarButtonAreaElement(a) {
        var _this = _super.call(this, a, "FormulaBarButtonContainer") || this;
        _this.cf = null;
        _this.cg = null;
        _this.cf = new ButtonVisualElement(_this, "FormulaBarCancelButton");
        _this.cg = new ButtonVisualElement(_this, "FormulaBarEnterButton");
        var b = a.g(SpreadsheetVisualElement.$).dq;
        b._h8(_this.cf, 78);
        b._h8(_this.cg, 75);
        return _this;
    }
    FormulaBarButtonAreaElement.prototype.b7 = function (a, b, c, d) {
        var e = a;
        this.cf.al(e, b, this.cf.a3, d);
        e += this.cf.a3;
        this.cg.al(e, b, this.cg.a3, d);
        e += this.cg.a3;
        _super.prototype.b7.call(this, a, b, c, d);
    };
    FormulaBarButtonAreaElement.$t = markType(FormulaBarButtonAreaElement, 'FormulaBarButtonAreaElement', VisualElement.$);
    return FormulaBarButtonAreaElement;
}(VisualElement));
export { FormulaBarButtonAreaElement };
/**
 * @hidden
 */
var FormulaBarNameBoxAreaElement = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarNameBoxAreaElement, _super);
    function FormulaBarNameBoxAreaElement(a) {
        var _this = _super.call(this, a, "FormulaBarNameBoxContainer") || this;
        _this.cf = null;
        _this.cf = new FormulaBarNameBoxElement(_this);
        var b = _this.cf;
        b.valueChanged = delegateCombine(b.valueChanged, runOn(_this, _this.cg));
        return _this;
    }
    FormulaBarNameBoxAreaElement.prototype.b7 = function (a, b, c, d) {
        this.cf.al(a, b, c, d);
        _super.prototype.b7.call(this, a, b, c, d);
    };
    FormulaBarNameBoxAreaElement.prototype.cg = function (a, b) {
        var c = this.g(SpreadsheetVisualElement.$);
        if (c != null) {
            var d = c.co;
            if (!c.dq._dw(this.cf.co, d != null && (d.ba & 4) != 0, d != null && (d.ba & 2) != 0)) {
                this.cf.co = c.dq._ft;
            }
        }
    };
    FormulaBarNameBoxAreaElement.$t = markType(FormulaBarNameBoxAreaElement, 'FormulaBarNameBoxAreaElement', VisualElement.$);
    return FormulaBarNameBoxAreaElement;
}(VisualElement));
export { FormulaBarNameBoxAreaElement };
/**
 * @hidden
 */
var FormulaBarNameBoxElement = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarNameBoxElement, _super);
    function FormulaBarNameBoxElement(a) {
        var _this = _super.call(this, a, "ComboBox") || this;
        _this.cr = null;
        return _this;
    }
    FormulaBarNameBoxElement.$t = markType(FormulaBarNameBoxElement, 'FormulaBarNameBoxElement', ComboBoxVisualElement.$);
    return FormulaBarNameBoxElement;
}(ComboBoxVisualElement));
export { FormulaBarNameBoxElement };
/**
 * @hidden
 */
var FormulaBarNameBoxSplitter = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarNameBoxSplitter, _super);
    function FormulaBarNameBoxSplitter(a) {
        var _this = _super.call(this, a, "FormulaBarNameBoxSplitter") || this;
        _this.cq = 0;
        _this.cp = 0;
        return _this;
    }
    FormulaBarNameBoxSplitter.prototype.cm = function () {
        var a = this.g(FormulaBarVisualElement.$);
        var b = a.g(SpreadsheetVisualElement.$);
        this.cq = b.dq.nameBoxWidth;
        this.cp = Math.max(this.cq, a.a4 - (this.a3 + a.cf.a1 + a.ci.az));
        _super.prototype.cm.call(this);
    };
    FormulaBarNameBoxSplitter.prototype.ck = function (a, b) {
    };
    FormulaBarNameBoxSplitter.prototype.cl = function (a, b) {
        var c = this.g(SpreadsheetVisualElement.$);
        c.dq.nameBoxWidth = Math.max(Math.min(this.cq + a, this.cp), 102);
    };
    FormulaBarNameBoxSplitter.prototype.ad = function (a) {
        if (a.a() == 1) {
            if (a.e() == 2) {
                var b = this.g(SpreadsheetVisualElement.$);
                if (b != null) {
                    b.dq.executeCommand(169);
                    return true;
                }
            }
        }
        return _super.prototype.ad.call(this, a);
    };
    FormulaBarNameBoxSplitter.$t = markType(FormulaBarNameBoxSplitter, 'FormulaBarNameBoxSplitter', AdjustableVisualElement.$);
    return FormulaBarNameBoxSplitter;
}(AdjustableVisualElement));
export { FormulaBarNameBoxSplitter };
/**
 * @hidden
 */
var FormulaBarTextAreaElement = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarTextAreaElement, _super);
    function FormulaBarTextAreaElement(a) {
        var _this = _super.call(this, a, "FormulaBarTextAreaContainer") || this;
        _this.cf = null;
        _this.cg = null;
        _this.ch = 0;
        _this.ci = 3;
        _this.cg = new ToggleButtonVisualElement(_this, "ToggleButton");
        _this.cf = new TextBoxVisualElement(_this, "TextBox");
        var b = _this.cf;
        b.textChanged = delegateCombine(b.textChanged, runOn(_this, _this.ck));
        var c = _this.cg;
        c.isCheckedChanged = delegateCombine(c.isCheckedChanged, runOn(_this, _this.cj));
        _this.cl();
        return _this;
    }
    FormulaBarTextAreaElement.prototype.ad = function (a) {
        var b = this.g(SpreadsheetVisualElement.$).dq;
        if (b.isInEditMode && a.a() == 2) {
            return b._at.j(5, this, a.h());
        }
        return _super.prototype.ad.call(this, a);
    };
    FormulaBarTextAreaElement.prototype.b7 = function (a, b, c, d) {
        this.cg.al(a + c - this.cg.a3, b, this.cg.a3, this.cg.av);
        this.cf.al(a, b, c - this.cg.a3, d);
        _super.prototype.b7.call(this, a, b, c, d);
    };
    FormulaBarTextAreaElement.prototype.cj = function (a, b) {
        if (this.cg.cl) {
            var c = this.ci;
            var d = this._parent.co();
            if (c > d) {
                this.ci = d;
            }
        }
        this.cl();
        this._parent.cr();
    };
    FormulaBarTextAreaElement.prototype.ck = function (a, b) {
        var c = this.g(SpreadsheetVisualElement.$);
        if (c != null) {
            c.dq._ha(this.cf.co);
        }
    };
    FormulaBarTextAreaElement.prototype.cl = function () {
        var a = this.cg.cl ? this.ci : 1;
        this.cf.cl = a;
    };
    FormulaBarTextAreaElement.$t = markType(FormulaBarTextAreaElement, 'FormulaBarTextAreaElement', VisualElement.$);
    return FormulaBarTextAreaElement;
}(VisualElement));
export { FormulaBarTextAreaElement };
/**
 * @hidden
 */
var FormulaBarTextAreaSplitter = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarTextAreaSplitter, _super);
    function FormulaBarTextAreaSplitter(a) {
        var _this = _super.call(this, a, "FormulaBarTextBoxSplitter") || this;
        _this.cp = false;
        _this.cs = 0;
        _this.cq = 0;
        _this.cr = 0;
        return _this;
    }
    FormulaBarTextAreaSplitter.prototype.cm = function () {
        var a = this._parent;
        this.cp = a.ci.cg.cl;
        this.cs = a.ci.ci;
        this.cq = a.ci.av;
        this.cr = Math.max(this.cs, a.co());
        _super.prototype.cm.call(this);
    };
    FormulaBarTextAreaSplitter.prototype.ck = function (a, b) {
        var c = this._parent;
        if (!c.ci.cg.cl) {
            c.ci.ci = this.cs;
        }
    };
    FormulaBarTextAreaSplitter.prototype.cl = function (a, b) {
        var c = this._parent;
        var d = Math.min(c.cn(b + this.cq), this.cr);
        if (d <= 1) {
            c.ci.ci = this.cs;
            c.ci.cg.cl = false;
        }
        else {
            c.ci.ci = d;
            c.ci.cg.cl = true;
        }
        c.ci.cl();
        c.cr();
    };
    FormulaBarTextAreaSplitter.$t = markType(FormulaBarTextAreaSplitter, 'FormulaBarTextAreaSplitter', AdjustableVisualElement.$);
    return FormulaBarTextAreaSplitter;
}(AdjustableVisualElement));
export { FormulaBarTextAreaSplitter };
/**
 * @hidden
 */
var FormulaBarVisualElement = /** @class */ (function (_super) {
    tslib_1.__extends(FormulaBarVisualElement, _super);
    function FormulaBarVisualElement(a) {
        var _this = _super.call(this, a, "FormulaBar") || this;
        _this.cg = null;
        _this.cf = null;
        _this.cj = null;
        _this.ch = null;
        _this.ci = null;
        _this.cm = 0;
        _this.ck = 0;
        _this.cl = 0;
        _this.cg = new FormulaBarNameBoxAreaElement(_this);
        _this.ch = new FormulaBarNameBoxSplitter(_this);
        _this.cf = new FormulaBarButtonAreaElement(_this);
        _this.ci = new FormulaBarTextAreaElement(_this);
        _this.cj = new FormulaBarTextAreaSplitter(_this);
        _this.cp();
        _this.ac = a.dq.isFormulaBarVisible;
        _this.ck = a.dq.nameBoxWidth;
        _this.cg.cf.u = !a.dq.isDisabled;
        _this.cg.cf.ck = a.dq._ef;
        _this.cg.cf.co = a.dq._ft;
        var b = a.dq;
        b.propertyChanged = delegateCombine(b.propertyChanged, runOn(_this, _this.cq));
        return _this;
    }
    FormulaBarVisualElement.prototype.bz = function () {
        var a = this._parent;
        if (a != null) {
            var b = a.dq;
            b.propertyChanged = delegateRemove(b.propertyChanged, runOn(this, this.cq));
        }
        _super.prototype.bz.call(this);
    };
    FormulaBarVisualElement.prototype.co = function () {
        var a = this.g(SpreadsheetVisualElement.$);
        var b = a.dq._ad.ax();
        var c = a.dr.av - b;
        return this.cn(this.ci.av + c);
    };
    FormulaBarVisualElement.prototype.cp = function () {
        var a = this._parent.dq._a1;
        this.ch.a3 = a.ap.width;
        this.cg.h = a.c;
        this.cf.h = a.a;
        this.cf.cg.a3 = a.am.width;
        this.cf.cf.a3 = a.al.width;
        this.cj.av = a.ao.height;
        this.ci.ch = a.o - a.n;
        this.ci.cg.a3 = a.an.width;
        this.ci.cg.av = a.an.height;
        this.h = a.b;
        this.cr();
    };
    FormulaBarVisualElement.prototype.cq = function (a, b) {
        switch (b.propertyName) {
            case "IsFormulaBarVisible":
                this.ac = a.isFormulaBarVisible;
                break;
            case "NameBoxWidth":
                this.ck = a.nameBoxWidth;
                this.t = true;
                break;
            case "NameBoxValue":
                this.cg.cf.co = a._ft;
                break;
        }
    };
    FormulaBarVisualElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        var e = this.ck;
        var f = a;
        this.cg.al(f, b, e, this.cm);
        f += e;
        this.ch.al(f, b, this.ch.a3, this.cm);
        f += this.ch.a3;
        var g = this.cf.au(this.cf.cf.a3 + this.cf.cg.a3);
        this.cf.al(f, b, g, this.cm);
        f += g;
        this.ci.al(f, b, Math.max(c + a - f, 0), d - this.cj.av);
        this.cj.al(a, Math.max(b, b + d - this.cj.av), c, this.cj.av);
    };
    FormulaBarVisualElement.prototype.b8 = function () {
        var a = this._parent;
        var b = a.dq;
        b.propertyChanged = delegateRemove(b.propertyChanged, runOn(this, this.cq));
        _super.prototype.b8.call(this);
    };
    FormulaBarVisualElement.prototype.cr = function () {
        var a = this._parent.dq._a1;
        var b = this.cg.at(a.l);
        var c = a.ap.height;
        var d = this.cf.at(Math.max(a.am.height, a.al.height));
        var e = this.ci.at(Math.max(a.m, a.an.height));
        var f = Math.max(Math.max(b, c), Math.max(d, e));
        this.cm = f;
        var g = a.m;
        if (this.ci.cg.cl) {
            g += (a.o - a.n) * (this.ci.ci - 1);
        }
        g = this.ci.at(g);
        f += this.cj.av;
        g += this.cj.av;
        var h = this.cl;
        this.cl = Math.max(this.at(f), this.at(g));
        if (h != this.cl && this._parent != null) {
            this._parent.t = true;
        }
    };
    FormulaBarVisualElement.prototype.cn = function (a) {
        var b = this.cm;
        var c = a - b;
        if (c <= 0) {
            return 1;
        }
        else {
            return 1 + truncate(Math.floor(c / this.ci.ch));
        }
    };
    FormulaBarVisualElement.$t = markType(FormulaBarVisualElement, 'FormulaBarVisualElement', VisualElement.$);
    return FormulaBarVisualElement;
}(VisualElement));
export { FormulaBarVisualElement };
/**
 * @hidden
 */
var SpreadsheetAreaVisualElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetAreaVisualElement, _super);
    function SpreadsheetAreaVisualElement(a) {
        var _this = _super.call(this, a, "SpreadsheetArea") || this;
        _this.cf = null;
        return _this;
    }
    SpreadsheetAreaVisualElement.prototype.ai = function (a, b) {
        if (this.cf.c != null) {
            this.cf.c._d1(b * -3, a.g() == 2);
            return true;
        }
        return _super.prototype.ai.call(this, a, b);
    };
    SpreadsheetAreaVisualElement.prototype.ag = function (a) {
        if (a.b()) {
            this.cf.dj(a.h());
            return true;
        }
        return _super.prototype.ag.call(this, a);
    };
    SpreadsheetAreaVisualElement.prototype.ah = function (a) {
        if (a.b()) {
            this.cf.dk();
            return true;
        }
        return _super.prototype.ah.call(this, a);
    };
    SpreadsheetAreaVisualElement.prototype.b4 = function () {
        this.cf.cc();
        _super.prototype.b4.call(this);
    };
    SpreadsheetAreaVisualElement.prototype.an = function (a, b, c, d) {
        var e = _super.prototype.an.call(this, a, b, c, d);
        if (e) {
            this.cf.cx();
        }
        return e;
    };
    SpreadsheetAreaVisualElement.$t = markType(SpreadsheetAreaVisualElement, 'SpreadsheetAreaVisualElement', VisualElement.$);
    return SpreadsheetAreaVisualElement;
}(VisualElement));
export { SpreadsheetAreaVisualElement };
/**
 * @hidden
 */
var SpreadsheetInplaceBackgroundElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetInplaceBackgroundElement, _super);
    function SpreadsheetInplaceBackgroundElement(a) {
        var _this = _super.call(this, a, "InplaceBackground") || this;
        _this.cf = null;
        _this.ch = false;
        _this.cm = null;
        _this.ci = false;
        _this.cl = null;
        _this.w = false;
        return _this;
    }
    SpreadsheetInplaceBackgroundElement.prototype.an = function (a, b, c, d) {
        var e = _super.prototype.an.call(this, a, b, c, d);
        if (e) {
            this.cj = true;
        }
        return e;
    };
    Object.defineProperty(SpreadsheetInplaceBackgroundElement.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (a != this.cf) {
                this.cf = a;
                this.cj = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceBackgroundElement.prototype, "cn", {
        get: function () {
            return this.cm;
        },
        set: function (a) {
            if (Rect.l_op_Inequality(a, this.cm)) {
                this.cm = a;
                this.ck = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceBackgroundElement.prototype, "cj", {
        get: function () {
            return this.ch;
        },
        set: function (a) {
            if (a != this.ch) {
                this.ch = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceBackgroundElement.prototype, "ck", {
        get: function () {
            return this.ci;
        },
        set: function (a) {
            if (a != this.ci) {
                this.ci = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetInplaceBackgroundElement.$t = markType(SpreadsheetInplaceBackgroundElement, 'SpreadsheetInplaceBackgroundElement', VisualElement.$);
    return SpreadsheetInplaceBackgroundElement;
}(VisualElement));
export { SpreadsheetInplaceBackgroundElement };
/**
 * @hidden
 */
var SpreadsheetInplaceEditorElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetInplaceEditorElement, _super);
    function SpreadsheetInplaceEditorElement(a) {
        var _this = _super.call(this, a, "InplaceEditor") || this;
        _this.dd = null;
        _this.cm = false;
        _this.ct = false;
        _this.cu = true;
        _this.c8 = null;
        _this.cl = false;
        _this.df = null;
        _this.cq = false;
        _this.ch = null;
        _this.cn = false;
        _this.cf = 0;
        _this.cp = false;
        _this.cj = 0;
        _this.cr = false;
        _this.db = new Color();
        _this.co = false;
        _this.c5 = 0;
        _this.cs = false;
        _this.cellValueChanged = null;
        _this.w = _this.c3;
        return _this;
    }
    SpreadsheetInplaceEditorElement.prototype.ad = function (a) {
        var b = this.g(SpreadsheetVisualElement.$).dq;
        if (b.isInEditMode && a.a() == 2) {
            return b._at.j(4, this, a.h());
        }
        return _super.prototype.ad.call(this, a);
    };
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c9", {
        get: function () {
            return this.c8;
        },
        set: function (a) {
            if (a != this.c8) {
                this.c8 = a;
                this.cv = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "de", {
        get: function () {
            return this.dd;
        },
        set: function (a) {
            if (Rect.l_op_Inequality(a, this.dd)) {
                this.dd = a;
                this.cw = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "ci", {
        get: function () {
            return this.ch;
        },
        set: function (a) {
            if (this.ch != a) {
                this.ch = a;
                this.cx = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "dc", {
        get: function () {
            return this.db;
        },
        set: function (a) {
            if (Color.d(this.db, a)) {
                this.db = a;
                this.cy = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cv", {
        get: function () {
            return this.cl;
        },
        set: function (a) {
            if (a != this.cl) {
                this.cl = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cw", {
        get: function () {
            return this.cm;
        },
        set: function (a) {
            if (a != this.cm) {
                this.cm = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cx", {
        get: function () {
            return this.cn;
        },
        set: function (a) {
            if (a != this.cn) {
                this.cn = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cy", {
        get: function () {
            return this.co;
        },
        set: function (a) {
            if (a != this.co) {
                this.co = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cz", {
        get: function () {
            return this.cp;
        },
        set: function (a) {
            if (a != this.cp) {
                this.cp = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c0", {
        get: function () {
            return this.cq;
        },
        set: function (a) {
            if (a != this.cq) {
                this.cq = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c1", {
        get: function () {
            return this.cr;
        },
        set: function (a) {
            if (a != this.cr) {
                this.cr = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c2", {
        get: function () {
            return this.cs;
        },
        set: function (a) {
            if (a != this.cs) {
                this.cs = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (this.cf != a) {
                this.cf = a;
                this.cz = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c3", {
        get: function () {
            return this.ct;
        },
        set: function (a) {
            if (a != this.ct) {
                this.ct = a;
                this.c4 = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c4", {
        get: function () {
            return this.cu;
        },
        set: function (a) {
            if (a != this.cu) {
                this.cu = a;
                this.w = this.c3;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "dg", {
        get: function () {
            return this.df;
        },
        set: function (a) {
            if (this.df != a) {
                this.df = a;
                this.c0 = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "ck", {
        get: function () {
            return this.cj;
        },
        set: function (a) {
            if (this.cj != a) {
                this.cj = a;
                this.c1 = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetInplaceEditorElement.prototype, "c6", {
        get: function () {
            return this.c5;
        },
        set: function (a) {
            if (this.c5 != a) {
                this.c5 = a;
                this.c2 = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetInplaceEditorElement.prototype.da = function () {
        var a = this.cellValueChanged;
        if (a != null) {
            a(this, EventArgs.empty);
        }
    };
    SpreadsheetInplaceEditorElement.$t = markType(SpreadsheetInplaceEditorElement, 'SpreadsheetInplaceEditorElement', VisualElement.$);
    return SpreadsheetInplaceEditorElement;
}(VisualElement));
export { SpreadsheetInplaceEditorElement };
/**
 * @hidden
 */
var SpreadsheetInputMessageElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetInputMessageElement, _super);
    function SpreadsheetInputMessageElement(a) {
        var _this = _super.call(this, a, "InputMessage") || this;
        _this.cl = null;
        _this.ck = null;
        _this.ch = false;
        _this.cj = 0;
        _this.ci = 0;
        _this.cf = null;
        _this.cg = null;
        _this.cg = new VisualElement(_this, "InputMessageTitle");
        _this.cf = new VisualElement(_this, "InputMessageBody");
        _this.cg.q = false;
        _this.cf.q = false;
        return _this;
    }
    SpreadsheetInputMessageElement.prototype.cm = function (a, b) {
        this.ch = this.ch || a != this.cl || b != this.ck;
        this.cl = a;
        this.ck = b;
        if (this.ch) {
            this.b1();
        }
    };
    SpreadsheetInputMessageElement.prototype.get_x = function () {
        return true;
    };
    SpreadsheetInputMessageElement.prototype.ad = function (a) {
        if (a.a() == 1) {
            if (a.e() == 2) {
                this._parent.cf.dh();
                return true;
            }
            else {
                var b = a.h();
                var c = { $type: Point_$type, x: b.x + this.ax, y: b.y + this.a2 };
                this._parent.cf.eb(b, c);
                return true;
            }
        }
        return _super.prototype.ad.call(this, a);
    };
    SpreadsheetInputMessageElement.$t = markType(SpreadsheetInputMessageElement, 'SpreadsheetInputMessageElement', VisualElement.$);
    return SpreadsheetInputMessageElement;
}(VisualElement));
export { SpreadsheetInputMessageElement };
/**
 * @hidden
 */
var SpreadsheetPaneSplitterElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetPaneSplitterElement, _super);
    function SpreadsheetPaneSplitterElement(a, b) {
        var _this = _super.call(this, a, "PaneSplitter") || this;
        _this.cf = 0;
        _this.cf = b;
        return _this;
    }
    SpreadsheetPaneSplitterElement.prototype.get_x = function () {
        return true;
    };
    SpreadsheetPaneSplitterElement.prototype.ad = function (a) {
        var b = a.h();
        var c = { $type: Point_$type, x: b.x + this.ax, y: b.y + this.a2 };
        if (this._parent.cf.ak(this.cf, a, c)) {
            return true;
        }
        return _super.prototype.ad.call(this, a);
    };
    SpreadsheetPaneSplitterElement.prototype.ag = function (a) {
        if (this._parent.cf.al(a)) {
            return true;
        }
        return _super.prototype.ag.call(this, a);
    };
    SpreadsheetPaneSplitterElement.prototype.ah = function (a) {
        this._parent.cf.dq(a);
        return _super.prototype.ah.call(this, a);
    };
    SpreadsheetPaneSplitterElement.prototype.b4 = function () {
        this._parent.cf.dp();
        _super.prototype.b4.call(this);
    };
    SpreadsheetPaneSplitterElement.$t = markType(SpreadsheetPaneSplitterElement, 'SpreadsheetPaneSplitterElement', VisualElement.$);
    return SpreadsheetPaneSplitterElement;
}(VisualElement));
export { SpreadsheetPaneSplitterElement };
/**
 * @hidden
 */
var SpreadsheetSelectAllButtonElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetSelectAllButtonElement, _super);
    function SpreadsheetSelectAllButtonElement(a) {
        var _this = _super.call(this, a, "SelectAllButton") || this;
        _this.cf = false;
        return _this;
    }
    SpreadsheetSelectAllButtonElement.prototype.get_x = function () {
        return true;
    };
    SpreadsheetSelectAllButtonElement.prototype.ad = function (a) {
        var b = this._parent.cf.c;
        if (b._dv(a, this)) {
            return true;
        }
        return _super.prototype.ad.call(this, a);
    };
    Object.defineProperty(SpreadsheetSelectAllButtonElement.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (a != this.cf) {
                this.cf = a;
                this.s = a;
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetSelectAllButtonElement.$t = markType(SpreadsheetSelectAllButtonElement, 'SpreadsheetSelectAllButtonElement', VisualElement.$);
    return SpreadsheetSelectAllButtonElement;
}(VisualElement));
export { SpreadsheetSelectAllButtonElement };
/**
 * @hidden
 */
var SpreadsheetShapeVisualElementBase = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetShapeVisualElementBase, _super);
    function SpreadsheetShapeVisualElementBase(a, b) {
        var _this = _super.call(this, a, b) || this;
        _this.cf = null;
        _this.ch = false;
        _this.cj = 0;
        _this.cl = 0;
        return _this;
    }
    Object.defineProperty(SpreadsheetShapeVisualElementBase.prototype, "cm", {
        get: function () {
            return this.cl;
        },
        set: function (a) {
            if (a != this.cl) {
                this.cl = a;
                this.ci = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetShapeVisualElementBase.prototype, "ck", {
        get: function () {
            return this.cj;
        },
        set: function (a) {
            if (a != this.cj) {
                this.cj = a;
                this.ci = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetShapeVisualElementBase.prototype, "cg", {
        get: function () {
            return this.cf;
        },
        set: function (a) {
            if (a != this.cf) {
                this.cf = a;
                this.ci = true;
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetShapeVisualElementBase.prototype, "ci", {
        get: function () {
            return this.ch;
        },
        set: function (a) {
            if (a != this.ch) {
                this.ch = a;
                if (a) {
                    this.b1();
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetShapeVisualElementBase.$t = markType(SpreadsheetShapeVisualElementBase, 'SpreadsheetShapeVisualElementBase', VisualElement.$);
    return SpreadsheetShapeVisualElementBase;
}(VisualElement));
export { SpreadsheetShapeVisualElementBase };
/**
 * @hidden
 */
var SpreadsheetShapeVisualElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetShapeVisualElement, _super);
    function SpreadsheetShapeVisualElement(a) {
        var _this = _super.call(this, a, "Shape") || this;
        _this.co = null;
        _this.cn = null;
        return _this;
    }
    SpreadsheetShapeVisualElement.prototype.an = function (a, b, c, d) {
        var e = this.a3;
        var f = this.av;
        var g = _super.prototype.an.call(this, a, b, c, d);
        if (g && (e != this.a3 || f != this.av)) {
            this.ci = true;
        }
        return g;
    };
    SpreadsheetShapeVisualElement.$t = markType(SpreadsheetShapeVisualElement, 'SpreadsheetShapeVisualElement', SpreadsheetShapeVisualElementBase.$);
    return SpreadsheetShapeVisualElement;
}(SpreadsheetShapeVisualElementBase));
export { SpreadsheetShapeVisualElement };
/**
 * @hidden
 */
var SpreadsheetChartVisualElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetChartVisualElement, _super);
    function SpreadsheetChartVisualElement(a, b, c) {
        var _this = _super.call(this, a, "Chart") || this;
        _this.cn = null;
        _this.cp = null;
        _this.cr = null;
        _this.cq = null;
        _this.co = null;
        _this.cn = c;
        _this.cp = b;
        return _this;
    }
    SpreadsheetChartVisualElement.prototype.bz = function () {
        _super.prototype.bz.call(this);
        this.cs();
    };
    SpreadsheetChartVisualElement.prototype.cs = function () {
        if (this.cq != null) {
            var a = this.co;
            var b = this.cq;
            this.cq = null;
            this.co = null;
            if (a != null) {
                a.i();
            }
            b.rootWrapper.remove();
            if (a != null) {
                a.h();
            }
        }
    };
    SpreadsheetChartVisualElement.$t = markType(SpreadsheetChartVisualElement, 'SpreadsheetChartVisualElement', SpreadsheetShapeVisualElementBase.$);
    return SpreadsheetChartVisualElement;
}(SpreadsheetShapeVisualElementBase));
export { SpreadsheetChartVisualElement };
/**
 * @hidden
 */
var SpreadsheetTabAreaSplitterElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabAreaSplitterElement, _super);
    function SpreadsheetTabAreaSplitterElement(a) {
        return _super.call(this, a, "TabAreaSplitter") || this;
    }
    SpreadsheetTabAreaSplitterElement.prototype.get_x = function () {
        return true;
    };
    SpreadsheetTabAreaSplitterElement.prototype.ad = function (a) {
        var b = a.h();
        var c = { $type: Point_$type, x: b.x + this.ax, y: b.y + this.a2 };
        if (this._parent.cf.an(b, c)) {
            return true;
        }
        return _super.prototype.ad.call(this, a);
    };
    SpreadsheetTabAreaSplitterElement.$t = markType(SpreadsheetTabAreaSplitterElement, 'SpreadsheetTabAreaSplitterElement', VisualElement.$);
    return SpreadsheetTabAreaSplitterElement;
}(VisualElement));
export { SpreadsheetTabAreaSplitterElement };
/**
 * @hidden
 */
var SpreadsheetTabItemAreaElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabItemAreaElement, _super);
    function SpreadsheetTabItemAreaElement(a, b) {
        var _this = _super.call(this, a, b) || this;
        _this.ci = null;
        _this.cl = null;
        _this.ck = null;
        _this.cj = null;
        _this.cg = null;
        _this.cm = null;
        _this.cf = null;
        _this.ch = null;
        _this.co = 0;
        _this.cp = 0;
        _this.ci = new ButtonVisualElement(_this, "TabScrollFirst");
        _this.cl = new RepeatButtonVisualElement(_this, "TabScrollPrev");
        _this.ck = new RepeatButtonVisualElement(_this, "TabScrollNext");
        _this.cj = new ButtonVisualElement(_this, "TabScrollLast");
        _this.cg = new ButtonVisualElement(_this, "TabActivatePrev");
        _this.cm = new SpreadsheetTabItemPanel(_this);
        _this.cf = new ButtonVisualElement(_this, "TabActivateNext");
        _this.ch = new ButtonVisualElement(_this, "AddWorksheetButton");
        var c = a.g(SpreadsheetVisualElement.$).dq;
        c._h8(_this.ci, 107);
        c._h8(_this.cl, 106);
        c._h8(_this.ck, 105);
        c._h8(_this.cj, 108);
        c._h8(_this.cg, 109);
        c._h8(_this.cf, 110);
        c._h8(_this.ch, 99);
        return _this;
    }
    SpreadsheetTabItemAreaElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        var e = this.cm.cf;
        var f = this.cp;
        if (!this.ch.ac) {
            f -= this.ch.a3;
        }
        var g = Math.min(c - f, e.a8().width);
        e.ad(g, d);
        var h = a;
        h = this.cn(h, b, d, this.ci);
        h = this.cn(h, b, d, this.cl);
        h = this.cn(h, b, d, this.ck);
        h = this.cn(h, b, d, this.cj);
        h = this.cn(h, b, d, this.cg);
        this.cm.al(h, b, g, d);
        h += g;
        h = this.cn(h, b, d, this.cf);
        if (this.ch.ac) {
            h = this.cn(h, b, d, this.ch);
        }
    };
    SpreadsheetTabItemAreaElement.prototype.an = function (a, b, c, d) {
        var e = _super.prototype.an.call(this, a, b, c, d);
        var f = this.cm.cf.a8().width;
        if (f != this.cm.a3) {
            this.t = true;
        }
        return e;
    };
    SpreadsheetTabItemAreaElement.prototype.cq = function () {
        var a = [this.ci, this.cj, this.ck, this.cl, this.cf, this.cg, this.ch];
        var b = this._parent;
        var c = b.cf.c._a1;
        var d = [c.ac, c.ae, c.ag, c.ai, c.g, c.i, c.k];
        var e = [c.ab, c.ad, c.af, c.ah, c.f, c.h, c.j];
        var f = 0;
        var g = 0;
        for (var h = 0; h < a.length; h++) {
            a[h].a3 = d[h];
            a[h].av = e[h];
            g += d[h];
            if (e[h] > f) {
                f = e[h];
            }
        }
        this.cp = g;
        this.co = f;
        this.t = true;
        b.cf.cx();
    };
    SpreadsheetTabItemAreaElement.prototype.cn = function (a, b, c, d) {
        var e = d.a3;
        d.al(a, b, e, c);
        return a + e;
    };
    SpreadsheetTabItemAreaElement.$t = markType(SpreadsheetTabItemAreaElement, 'SpreadsheetTabItemAreaElement', VisualElement.$);
    return SpreadsheetTabItemAreaElement;
}(VisualElement));
export { SpreadsheetTabItemAreaElement };
/**
 * @hidden
 */
var SpreadsheetTabItemElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabItemElement, _super);
    function SpreadsheetTabItemElement(a, b) {
        var _this = _super.call(this, a, "SheetTabItem") || this;
        _this.cn = 31;
        _this.cf = null;
        _this.cl = 0;
        _this.cv = -1;
        _this.cm = null;
        _this.cf = b;
        b.propertyChanged = delegateCombine(b.propertyChanged, runOn(_this, _this.cx));
        return _this;
    }
    SpreadsheetTabItemElement.prototype.get_x = function () {
        return true;
    };
    SpreadsheetTabItemElement.prototype.cy = function (a, b) {
        var c = this.cn;
        if (b) {
            c |= a;
        }
        else {
            c &= ~a;
        }
        if (c != this.cn) {
            this.cn = c;
            this.b1();
        }
    };
    Object.defineProperty(SpreadsheetTabItemElement.prototype, "ck", {
        get: function () {
            return (this.cn & 1) != 0;
        },
        set: function (a) {
            this.cy(1, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemElement.prototype, "ci", {
        get: function () {
            return (this.cn & 2) != 0;
        },
        set: function (a) {
            this.cy(2, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemElement.prototype, "cj", {
        get: function () {
            return (this.cn & 4) != 0;
        },
        set: function (a) {
            this.cy(4, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemElement.prototype, "cg", {
        get: function () {
            return (this.cn & 8) != 0;
        },
        set: function (a) {
            this.cy(8, a);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SpreadsheetTabItemElement.prototype, "ch", {
        get: function () {
            return (this.cn & 16) != 0;
        },
        set: function (a) {
            this.cy(16, a);
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabItemElement.prototype.cw = function () {
        if (this._parent != null) {
            this._parent.cf.aj();
        }
    };
    SpreadsheetTabItemElement.prototype.cx = function (a, b) {
        if (stringIsNullOrEmpty(b.propertyName)) {
            this.cv = -1;
            this.cy(31, true);
            this.cw();
        }
        else {
            switch (b.propertyName) {
                case "Name":
                    this.cv = -1;
                    this.ch = true;
                    this.cw();
                    break;
                case "Color":
                    this.cg = true;
                    break;
                case "IsActive":
                    this.ci = true;
                    break;
                case "IsSelected":
                    this.ck = true;
                    break;
                case "IsProtected":
                    this.cj = true;
                    this.cw();
                    break;
            }
        }
    };
    SpreadsheetTabItemElement.prototype.b4 = function () {
        this._parent.cf.ap();
        _super.prototype.b4.call(this);
    };
    SpreadsheetTabItemElement.prototype.ad = function (a) {
        if (this._parent.cf.q(a, this)) {
            return true;
        }
        return _super.prototype.ad.call(this, a);
    };
    SpreadsheetTabItemElement.prototype.ag = function (a) {
        if (this._parent.cf.t(a, this)) {
            return true;
        }
        return _super.prototype.ag.call(this, a);
    };
    SpreadsheetTabItemElement.prototype.ah = function (a) {
        return this._parent.cf.u(a, this);
    };
    SpreadsheetTabItemElement.prototype.bz = function () {
        var a = this.cf;
        a.propertyChanged = delegateRemove(a.propertyChanged, runOn(this, this.cx));
        _super.prototype.bz.call(this);
    };
    SpreadsheetTabItemElement.$t = markType(SpreadsheetTabItemElement, 'SpreadsheetTabItemElement', VisualElement.$);
    return SpreadsheetTabItemElement;
}(VisualElement));
export { SpreadsheetTabItemElement };
/**
 * @hidden
 */
var SpreadsheetTabItemElementLayoutManager = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabItemElementLayoutManager, _super);
    function SpreadsheetTabItemElementLayoutManager(a) {
        var _this = _super.call(this, SpreadsheetTabItemElement.$) || this;
        _this.ba = null;
        _this.bb = 0;
        _this.bc = 0;
        _this.a9 = null;
        _this.ba = a;
        return _this;
    }
    SpreadsheetTabItemElementLayoutManager.prototype.get_b = function () {
        return this.ba._parent._parent.cf.c;
    };
    Object.defineProperty(SpreadsheetTabItemElementLayoutManager.prototype, "b", {
        get: function () {
            return this.get_b();
        },
        enumerable: true,
        configurable: true
    });
    SpreadsheetTabItemElementLayoutManager.prototype.ae = function (a, b) {
        a.am(b);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.bd = function () {
        this.bc++;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.n = function () {
        return this.ba.d().cq(this.ba);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.o = function (a) {
        return this.ba.d().cq(a);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.f = function (a) {
        return new SpreadsheetTabItemElement(this.ba, a);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.y = function () {
        return this.b._a1.y;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.z = function (a) {
        return a.cl;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.a6 = function (a, b, c) {
        return { $type: Point_$type, x: a.ax + b, y: a.a2 + c };
    };
    SpreadsheetTabItemElementLayoutManager.prototype.d = function (a) {
        return a.cf;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.aa = function () {
        return this.ba.a3;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.ai = function () {
        if (this.ba._parent != null) {
            this.ba._parent.t = true;
        }
        this.b.scheduleArrange();
    };
    SpreadsheetTabItemElementLayoutManager.prototype.ak = function () {
        if (this.ba._parent != null) {
            this.ba._parent.t = true;
        }
        this.b.scheduleArrange();
    };
    SpreadsheetTabItemElementLayoutManager.prototype.al = function () {
        var a = this.a9;
        this.a9 = null;
        if (a != null) {
            a.ab = true;
        }
        this.ba.bw = null;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.an = function () {
        if (this.a9 == null) {
            this.a9 = new VisualElement(this.ba._parent._parent, "TabDropIndicator");
            this.a9.w = false;
            this.a9.bu = 20000;
        }
        this.ba.bw = SpreadsheetCursorHelper.a(4);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.au = function (a, b) {
    };
    SpreadsheetTabItemElementLayoutManager.prototype.av = function () {
        var a = this.a7(0, 0);
        this.a9.al(a.x + this.ba.ax + this.ba._parent.ax, a.y + this.ba.a2 + this.ba._parent.a2, 0, 0);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.ax = function () {
        this.ba.d().dk(this.ba);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.ay = function (a) {
        this.ba.d().dk(a);
    };
    SpreadsheetTabItemElementLayoutManager.prototype.az = function (a) {
        a.ab = true;
    };
    SpreadsheetTabItemElementLayoutManager.prototype.a4 = function () {
        var a = 0;
        var b = this.h._k;
        for (var c = 0, d = b.count; c < d; c++) {
            var e = b.item(c)._ac;
            if (e != null && e.cf._l == 0) {
                if (e.cv != this.bc) {
                    e.cl = this.b._a0.j(e.cf);
                    e.cv = this.bc;
                }
                a += e.cl;
            }
        }
        this.bb = a;
    };
    SpreadsheetTabItemElementLayoutManager.$t = markType(SpreadsheetTabItemElementLayoutManager, 'SpreadsheetTabItemElementLayoutManager', SpreadsheetTabItemLayoutManager$1.$.specialize(SpreadsheetTabItemElement.$));
    return SpreadsheetTabItemElementLayoutManager;
}(SpreadsheetTabItemLayoutManager$1));
export { SpreadsheetTabItemElementLayoutManager };
/**
 * @hidden
 */
var SpreadsheetTabItemPanel = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetTabItemPanel, _super);
    function SpreadsheetTabItemPanel(a) {
        var _this = _super.call(this, a, "TabItemPanel") || this;
        _this.cf = null;
        _this.cf = new SpreadsheetTabItemElementLayoutManager(_this);
        return _this;
    }
    SpreadsheetTabItemPanel.prototype.b4 = function () {
        this.cf.ao();
        _super.prototype.b4.call(this);
    };
    SpreadsheetTabItemPanel.prototype.ad = function (a) {
        this.cf.aq(a);
        return _super.prototype.ad.call(this, a);
    };
    SpreadsheetTabItemPanel.prototype.ag = function (a) {
        if (this.cf.s(a)) {
            return true;
        }
        return _super.prototype.ag.call(this, a);
    };
    SpreadsheetTabItemPanel.prototype.ah = function (a) {
        if (a.a() == 1) {
            return this.cf.r(a);
        }
        return _super.prototype.ah.call(this, a);
    };
    SpreadsheetTabItemPanel.$t = markType(SpreadsheetTabItemPanel, 'SpreadsheetTabItemPanel', VisualElement.$);
    return SpreadsheetTabItemPanel;
}(VisualElement));
export { SpreadsheetTabItemPanel };
/**
 * @hidden
 */
var SpreadsheetVisualElement = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetVisualElement, _super);
    function SpreadsheetVisualElement(a) {
        var _this = _super.call(this, "Spreadsheet") || this;
        _this.dq = null;
        _this.dr = null;
        _this.dp = null;
        _this.dq = a;
        _this.dp = new FormulaBarVisualElement(_this);
        _this.dp.bu = 1000;
        _this.dr = new SpreadsheetAreaVisualElement(_this);
        return _this;
    }
    SpreadsheetVisualElement.prototype.c8 = function (a) {
        if (this.dq.activeWorksheet == null || this.dq.activeWorksheet.workbook == null) {
            this.dq._fy(false);
        }
        _super.prototype.c8.call(this, a);
    };
    SpreadsheetVisualElement.prototype.da = function (a, b) {
        _super.prototype.da.call(this, a, b);
        if (a != null) {
            a.onKeyDown = delegateRemove(a.onKeyDown, runOn(this, this.ds));
        }
        if (b != null) {
            b.onKeyDown = delegateCombine(b.onKeyDown, runOn(this, this.ds));
        }
    };
    SpreadsheetVisualElement.prototype.cw = function (a) {
        if (this.dq._at.h()) {
            this.dq._at.l();
            return true;
        }
        return _super.prototype.cw.call(this, a);
    };
    SpreadsheetVisualElement.prototype.cx = function (a, b) {
        if (this.dq._at.h()) {
            this.dq._at.l();
        }
        return _super.prototype.cx.call(this, a, b);
    };
    SpreadsheetVisualElement.prototype.b7 = function (a, b, c, d) {
        _super.prototype.b7.call(this, a, b, c, d);
        var e = b;
        if (this.dp.ac) {
            var f = this.dp.cl;
            f += d % 1;
            this.dp.al(a, e, c, f);
            e += f;
            d = Math.max(d - f, 0);
        }
        this.dr.al(a, e, c, d);
    };
    SpreadsheetVisualElement.prototype.ds = function (a) {
        var b = this.co.ba;
        var c = SpreadsheetUtilities.c1(this.co.am);
        return this.dq._dy(a, b, c);
    };
    SpreadsheetVisualElement.$t = markType(SpreadsheetVisualElement, 'SpreadsheetVisualElement', RootVisualElement.$);
    return SpreadsheetVisualElement;
}(RootVisualElement));
export { SpreadsheetVisualElement };
/**
 * @hidden
 */
var FilterDialogManager = /** @class */ (function (_super) {
    tslib_1.__extends(FilterDialogManager, _super);
    function FilterDialogManager(a, b) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.e = null;
        _this.c = null;
        _this.b = null;
        _this.j = null;
        _this.h = null;
        _this.f = null;
        _this.g = null;
        _this.k = null;
        _this.i = null;
        _this.c = a;
        _this.a = b;
        return _this;
    }
    FilterDialogManager.prototype.q = function () {
        var _this = this;
        var a = this.l(1);
        var b = this.l(2);
        var c = this.n(1);
        var d = this.n(2);
        var e = this.d();
        this.c._gi(43, function () { return _this.a.aa(a, c, b, d, e); });
    };
    FilterDialogManager.prototype.r = function () {
        var _this = this;
        var e_294, _0, e_295, _1;
        var a;
        var b = this.c.css;
        this.e = document.createElement("div");
        this.e.className = b.filterDialog;
        this.e.id = "FilterDialog_Main_Content_Element";
        var c = document.createElement("div");
        c.innerText = this.o("FilterDialog_ShowRowsWhere");
        c.className = b.filterDialogShowRowsWhere;
        this.e.appendChild(c);
        var d = document.createElement("div");
        d.id = "lblColumnName";
        d.innerText = this.a.w;
        d.className = b.filterDialogColumnName;
        this.e.appendChild(d);
        var e = document.createElement("div");
        e.className = b.filterDialogCondition1;
        this.e.appendChild(e);
        this.j = document.createElement("select");
        this.j.id = "cboOperator1";
        e.appendChild(this.j);
        this.h = document.createElement("select");
        this.h.id = "cboOperand1";
        e.appendChild(this.h);
        var f = document.createElement("div");
        f.className = b.filterDialogConditionalOperator;
        this.e.appendChild(f);
        var g = document.createElement("label");
        f.appendChild(g);
        this.f = document.createElement("input");
        this.f.name = "conditionalOperator";
        this.f.type = "radio";
        this.f.id = "optAnd";
        g.appendChild(this.f);
        var h = document.createElement("text");
        h.innerText = ((function () { var i = _this.p("FilterDialog_And", a); a = i.p1; return i.ret; })());
        this.f.accessKey = a;
        g.appendChild(h);
        var i = document.createElement("label");
        f.appendChild(i);
        this.g = document.createElement("input");
        this.g.name = "conditionalOperator";
        this.g.type = "radio";
        this.g.id = "optOr";
        i.appendChild(this.g);
        var j = document.createElement("text");
        j.innerText = ((function () { var k = _this.p("FilterDialog_Or", a); a = k.p1; return k.ret; })());
        this.g.accessKey = a;
        i.appendChild(j);
        var k = document.createElement("div");
        k.className = b.filterDialogCondition2;
        this.e.appendChild(k);
        this.k = document.createElement("select");
        this.k.id = "cboOperator2";
        k.appendChild(this.k);
        this.i = document.createElement("select");
        this.i.id = "cboOperand2";
        k.appendChild(this.i);
        var l = document.createElement("div");
        l.className = b.filterDialogHintText;
        this.e.appendChild(l);
        var m = document.createElement("div");
        m.innerText = this.o("FilterDialog_QuestionMarkHint");
        l.appendChild(m);
        var n = document.createElement("div");
        n.innerText = this.o("FilterDialog_AsteriskHint");
        l.appendChild(n);
        var o = document.createElement("div");
        o.className = b.filterDialogButtons;
        var p = SpreadsheetDialogUtilities.a();
        var q = function (r) {
            _this.q();
            _this.s();
        };
        var r = q;
        p.id = "btnOK";
        p.addEventListener("click", r, false);
        p.innerText = ((function () { var s = _this.p("FilterDialog_OK", a); a = s.p1; return s.ret; })());
        p.accessKey = a;
        var s = SpreadsheetDialogUtilities.a();
        var t = function (u) { return _this.s(); };
        var u = t;
        s.id = "btnCancel";
        s.addEventListener("click", u, false);
        s.innerText = ((function () { var v = _this.p("FilterDialog_Cancel", a); a = v.p1; return v.ret; })());
        s.accessKey = a;
        o.appendChild(p);
        o.appendChild(s);
        this.e.appendChild(o);
        var v = FilterDialogViewModel.i(this.c);
        try {
            for (var _2 = tslib_1.__values(fromEnum(v)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var w = _3.value;
                var x = document.createElement("option");
                x.innerText = w.displayText;
                x.setAttribute("value", w.dataValue);
                this.j.appendChild(x);
                var y = document.createElement("option");
                y.innerText = w.displayText;
                y.setAttribute("value", w.dataValue);
                this.k.appendChild(y);
            }
        }
        catch (e_294_1) { e_294 = { error: e_294_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_294) throw e_294.error; }
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this.a.k)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var z = _5.value;
                var aa = document.createElement("option");
                var ab = z.toString();
                aa.innerText = ab;
                aa.setAttribute("value", ab);
                this.h.appendChild(aa);
                var ac = document.createElement("option");
                var ad = z.toString();
                ac.innerText = ad;
                ac.setAttribute("value", ad);
                this.i.appendChild(ac);
            }
        }
        catch (e_295_1) { e_295 = { error: e_295_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_295) throw e_295.error; }
        }
        var ae = this.a.n;
        if (ae.hasValue) {
            this.j.value = EnumUtil.getName(ExcelComparisonOperator_$type, this.a.n.value);
        }
        var af = this.a.p;
        if (af.hasValue) {
            this.k.value = EnumUtil.getName(ExcelComparisonOperator_$type, this.a.p.value);
        }
        var ag = this.a.z(1);
        var ah = this.a.z(2);
        switch (this.a.d) {
            case 0:
                this.f.checked = true;
                break;
            case 1:
                this.g.checked = true;
                break;
            default: break;
        }
        this.t(this.h);
        this.t(this.i);
    };
    FilterDialogManager.prototype.s = function () {
        this.b.close(false);
    };
    FilterDialogManager.prototype.t = function (a) {
    };
    FilterDialogManager.prototype.d = function () {
        if (this.f.checked) {
            return 0;
        }
        if (this.g.checked) {
            return 1;
        }
        return 0;
    };
    FilterDialogManager.prototype.o = function (a) {
        var b = this.c._fs(a);
        b = SpreadsheetUtilities.c2(b);
        return b;
    };
    FilterDialogManager.prototype.p = function (a, b) {
        var c = this.c._fs(a);
        c = ((function () { var d = SpreadsheetUtilities.c3(c, b); b = d.p1; return d.ret; })());
        return {
            ret: c,
            p1: b
        };
    };
    FilterDialogManager.prototype.m = function (a) {
        var b = a.selectedIndex;
        var c = a.options.item(b);
        if (null == c) {
            return null;
        }
        var d = c.getAttribute("value");
        return d;
    };
    FilterDialogManager.prototype.l = function (a) {
        var b = a == 1 ? this.j : this.k;
        var c = this.m(b);
        if (null == c) {
            return Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        }
        var d = c.toString();
        if (stringIsNullOrEmpty(d)) {
            return Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        }
        var e = EnumUtil.getEnumValue(ExcelComparisonOperator_$type, EnumUtil.parse(ExcelComparisonOperator_$type, d, true));
        return Nullable$1.toNullable(ExcelComparisonOperator_$type, e);
    };
    FilterDialogManager.prototype.n = function (a) {
        var b = a == 1 ? this.h : this.i;
        throw new NotImplementedException(0);
    };
    FilterDialogManager.prototype.u = function () {
        this.r();
        var a = this.e;
        var b = this.c._fs("FilterDialog_Title");
        this.b = this.c._r(a, b);
    };
    FilterDialogManager.$t = markType(FilterDialogManager, 'FilterDialogManager');
    return FilterDialogManager;
}(Base));
export { FilterDialogManager };
/**
 * @hidden
 */
var FormatCellsDialogManager = /** @class */ (function (_super) {
    tslib_1.__extends(FormatCellsDialogManager, _super);
    function FormatCellsDialogManager(a, b, c) {
        var _this = _super.call(this) || this;
        _this.t = null;
        _this.v = null;
        _this.ag = null;
        _this.ah = null;
        _this.u = null;
        _this.y = null;
        _this.z = false;
        _this.r = null;
        _this.a0 = null;
        _this.ay = null;
        _this.af = null;
        _this.bw = null;
        _this.az = null;
        _this.bx = null;
        _this.by = null;
        _this.ac = null;
        _this.bv = null;
        _this.bu = null;
        _this.bt = null;
        _this.b5 = null;
        _this.b6 = null;
        _this.ar = null;
        _this.at = null;
        _this.as = null;
        _this.av = null;
        _this.aq = null;
        _this.au = null;
        _this.aw = null;
        _this.ax = null;
        _this.b1 = null;
        _this.b3 = null;
        _this.b2 = null;
        _this.b4 = null;
        _this.ak = null;
        _this.an = null;
        _this.ap = null;
        _this.ao = null;
        _this.al = null;
        _this.am = null;
        _this.x = null;
        _this.q = null;
        _this.p = null;
        _this.o = null;
        _this.b0 = null;
        _this.ai = null;
        _this.aj = null;
        _this.j = null;
        _this.k = null;
        _this.i = null;
        _this.h = null;
        _this.d = null;
        _this.a = null;
        _this.c = null;
        _this.f = null;
        _this.e = null;
        _this.g = null;
        _this.b = null;
        _this.bz = null;
        _this.n = null;
        _this.ad = null;
        _this.ae = null;
        _this.l = null;
        _this.v = a;
        _this.t = b;
        _this.y = c;
        return _this;
    }
    Object.defineProperty(FormatCellsDialogManager.prototype, "w", {
        get: function () {
            return this.v.css;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogManager.prototype, "bs", {
        get: function () {
            return this.ag;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogManager.prototype, "s", {
        get: function () {
            if (null == this.r) {
                this.r = this.t._b;
            }
            return this.r;
        },
        enumerable: true,
        configurable: true
    });
    FormatCellsDialogManager.prototype.ea = function () {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.b8 = function (a, b, c) {
        var e_296, _0;
        if (stringIsNullOrEmpty(b) || stringIsNullOrEmpty(c)) {
            return a;
        }
        if (null == a) {
            a = stringEmpty();
        }
        var d = a.split(';');
        var e = new List$1(StyleAttributeMember.$, 0);
        for (var g = 0; g < d.length; g++) {
            var f = d[g];
            if (false == stringIsNullOrEmpty(f)) {
                var h = f.split(':');
                if (h.length == 2) {
                    e.add(new StyleAttributeMember(h[0].trim(), h[1].trim()));
                }
            }
        }
        b = b.trim();
        var i = null;
        try {
            for (var _1 = tslib_1.__values(fromEnum(e)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var j = _2.value;
                if (b == j.a) {
                    i = j;
                    break;
                }
            }
        }
        catch (e_296_1) { e_296 = { error: e_296_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_296) throw e_296.error; }
        }
        ;
        if (null != i) {
            i.b = c;
        }
        else {
            e.add(new StyleAttributeMember(b, c));
        }
        var k = new StringBuilder(0);
        e.q(function (l) {
            k.l(l.a);
            k.l(": ");
            k.l(l.b);
            k.l("; ");
        });
        return k.toString();
    };
    FormatCellsDialogManager.prototype.dr = function () {
        this.t._cl();
    };
    FormatCellsDialogManager.prototype.ds = function () {
        this.ag = document.createElement("div");
        this.ag.className = this.w.formatCellsDialog;
        this.ag.id = "SFCD_DIALOG_ROOT_ELEMENT";
        this.ah = document.createElement("div");
        this.ah.id = "SFCD_DIALOG_ROOT_GRID_ELEMENT";
        this.ag.appendChild(this.ah);
        this.ah.setAttribute("style", SpreadsheetDialogUtilities.k("11fr 2em", "5fr 2fr 2fr", ".5em"));
        var a = this.aa(this.w);
        this.ah.appendChild(this.a0);
        this.a0.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 3));
        this.d5(a);
        this.dv(this.w);
        this.ah.appendChild(this.ay);
        this.ay.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 2, 1, "height: 2em;"));
        this.ah.appendChild(this.af);
        this.af.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 3, 1, "height: 2em;"));
    };
    FormatCellsDialogManager.prototype.dt = function (a, b) {
        this.eb();
    };
    FormatCellsDialogManager.prototype.du = function () {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.a1 = function () {
        var _this = this;
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_AT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1em 1em 2em 2em 2em 1em 1em 1.5em 1.5em 1.5em 1fr", "2em 3fr 2fr 3fr", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = this.bl(b, "FormatCellsDialog_AlignmentTab_Text_TextAlignment", null);
        var d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 2, d + " display: block;"));
        c = this.bl(b, "FormatCellsDialog_AlignmentTab_Text_Horizontal", null);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 2, 1, d + " display: block;"));
        c = this.a2(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 2, 1, d));
        c = this.bl(b, "FormatCellsDialog_AlignmentTab_Text_Indent", null);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 3, 1, d + " display: block; margin-top: 1em;"));
        c = this.bl(b, "FormatCellsDialog_AlignmentTab_Text_Vertical", null);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 2, 1, d + " display: block; margin-top: 1em;"));
        c = this.a3(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 3, 1, d));
        c = this.a4(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 2, 1, d));
        c = this.bl(b, "FormatCellsDialog_AlignmentTab_Text_TextControl", null);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 1, 2, d + " display: block;"));
        var e = function (f) { return _this.t._br = Nullable$1.toNullable(Boolean_$type, _this.bv.checked); };
        var f = this.m(b, "chkWrapText", "FormatCellsDialog_AlignmentTab_Text_WrapText", this.t._br, e);
        this.bv = f.c;
        c = f.a;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(8, 1, 2, 1, d));
        var g = function (h) { return _this.t._bq = Nullable$1.toNullable(Boolean_$type, _this.bu.checked); };
        f = this.m(b, "TESTID_AT_ShrinkToFit", "FormatCellsDialog_AlignmentTab_Text_ShrinkToFit", this.t._bq, g);
        this.bu = f.c;
        this.bu.disabled = (false == this.t._a7);
        c = f.a;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(9, 1, 2, 1, d));
        var h = function (i) { return _this.t._bo = Nullable$1.toNullable(Boolean_$type, _this.bt.checked); };
        f = this.m(b, "TESTID_AT_MergeCells", "FormatCellsDialog_AlignmentTab_Text_MergeCells", this.t._bo, h);
        this.bt = f.c;
        this.bt.disabled = (false == this.t._a4);
        c = f.a;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(10, 1, 2, 1, d));
        return a;
    };
    FormatCellsDialogManager.prototype.m = function (a, b, c, d, e) {
        var f = document.createElement("input");
        f.id = b;
        f.setAttribute("Type", "checkbox");
        var g = document.createElement("div");
        g.appendChild(f);
        a.appendChild(g);
        if (false == d.hasValue) {
            f.indeterminate = true;
        }
        else {
            f.checked = d.value;
        }
        if (null != e) {
            f.addEventListener("change", e, false);
        }
        var h = null;
        if (false == stringIsNullOrEmpty(c)) {
            h = this.bl(g, c, b);
            var i = this.b8((h.getAttribute("style")), "display", "inline");
            i = this.b8(i, "vertical-align", "top");
            h.setAttribute("style", i);
        }
        return new CheckboxElementInfo(f, g, h);
    };
    FormatCellsDialogManager.prototype.bj = function (a, b, c, d, e) {
        var _this = this;
        if (c === void 0) { c = "1px"; }
        if (d === void 0) { d = "gray"; }
        if (e === void 0) { e = "solid"; }
        var f;
        var g = document.createElement("fieldset");
        var h = document.createElement("legend");
        g.setAttribute("style", stringFormat(" border-width: {0}; border-color: {1}; border-style: {2};", c, d, e));
        h.setAttribute("style", " color: black; font-weight: NORMAL;");
        h.innerText = ((function () { var i = _this.di(b, f); f = i.p1; return i.ret; })());
        h.accessKey = f;
        g.appendChild(h);
        a.appendChild(g);
        return g;
    };
    FormatCellsDialogManager.prototype.bk = function (a, b, c, d, e, f) {
        if (true == e && false == stringIsNullOrEmpty(d)) {
            this.bl(a, d, b);
        }
        var g = document.createElement("input");
        g.id = b;
        if (false == stringIsNullOrEmpty(c)) {
            g.setAttribute("Type", c);
        }
        if (null != f) {
            g.addEventListener("change", f, false);
        }
        a.appendChild(g);
        if (false == e && false == stringIsNullOrEmpty(d)) {
            this.bl(a, d, b);
        }
        return g;
    };
    FormatCellsDialogManager.prototype.bl = function (a, b, c) {
        var _this = this;
        var d;
        var e = document.createElement("label");
        if (false == stringIsNullOrEmpty(b)) {
            e.innerText = ((function () { var f = _this.di(b, d); d = f.p1; return f.ret; })());
            e.accessKey = d;
        }
        if (false == stringIsNullOrEmpty(c)) {
            e.setAttribute("for", c);
        }
        a.appendChild(e);
        return e;
    };
    FormatCellsDialogManager.prototype.b7 = function (a, b, c, d) {
        if (d === void 0) { d = 0; }
        var e = document.createElement("select");
        e.id = b;
        if (null != c) {
            e.addEventListener("change", c, false);
        }
        if (d > 0) {
            e.size = d;
        }
        e.setAttribute("style", "overflow: auto;");
        a.appendChild(e);
        return e;
    };
    FormatCellsDialogManager.prototype.a2 = function (a) {
        var _this = this;
        var e_297, _0;
        var b = function (c) {
            var d = _this.bx.selectedIndex;
            var e = _this.bx.options.item(d);
            if (null != e) {
                var f = EnumWrapper$1._b(HorizontalCellAlignment_$type, _this.t._au, e.innerText);
                _this.t._ad = f._enumValue$i;
            }
        };
        this.bx = this.b7(a, "cmbHorizontalTextAlignment", b);
        try {
            for (var _1 = tslib_1.__values(this.t._au), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.toString();
                d.setAttribute("value", c.toString());
                this.bx.appendChild(d);
                if (EnumUtil.getName(HorizontalCellAlignment_$type, this.t._ad) == c._h) {
                    this.bx.value = c;
                }
            }
        }
        catch (e_297_1) { e_297 = { error: e_297_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_297) throw e_297.error; }
        }
        return this.bx;
    };
    FormatCellsDialogManager.prototype.a3 = function (a) {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.a4 = function (a) {
        var _this = this;
        var e_298, _0;
        var b = function (c) {
            var d = _this.by.selectedIndex;
            var e = _this.by.options.item(d);
            if (null != e) {
                var f = EnumWrapper$1._b(VerticalCellAlignment_$type, _this.t._av, e.innerText);
                _this.t._af = f._enumValue$i;
            }
        };
        this.by = this.b7(a, "cmbVerticalTextAlignment", b);
        try {
            for (var _1 = tslib_1.__values(this.t._av), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.toString();
                d.setAttribute("value", c.toString());
                this.by.appendChild(d);
                if (EnumUtil.getName(VerticalCellAlignment_$type, this.t._af) == c._h) {
                    this.by.value = c;
                }
            }
        }
        catch (e_298_1) { e_298 = { error: e_298_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_298) throw e_298.error; }
        }
        return this.by;
    };
    FormatCellsDialogManager.prototype.a5 = function (a) {
        var _this = this;
        var e_299, _0;
        var b = function (c) {
            var d = _this.bz.selectedIndex;
            var e = _this.bz.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = EnumWrapper$1._b(CellBorderLineStyle_$type, _this.t._as, f);
                _this.t._v = g._enumValue$i;
            }
        };
        this.bz = this.b7(a, "TESTID_BT_LineStyles", b, 7);
        try {
            for (var _1 = tslib_1.__values(this.t._as), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.toString();
                d.setAttribute("value", c.toString());
                this.bz.appendChild(d);
                if (EnumUtil.getName(CellBorderLineStyle_$type, this.t._v) == c._h) {
                    this.bz.value = c;
                }
            }
        }
        catch (e_299_1) { e_299 = { error: e_299_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_299) throw e_299.error; }
        }
        return this.bz;
    };
    FormatCellsDialogManager.prototype.a6 = function (a) {
        this.ae = document.createElement("div");
        this.ae.id = "TESTID_BT_BordersPreview";
        a.appendChild(this.ae);
        return this.ae;
    };
    FormatCellsDialogManager.prototype.a7 = function (a) {
        var _this = this;
        var e_300, _0;
        var b = function (c) {
            var d = _this.b0.selectedIndex;
            var e = _this.b0.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = EnumWrapper$1._b(FillPatternStyle_$type, _this.t._at, f);
                _this.t._ab = g._enumValue$i;
            }
        };
        this.b0 = this.b7(a, "TESTID_FILLT_PatternStyle", b);
        try {
            for (var _1 = tslib_1.__values(this.t._at), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.toString();
                d.setAttribute("value", c.toString());
                this.b0.appendChild(d);
                if (EnumUtil.getName(FillPatternStyle_$type, this.t._ab) == c._h) {
                    this.b0.value = c;
                }
            }
        }
        catch (e_300_1) { e_300 = { error: e_300_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_300) throw e_300.error; }
        }
        return this.b0;
    };
    FormatCellsDialogManager.prototype.a8 = function (a) {
        this.aj = document.createElement("div");
        a.appendChild(this.aj);
        return this.aj;
    };
    FormatCellsDialogManager.prototype.a9 = function (a) {
        var _this = this;
        var e_301, _0;
        var b = function (c) {
            var e_302, _0;
            var d = _this.b1.selectedIndex;
            var e = _this.b1.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = _this.s._ae._inner[0];
                try {
                    for (var _1 = tslib_1.__values(fromEnum(_this.s._ae)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var h = _2.value;
                        if (h == f) {
                            g = h;
                            break;
                        }
                    }
                }
                catch (e_302_1) { e_302 = { error: e_302_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_302) throw e_302.error; }
                }
                if (false == stringIsNullOrEmpty(g)) {
                    _this.s._ax = g;
                }
            }
        };
        this.b1 = this.b7(a, "TESTID_FT_FontNames", b, 5);
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.s._ae)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c;
                d.setAttribute("value", c.toString());
                this.b1.appendChild(d);
            }
        }
        catch (e_301_1) { e_301 = { error: e_301_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_301) throw e_301.error; }
        }
        this.b1.value = this.s._ax;
        return this.b1;
    };
    FormatCellsDialogManager.prototype.ba = function (a) {
        var _this = this;
        var e_303, _0;
        var b = function (c) {
            var e_304, _0;
            var d = _this.b2.selectedIndex;
            var e = _this.b2.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = _this.s._af._inner[0];
                try {
                    for (var _1 = tslib_1.__values(fromEnum(_this.s._af)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var h = _2.value;
                        if (h.toString() == f) {
                            g = h;
                            break;
                        }
                    }
                }
                catch (e_304_1) { e_304 = { error: e_304_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_304) throw e_304.error; }
                }
                _this.s._aj = g;
            }
        };
        this.b2 = this.b7(a, "TESTID_FT_FontSizes", b, 5);
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.s._af)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.toString();
                d.setAttribute("value", c.toString());
                this.b2.appendChild(d);
            }
        }
        catch (e_303_1) { e_303 = { error: e_303_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_303) throw e_303.error; }
        }
        this.b2.value = this.s._aj.toString();
        return this.b2;
    };
    FormatCellsDialogManager.prototype.bb = function (a) {
        var _this = this;
        var e_305, _0;
        var b = function (c) {
            var e_306, _0;
            var d = _this.b3.selectedIndex;
            var e = _this.b3.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = _this.s._ag._inner[0];
                try {
                    for (var _1 = tslib_1.__values(fromEnum(_this.s._ag)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var h = _2.value;
                        if (h.b == f) {
                            g = h;
                            break;
                        }
                    }
                }
                catch (e_306_1) { e_306 = { error: e_306_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_306) throw e_306.error; }
                }
                if (null != g) {
                    _this.s._d = g;
                }
            }
        };
        this.b3 = this.b7(a, "TESTID_FT_FontStyles", b, 5);
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.s._ag)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c.b;
                d.setAttribute("value", c.toString());
                this.b3.appendChild(d);
            }
        }
        catch (e_305_1) { e_305 = { error: e_305_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_305) throw e_305.error; }
        }
        var e = this.s._d;
        if (null != e) {
            this.b3.value = e.b;
        }
        return this.b3;
    };
    FormatCellsDialogManager.prototype.bc = function (a) {
        var _this = this;
        var e_307, _0;
        var b = function (c) {
            var d = _this.b4.selectedIndex;
            var e = _this.b4.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = EnumUtil.getEnumValue(FontUnderlineStyle_$type, EnumUtil.parse(FontUnderlineStyle_$type, f, true));
                _this.s._h = g;
            }
        };
        this.b4 = this.b7(a, "cmbFontUnderlineStyles", b);
        try {
            for (var _1 = tslib_1.__values(this.s._n), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = EnumUtil.getName(FontUnderlineStyle_$type, c);
                d.setAttribute("value", EnumUtil.getName(FontUnderlineStyle_$type, c));
                this.b4.appendChild(d);
            }
        }
        catch (e_307_1) { e_307 = { error: e_307_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_307) throw e_307.error; }
        }
        this.b4.value = EnumUtil.getName(FontUnderlineStyle_$type, this.s._h);
        return this.b4;
    };
    FormatCellsDialogManager.prototype.bd = function (a) {
        this.am = document.createElement("div");
        a.appendChild(this.am);
        return this.am;
    };
    FormatCellsDialogManager.prototype.be = function (a) {
        var _this = this;
        var e_308, _0;
        var b = function (c) {
            var e_309, _0;
            var d = _this.b5.selectedIndex;
            var e = _this.b5.options.item(d);
            if (null != e) {
                var f = (e.textContent);
                var g = null;
                try {
                    for (var _1 = tslib_1.__values(fromEnum(_this.t._ba)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var h = _2.value;
                        if (h._aa == f) {
                            g = h;
                            break;
                        }
                    }
                }
                catch (e_309_1) { e_309 = { error: e_309_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_309) throw e_309.error; }
                }
                if (null != g) {
                    _this.t._n = g;
                }
            }
        };
        this.b5 = this.b7(a, "TESTID_NT_Category", b, 10);
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.t._ba)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                var d = document.createElement("option");
                d.innerText = c._aa;
                d.setAttribute("value", c.toString());
                this.b5.appendChild(d);
            }
        }
        catch (e_308_1) { e_308 = { error: e_308_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_308) throw e_308.error; }
        }
        this.b5.value = this.t._n.toString();
        return this.b5;
    };
    FormatCellsDialogManager.prototype.bf = function (a) {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.bg = function (a) {
        var _this = this;
        var b = function (c) {
            var e_310, _0;
            var d = _this.b6.selectedIndex;
            var e = _this.b6.options.item(d);
            if (null != e) {
                var f = null;
                try {
                    for (var _1 = tslib_1.__values(fromEnum(_this.t._n._w)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var g = _2.value;
                        if (g._e == (e.value)) {
                            f = g;
                            break;
                        }
                    }
                }
                catch (e_310_1) { e_310 = { error: e_310_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_310) throw e_310.error; }
                }
                if (null != f) {
                    _this.t._k = f;
                }
            }
        };
        this.b6 = this.b7(a, "TESTID_NT_Formats", b, 4);
        return this.b6;
    };
    FormatCellsDialogManager.prototype.bh = function (a) {
        var _this = this;
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1fr 1fr 5fr", "1fr", "3px", "overflow: hidden; box-sizing: border-box; "));
        a.appendChild(b);
        this.av = this.bl(b, null, "formatsList");
        var c = this.dg(this.av);
        b.appendChild(this.av);
        this.av.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, c));
        var d = function (e) {
            var f = _this.bv.checked;
            _this.t._bx = _this.aq.value;
        };
        this.aq = this.bk(a, "TESTID_NT_CustomizedFormatMask", null, null, false, d);
        c = this.dg(this.aq);
        b.appendChild(this.aq);
        this.aq.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, c));
        var e = this.bg(b);
        c = this.dg(e);
        b.appendChild(e);
        e.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 1, 1, c));
        return b;
    };
    FormatCellsDialogManager.prototype.bi = function (a) {
        this.ax = document.createElement("div");
        a.appendChild(this.ax);
        return this.ax;
    };
    FormatCellsDialogManager.prototype.ab = function (a, b, c, d) {
        var _this = this;
        var e = SpreadsheetDialogUtilities.a();
        if (false == stringIsNullOrEmpty(b)) {
            e.className = b;
        }
        e.id = a;
        e.addEventListener("click", d, false);
        var f = stringEmpty();
        if (false == stringIsNullOrEmpty(c)) {
            e.innerText = ((function () { var g = _this.di(c, f); f = g.p1; return g.ret; })());
        }
        e.accessKey = f;
        return e;
    };
    FormatCellsDialogManager.prototype.bm = function () {
        var _this = this;
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_BT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1fr 2.2fr 20px 1fr", "2.5fr 20px 3.5fr 50px", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = this.bj(b, "FormatCellsDialog_BorderTab_Text_Line");
        var d = c;
        var e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 2, 1, 1, e + " overflow: hidden; border-color: #fff; "));
        var f = document.createElement("div");
        f.setAttribute("style", SpreadsheetDialogUtilities.k("1em 1fr 1em 1em 2em 2em", "1fr", "10px", "height: 100%; box-sizing: border-box; "));
        d.appendChild(f);
        c = this.bl(f, "FormatCellsDialog_BorderTab_Text_Style", "TESTID_BT_LineStyles");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, e + " display: block;"));
        c = this.a5(f);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, e));
        c = this.bl(f, "FormatCellsDialog_BorderTab_Text_Color", "TESTID_BT_LineColor");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 1, 1, e + " display: block;"));
        var g = function (h) { return _this.t._al = h; };
        this.n = new ColorPickerProxy(this, "SpreadsheetThemeColorPickerControl_Text_Automatic", "SpreadsheetThemeColorPickerControl_Text_NoColor", true, g);
        c = this.n.m;
        f.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 1, 1, e));
        this.dy();
        c = this.bj(b, "FormatCellsDialog_BorderTab_Text_Presets");
        d = c;
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 3, 1, e + " overflow: hidden; border-color: #fff; border-bottom-style: none; border-left-style: none; border-right-style: none; "));
        var h = document.createElement("div");
        h.setAttribute("style", SpreadsheetDialogUtilities.k("50px 1em ", "50px 2px 50px 2px 50px 1fr", "10px", "height: 100%; box-sizing: border-box; "));
        d.appendChild(h);
        this.j = new BorderLineButtonElementProxy("TESTID_BT_NonePreset", false, 0, false, runOn(this, this.d7), runOn(this, this.d6));
        var i;
        c = i = this.j.ab;
        i.width = 50;
        i.height = 50;
        h.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, e));
        this.j.ah();
        c = this.bl(h, "FormatCellsDialog_BorderTab_Text_PresetNone", "TESTID_BT_NonePreset");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, e + " display: block; margin: 0px;"));
        this.k = new BorderLineButtonElementProxy("TESTID_BT_OutlinePreset", false, 1, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.k.ab;
        i.width = 50;
        i.height = 50;
        h.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 3, 1, e));
        this.k.ah();
        c = this.bl(h, "FormatCellsDialog_BorderTab_Text_PresetOutline", "TESTID_BT_OutlinePreset");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 3, 1, e + " display: block; margin: 0px;"));
        this.i = new BorderLineButtonElementProxy("TESTID_BT_InsidePreset", false, 2, false == this.t._d._au, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.i.ab;
        i.width = 50;
        i.height = 50;
        h.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 5, 1, e));
        this.i.ah();
        c = this.bl(h, "FormatCellsDialog_BorderTab_Text_PresetInside", "TESTID_BT_InsidePreset");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 5, 1, e + " display: block; margin: 0px;"));
        c = this.bj(b, "FormatCellsDialog_BorderTab_Text_Border");
        d = c;
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 3, 1, e + " overflow: hidden; border-color: #fff; border-bottom-style: none; border-left-style: none; border-right-style: none; "));
        var j = document.createElement("div");
        j.setAttribute("style", SpreadsheetDialogUtilities.k("40px 1fr 40px 1fr 40px 1fr 40px 1fr ", "40px 2px 40px 2px 40px 2px 40px 2px 40px 1fr", "10px", "height: 100%; box-sizing: border-box; "));
        d.appendChild(j);
        this.h = new BorderLineButtonElementProxy("TESTID_BT_AddTopLine", true, 10, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.h.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, e));
        this.h.ah();
        this.d = new BorderLineButtonElementProxy("TESTID_BT_AddInsideHorizontalLine", true, 6, false == this.t._d._av, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.d.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 1, 1, e));
        this.d.ah();
        this.a = new BorderLineButtonElementProxy("TESTID_BT_AddBottomLine", true, 3, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.a.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 1, 1, e));
        this.a.ah();
        this.c = new BorderLineButtonElementProxy("TESTID_BT_AddDiagonalUpLine", true, 5, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.c.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 1, 1, e));
        this.c.ah();
        this.f = new BorderLineButtonElementProxy("TESTID_BT_AddLeftLine", true, 8, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.f.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 3, 1, e));
        this.f.ah();
        this.e = new BorderLineButtonElementProxy("TESTID_BT_AddInsideVerticalLine", true, 7, false == this.t._d._ax, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.e.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 5, 1, e));
        this.e.ah();
        this.g = new BorderLineButtonElementProxy("TESTID_BT_AddRightLine", true, 9, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.g.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 7, 1, e));
        this.g.ah();
        this.b = new BorderLineButtonElementProxy("TESTID_BT_AddDiagonalDownLine", true, 4, false, runOn(this, this.d7), runOn(this, this.d6));
        c = i = this.b.ab;
        i.width = 40;
        i.height = 40;
        j.appendChild(c);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(7, 1, 9, 1, e));
        this.b.ah();
        c = this.a6(j);
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 5, 3, 5, e));
        this.eb();
        c = this.bl(b, "FormatCellsDialog_BorderTab_Text_Description", "");
        e = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 1, 4, e + " display: block;"));
        return a;
    };
    FormatCellsDialogManager.prototype.dv = function (a) {
        var _this = this;
        var b = function (c) {
            _this.dr();
            _this.du();
        };
        this.ay = this.ab("TESTID_DIALOG_OK", a.formatCellsDialogButtons, "FormatCellsDialog_OK", b);
        var c = function (d) { return _this.du(); };
        this.af = this.ab("TESTID_DIALOG_Cancel", a.formatCellsDialogButtons, "FormatCellsDialog_Cancel", c);
    };
    FormatCellsDialogManager.prototype.bn = function () {
        var _this = this;
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_FILLT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1em 2em 1em 2em 2fr 1fr", "1fr 50px 1fr", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = this.bl(b, "FormatCellsDialog_FillTab_Text_BackgroundColor", "TESTID_FILLT_NoColor");
        var d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, d + " display: block;"));
        c = this.bl(b, "FormatCellsDialog_FillTab_Text_PatternColor", "TESTID_FILLT_PatternColor");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 3, 1, d + " display: block;"));
        var e = function (f) {
            _this.t._ak = f;
            if (WorkbookColorInfo.l_op_Equality(null, f)) {
                _this.t._bg++;
            }
        };
        this.o = new ColorPickerProxy(this, "SpreadsheetThemeColorPickerControl_Text_Automatic", "SpreadsheetThemeColorPickerControl_Text_NoColor", false, e);
        c = this.o.m;
        b.appendChild(c);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, d));
        this.o.w(WorkbookColorInfo.l_op_Equality(null, this.t._ak));
        var f = function (g) { return _this.t._am = g; };
        this.p = new ColorPickerProxy(this, "SpreadsheetThemeColorPickerControl_Text_Automatic", "SpreadsheetThemeColorPickerControl_Text_NoColor", true, f);
        c = this.p.m;
        b.appendChild(c);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 3, 1, d));
        this.d0();
        c = this.bl(b, "FormatCellsDialog_FillTab_Text_PatternStyle", "TESTID_FILLT_PatternStyle");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 3, 1, d + " display: block;"));
        c = this.a7(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 3, 1, d));
        c = this.bj(b, "FormatCellsDialog_FillTab_Text_Sample");
        var g = c;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(6, 1, 1, 3, d + " overflow: hidden; "));
        c = this.a8(g);
        d = this.dg(c);
        c.setAttribute("style", d);
        return a;
    };
    FormatCellsDialogManager.prototype.bo = function () {
        var _this = this;
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_FT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1em 8em 1em 2em 11em 1fr", "2fr 1fr 1fr", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = this.bl(b, "SpreadsheetFontControl_FontLabel", "TESTID_FT_FontNames");
        var d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, d + " display: block;"));
        c = this.bl(b, "SpreadsheetFontControl_FontStyleLabel", "TESTID_FT_FontStyles");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 2, 1, d + " display: block;"));
        c = this.bl(b, "SpreadsheetFontControl_SizeLabel", "TESTID_FT_FontSizes");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 3, 1, d + " display: block;"));
        c = this.a9(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, d));
        c = this.bb(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 2, 1, d));
        c = this.ba(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 3, 1, d));
        c = this.bl(b, "SpreadsheetFontControl_UnderlineLabel", "cmbFontUnderlineStyles");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 1, 1, d + " display: block;"));
        c = this.bl(b, "SpreadsheetFontControl_ColorLabel", "TESTID_FT_FontColor");
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 2, 1, d + " display: block;"));
        c = this.bc(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 1, 1, d));
        var e = function (f) { return _this.s._m = f; };
        this.q = new ColorPickerProxy(this, "SpreadsheetThemeColorPickerControl_Text_Automatic", "SpreadsheetThemeColorPickerControl_Text_NoColor", true, e);
        c = this.q.m;
        b.appendChild(c);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 2, 1, d));
        this.d2();
        var f = function (g) { return _this.s._x = _this.ak.checked; };
        var g = this.m(b, "TESTID_FT_NormalFont", "SpreadsheetFontControl_NormalFontLabel", Nullable$1.toNullable(Boolean_$type, this.s._x), f);
        this.ak = g.c;
        c = g.a;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 3, 1, d));
        c = this.bj(b, "SpreadsheetFontControl_Text_Effects");
        var h = c;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 1, 1, d));
        var i = function (j) { return _this.s._aq = Nullable$1.toNullable(Boolean_$type, _this.an.checked); };
        g = this.m(b, "TESTID_FT_Strikethrough", "SpreadsheetFontControl_StrikethroughLabel", this.s._aq, i);
        this.an = g.c;
        c = g.a;
        h.appendChild(c);
        d = this.dg(c);
        c.setAttribute("style", d + " margin-top: .5em; margin-bottom: .5em;");
        var j = function (k) { return _this.s._as = Nullable$1.toNullable(Boolean_$type, _this.ap.checked); };
        g = this.m(b, "TESTID_FT_Superscript", "SpreadsheetFontControl_SuperscriptLabel", this.s._as, j);
        this.ap = g.c;
        c = g.a;
        h.appendChild(c);
        d = this.dg(c);
        c.setAttribute("style", d + " margin-bottom: .5em;");
        var k = function (l) { return _this.s._ar = Nullable$1.toNullable(Boolean_$type, _this.ao.checked); };
        g = this.m(b, "TESTID_FT_Subscript", "SpreadsheetFontControl_SubscriptLabel", this.s._ar, k);
        this.ao = g.c;
        h.appendChild(g.a);
        c = this.bj(b, "SpreadsheetFontControl_Text_Preview");
        h = c;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 2, 2, d + " overflow: hidden; "));
        c = this.bd(h);
        d = this.dg(c);
        c.setAttribute("style", d + " margin-left: 40px; ");
        return a;
    };
    FormatCellsDialogManager.prototype.aa = function (a) {
        this.a0 = document.createElement("div");
        this.a0.className = a.formatCellsDialogTabs;
        this.a0.id = "MainTabControl";
        var b = document.createElement("ul");
        if (this.t._a5) {
            b.appendChild(this.br("#" + "SFCD_NT", this.dh("FormatCellsDialog_NumberTabCaption")));
        }
        if (this.t._a0) {
            b.appendChild(this.br("#" + "SFCD_AT", this.dh("FormatCellsDialog_AlignmentTabCaption")));
        }
        if (this.t._a3) {
            b.appendChild(this.br("#" + "SFCD_FT", this.dh("FormatCellsDialog_FontTabCaption")));
        }
        if (this.t._a1) {
            b.appendChild(this.br("#" + "SFCD_BT", this.dh("FormatCellsDialog_BorderTabCaption")));
        }
        if (this.t._a2) {
            b.appendChild(this.br("#" + "SFCD_FILLT", this.dh("FormatCellsDialog_FillTabCaption")));
        }
        if (this.t._a6) {
            b.appendChild(this.br("#" + "SFCD_PT", this.dh("FormatCellsDialog_ProtectionTabCaption")));
        }
        this.a0.appendChild(b);
        var c = new List$1(FormatCellsDialogTab_$type, 2, 6);
        if (this.t._a5) {
            this.a0.appendChild(this.bp());
            c.add(1);
        }
        if (this.t._a0) {
            this.a0.appendChild(this.a1());
            c.add(2);
        }
        if (this.t._a3) {
            this.a0.appendChild(this.bo());
            c.add(4);
        }
        if (this.t._a1) {
            this.a0.appendChild(this.bm());
            c.add(8);
        }
        if (this.t._a2) {
            this.a0.appendChild(this.bn());
            c.add(16);
        }
        if (this.t._a6) {
            this.a0.appendChild(this.bq());
            c.add(32);
        }
        return c;
    };
    FormatCellsDialogManager.prototype.bp = function () {
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_NT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1.5em 3fr 1fr 5fr 3fr", "1fr 3fr", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = this.bl(b, "FormatCellsDialog_NumberTab_CategoryLabel", null);
        var d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, d));
        c = this.be(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 3, 1, 1, d));
        c = this.bj(b, "FormatCellsDialog_NumberTab_SampleLabel");
        var e = c;
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 2, 1, d + " overflow: hidden; "));
        c = this.bi(e);
        d = this.dg(c);
        c.setAttribute("style", d + " margin-left: 40px; ");
        c = this.bf(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 2, 1, d));
        if (null != this.t._n) {
            this.d9(this.as, this.t._n._y > -1);
        }
        c = this.bh(b);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(4, 1, 2, 1, d));
        c = this.au = this.bl(b, null, null);
        d = this.dg(c);
        c.setAttribute("style", SpreadsheetDialogUtilities.j(5, 1, 1, 2, d + " display: block;"));
        this.d8();
        return a;
    };
    FormatCellsDialogManager.prototype.bq = function () {
        var _this = this;
        var a = document.createElement("div");
        a.className = this.v.css.formatCellsDialogTab;
        a.id = "SFCD_PT";
        a.setAttribute("style", "height: " + "555px" + "; ");
        var b = document.createElement("div");
        b.setAttribute("style", SpreadsheetDialogUtilities.k("1em 1em 1fr", "1fr", "10px", "height: 100%; box-sizing: border-box; "));
        a.appendChild(b);
        var c = function (d) {
            var e = _this.bw.checked;
            _this.t._bn = Nullable$1.toNullable(Boolean_$type, _this.bw.checked);
        };
        var d = this.t._bn.hasValue && true == this.t._bn.value;
        var e = this.m(b, "TESTID_PT_Locked", "FormatCellsDialog_ProtectionTab_Text_Locked", this.t._bn, c);
        this.bw = e.c;
        var f = e.a;
        var g = this.dg(f);
        f.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, g));
        f = this.az = this.bl(b, "FormatCellsDialog_ProtectionTab_Text_Summary", null);
        g = this.dg(f);
        f.setAttribute("style", SpreadsheetDialogUtilities.j(3, 1, 1, 1, g + " display: block;"));
        return a;
    };
    FormatCellsDialogManager.prototype.br = function (a, b) {
        var c = document.createElement("li");
        var d = document.createElement("a");
        d.innerText = b;
        d.setAttribute("href", a);
        c.appendChild(d);
        return c;
    };
    FormatCellsDialogManager.prototype.dw = function (a, b) {
        var c = this.x._worksheets$i._item(0)._getCell("A1");
        switch (b.propertyName) {
            case "IsNormalFont":
                this.ak.checked = this.s._x;
                break;
            case "Superscript":
                if (this.s._as.hasValue) {
                    this.ap.checked = this.s._as.value;
                }
                else {
                    this.ap.checked = false;
                }
                this.s._a8(c);
                break;
            case "Subscript":
                if (this.s._ar.hasValue) {
                    this.ao.checked = this.s._ar.value;
                }
                else {
                    this.ao.checked = false;
                }
                this.s._a8(c);
                break;
            case "SelectedFontName":
                this.b1.selectedIndex = this.s._ae.indexOf(this.s._ax);
                this.s._a8(c);
                break;
            case "SelectedFontStyle":
                this.b3.selectedIndex = this.s._ag.indexOf(this.s._d);
                this.s._a8(c);
                break;
            case "SelectedFontUnderlineStyle":
                for (var d = 0; d < this.s._n.length; d++) {
                    var e = EnumUtil.getEnumValue(FontUnderlineStyle_$type, (this.s._n[d]));
                    if (e == this.s._h) {
                        this.b4.selectedIndex = d;
                        break;
                    }
                }
                this.s._a8(c);
                break;
            case "SelectedFontSize":
                this.b2.selectedIndex = this.s._af.indexOf(this.s._aj);
                this.s._a8(c);
                break;
            case "Strikeout":
                if (this.s._aq.hasValue) {
                    this.an.checked = this.s._aq.value;
                }
                else {
                    this.an.checked = false;
                }
                this.s._a8(c);
                break;
            case "SelectedFontColorInfo":
                this.d2();
                this.s._a8(c);
                break;
        }
    };
    FormatCellsDialogManager.prototype.dx = function (a, b) {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.dg = function (a) {
        var b = a.getAttribute("style");
        if (null == b) {
            return stringEmpty();
        }
        return b;
    };
    FormatCellsDialogManager.prototype.dh = function (a) {
        var b = this.v._fs(a);
        b = SpreadsheetUtilities.c2(b);
        return b;
    };
    FormatCellsDialogManager.prototype.di = function (a, b) {
        var c = this.v._fs(a);
        c = ((function () { var d = SpreadsheetUtilities.c3(c, b); b = d.p1; return d.ret; })());
        return {
            ret: c,
            p1: b
        };
    };
    FormatCellsDialogManager.prototype.dy = function () {
        this.n.v();
        if (WorkbookColorInfo.l_op_Inequality(null, this.t._al)) {
            if (this.t._al.isAutomatic) {
                this.n.x();
            }
            else {
                this.n.y(this.t._al._getResolvedColor1(this.t._ag));
            }
        }
        else {
            this.n.x();
        }
    };
    FormatCellsDialogManager.prototype.dz = function (a, b) {
        if (a === void 0) { a = 1; }
        if (b === void 0) { b = 1; }
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.d0 = function () {
        this.p.v();
        if (WorkbookColorInfo.l_op_Inequality(null, this.t._am)) {
            if (this.t._am.isAutomatic) {
                this.p.x();
            }
            else {
                this.p.y(this.t._am._getResolvedColor1(this.t._ag));
            }
        }
        else {
            this.p.x();
        }
    };
    FormatCellsDialogManager.prototype.d1 = function (a, b) {
        if (a === void 0) { a = 2; }
        if (b === void 0) { b = 1; }
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.d2 = function () {
        this.q.v();
        if (WorkbookColorInfo.l_op_Inequality(null, this.s._m)) {
            if (this.s._m.isAutomatic) {
                this.q.x();
            }
            else {
                this.q.y(this.s._a9);
            }
        }
        else {
            this.q.x();
        }
    };
    FormatCellsDialogManager.prototype.d3 = function (a, b) {
        if (a === void 0) { a = 2; }
        if (b === void 0) { b = 1; }
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.d4 = function (a, b) {
        if (a === void 0) { a = 2; }
        if (b === void 0) { b = 1; }
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.d5 = function (a) {
        throw new NotSupportedException(0);
    };
    FormatCellsDialogManager.prototype.d6 = function (a) {
        var b = typeCast(BorderLineButtonElementProxy.$, a);
        switch (b.s) {
            case 0:
                this.t._ck(0);
                break;
            case 1:
                this.t._ck(1);
                break;
            case 2:
                this.t._ck(2);
                break;
            default: break;
        }
    };
    FormatCellsDialogManager.prototype.d7 = function (a) {
        var b = typeCast(BorderLineButtonElementProxy.$, a);
        switch (b.s) {
            case 10:
                this.t._cv(1);
                break;
            case 6:
                this.t._cv(5);
                break;
            case 3:
                this.t._cv(3);
                break;
            case 5:
                this.t._cv(7);
                break;
            case 8:
                this.t._cv(0);
                break;
            case 7:
                this.t._cv(4);
                break;
            case 9:
                this.t._cv(2);
                break;
            case 4:
                this.t._cv(6);
                break;
            default: break;
        }
    };
    FormatCellsDialogManager.prototype.d8 = function () {
        this.d9(this.b6, this.t._n._h);
        this.d9(this.aq, this.t._n._l, 0);
        this.d9(this.as, this.t._n._y > -1);
        var a = false;
        if (false == stringIsNullOrEmpty(this.t._n._ae)) {
            a = true;
        }
        this.d9(this.av, a);
        this.au.innerText = this.t._n._ac;
        this.av.innerText = this.t._n._ae;
        this.aq.value = this.t._ce;
        if (this.t._n._h) {
            this.ec(1);
        }
    };
    FormatCellsDialogManager.prototype.d9 = function (a, b, c, d) {
        if (c === void 0) { c = 1; }
        if (d === void 0) { d = false; }
        var e = 2;
        if (false == b) {
            e = c;
        }
        var f = EnumUtil.getName(FormatCellsDialogManager_ElementVisibility_$type, e);
        var g = null;
        var h = null;
        if (e == 0) {
            g = "none";
        }
        else if (d) {
            g = "grid";
            g = "-ms-grid";
        }
        else {
            g = "block";
        }
        var i = this.b8((a.getAttribute("style")), "display", g);
        if (false == stringIsNullOrEmpty(h)) {
            i = this.b8(i, "display", h);
        }
        i = this.b8(i, "visibility", f);
        if (e == 2) {
            i = this.b8(i, "opacity", "1");
        }
        else {
            i = this.b8(i, "opacity", "0");
        }
        a.setAttribute("style", i);
    };
    FormatCellsDialogManager.prototype.eb = function () {
        var a = this.t._d;
        this.h.y = a._a1;
        this.d.y = a._aw;
        this.a.y = a._ar;
        this.c.y = a._at;
        this.f.y = a._az;
        this.e.y = a._ay;
        this.g.y = a._a0;
        this.b.y = a._as;
    };
    FormatCellsDialogManager.prototype.ec = function (a) {
        if (a === void 0) { a = 0; }
        var b = this.b6.selectedIndex;
        SpreadsheetDialogUtilities.l(this.b6);
        this.b6.selectedIndex = -1;
        var c = this.t._n._w.count;
        var d = -1;
        var e = this.t._k;
        for (var f = 0; f < c; f++) {
            var g = this.t._n._w._inner[f];
            var h = document.createElement("option");
            h.innerText = g._g;
            h.setAttribute("value", g._e);
            h.setAttribute("style", stringFormat("color: {0};", g._c));
            this.b6.appendChild(h);
            if (g == e) {
                d = f;
            }
        }
        if (a == 2) {
            this.b6.selectedIndex = Math.max(0, b);
        }
        else if (a == 1 && d != -1) {
            this.b6.selectedIndex = d;
        }
    };
    FormatCellsDialogManager.$t = markType(FormatCellsDialogManager, 'FormatCellsDialogManager');
    return FormatCellsDialogManager;
}(Base));
export { FormatCellsDialogManager };
/**
 * @hidden
 */
var ColorPickerProxy = /** @class */ (function (_super) {
    tslib_1.__extends(ColorPickerProxy, _super);
    function ColorPickerProxy(a, b, c, d, e) {
        var _this = _super.call(this) || this;
        _this.e = false;
        _this.g = null;
        _this.k = null;
        _this.h = null;
        _this.i = null;
        _this.l = null;
        _this.j = null;
        _this.d = null;
        _this.o = 0;
        _this.c = null;
        _this.p = null;
        _this.q = null;
        _this.aa = new Color();
        _this.b = 0;
        _this.a = 0;
        _this.f = false;
        _this.c = a;
        _this.e = d;
        _this.q = a.dh(c);
        _this.p = a.dh(b);
        _this.d = e;
        var f = ColorPickerProxy.n.toString();
        _this.o = ColorPickerProxy.n;
        ColorPickerProxy.n++;
        if (_this.e) {
            _this.j = document.createElement("div");
            _this.j.id = "dropdown-color-picker" + f;
            _this.j.setAttribute("style", "border-style: solid; border-color: gray; border-width: 1px; padding: 2px;");
            var g = function (h) { return _this.s(); };
            _this.c.bs.addEventListener("mousedown", g, true);
            var h = document.createElement("div");
            h.setAttribute("style", SpreadsheetDialogUtilities.k("1fr", "1fr 1em", "2px", "height: 100%; box-sizing: border-box; "));
            _this.j.appendChild(h);
            var i = function (j) {
                switch (_this.b) {
                    case 0: break;
                    case 2:
                        if (null != _this.d) {
                            _this.d(WorkbookColorInfo.automatic);
                        }
                        break;
                    case 1:
                        if (null != _this.d) {
                            _this.d(new WorkbookColorInfo(_this.aa));
                        }
                        break;
                }
            };
            _this.g = a.ab(_this.r("btn-selectedcolor", f), a.w.formatCellsDialogButtons, "", i);
            _this.g.disabled = true;
            var j = a.dg(_this.g);
            _this.g.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, j + " border-style: none; border-width: 0px; background: transparent; "));
            h.appendChild(_this.g);
            var k = function (l) { return _this.s(); };
            var l = a.w.formatCellsDialogColorPickerDropdownButton + " ui-icon-triangle-1-s" + " ui-icon";
            _this.k = a.ab(_this.r("btn-dropdown", f), l, "", k);
            j = a.dg(_this.k);
            _this.k.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 2, 1, j + " border-style: none; height: 100%; "));
            h.appendChild(_this.k);
            _this.l = document.createElement("div");
            _this.l.id = _this.r("dropdown-content", f);
            _this.l.setAttribute("style", SpreadsheetDialogUtilities.k("2em 1fr", "1fr", "0px", "height: 184px; width: 200px; box-sizing: border-box; "));
            _this.j.appendChild(_this.l);
            var m = function (n) {
                _this.u();
                _this.s();
            };
            _this.h = a.ab(_this.r("btn-action", f), a.w.formatCellsDialogButtons, "", m);
            j = a.dg(_this.h);
            _this.h.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, j + " border-style: solid; border-width: 1px; "));
            _this.l.appendChild(_this.h);
            _this.i = document.createElement("div");
            _this.i.id = _this.r("color-picker", f);
            _this.i.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, j));
            _this.l.appendChild(_this.i);
        }
        else {
            _this.j = document.createElement("div");
            _this.j.id = _this.r("inplace-color-picker-container", f);
            _this.j.setAttribute("style", SpreadsheetDialogUtilities.k("2em 1fr", "1fr", "0px", "height: 184px; width: 200px; box-sizing: border-box; "));
            var n = function (o) { return _this.u(); };
            _this.h = a.ab(_this.r("btn-action", f), a.w.formatCellsDialogButtons, "", n);
            var o = a.dg(_this.h);
            _this.h.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, o + " border-style: solid; border-width: 1px; "));
            _this.j.appendChild(_this.h);
            _this.i = document.createElement("div");
            _this.i.id = _this.r("color-picker", f);
            _this.i.setAttribute("style", SpreadsheetDialogUtilities.j(2, 1, 1, 1, o));
            _this.j.appendChild(_this.i);
        }
        return _this;
    }
    Object.defineProperty(ColorPickerProxy.prototype, "m", {
        get: function () {
            return this.j;
        },
        enumerable: true,
        configurable: true
    });
    ColorPickerProxy.prototype.t = function () {
        throw new NotSupportedException(0);
    };
    ColorPickerProxy.prototype.w = function (a) {
        var b = a ? "#CCE8FF" : "transparent";
        var c = this.c.b8((this.h.getAttribute("style")), "background", b);
        this.h.setAttribute("style", c);
        this.h.innerText = this.q;
        this.a = 1;
    };
    ColorPickerProxy.prototype.v = function () {
        var a = this.c.b8((this.h.getAttribute("style")), "background", "transparent");
        this.h.setAttribute("style", a);
        this.h.innerText = this.p;
        this.a = 2;
    };
    ColorPickerProxy.prototype.y = function (a) {
        var b = this.c.b8((this.g.getAttribute("style")), "background", a.colorString);
        this.g.setAttribute("style", b);
        this.g.innerText = "";
        this.b = 1;
        this.aa = a;
    };
    ColorPickerProxy.prototype.x = function () {
        var a = this.c.b8((this.g.getAttribute("style")), "background", "transparent");
        this.g.setAttribute("style", a);
        this.g.innerText = this.p;
        this.b = 2;
    };
    ColorPickerProxy.prototype.z = function () {
    };
    ColorPickerProxy.prototype.r = function (a, b) {
        return a + b;
    };
    ColorPickerProxy.prototype.s = function () {
        if (this.f) {
            this.f = false;
        }
    };
    ColorPickerProxy.prototype.u = function () {
        switch (this.a) {
            case 0: break;
            case 2:
                if (null != this.d) {
                    this.d(WorkbookColorInfo.automatic);
                }
                break;
            case 1:
                if (null != this.d) {
                    this.d(null);
                }
                break;
        }
    };
    ColorPickerProxy.$t = markType(ColorPickerProxy, 'ColorPickerProxy');
    ColorPickerProxy.n = 0;
    return ColorPickerProxy;
}(Base));
export { ColorPickerProxy };
/**
 * @hidden
 */
var BorderPreviewSpreadsheetHelper = /** @class */ (function (_super) {
    tslib_1.__extends(BorderPreviewSpreadsheetHelper, _super);
    function BorderPreviewSpreadsheetHelper(a, b, c, d, e) {
        var _this = _super.call(this) || this;
        _this.c = null;
        _this.a = null;
        _this.j = new Color();
        _this.i = new Color();
        _this.b = null;
        _this.b = a;
        _this.c = SingleCellSpreadsheetPreviewHelper.a(b, c, d, e, false);
        _this.a = new CellBordersPreviewControlHelper(_this.c, a._d, b, c, a._ag, 4);
        return _this;
    }
    Object.defineProperty(BorderPreviewSpreadsheetHelper.prototype, "k", {
        get: function () {
            return this.i;
        },
        set: function (a) {
            this.i = a;
            for (var b = 0; b < 4; b++) {
                for (var c = 0; c < 4; c++) {
                    this.c._worksheets$i._item(0)._rows$i.item(b)._cells$i.item(c).cellFormat.fill = CellFill._createSolidFill(new WorkbookColorInfo(a));
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BorderPreviewSpreadsheetHelper.prototype, "l", {
        get: function () {
            return this.j;
        },
        set: function (a) {
            this.j = a;
            for (var b = 0; b < 4; b++) {
                for (var c = 0; c < 4; c++) {
                    this.c._worksheets$i._item(0)._rows$i.item(b)._cells$i.item(c).cellFormat.font.colorInfo = new WorkbookColorInfo(a);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BorderPreviewSpreadsheetHelper.prototype, "f", {
        get: function () {
            return this.a.s;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BorderPreviewSpreadsheetHelper.prototype, "g", {
        get: function () {
            return this.a.t;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(BorderPreviewSpreadsheetHelper.prototype, "d", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    BorderPreviewSpreadsheetHelper.prototype.e = function (a, b, c) {
        return this.a.f(a, b, c);
    };
    BorderPreviewSpreadsheetHelper.prototype.h = function (a, b, c) {
        return this.a.u(a, b, c);
    };
    BorderPreviewSpreadsheetHelper.$t = markType(BorderPreviewSpreadsheetHelper, 'BorderPreviewSpreadsheetHelper');
    return BorderPreviewSpreadsheetHelper;
}(Base));
export { BorderPreviewSpreadsheetHelper };
/**
 * @hidden
 */
var ColorSortingCriteriaControl = /** @class */ (function (_super) {
    tslib_1.__extends(ColorSortingCriteriaControl, _super);
    function ColorSortingCriteriaControl(a, b) {
        var _this = _super.call(this) || this;
        _this.p = 50;
        _this.o = 15;
        _this.r = "<img src='${image}' width='{0}px' height='{1}px'/><span>${displayText}</span>";
        _this.q = "<img src='{0}' width='{1}px' height='{2}px' /><span class='{4}'>{3}</span>";
        _this.d = new WorkbookColorInfo(Colors.a);
        _this.c = null;
        _this.a = null;
        _this.b = null;
        _this.i = null;
        _this.m = null;
        _this.n = null;
        _this.e = true;
        _this.f = new Dictionary$2(ColorSortingCriteriaControl_ColorSortingCriteriaElementPart_$type, HTMLElement.$, 1, 3);
        _this.a = a;
        _this.c = b;
        _this.s();
        return _this;
    }
    ColorSortingCriteriaControl.prototype.k = function () {
        var a;
        this.m = document.createElement("div");
        this.m.id = "cboColor";
        a = SpreadsheetDialogUtilities.j(1, 1, 1, 1, "display: block; width: 100%;");
        this.m.setAttribute("style", a);
        return this.m;
    };
    ColorSortingCriteriaControl.prototype.l = function () {
        var _this = this;
        var a;
        var b = this.a.css;
        this.n = document.createElement("select");
        this.n.id = "cboDirection";
        a = SpreadsheetDialogUtilities.j(1, 1, 2, 1, "display: block; width: 100%;");
        this.n.setAttribute("style", a);
        this.ab();
        var c = function (d) {
            if (_this.e) {
                return;
            }
            var e = EnumUtil.getEnumValue(SortDirectionWithCustomListOptions_$type, SpreadsheetDialogUtilities.i(_this.n, SortDirectionWithCustomListOptions_$type));
            _this.b._e = e;
        };
        var d = c;
        this.n.addEventListener("change", d, false);
        return this.n;
    };
    ColorSortingCriteriaControl.prototype.s = function () {
        var a = this.a.css;
        this.i = document.createElement("div");
        this.i.id = "colorSortingCriteriaControl";
        var b = document.createElement("div");
        b.id = "colorSortingCriteriaControlInnerGrid";
        this.i.appendChild(b);
        var c = SpreadsheetDialogUtilities.k("auto", "1fr 1fr", "3px");
        b.setAttribute("style", c);
        var d = this.k();
        var e = this.l();
        this.f.item(0, d);
        this.f.item(1, e);
        b.appendChild(d);
        b.appendChild(e);
    };
    ColorSortingCriteriaControl.g = function (a, b) {
        var c = document.createElement("canvas");
        c.width = a;
        c.height = b;
        return c;
    };
    ColorSortingCriteriaControl.prototype.h = function (a) {
        var b;
        var c;
        var d = this.v(b, c);
        b = d.p0;
        c = d.p1;
        var e = null;
        switch (this.b._h) {
            case 1:
                var f = typeCast(CellFill.$, a.dataValue);
                if (null != f) {
                    e = SpreadsheetUtilities.ce(this.a, f, b, c, this.d);
                }
                break;
            case 2:
                var g = typeCast(WorkbookColorInfo.$, a.dataValue);
                if (WorkbookColorInfo.l_op_Inequality(null, g)) {
                    e = SpreadsheetUtilities.cg(this.a, g, b, c, this.d);
                }
                break;
            case 3:
                var h = typeCast(Tuple$2.$.specialize(FormatConditionIconSet_$type, Nullable$1.$.specialize(Number_$type)), a.dataValue);
                if (null != h) {
                    var i = h.c;
                    var j = h.d;
                    var k = SpreadsheetUtilities.am(i, j);
                    e = SpreadsheetUtilities.cf(this.a, k, b, c);
                }
                break;
            case 0:
            case 4: break;
            default: break;
        }
        var l = e != null ? e.getNativeElement() : null;
        if (null == l) {
            l = ColorSortingCriteriaControl.g(b, c);
        }
        {
            l.style.verticalAlign = "middle";
            l.style.marginRight = "5px";
        }
        return l;
    };
    ColorSortingCriteriaControl.prototype.u = function (a) {
        switch (a) {
            case "cboColor":
                this.m.focus();
                break;
            default: break;
        }
    };
    ColorSortingCriteriaControl.prototype.v = function (a, b) {
        switch (this.b._h) {
            case 4:
            case 0:
                a = 0;
                b = 0;
                break;
            case 1:
            case 2:
                a = this.p;
                b = this.o;
                break;
            case 3:
                a = 16;
                b = 16;
                break;
            default:
                a = 0;
                b = 0;
                break;
        }
        return {
            p0: a,
            p1: b
        };
    };
    ColorSortingCriteriaControl.prototype.w = function (a, b, c, d) {
        b = null;
        c = null;
        d = null;
        if (null != a) {
            var e = (a.count());
            if (e == 1) {
                var f = a[0];
                var g = f.data;
                b = g.dataValue;
                c = (g.displayText);
                d = g.image;
            }
        }
        return {
            p1: b,
            p2: c,
            p3: d
        };
    };
    ColorSortingCriteriaControl.prototype.x = function () {
    };
    ColorSortingCriteriaControl.prototype.y = function (a) {
        this.b = a;
        this.n.value = EnumUtil.getName(SortDirectionWithCustomListOptions_$type, a._e);
        var b = this.b;
        b.propertyChanged = delegateCombine(b.propertyChanged, runOn(this, this.aa));
        this.ac();
        var c = this.b._u();
        this.z(c);
        this.ad();
        this.e = false;
    };
    ColorSortingCriteriaControl.prototype.z = function (a) {
    };
    ColorSortingCriteriaControl.prototype.ab = function () {
        SpreadsheetDialogUtilities.n(this.n, this.c._an);
    };
    ColorSortingCriteriaControl.prototype.ac = function () {
    };
    ColorSortingCriteriaControl.prototype.ad = function () {
    };
    ColorSortingCriteriaControl.prototype.ae = function (a) {
    };
    Object.defineProperty(ColorSortingCriteriaControl.prototype, "j", {
        get: function () {
            return this.i;
        },
        enumerable: true,
        configurable: true
    });
    ColorSortingCriteriaControl.prototype.t = function (a, b) {
        var c = b.items;
        var d;
        var e;
        var f;
        var g = this.w(c, d, e, f);
        d = g.p1;
        e = g.p2;
        f = g.p3;
        this.b._aa = d;
        this.ae(c);
    };
    ColorSortingCriteriaControl.prototype.aa = function (a, b) {
        switch (b.propertyName) {
            case "ColorSortingCriteriaListItems":
                this.ac();
                break;
        }
    };
    ColorSortingCriteriaControl.$t = markType(ColorSortingCriteriaControl, 'ColorSortingCriteriaControl');
    return ColorSortingCriteriaControl;
}(Base));
export { ColorSortingCriteriaControl };
/**
 * @hidden
 */
var SortCriteriaRow = /** @class */ (function (_super) {
    tslib_1.__extends(SortCriteriaRow, _super);
    function SortCriteriaRow(a, b, c) {
        var _this = _super.call(this) || this;
        _this._d = null;
        _this._b = null;
        _this._c = null;
        _this._k = null;
        _this._m = null;
        _this._n = null;
        _this._g = null;
        _this._a = null;
        _this._f = new Dictionary$2(SortCriteriaRow_RowElementPart_$type, HTMLElement.$, 1, 3);
        _this._o = null;
        _this._b = a;
        _this._d = b;
        _this._c = c;
        _this._p();
        var d = _this._c;
        d.propertyChanged = delegateCombine(d.propertyChanged, runOn(_this, _this._t));
        return _this;
    }
    SortCriteriaRow.prototype._h = function () {
        var _this = this;
        var a;
        var b = this._b.css;
        var c = document.createElement("div");
        c.id = "pnlColumn";
        var d = document.createElement("div");
        d.id = "pnlColumnContentsGrid";
        a = SpreadsheetDialogUtilities.k("auto", "auto 1fr", "3px");
        d.setAttribute("style", a);
        c.appendChild(d);
        this._k = document.createElement("label");
        this._k.id = "lblLabel";
        a = SpreadsheetDialogUtilities.j(1, 1, 1, 1, "display: block; ");
        this._k.setAttribute("style", a);
        this._k.innerText = this._c._af;
        d.appendChild(this._k);
        this._m = document.createElement("select");
        this._m.id = "cbCombo";
        a = SpreadsheetDialogUtilities.j(1, 1, 2, 1, "display: block; width: 100%;");
        this._m.setAttribute("style", a);
        this._y(false);
        d.appendChild(this._m);
        var e = function (f) {
            var g = SpreadsheetDialogUtilities.h(_this._m);
            _this._c._t = Convert.toInt321(g);
        };
        var f = e;
        this._m.addEventListener("change", f, false);
        return c;
    };
    SortCriteriaRow.prototype._p = function () {
        var a = this._b.css;
        this._f.item(0, this._h());
        this._f.item(1, this._j());
        this._f.item(2, this._i());
        this._x();
        this._aa();
        this._u();
    };
    SortCriteriaRow.prototype._i = function () {
        var _this = this;
        var a;
        var b = this._b.css;
        this._g = document.createElement("div");
        this._g.id = "pnlSortCriteria";
        var c = document.createElement("div");
        this._g.id = "orderElementInnerGrid";
        a = SpreadsheetDialogUtilities.k("1fr", "1fr", "0px", "width:100%; height:100%");
        c.setAttribute("style", a);
        this._g.appendChild(c);
        this._n = document.createElement("select");
        this._n.id = "cboSortDirection";
        a = SpreadsheetDialogUtilities.j(1, 1, 1, 1, "width:100%; height:100%");
        this._n.setAttribute("style", a);
        this._ab(false);
        var d = function (e) {
            var f = EnumUtil.getEnumValue(SortDirectionWithCustomListOptions_$type, SpreadsheetDialogUtilities.i(_this._n, SortDirectionWithCustomListOptions_$type));
            _this._c._e = f;
        };
        var e = d;
        this._n.addEventListener("change", e, false);
        this._a = new ColorSortingCriteriaControl(this._b, this._d);
        var f = this._a.j;
        f.id = "colorSortingCriteriaControl";
        f.setAttribute("style", a);
        c.appendChild(this._n);
        c.appendChild(f);
        return this._g;
    };
    SortCriteriaRow.prototype._j = function () {
        var _this = this;
        var a = this._b.css;
        this._o = document.createElement("select");
        this._o.id = "cboSortType";
        SpreadsheetDialogUtilities.n(this._o, this._d._ap);
        var b = function (c) {
            if (null != _this._o.value) {
                var d = EnumUtil.getEnumValue(SpreadsheetSortDialogConditionType_$type, SpreadsheetDialogUtilities.i(_this._o, SpreadsheetSortDialogConditionType_$type));
                _this._c._g = d;
            }
        };
        var c = b;
        this._o.addEventListener("change", c, false);
        return this._o;
    };
    SortCriteriaRow.prototype._q = function (a) {
        switch (a) {
            case "cboColor":
                this._a.u(a);
                break;
            default: break;
        }
    };
    SortCriteriaRow.prototype._r = function () {
        this._a.x();
        this._s(this._c);
        this._z();
    };
    SortCriteriaRow.prototype._s = function (a) {
        this._o.value = EnumUtil.getName(SpreadsheetSortDialogConditionType_$type, a._g);
        this._m.value = a._t.toString();
        switch (a._g) {
            case 4: break;
            case 0:
                this._n.value = EnumUtil.getName(SortDirectionWithCustomListOptions_$type, a._e);
                break;
            case 1:
            case 2:
            case 3:
                this._n.value = EnumUtil.getName(SortDirectionWithCustomListOptions_$type, (0));
                break;
        }
        this._a.y(a);
    };
    SortCriteriaRow.prototype._u = function () {
        var a = this._b.css;
        var b = new StringBuilder(0);
        b.l(a.sortDialogSortConditionRow);
        if (this._e) {
            b.l(" ");
            b.l(a.sortDialogSortConditionActiveRow);
        }
        this._item(0).className = b.toString();
    };
    SortCriteriaRow.prototype._v = function () {
        this._a.ab();
    };
    SortCriteriaRow.prototype._w = function () {
        this._a.ac();
    };
    SortCriteriaRow.prototype._x = function () {
        var a;
        a = SpreadsheetDialogUtilities.j(this._c._w + 1, 1, 1, 1, "display: block; width: 100%;");
        this._item(0).setAttribute("style", a);
        a = SpreadsheetDialogUtilities.j(this._c._w + 1, 1, 2, 1, "display: block; width: 100%;");
        this._item(1).setAttribute("style", a);
        a = SpreadsheetDialogUtilities.j(this._c._w + 1, 1, 3, 1, "display: block; width: 100%;");
        this._item(2).setAttribute("style", a);
    };
    SortCriteriaRow.prototype._y = function (a) {
        var b = SpreadsheetDialogUtilities.h(this._m);
        SpreadsheetDialogUtilities.n(this._m, this._d._b);
        if (a) {
            this._m.value = b;
        }
    };
    SortCriteriaRow.prototype._z = function () {
        this._k.innerText = this._c._af;
    };
    SortCriteriaRow.prototype._aa = function () {
        var a = this._c._h;
        switch (a) {
            case 0:
                this._n.style.visibility = "visible";
                this._a.j.style.visibility = "hidden";
                break;
            case 1:
            case 2:
            case 3:
            case 4:
                this._n.style.visibility = "hidden";
                this._a.j.style.visibility = "visible";
                break;
        }
    };
    SortCriteriaRow.prototype._ab = function (a) {
        var b = SpreadsheetDialogUtilities.h(this._n);
        SpreadsheetDialogUtilities.n(this._n, this._c._r);
        if (a) {
            this._n.value = b;
        }
    };
    SortCriteriaRow.prototype._item = function (a) {
        return this._f.item(a);
    };
    Object.defineProperty(SortCriteriaRow.prototype, "_e", {
        get: function () {
            return this._c._m;
        },
        enumerable: true,
        configurable: true
    });
    SortCriteriaRow.prototype.getEnumerator = function () {
        return new SortCriteriaRow_SortCriteriaRowEnumerator(this);
    };
    SortCriteriaRow.prototype.getEnumeratorObject = function () {
        return new SortCriteriaRow_SortCriteriaRowEnumerator(this);
    };
    SortCriteriaRow.prototype._t = function (a, b) {
        switch (b.propertyName) {
            case "SortByLabelText":
                this._z();
                break;
            case "SortConditionType":
                this._aa();
                this._ab(false);
                this._w();
                break;
            case "SortDirection":
                this._n.value = EnumUtil.getName(SortDirectionWithCustomListOptions_$type, this._c._e);
                break;
            case "Column":
                this._ab(true);
                this._w();
                break;
        }
    };
    SortCriteriaRow.$t = markType(SortCriteriaRow, 'SortCriteriaRow', Base.$, [IEnumerable$1_$type.specialize(HTMLElement.$)]);
    return SortCriteriaRow;
}(Base));
export { SortCriteriaRow };
/**
 * @hidden
 */
var SortCriteriaRow_SortCriteriaRowEnumerator = /** @class */ (function (_super) {
    tslib_1.__extends(SortCriteriaRow_SortCriteriaRowEnumerator, _super);
    function SortCriteriaRow_SortCriteriaRowEnumerator(a) {
        var _this = _super.call(this) || this;
        _this._a = null;
        _this._b = -1;
        _this._a = a;
        return _this;
    }
    Object.defineProperty(SortCriteriaRow_SortCriteriaRowEnumerator.prototype, "current", {
        get: function () {
            return this._a._item(this._b);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortCriteriaRow_SortCriteriaRowEnumerator.prototype, "currentObject", {
        get: function () {
            return this._a._item(this._b);
        },
        enumerable: true,
        configurable: true
    });
    SortCriteriaRow_SortCriteriaRowEnumerator.prototype.dispose = function () {
    };
    SortCriteriaRow_SortCriteriaRowEnumerator.prototype.moveNext = function () {
        this._b++;
        return (this._b < this._a._f.count);
    };
    SortCriteriaRow_SortCriteriaRowEnumerator.prototype.reset = function () {
        this._b = 0;
    };
    SortCriteriaRow_SortCriteriaRowEnumerator.$t = markType(SortCriteriaRow_SortCriteriaRowEnumerator, 'SortCriteriaRow_SortCriteriaRowEnumerator', Base.$, [IEnumerator_$type, IEnumerator$1_$type.specialize(HTMLElement.$)]);
    return SortCriteriaRow_SortCriteriaRowEnumerator;
}(Base));
export { SortCriteriaRow_SortCriteriaRowEnumerator };
/**
 * @hidden
 */
var SortOptionsDialogManager = /** @class */ (function (_super) {
    tslib_1.__extends(SortOptionsDialogManager, _super);
    function SortOptionsDialogManager(a, b, c) {
        var _this = _super.call(this) || this;
        _this.c = null;
        _this.d = null;
        _this.b = null;
        _this.a = null;
        _this.h = null;
        _this.e = null;
        _this.g = null;
        _this.f = null;
        _this.b = a;
        _this.c = b;
        _this.h = c;
        return _this;
    }
    SortOptionsDialogManager.prototype.k = function () {
        this.c._ab = this.e.checked;
        if (this.f.checked) {
            this.c._p = 1;
        }
        else {
            this.c._p = 0;
        }
    };
    SortOptionsDialogManager.prototype.m = function () {
        var a = this.b.css;
        this.d = document.createElement("div");
        this.d.className = a.sortDialog;
        this.d.id = "SortOptionsDialog_Main_Content_Element";
        this.l(a);
        this.o(a);
        this.n(a);
    };
    SortOptionsDialogManager.prototype.l = function (a) {
        var _this = this;
        var b;
        var c = document.createElement("div");
        c.className = a.sortOptionsDialogCaseSensitiveCheckboxArea;
        var d;
        var e = ((function () { var f = _this.j("SortOptionsDialog_CaseSensitive", b); b = f.p1; return f.ret; })());
        var f = ((function () { var g = SpreadsheetDialogUtilities.c("chkCaseSensitive", e, b, d); d = g.p3; return g.ret; })());
        this.e = d;
        c.appendChild(f);
        this.d.appendChild(c);
    };
    SortOptionsDialogManager.prototype.o = function (a) {
        var _this = this;
        var b;
        var c = document.createElement("div");
        c.className = a.sortOptionsDialogOrientationArea;
        this.d.appendChild(c);
        var d = document.createElement("label");
        d.id = "lblOrientation";
        d.innerText = ((function () { var e = _this.j("SortOptionsDialog_Orientation", b); b = e.p1; return e.ret; })());
        d.accessKey = b;
        c.appendChild(d);
        var e = document.createElement("br");
        c.appendChild(e);
        var f;
        var g = ((function () { var h = _this.j("SortOptionsDialog_SortTopToBottom", b); b = h.p1; return h.ret; })());
        var h = ((function () { var i = SpreadsheetDialogUtilities.d("radSortTopToBottom", "sortOrientation", g, b, f); f = i.p4; return i.ret; })());
        this.g = f;
        c.appendChild(h);
        e = document.createElement("br");
        c.appendChild(e);
        var i;
        var j = ((function () { var k = _this.j("SortOptionsDialog_SortLeftToRight", b); b = k.p1; return k.ret; })());
        var k = ((function () { var l = SpreadsheetDialogUtilities.d("radSortLeftToRight", "sortOrientation", j, b, i); i = l.p4; return l.ret; })());
        this.f = i;
        c.appendChild(k);
        this.f.disabled = !this.c._t;
        e = document.createElement("br");
        c.appendChild(e);
        this.d.appendChild(c);
    };
    SortOptionsDialogManager.prototype.n = function (a) {
        var _this = this;
        var b;
        var c = document.createElement("div");
        c.className = a.sortOptionsDialogOkCancelButtonsArea;
        var d = SpreadsheetDialogUtilities.a();
        var e = function (f) {
            _this.k();
            _this.p();
        };
        var f = e;
        d.id = "btnOK";
        d.addEventListener("click", f, false);
        d.innerText = ((function () { var g = _this.j("SortOptionsDialog_OK", b); b = g.p1; return g.ret; })());
        d.accessKey = b;
        var g = SpreadsheetDialogUtilities.a();
        var h = function (i) { return _this.p(); };
        var i = h;
        g.id = "btnCancel";
        g.addEventListener("click", i, false);
        g.innerText = ((function () { var j = _this.j("SortOptionsDialog_Cancel", b); b = j.p1; return j.ret; })());
        g.accessKey = b;
        c.appendChild(d);
        c.appendChild(g);
        this.d.appendChild(c);
    };
    SortOptionsDialogManager.prototype.p = function () {
        this.a.close(false);
    };
    SortOptionsDialogManager.prototype.i = function (a) {
        var b = this.b._fs(a);
        b = SpreadsheetUtilities.c2(b);
        return b;
    };
    SortOptionsDialogManager.prototype.j = function (a, b) {
        var c = this.b._fs(a);
        c = ((function () { var d = SpreadsheetUtilities.c3(c, b); b = d.p1; return d.ret; })());
        return {
            ret: c,
            p1: b
        };
    };
    SortOptionsDialogManager.prototype.q = function () {
        this.e.checked = this.c._ab;
        switch (this.c._p) {
            case 1:
                this.f.checked = true;
                break;
            case 0:
                this.g.checked = true;
                break;
        }
    };
    SortOptionsDialogManager.prototype.r = function () {
        var _this = this;
        this.m();
        this.q();
        var a = this.d;
        var b = this.b._fs("SortOptionsDialog_Title");
        var c = function () { return SpreadsheetUtilities.d7(_this.h); };
        this.a = this.b._q(a, b, c);
    };
    SortOptionsDialogManager.$t = markType(SortOptionsDialogManager, 'SortOptionsDialogManager');
    return SortOptionsDialogManager;
}(Base));
export { SortOptionsDialogManager };
/**
 * @hidden
 */
var SortDialogManager = /** @class */ (function (_super) {
    tslib_1.__extends(SortDialogManager, _super);
    function SortDialogManager(a, b) {
        var _this = _super.call(this) || this;
        _this.e = null;
        _this.r = null;
        _this.d = null;
        _this.c = null;
        _this.b = null;
        _this.v = Nullable$1.toNullable(Number_$type, null);
        _this.g = new List$1(SortCriteriaRow.$, 0);
        _this.m = null;
        _this.l = null;
        _this.s = null;
        _this.o = null;
        _this.q = null;
        _this.p = null;
        _this.i = null;
        _this.h = null;
        _this.k = null;
        _this.j = null;
        _this.n = null;
        _this.d = a;
        _this.e = b;
        var c = _this.e;
        c._activeRowIndexChanged = delegateCombine(c._activeRowIndexChanged, runOn(_this, _this.am));
        var d = _this.e;
        d.propertyChanged = delegateCombine(d.propertyChanged, runOn(_this, _this.an));
        return _this;
    }
    Object.defineProperty(SortDialogManager.prototype, "u", {
        get: function () {
            if (nullableEquals(null, this.v)) {
                this.v = Nullable$1.toNullable(Number_$type, SpreadsheetDialogUtilities.g());
            }
            return this.v.value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(SortDialogManager.prototype, "y", {
        get: function () {
            return stringFormat("{0}px", this.u);
        },
        enumerable: true,
        configurable: true
    });
    SortDialogManager.prototype.t = function (a) {
        var b = this.g.count;
        this.ag(b, a);
        return b;
    };
    SortDialogManager.prototype.f = function () {
        var _this = this;
        var a = false;
        var b = null;
        this.d._gi(43, function () { return a = ((function () { var c = _this.e._u(b); b = c.p0; return c.ret; })()); });
        if (false == a) {
            if (null == b) {
                return false;
            }
            var c = b.b;
            if (-1 != c) {
                this.e._ax = Nullable$1.toNullable(Number_$type, c);
                switch (b.d) {
                    case "Cell Color":
                    case "Font Color":
                    case "Conditional Formatting Icon":
                        this.g._inner[c]._q("cboColor");
                        break;
                    default: break;
                }
            }
            alert(b.c);
        }
        return a;
    };
    SortDialogManager.prototype.z = function () {
        var a = this.d.css;
        this.r = document.createElement("div");
        this.r.className = a.sortDialog;
        this.r.id = "SortDialog_Main_Content_Element";
        this.ad(a);
        this.ac(a);
        this.ab(a);
        this.aa(a);
    };
    SortDialogManager.prototype.ad = function (a) {
        var _this = this;
        var b;
        var c = document.createElement("div");
        c.className = a.sortDialogTopButtonsArea;
        this.r.appendChild(c);
        var d = SpreadsheetDialogUtilities.a();
        d.className = a.sortDialogAddLevelButton;
        var e = function (f) { return _this.e._f(); };
        var f = e;
        d.id = "btnAddLevel";
        d.addEventListener("click", f, false);
        d.innerText = ((function () { var g = _this.x("SortDialog_AddLevel", b); b = g.p1; return g.ret; })());
        d.accessKey = b;
        this.i = SpreadsheetDialogUtilities.a();
        this.i.className = a.sortDialogDeleteLevelButton;
        var g = function (h) { return _this.e._bv(); };
        var h = g;
        this.i.id = "btnDeleteLevel";
        this.i.addEventListener("click", h, false);
        this.i.innerText = ((function () { var i = _this.x("SortDialog_DeleteLevel", b); b = i.p1; return i.ret; })());
        this.i.accessKey = b;
        this.h = SpreadsheetDialogUtilities.a();
        this.h.className = a.sortDialogCopyLevelButton;
        var i = function (j) { return _this.e._bu(); };
        var j = i;
        this.h.id = "btnCopyLevel";
        this.h.addEventListener("click", j, false);
        this.h.innerText = ((function () { var k = _this.x("SortDialog_CopyLevel", b); b = k.p1; return k.ret; })());
        this.h.accessKey = b;
        this.k = SpreadsheetDialogUtilities.a();
        this.k.className = a.sortDialogMoveUpButton;
        var k = function (l) { return _this.e._b0(); };
        var l = k;
        this.k.id = "btnMoveUp";
        this.k.addEventListener("click", l, false);
        this.k.innerText = ((function () { var m = _this.x("SortDialog_MoveUp", b); b = m.p1; return m.ret; })());
        this.k.accessKey = b;
        this.j = SpreadsheetDialogUtilities.a();
        this.j.className = a.sortDialogMoveDownButton;
        var m = function (n) { return _this.e._bz(); };
        var n = m;
        this.j.id = "btnMoveDown";
        this.j.addEventListener("click", n, false);
        this.j.innerText = ((function () { var o = _this.x("SortDialog_MoveDown", b); b = o.p1; return o.ret; })());
        this.j.accessKey = b;
        var o = SpreadsheetDialogUtilities.a();
        var p = function (q) { return _this.ak(); };
        var q = p;
        o.id = "btnOptions";
        o.addEventListener("click", q, false);
        o.innerText = ((function () { var r = _this.x("SortDialog_Options", b); b = r.p1; return r.ret; })());
        o.accessKey = b;
        var r = ((function () { var s = _this.x("SortDialog_MyDataHasHeaders", b); b = s.p1; return s.ret; })());
        this.n = ((function () { var s = SpreadsheetDialogUtilities.c("chkDataHasHeaders", r, b, _this.s); _this.s = s.p3; return s.ret; })());
        this.n.className = a.sortDialogMyDataHasHeaderCheckBox;
        var s = function (t) { return _this.e._ah = _this.s.checked; };
        var t = s;
        this.s.addEventListener("change", t, false);
        c.appendChild(d);
        c.appendChild(this.i);
        c.appendChild(this.h);
        c.appendChild(this.k);
        c.appendChild(this.j);
        c.appendChild(o);
        c.appendChild(this.n);
    };
    SortDialogManager.prototype.ac = function (a) {
        var b = document.createElement("div");
        this.m = document.createElement("div");
        this.m.id = "grdHeaders";
        var c = stringFormat("margin-right:{0};", this.y);
        b.setAttribute("style", c);
        this.o = document.createElement("label");
        this.o.className = a.sortDialogSortConditionsGridHeader;
        this.aq();
        this.o.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 1, 1, "display: block; "));
        this.q = document.createElement("label");
        this.q.className = a.sortDialogSortConditionsGridHeader;
        this.q.innerText = this.e._bi;
        this.q.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 2, 1, "display: block; "));
        this.p = document.createElement("label");
        this.p.className = a.sortDialogSortConditionsGridHeader;
        this.p.innerText = this.e._bf;
        this.p.setAttribute("style", SpreadsheetDialogUtilities.j(1, 1, 3, 1, "display: block; "));
        this.m.appendChild(this.o);
        this.m.appendChild(this.q);
        this.m.appendChild(this.p);
        b.appendChild(this.m);
        this.r.appendChild(b);
    };
    SortDialogManager.prototype.ab = function (a) {
        var b = new StringBuilder(0);
        var c = document.createElement("div");
        c.id = "divScroll";
        b.l("overflow-y:scroll;");
        b.l("height:200px;");
        c.setAttribute("style", b.toString());
        this.l = document.createElement("div");
        this.l.id = "grdSortConditions";
        c.appendChild(this.l);
        this.r.appendChild(c);
    };
    SortDialogManager.prototype.aa = function (a) {
        var _this = this;
        var b;
        var c = document.createElement("div");
        c.className = a.sortDialogOkCancelButtonsArea;
        var d = SpreadsheetDialogUtilities.a();
        var e = function (f) {
            var g = _this.f();
            if (g) {
                _this.af();
            }
        };
        var f = e;
        d.id = "btnOK";
        d.addEventListener("click", f, false);
        d.innerText = ((function () { var g = _this.x("SortDialog_OK", b); b = g.p1; return g.ret; })());
        d.accessKey = b;
        var g = SpreadsheetDialogUtilities.a();
        var h = function (i) { return _this.af(); };
        var i = h;
        g.id = "btnCancel";
        g.addEventListener("click", i, false);
        g.innerText = ((function () { var j = _this.x("SortDialog_Cancel", b); b = j.p1; return j.ret; })());
        g.accessKey = b;
        c.appendChild(d);
        c.appendChild(g);
        this.r.appendChild(c);
    };
    SortDialogManager.prototype.ae = function () {
        for (var a = this.g.count - 1; a >= 0; a--) {
            var b = this.g._inner[a];
            this.ai(b);
        }
        this.g.clear();
    };
    SortDialogManager.prototype.af = function () {
        this.c.close(false);
    };
    SortDialogManager.prototype.a = function (a, b) {
        var e_311, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(this.g)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var c = _2.value;
                if (c._item(b) == a) {
                    return c;
                }
            }
        }
        catch (e_311_1) { e_311 = { error: e_311_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_311) throw e_311.error; }
        }
        return null;
    };
    SortDialogManager.prototype.w = function (a) {
        var b = this.d._fs(a);
        b = SpreadsheetUtilities.c2(b);
        return b;
    };
    SortDialogManager.prototype.x = function (a, b) {
        var c = this.d._fs(a);
        c = ((function () { var d = SpreadsheetUtilities.c3(c, b); b = d.p1; return d.ret; })());
        return {
            ret: c,
            p1: b
        };
    };
    SortDialogManager.prototype.ag = function (a, b) {
        var c = new SortCriteriaRow(this.d, this.e, b);
        var d = a * 3;
        var e = c._item(0);
        SpreadsheetDialogUtilities.m(this.l, e, d);
        d++;
        var f = c._item(1);
        SpreadsheetDialogUtilities.m(this.l, f, d);
        d++;
        var g = c._item(2);
        SpreadsheetDialogUtilities.m(this.l, g, d);
        this.g.insert(a, c);
        c._r();
    };
    SortDialogManager.prototype.ah = function (a, b) {
        if (a.hasValue) {
            var c = a.value;
            if (c >= 0 && c < this.g.count) {
                this.g._inner[c]._u();
            }
        }
        if (b.hasValue) {
            var d = b.value;
            this.g._inner[d]._u();
        }
        this.ap();
    };
    SortDialogManager.prototype.ai = function (a) {
        var e_312, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                this.l.removeChild(b);
            }
        }
        catch (e_312_1) { e_312 = { error: e_312_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_312) throw e_312.error; }
        }
        this.g.remove(a);
    };
    SortDialogManager.prototype.ao = function () {
        var e_313, _0;
        this.ae();
        var a = this.e._ar;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                this.t(b);
            }
        }
        catch (e_313_1) { e_313 = { error: e_313_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_313) throw e_313.error; }
        }
        this.ah(Nullable$1.toNullable(Number_$type, null), this.e._ax);
    };
    SortDialogManager.prototype.ap = function () {
        this.k.disabled = !this.e._z;
        this.j.disabled = !this.e._y;
        this.h.disabled = !this.e._w;
        this.i.disabled = !this.e._x;
    };
    SortDialogManager.prototype.aq = function () {
        this.o.innerText = this.e._a3;
    };
    SortDialogManager.prototype.ar = function () {
        this.s.disabled = !this.e._aj;
    };
    SortDialogManager.prototype.aj = function (a) {
        var _this = this;
        this.z();
        var b = this.r;
        var c = this.d._fs("SortDialog_Title");
        var d = runOn(this, this.as);
        window.addEventListener("focus", d, true);
        var e = function () {
            window.removeEventListener("focus", d, true);
            if (a != null) {
                a();
            }
            _this.d._v.focus();
        };
        this.c = this.d._q(b, c, e);
        this.s.checked = this.e._ah;
        this.s.disabled = !this.e._aj;
        this.ao();
        var f = this.e._ar;
        f.collectionChanged = delegateCombine(f.collectionChanged, runOn(this, this.al));
        var g = this.r.innerHTML;
    };
    SortDialogManager.prototype.ak = function () {
        var a = document.activeElement;
        this.b = new SortOptionsDialogManager(this.d, this.e, a);
        this.b.r();
    };
    SortDialogManager.prototype.al = function (a, b) {
        switch (b.action) {
            case 0:
                var c = b.newItems.item(0);
                this.ag(b.newStartingIndex, c);
                for (var d = b.newStartingIndex; d < this.g.count; d++) {
                    this.g._inner[d]._x();
                }
                break;
            case 1:
                this.ai(this.g._inner[b.oldStartingIndex]);
                for (var e = b.oldStartingIndex; e < this.g.count; e++) {
                    this.g._inner[e]._x();
                }
                break;
            case 4:
                this.ao();
                break;
        }
    };
    SortDialogManager.prototype.am = function (a, b) {
        this.ah(b._oldActiveRowIndex, b._newActiveRowIndex);
    };
    SortDialogManager.prototype.an = function (a, b) {
        var e_314, _0, e_315, _1;
        switch (b.propertyName) {
            case "SortOrientation":
                this.aq();
                try {
                    for (var _2 = tslib_1.__values(fromEnum(this.g)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                        var c = _3.value;
                        c._y(false);
                        c._v();
                        c._ab(true);
                        c._w();
                    }
                }
                catch (e_314_1) { e_314 = { error: e_314_1 }; }
                finally {
                    try {
                        if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                    }
                    finally { if (e_314) throw e_314.error; }
                }
                break;
            case "ColumnColumnHeaderText":
                this.aq();
                break;
            case "MyDataHasHeadersEnabled":
                this.ar();
                break;
            case "MyDataHasHeaders":
                try {
                    for (var _4 = tslib_1.__values(fromEnum(this.g)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                        var d = _5.value;
                        d._y(true);
                    }
                }
                catch (e_315_1) { e_315 = { error: e_315_1 }; }
                finally {
                    try {
                        if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
                    }
                    finally { if (e_315) throw e_315.error; }
                }
                break;
        }
    };
    SortDialogManager.prototype.as = function (a) {
        var b = document.activeElement;
        if (null == b) {
            return;
        }
        var c = b;
        var d = null;
        var t1 = c.id;
        L0: while (true) {
            switch (t1) {
                case "pnlColumn":
                    d = this.a(c, 0);
                    break;
                case "cboSortType":
                    d = this.a(c, 1);
                    break;
                case "pnlSortCriteria":
                    d = this.a(c, 2);
                    break;
                case "cbCombo":
                case "lvlLabel":
                case "cboColumn":
                    c = SpreadsheetDialogUtilities.e(c, "pnlColumn");
                    if (null != c) {
                        t1 = "pnlColumn";
                        continue L0;
                    }
                    break;
                case "cboSortDirection":
                case "colorSortingCriteriaControl":
                case "cboColor":
                case "cboDirection":
                    c = SpreadsheetDialogUtilities.e(c, "pnlSortCriteria");
                    if (null != c) {
                        t1 = "pnlSortCriteria";
                        continue L0;
                    }
                    break;
            }
            break;
        }
        if (null != d) {
            var e = this.g.indexOf(d);
            this.e._ax = Nullable$1.toNullable(Number_$type, e);
        }
    };
    SortDialogManager.$t = markType(SortDialogManager, 'SortDialogManager');
    return SortDialogManager;
}(Base));
export { SortDialogManager };
/**
 * @hidden
 */
var TopOrBottomDialogManager = /** @class */ (function (_super) {
    tslib_1.__extends(TopOrBottomDialogManager, _super);
    function TopOrBottomDialogManager(a, b) {
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.f = null;
        _this.c = null;
        _this.b = null;
        _this.h = null;
        _this.g = null;
        _this.i = null;
        _this.c = a;
        _this.a = b;
        return _this;
    }
    TopOrBottomDialogManager.prototype.m = function () {
        var _this = this;
        var a = this.e();
        var b = this.j();
        var c = this.d();
        this.c._gi(43, function () { return _this.a.q(a, c, b); });
    };
    TopOrBottomDialogManager.prototype.n = function () {
        var _this = this;
        var e_316, _0, e_317, _1;
        var a;
        var b = this.c.css;
        this.f = document.createElement("div");
        this.f.className = b.topOrBottomDialog;
        this.f.id = "TopOrBottomDialog_Main_Content_Element";
        var c = document.createElement("div");
        c.innerText = this.k("TopOrBottomDialog_Show");
        c.className = b.topOrBottomDialogShow;
        this.f.appendChild(c);
        var d = document.createElement("div");
        d.className = b.topOrBottomDialogInputArea;
        this.f.appendChild(d);
        this.h = document.createElement("select");
        this.h.id = "cboOperator";
        d.appendChild(this.h);
        this.g = document.createElement("input");
        this.g.id = "nudValue";
        d.appendChild(this.g);
        this.i = document.createElement("select");
        this.i.id = "cboType";
        d.appendChild(this.i);
        var e = document.createElement("div");
        e.className = b.topOrBottomDialogButtons;
        var f = SpreadsheetDialogUtilities.a();
        var g = function (h) {
            _this.m();
            _this.o();
        };
        var h = g;
        f.id = "btnOK";
        f.addEventListener("click", h, false);
        f.innerText = ((function () { var i = _this.l("TopOrBottomDialog_OK", a); a = i.p1; return i.ret; })());
        f.accessKey = a;
        var i = SpreadsheetDialogUtilities.a();
        var j = function (k) { return _this.o(); };
        var k = j;
        i.id = "btnCancel";
        i.addEventListener("click", k, false);
        i.innerText = ((function () { var l = _this.l("TopOrBottomDialog_Cancel", a); a = l.p1; return l.ret; })());
        i.accessKey = a;
        e.appendChild(f);
        e.appendChild(i);
        this.f.appendChild(e);
        var l = TopOrBottomDialogViewModel.k(this.c);
        try {
            for (var _2 = tslib_1.__values(fromEnum(l)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var m = _3.value;
                var n = document.createElement("option");
                n.innerText = m.displayText;
                n.setAttribute("value", m.dataValue);
                this.h.appendChild(n);
            }
        }
        catch (e_316_1) { e_316 = { error: e_316_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_316) throw e_316.error; }
        }
        var o = TopOrBottomDialogViewModel.l(this.c);
        try {
            for (var _4 = tslib_1.__values(fromEnum(o)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var p = _5.value;
                var q = document.createElement("option");
                q.innerText = p.displayText;
                q.setAttribute("value", p.dataValue);
                this.i.appendChild(q);
            }
        }
        catch (e_317_1) { e_317 = { error: e_317_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_317) throw e_317.error; }
        }
        this.p(this.g);
        this.h.value = this.a.j.toString();
        this.g.value = this.a.n.toString();
        this.i.value = this.a.h.toString();
    };
    TopOrBottomDialogManager.prototype.o = function () {
        this.b.close(false);
    };
    TopOrBottomDialogManager.prototype.p = function (a) {
    };
    TopOrBottomDialogManager.prototype.k = function (a) {
        var b = this.c._fs(a);
        b = SpreadsheetUtilities.c2(b);
        return b;
    };
    TopOrBottomDialogManager.prototype.l = function (a, b) {
        var c = this.c._fs(a);
        c = ((function () { var d = SpreadsheetUtilities.c3(c, b); b = d.p1; return d.ret; })());
        return {
            ret: c,
            p1: b
        };
    };
    TopOrBottomDialogManager.prototype.e = function () {
        var a = this.h;
        var b = SpreadsheetDialogUtilities.h(a);
        if (null == b) {
            return true;
        }
        var c = b.toString();
        if (stringIsNullOrEmpty(c)) {
            return true;
        }
        var d = false;
        var e = tryParseBool(c, d);
        d = e.p1;
        return d;
    };
    TopOrBottomDialogManager.prototype.d = function () {
        var a = this.i;
        var b = SpreadsheetDialogUtilities.h(a);
        if (null == b) {
            return true;
        }
        var c = b.toString();
        if (stringIsNullOrEmpty(c)) {
            return true;
        }
        var d = false;
        var e = tryParseBool(c, d);
        d = e.p1;
        return d;
    };
    TopOrBottomDialogManager.prototype.j = function () {
        var a = this.g.value;
        if (null == a) {
            return 10;
        }
        var b = 10;
        if (typeof a === 'number') {
            b = typeGetValue(a);
        }
        else {
            var c = tryParseInt32_1(a.toString(), b);
            b = c.p1;
        }
        return b;
    };
    TopOrBottomDialogManager.prototype.q = function () {
        this.n();
        var a = this.f;
        var b = this.c._fs("TopOrBottomDialog_Title");
        this.b = this.c._r(a, b);
    };
    TopOrBottomDialogManager.$t = markType(TopOrBottomDialogManager, 'TopOrBottomDialogManager');
    return TopOrBottomDialogManager;
}(Base));
export { TopOrBottomDialogManager };
/**
 * @hidden
 */
var CellBordersPreviewControlHelper = /** @class */ (function (_super) {
    tslib_1.__extends(CellBordersPreviewControlHelper, _super);
    function CellBordersPreviewControlHelper(a, b, c, d, e, f) {
        var _this = _super.call(this) || this;
        _this.r = 0;
        _this.q = 0;
        _this.p = 0;
        _this.o = 0;
        _this.a = null;
        _this.e = null;
        _this.d = null;
        _this.b = null;
        _this.i = 0;
        _this.h = 0;
        _this.k = 0;
        _this.m = 0;
        _this.j = 0;
        _this.l = 0;
        _this.n = 0;
        CoreUtilities.z(a, "workbook");
        CoreUtilities.z(b, "cellBorderInfo");
        CoreUtilities.z(e, "originalWorkbook");
        _this.e = a;
        _this.b = b;
        _this.i = c;
        _this.h = d;
        _this.d = e;
        _this.n = f;
        _this.am();
        return _this;
    }
    Object.defineProperty(CellBordersPreviewControlHelper.prototype, "t", {
        get: function () {
            return this.p;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(CellBordersPreviewControlHelper.prototype, "s", {
        get: function () {
            return this.o;
        },
        enumerable: true,
        configurable: true
    });
    CellBordersPreviewControlHelper.prototype.f = function (a, b, c) {
        var d = this.v(a, b);
        if (stringIsNullOrEmpty(d)) {
            return null;
        }
        var e = this.e.windowOptions.selectedWorksheet._getCell(d).getResolvedCellFormat();
        switch (c) {
            case "Left": return e.leftBorderColorInfo;
            case "Top": return e.topBorderColorInfo;
            case "Right": return e.rightBorderColorInfo;
            case "Bottom": return e.bottomBorderColorInfo;
            case "DiagonalUp":
            case "DiagonalDown":
                var f = e.diagonalBorders;
                if ((c == "DiagonalUp" && f == 5) || (c == "DiagonalDown" && f == 3) || (f == 7)) {
                    return e.diagonalBorderColorInfo;
                }
                else {
                    return WorkbookColorInfo.automatic;
                }
        }
        return null;
    };
    CellBordersPreviewControlHelper.prototype.u = function (a, b, c) {
        var d = this.v(a, b);
        if (stringIsNullOrEmpty(d)) {
            return Nullable$1.toNullable(CellBorderLineStyle_$type, null);
        }
        var e = this.e.windowOptions.selectedWorksheet._getCell(d).getResolvedCellFormat();
        switch (c) {
            case "Left": return Nullable$1.toNullable(CellBorderLineStyle_$type, e.leftBorderStyle);
            case "Top": return Nullable$1.toNullable(CellBorderLineStyle_$type, e.topBorderStyle);
            case "Right": return Nullable$1.toNullable(CellBorderLineStyle_$type, e.rightBorderStyle);
            case "Bottom": return Nullable$1.toNullable(CellBorderLineStyle_$type, e.bottomBorderStyle);
            case "DiagonalUp":
            case "DiagonalDown":
                var f = e.diagonalBorders;
                if ((c == "DiagonalUp" && f == 5) || (c == "DiagonalDown" && f == 3) || (f == 7)) {
                    return Nullable$1.toNullable(CellBorderLineStyle_$type, e.diagonalBorderStyle);
                }
                else {
                    return Nullable$1.toNullable(CellBorderLineStyle_$type, 0);
                }
        }
        return Nullable$1.toNullable(CellBorderLineStyle_$type, null);
    };
    CellBordersPreviewControlHelper.prototype.w = function () {
        var _this = this;
        this.ap(this.a[this.m], function (a) { return a.cellFormat.bottomBorderColorInfo = _this.g(_this.b._aa); });
    };
    CellBordersPreviewControlHelper.prototype.x = function () {
        var _this = this;
        this.ap(this.a[this.m], function (a) { return a.cellFormat.bottomBorderStyle = _this.b._i; });
    };
    CellBordersPreviewControlHelper.prototype.y = function () {
        var _this = this;
        this.an(function (a) { return a.cellFormat.diagonalBorderColorInfo = _this.g(_this.b._ab); });
    };
    CellBordersPreviewControlHelper.prototype.z = function () {
        var _this = this;
        this.an(function (a) {
            a.cellFormat.diagonalBorders = _this.b._r;
            a.cellFormat.diagonalBorderStyle = _this.c(_this.b);
        });
    };
    CellBordersPreviewControlHelper.prototype.aa = function () {
        var _this = this;
        this.an(function (a) { return a.cellFormat.diagonalBorderColorInfo = _this.g(_this.b._ac); });
    };
    CellBordersPreviewControlHelper.prototype.ab = function () {
        var _this = this;
        this.an(function (a) {
            a.cellFormat.diagonalBorders = _this.b._r;
            a.cellFormat.diagonalBorderStyle = _this.c(_this.b);
        });
    };
    CellBordersPreviewControlHelper.prototype.ac = function () {
        var _this = this;
        if (this.p > 1) {
            this.ap(this.a[this.k], function (a) { return a.cellFormat.bottomBorderColorInfo = _this.g(_this.b._ad); });
        }
    };
    CellBordersPreviewControlHelper.prototype.ad = function () {
        var _this = this;
        if (this.p > 1) {
            this.ap(this.a[this.k], function (a) { return a.cellFormat.bottomBorderStyle = _this.b._l; });
        }
    };
    CellBordersPreviewControlHelper.prototype.ae = function () {
        var _this = this;
        if (this.o > 1) {
            this.ao(this.j, function (a) { return a.cellFormat.rightBorderColorInfo = _this.g(_this.b._ae); });
        }
    };
    CellBordersPreviewControlHelper.prototype.af = function () {
        var _this = this;
        if (this.o > 1) {
            this.ao(this.j, function (a) { return a.cellFormat.rightBorderStyle = _this.b._m; });
        }
    };
    CellBordersPreviewControlHelper.prototype.ag = function () {
        var _this = this;
        this.ao(this.j, function (a) { return a.cellFormat.leftBorderColorInfo = _this.g(_this.b._af); });
    };
    CellBordersPreviewControlHelper.prototype.ah = function () {
        var _this = this;
        this.ao(this.j, function (a) { return a.cellFormat.leftBorderStyle = _this.b._n; });
    };
    CellBordersPreviewControlHelper.prototype.ai = function () {
        var _this = this;
        this.ao(this.l, function (a) { return a.cellFormat.rightBorderColorInfo = _this.g(_this.b._ag); });
    };
    CellBordersPreviewControlHelper.prototype.aj = function () {
        var _this = this;
        this.ao(this.l, function (a) { return a.cellFormat.rightBorderStyle = _this.b._o; });
    };
    CellBordersPreviewControlHelper.prototype.ak = function () {
        var _this = this;
        this.ap(this.a[this.k], function (a) { return a.cellFormat.topBorderColorInfo = _this.g(_this.b._ah); });
    };
    CellBordersPreviewControlHelper.prototype.al = function () {
        var _this = this;
        this.ap(this.a[this.k], function (a) { return a.cellFormat.topBorderStyle = _this.b._p; });
    };
    CellBordersPreviewControlHelper.prototype.c = function (a) {
        switch (a._r) {
            case 1: return 0;
            case 7: return a._j;
            case 3: return a._j;
            case 5: return a._k;
            default: return -1;
        }
    };
    CellBordersPreviewControlHelper.prototype.v = function (a, b) {
        if (a >= this.t || b >= this.s) {
            return stringEmpty();
        }
        var c = "";
        var d = "";
        if (a == 0) {
            c = "2";
        }
        else {
            c = "3";
        }
        if (b == 0) {
            d = "B";
        }
        else {
            d = "C";
        }
        return stringFormat("{0}{1}", d, c);
    };
    CellBordersPreviewControlHelper.prototype.g = function (a) {
        if (WorkbookColorInfo.l_op_Inequality(null, a)) {
            return new WorkbookColorInfo(a._getResolvedColor1(this.d));
        }
        return null;
    };
    CellBordersPreviewControlHelper.prototype.am = function () {
        var a = this.e._worksheets$i._item(0);
        for (var b = 0; b < 4; b++) {
            a._rows$i.item(b).hidden = true;
            for (var c = 0; c < 4; c++) {
                a._columns$i.item(c).hidden = true;
            }
        }
        if (this.b._av) {
            this.r = 4;
            this.p = 2;
            this.k = 0;
            this.m = 1;
            this.a = new Array(this.p);
        }
        else {
            this.r = 3;
            this.p = 1;
            this.k = 0;
            this.m = 0;
            this.a = new Array(this.p);
        }
        if (this.b._ax) {
            this.q = 4;
            this.o = 2;
            this.j = 1;
            this.l = 2;
        }
        else {
            this.q = 3;
            this.o = 1;
            this.j = 1;
            this.l = 1;
        }
        var d = a._rows$i;
        var e = intDivide(((this.i) - (2 * this.n)), this.o);
        var f = intDivide(((this.h) - (2 * this.n)), this.p);
        var g = 0;
        for (var h = 0; h < this.r; h++) {
            var i = h > 0 && h < (this.r - 1);
            var j = d.item(h);
            j.hidden = false;
            j.height = truncate(Workbook._ep(this.e, i ? f : this.n, true));
            if (i) {
                this.a[g] = j;
                g++;
            }
            for (var k = 0; k < this.q; k++) {
                var l = k > 0 && k < (this.q - 1);
                a._columns$i.item(k).setWidth(l ? e : this.n, 3);
                a._columns$i.item(k).hidden = false;
                var m = j._cells$i.item(k);
                var n = m.cellFormat;
                n.alignment = 2;
                n.verticalAlignment = 1;
                if (i && l) {
                    m.value = SpreadsheetUtilities.di(null, "FormatCellsDialog_BorderTab_Text_SampleText");
                }
            }
        }
        this.ar();
        var o = this.b;
        o.propertyChanged = delegateCombine(o.propertyChanged, runOn(this, this.aq));
    };
    CellBordersPreviewControlHelper.prototype.an = function (a) {
        var d = this.a;
        for (var c = 0; c < d.length; c++) {
            var b = d[c];
            this.ap(b, a);
        }
    };
    CellBordersPreviewControlHelper.prototype.ao = function (a, b) {
        for (var c = this.k; c <= this.m; c++) {
            b(this.a[c]._cells$i.item(a));
        }
    };
    CellBordersPreviewControlHelper.prototype.ap = function (a, b) {
        for (var c = this.j; c <= this.l; c++) {
            b(a._cells$i.item(c));
        }
    };
    CellBordersPreviewControlHelper.prototype.aq = function (a, b) {
        switch (b.propertyName) {
            case "BottomCellBorderColorInfo":
                this.w();
                break;
            case "BottomCellBorderStyle":
                this.x();
                break;
            case "InsideHorizontalCellBorderColorInfo":
                this.ac();
                break;
            case "InsideHorizontalCellBorderStyle":
                this.ad();
                break;
            case "InsideVerticalCellBorderColorInfo":
                this.ae();
                break;
            case "InsideVerticalCellBorderStyle":
                this.af();
                break;
            case "LeftCellBorderColorInfo":
                this.ag();
                break;
            case "LeftCellBorderStyle":
                this.ah();
                break;
            case "RightCellBorderColorInfo":
                this.ai();
                break;
            case "RightCellBorderStyle":
                this.aj();
                break;
            case "TopCellBorderColorInfo":
                this.ak();
                break;
            case "TopCellBorderStyle":
                this.al();
                break;
            case "DiagonalDownCellBorderColorInfo":
                this.y();
                break;
            case "DiagonalDownCellBorderStyle":
                this.z();
                break;
            case "DiagonalUpCellBorderColorInfo":
                this.aa();
                break;
            case "DiagonalUpCellBorderStyle":
                this.ab();
                break;
        }
    };
    CellBordersPreviewControlHelper.prototype.ar = function () {
        this.w();
        this.x();
        this.ac();
        this.ad();
        this.ae();
        this.af();
        this.ag();
        this.ah();
        this.ai();
        this.aj();
        this.ak();
        this.al();
        this.aa();
        this.ab();
    };
    CellBordersPreviewControlHelper.$t = markType(CellBordersPreviewControlHelper, 'CellBordersPreviewControlHelper');
    return CellBordersPreviewControlHelper;
}(Base));
export { CellBordersPreviewControlHelper };
/**
 * @hidden
 */
var FontControlViewModel = /** @class */ (function (_super) {
    tslib_1.__extends(FontControlViewModel, _super);
    function FontControlViewModel(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o) {
        var _this = _super.call(this) || this;
        _this._e = null;
        _this._ab = null;
        _this._aa = null;
        _this._ac = null;
        _this._q = false;
        _this._at = null;
        _this._ai = 0;
        _this._c = null;
        _this._g = 0;
        _this._l = null;
        _this._am = Nullable$1.toNullable(Boolean_$type, null);
        _this._an = Nullable$1.toNullable(Boolean_$type, null);
        _this._al = Nullable$1.toNullable(Boolean_$type, null);
        _this._o = false;
        _this._p = false;
        _this._ad = null;
        _this._i = null;
        _this._ak = Nullable$1.toNullable(DialogFontStyle_$type, null);
        _this._v = false;
        _this._w = false;
        _this._y = false;
        _this._z = false;
        _this._f = null;
        _this._k = null;
        _this.propertyChanged = null;
        CoreUtilities.z(i, "dialogServicesManager");
        _this._e = i;
        _this._p = true;
        _this._k = n;
        _this._f = o;
        _this._ax = a;
        var p = _this._b(c, d);
        _this._d = Enumerable.ag(DialogFontStyleInfo.$, _this._ag, function (q) { return q.a == p; });
        _this._h = g;
        if (b > -1) {
            _this._aj = intDivide(b, 20);
        }
        else {
            _this._aj = b;
        }
        if (f != -1) {
            _this._ar = Nullable$1.toNullable(Boolean_$type, _this._s(f));
            _this._as = Nullable$1.toNullable(Boolean_$type, _this._t(f));
        }
        else {
            _this._ar = Nullable$1.toNullable(Boolean_$type, null);
            _this._as = Nullable$1.toNullable(Boolean_$type, null);
        }
        _this._aq = _this._ao(e);
        _this._m = h;
        _this._v = j;
        _this._w = j;
        _this._y = l;
        _this._z = m;
        _this._a5(true);
        _this._p = false;
        _this._ad = new List$1(String_$type, 0);
        return _this;
    }
    Object.defineProperty(FontControlViewModel.prototype, "_ah", {
        get: function () {
            return this._ad;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_ae", {
        get: function () {
            if (null == this._aa) {
                this._aa = this._e.fontsService.getFontNames();
            }
            return this._aa;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_af", {
        get: function () {
            if (null == this._ab) {
                this._ab = this._e.fontsService.getFontSizes();
            }
            return this._ab;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_ag", {
        get: function () {
            if (null == this._ac) {
                this._ac = new List$1(DialogFontStyleInfo.$, 0);
                this._ac.add(new DialogFontStyleInfo(1));
                this._ac.add(new DialogFontStyleInfo(2));
                this._ac.add(new DialogFontStyleInfo(3));
                this._ac.add(new DialogFontStyleInfo(4));
            }
            return this._ac;
        },
        set: function (a) {
            this._ag = a;
            this._a7("FontStyles");
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_n", {
        get: function () {
            return EnumUtil.getValues(FontUnderlineStyle_$type);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_x", {
        get: function () {
            return this._q;
        },
        set: function (a) {
            if (a != this._q) {
                this._q = a;
                this._a7("IsNormalFont");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_a9", {
        get: function () {
            if (WorkbookColorInfo.l_op_Inequality(null, this._l) && null != this._k) {
                return this._l._getResolvedColor1(this._k);
            }
            if (null != this._k) {
                return WorkbookColorInfo.automatic._getResolvedColor1(this._k);
            }
            return WorkbookColorInfo.automatic._getResolvedColor();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_m", {
        get: function () {
            return this._l;
        },
        set: function (a) {
            if (WorkbookColorInfo.l_op_Inequality(a, this._l)) {
                this._l = a;
                this._a7("SelectedFontColorInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_ax", {
        get: function () {
            return this._at;
        },
        set: function (a) {
            if (a != this._at) {
                this._at = a;
                this._a7("SelectedFontName");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_aj", {
        get: function () {
            return this._ai;
        },
        set: function (a) {
            if (a != this._ai) {
                this._ai = a;
                this._a7("SelectedFontSize");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_d", {
        get: function () {
            return this._c;
        },
        set: function (a) {
            if (a != this._c) {
                this._c = a;
                this._a7("SelectedFontStyle");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_h", {
        get: function () {
            return this._g;
        },
        set: function (a) {
            if (a != this._g) {
                this._g = a;
                this._a7("SelectedFontUnderlineStyle");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_aq", {
        get: function () {
            return this._al;
        },
        set: function (a) {
            var b = this._ap(a);
            if (nullableNotEquals(b, this._al)) {
                this._al = b;
                this._a7("Strikeout");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_ar", {
        get: function () {
            return this._am;
        },
        set: function (a) {
            var b = this._ap(a);
            if (nullableNotEquals(b, this._am)) {
                this._am = b;
                this._a7("Subscript");
                if (nullableEquals(true, this._am)) {
                    this._as = Nullable$1.toNullable(Boolean_$type, false);
                }
                else if (!this._p && false == this._as.hasValue) {
                    this._as = Nullable$1.toNullable(Boolean_$type, false);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_as", {
        get: function () {
            return this._an;
        },
        set: function (a) {
            var b = this._ap(a);
            if (nullableNotEquals(b, this._an)) {
                this._an = b;
                this._a7("Superscript");
                if (nullableEquals(true, this._an)) {
                    this._ar = Nullable$1.toNullable(Boolean_$type, false);
                }
                else if (!this._p && false == this._ar.hasValue) {
                    this._ar = Nullable$1.toNullable(Boolean_$type, false);
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_j", {
        get: function () {
            if (null == this._i) {
                this._i = this._k._styles$i.normalStyle.styleFormat.font;
            }
            return this._i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FontControlViewModel.prototype, "_a", {
        get: function () {
            if (false == this._ak.hasValue) {
                this._ak = Nullable$1.toNullable(DialogFontStyle_$type, this._b(this._j._bold$i, this._j._italic$i));
            }
            return this._ak.value;
        },
        enumerable: true,
        configurable: true
    });
    FontControlViewModel.prototype._a8 = function (a) {
        a.value = this._ax;
        a.cellFormat.font.height = this._aj < 0 ? this._aj : this._aj * 20;
        a.cellFormat.font.name = this._ax;
        if (null != this._d) {
            var b = this._d.a;
            a.cellFormat.font._italic$i = Nullable$1.toNullable(Boolean_$type, (b == 3 || b == 4) ? true : false);
            a.cellFormat.font._bold$i = Nullable$1.toNullable(Boolean_$type, (b == 2 || b == 4) ? true : false);
        }
        a.cellFormat.font.colorInfo = this._m;
        a.cellFormat.font._strikeout$i = Nullable$1.toNullable(Boolean_$type, nullableEquals(false, this._aq) ? false : true);
        if (nullableEquals(true, this._ar)) {
            a.cellFormat.font.superscriptSubscriptStyle = 2;
        }
        else if (nullableEquals(true, this._as)) {
            a.cellFormat.font.superscriptSubscriptStyle = 1;
        }
        else {
            a.cellFormat.font.superscriptSubscriptStyle = 0;
        }
        a.cellFormat.font.underlineStyle = this._h;
    };
    FontControlViewModel.prototype._a5 = function (a) {
        if (a === void 0) { a = false; }
        if (false == a && false == this._x) {
            return;
        }
        this._x = this._aj == intDivide(this._j.height, 20) && this._ax == this._j.name && null != this._d && this._d.a == this._a && this._h == this._j.underlineStyle && this._u(this._j._strikeout$i, this._aq) && nullableEquals(this._ar, this._s(this._j.superscriptSubscriptStyle)) && nullableEquals(this._as, this._t(this._j.superscriptSubscriptStyle)) && WorkbookColorInfo.l_op_Inequality(null, this._m) && (WorkbookColorInfo.l_op_Equality(this._m, this._j.colorInfo) || (this._m._themeColorType$i.hasValue && nullableEquals(this._m._themeColorType$i.value, this._j.colorInfo._themeColorType$i) && (nullableEquals(this._m._tint$i, null) || nullableEquals(this._m._tint$i, 0))));
    };
    FontControlViewModel.prototype._r = function (a) {
        return nullableEquals(a, true);
    };
    FontControlViewModel.prototype._ao = function (a) {
        if (nullableEquals(a, null)) {
            return Nullable$1.toNullable(Boolean_$type, null);
        }
        else {
            return Nullable$1.toNullable(Boolean_$type, nullableEquals(a, true));
        }
    };
    FontControlViewModel.prototype._s = function (a) {
        return a == 2;
    };
    FontControlViewModel.prototype._t = function (a) {
        return a == 1;
    };
    FontControlViewModel.prototype._u = function (a, b) {
        if (nullableEquals(a, null)) {
            return false == b.hasValue;
        }
        if (nullableEquals(null, b)) {
            return false;
        }
        if (nullableEquals(a, true)) {
            return b.value == true;
        }
        else {
            return b.value == false;
        }
    };
    FontControlViewModel.prototype._ap = function (a) {
        if (a.hasValue) {
            return Nullable$1.toNullable(Boolean_$type, a.value);
        }
        if (this._p) {
            return Nullable$1.toNullable(Boolean_$type, null);
        }
        else {
            return Nullable$1.toNullable(Boolean_$type, false);
        }
    };
    FontControlViewModel.prototype._a6 = function (a) {
        var _this = this;
        if (this._p) {
            return;
        }
        if (null != this._ad && !this._ad.contains(a)) {
            this._ad.add(a);
        }
        switch (a) {
            case "SelectedFontName":
            case "SelectedFontSize":
            case "SelectedFontStyle":
            case "SelectedFontUnderlineStyle":
            case "Strikeout":
            case "Superscript":
            case "Subscript":
            case "SelectedFontColorInfo":
                if (false == this._o) {
                    this._a5();
                }
                break;
            case "IsNormalFont":
                if (this._o) {
                    break;
                }
                if (true == this._x) {
                    this._ad.clear();
                    this._o = true;
                    try {
                        this._ax = this._j.name;
                        this._aj = intDivide(this._j.height, 20);
                        this._d = Enumerable.ag(DialogFontStyleInfo.$, this._ag, function (b) { return b.a == _this._a; });
                        this._h = this._j.underlineStyle;
                        this._aq = Nullable$1.toNullable(Boolean_$type, false);
                        this._ar = Nullable$1.toNullable(Boolean_$type, false);
                        this._as = Nullable$1.toNullable(Boolean_$type, false);
                        this._m = this._j.colorInfo;
                    }
                    finally {
                        this._o = false;
                    }
                }
                break;
        }
    };
    FontControlViewModel.prototype._b = function (a, b) {
        if (nullableEquals(a, null) || nullableEquals(b, null)) {
            return 0;
        }
        if (nullableEquals(a, false) && nullableEquals(b, false)) {
            return 1;
        }
        else if (nullableEquals(a, true) && nullableEquals(b, false)) {
            return 2;
        }
        else if (nullableEquals(a, false) && nullableEquals(b, true)) {
            return 3;
        }
        else {
            return 4;
        }
    };
    FontControlViewModel.prototype._a7 = function (a) {
        this._a6(a);
        var b = this.propertyChanged;
        if (null != b) {
            b(this, new PropertyChangedEventArgs(a));
        }
    };
    FontControlViewModel.$t = markType(FontControlViewModel, 'FontControlViewModel', Base.$, [INotifyPropertyChanged_$type]);
    return FontControlViewModel;
}(Base));
export { FontControlViewModel };
/**
 * @hidden
 */
var DialogFontStyleInfo = /** @class */ (function (_super) {
    tslib_1.__extends(DialogFontStyleInfo, _super);
    function DialogFontStyleInfo(a) {
        var _this = _super.call(this) || this;
        _this.a = 0;
        _this.a = a;
        return _this;
    }
    DialogFontStyleInfo.prototype.toString = function () {
        return this.b;
    };
    Object.defineProperty(DialogFontStyleInfo.prototype, "b", {
        get: function () {
            switch (this.a) {
                case 1: return SpreadsheetUtilities.di(null, "SpreadsheetFontControl_FontStyle_Regular");
                case 2: return SpreadsheetUtilities.di(null, "SpreadsheetFontControl_FontStyle_Bold");
                case 3: return SpreadsheetUtilities.di(null, "SpreadsheetFontControl_FontStyle_Italic");
                case 4: return SpreadsheetUtilities.di(null, "SpreadsheetFontControl_FontStyle_BoldItalic");
            }
            return stringEmpty();
        },
        enumerable: true,
        configurable: true
    });
    DialogFontStyleInfo.$t = markType(DialogFontStyleInfo, 'DialogFontStyleInfo');
    return DialogFontStyleInfo;
}(Base));
export { DialogFontStyleInfo };
/**
 * @hidden
 */
var SpreadsheetDialogFormatsService = /** @class */ (function (_super) {
    tslib_1.__extends(SpreadsheetDialogFormatsService, _super);
    function SpreadsheetDialogFormatsService() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    SpreadsheetDialogFormatsService.prototype.a = function (a, b, c, d, e) {
        var f = new ValueFormatter(0, a, b, a._e6);
        var g = f.h(c, d, c, 0, null, null, false, false);
        e = g.g;
        return {
            p4: e
        };
    };
    SpreadsheetDialogFormatsService.prototype.getFormatCategories = function (a) {
        var e_318, _0, e_319, _1;
        var b = function (c) { return SpreadsheetUtilities.di(null, c); };
        var c = new List$1(SpreadsheetDialogFormatCategory.$, 0);
        var d = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_General");
            $ret._y = -1;
            $ret._h = false;
            $ret._ac = b("FormatInfo_General_NumberFormat_Description");
            $ret._e = 0;
            return $ret;
        })());
        d._b("General");
        c.add(d);
        var e = ((function () {
            var $ret = new SpreadsheetDialogFormatCategoryEx();
            $ret._aa = b("FormatInfo_Number");
            $ret._ae = b("FormatInfo_FormatHeader_NegativeNumbers");
            $ret._ac = b("FormatInfo_Number_NumberFormat_Description");
            $ret._e = 1;
            return $ret;
        })());
        var f = a || new Workbook();
        var g = stringEmpty();
        var h = stringEmpty();
        var i = 0;
        var j = i.toString();
        ;
        i = -1234.1;
        j = i.toString();
        h = "0.00";
        var k = this.a(f, h, i, i.toString(), g);
        g = k.p4;
        e._w.add(new SpreadsheetDialogFormat(0, h, g));
        h = "0.00;[Red]0.00";
        var l = this.a(f, h, i, i.toString(), g);
        g = l.p4;
        e._w.add(new SpreadsheetDialogFormat(1, h, g, "#FF0000"));
        h = "0.00;(#.00)";
        var m = this.a(f, h, i, i.toString(), g);
        g = m.p4;
        e._w.add(new SpreadsheetDialogFormat(0, h, g));
        h = "0.00;[Red](#.00)";
        var n = this.a(f, h, i, i.toString(), g);
        g = n.p4;
        e._w.add(new SpreadsheetDialogFormat(1, h, g, "#FF0000"));
        c.add(e);
        var o = ((function () {
            var $ret = new SpreadsheetDialogFormatCategoryEx();
            $ret._aa = b("FormatInfo_Currency");
            $ret._ae = b("FormatInfo_FormatHeader_NegativeNumbers");
            $ret._ac = b("FormatInfo_Currency_NumberFormat_Description");
            $ret._e = 2;
            return $ret;
        })());
        h = "$#,##0.00";
        var p = this.a(f, h, i, i.toString(), g);
        g = p.p4;
        o._w.add(new SpreadsheetDialogFormat(0, h, g));
        h = "$#,##0.00;[Red]$#,##0.00";
        var q = this.a(f, h, i, i.toString(), g);
        g = q.p4;
        o._w.add(new SpreadsheetDialogFormat(1, h, g, "#FF0000"));
        h = "$#,##0.00_);($#,##0.00)";
        var r = this.a(f, h, i, i.toString(), g);
        g = r.p4;
        o._w.add(new SpreadsheetDialogFormat(0, h, g));
        h = "$#,##0.00_);[Red]($#,##0.00)";
        var s = this.a(f, h, i, i.toString(), g);
        g = s.p4;
        o._w.add(new SpreadsheetDialogFormat(1, h, g, "#FF0000"));
        c.add(o);
        var t = ((function () {
            var $ret = new SpreadsheetDialogFormatCategoryEx();
            $ret._aa = b("FormatInfo_Accounting");
            $ret._h = false;
            $ret._ac = b("FormatInfo_Accounting_NumberFormat_Description");
            $ret._y = 2;
            $ret._e = 3;
            return $ret;
        })());
        h = "_($* #,##0.00_);_($* (#,##0.00);_($* \" - \"??_);_(@_)";
        var u = this.a(f, h, i, i.toString(), g);
        g = u.p4;
        t._w.add(new SpreadsheetDialogFormat(0, h, g));
        c.add(t);
        var v = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Date");
            $ret._y = -1;
            $ret._ae = b("FormatInfo_FormatHeader_Type");
            $ret._ac = b("FormatInfo_Date_NumberFormat_Description");
            $ret._e = 4;
            return $ret;
        })());
        var w = b("FormatCellsDialog_NumberTab_DateFormatMasks");
        var x = stringSplit(w, ["\r\n", "\r", "\n"], 1);
        var y = dateFromValues(2012, 3, 14, 13, 30, 55, 0);
        var z = ExcelUtils.b0(f, y, i);
        i = z.p2;
        for (var ab = 0; ab < x.length; ab++) {
            var aa = x[ab];
            h = aa;
            var ac = this.a(f, h, i, i.toString(), g);
            g = ac.p4;
            if (stringContains(aa, "[$-F800") || stringContains(aa, "[$-F400")) {
                g = "*" + g;
            }
            v._w.add(new SpreadsheetDialogFormat(0, h, g));
        }
        c.add(v);
        var ad = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Time");
            $ret._y = -1;
            $ret._ae = b("FormatInfo_FormatHeader_Type");
            $ret._ac = b("FormatInfo_Time_NumberFormat_Description");
            $ret._e = 5;
            return $ret;
        })());
        w = b("FormatCellsDialog_NumberTab_TimeFormatMasks");
        x = stringSplit(w, ["\r\n", "\r", "\n"], 1);
        for (var af = 0; af < x.length; af++) {
            var ae = x[af];
            h = ae;
            var ag = this.a(f, h, i, i.toString(), g);
            g = ag.p4;
            if (stringContains(ae, "[$-F800") || stringContains(ae, "[$-F400")) {
                g = "*" + g;
            }
            ad._w.add(new SpreadsheetDialogFormat(0, h, g));
        }
        c.add(ad);
        var ah = ((function () {
            var $ret = new SpreadsheetDialogFormatCategoryEx();
            $ret._aa = b("FormatInfo_Percentage");
            $ret._ac = b("FormatInfo_Percentage_NumberFormat_Description");
            $ret._h = false;
            $ret._y = 2;
            $ret._e = 6;
            return $ret;
        })());
        ah._b("0.00%");
        c.add(ah);
        var ai = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Fraction");
            $ret._y = -1;
            $ret._ae = b("FormatInfo_FormatHeader_Type");
            $ret._ac = "";
            $ret._e = 7;
            return $ret;
        })());
        ai._w.add(new SpreadsheetDialogFormat(0, "# ?/?", b("FormatInfo_Fraction_OneDigit")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ??/??", b("FormatInfo_Fraction_TwoDigits")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ???/???", b("FormatInfo_Fraction_ThreeDigits")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ?/2", b("FormatInfo_Fraction_Halves")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ?/4", b("FormatInfo_Fraction_Quarters")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ?/8", b("FormatInfo_Fraction_Eighths")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ??/16", b("FormatInfo_Fraction_Sixteenths")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ??/10", b("FormatInfo_Fraction_Tenths")));
        ai._w.add(new SpreadsheetDialogFormat(0, "# ??/100", b("FormatInfo_Fraction_Hundreths")));
        c.add(ai);
        var aj = ((function () {
            var $ret = new SpreadsheetDialogFormatCategoryEx();
            $ret._aa = b("FormatInfo_Scientific");
            $ret._ac = "";
            $ret._h = false;
            $ret._y = 2;
            $ret._e = 8;
            return $ret;
        })());
        aj._b("0.00E+00");
        c.add(aj);
        var ak = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Text");
            $ret._ac = b("FormatInfo_Text_NumberFormat_Description");
            $ret._h = false;
            $ret._y = -1;
            $ret._e = 9;
            return $ret;
        })());
        ak._b("@");
        c.add(ak);
        var al = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Special");
            $ret._y = -1;
            $ret._ae = b("FormatInfo_FormatHeader_Type");
            $ret._ac = b("FormatInfo_Special_NumberFormat_Description");
            $ret._e = 10;
            return $ret;
        })());
        al._w.add(new SpreadsheetDialogFormat(0, "00000", b("FormatInfo_Special_ZipCode")));
        al._w.add(new SpreadsheetDialogFormat(0, "00000-0000", b("FormatInfo_Special_ZipCodePlus4")));
        al._w.add(new SpreadsheetDialogFormat(0, "[<=9999999]###-####;(###) ###-####", b("FormatInfo_Special_PhoneNumber")));
        al._w.add(new SpreadsheetDialogFormat(0, "000-00-0000", b("FormatInfo_Special_SocialSecurityNumber")));
        c.add(al);
        var am = ((function () {
            var $ret = new SpreadsheetDialogFormatCategory();
            $ret._aa = b("FormatInfo_Custom");
            $ret._y = -1;
            $ret._ae = b("FormatInfo_FormatHeader_Type");
            $ret._l = true;
            $ret._ac = b("FormatInfo_Custom_NumberFormat_Description");
            return $ret;
        })());
        for (var an = 1; an < c.count; an++) {
            try {
                for (var _2 = tslib_1.__values(fromEnum(c._inner[an]._w)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                    var ao = _3.value;
                    am._b(ao._e);
                }
            }
            catch (e_318_1) { e_318 = { error: e_318_1 }; }
            finally {
                try {
                    if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
                }
                finally { if (e_318) throw e_318.error; }
            }
        }
        am._w = Enumerable.z(SpreadsheetDialogFormat.$, Enumerable.x(SpreadsheetDialogFormat.$, String_$type, Enumerable.o(SpreadsheetDialogFormat.$, SpreadsheetDialogFormat.$, am._w, function (ap) { return ap; }), function (ap) { return ap._e; }));
        am._w.insert(0, c._inner[0]._w._inner[0]);
        var _loop_34 = function (ap) {
            var aq = a._b2.item(ap);
            if (null == Enumerable.ag(SpreadsheetDialogFormat.$, am._w, function (ar) { return ar._e == aq; })) {
                am._b(aq);
            }
        };
        try {
            for (var _4 = tslib_1.__values(fromEnum(a._b2.m())), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var ap = _5.value;
                _loop_34(ap);
            }
        }
        catch (e_319_1) { e_319 = { error: e_319_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_319) throw e_319.error; }
        }
        c.add(am);
        return c;
    };
    SpreadsheetDialogFormatsService.$t = markType(SpreadsheetDialogFormatsService, 'SpreadsheetDialogFormatsService', Base.$, [ISpreadsheetDialogFormatsService_$type]);
    return SpreadsheetDialogFormatsService;
}(Base));
export { SpreadsheetDialogFormatsService };
/**
 * @hidden
 */
var FilterDialogViewModel = /** @class */ (function (_super) {
    tslib_1.__extends(FilterDialogViewModel, _super);
    function FilterDialogViewModel(a) {
        var _rest = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            _rest[_0 - 1] = arguments[_0];
        }
        var _this = _super.call(this) || this;
        _this.f = null;
        _this.j = null;
        _this.v = null;
        _this.m = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        _this.o = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        _this.r = null;
        _this.t = null;
        _this.c = 0;
        _this.a = 0;
        _this.g = null;
        _this.l = 0;
        _this.h = null;
        _this.b = 0;
        a = (a == void 0) ? 0 : a;
        switch (a) {
            case 0:
                {
                    var c_4 = _rest[0];
                    var d_8 = _rest[1];
                    var e = _rest[2];
                    _this.g = c_4;
                    _this.l = d_8;
                    _this.b = e;
                    _this.f = c_4.filterSettings.getFilter(d_8);
                    _this.j = ((function () { var f = SpreadsheetUtilities.bz(c_4, d_8, _this.a); _this.a = f.p2; return f.ret; })());
                    _this.v = FilterDialogViewModel.x(c_4, d_8);
                    _this.ac();
                }
                break;
            case 1:
                {
                    var c_5 = _rest[0];
                    var d = _rest[1];
                    _this.h = c_5;
                    _this.b = d;
                    _this.g = _this.h.table.worksheet;
                    _this.f = c_5.filter;
                    _this.j = ((function () { var e = SpreadsheetUtilities.b1(c_5, _this.a); _this.a = e.p1; return e.ret; })());
                    _this.v = FilterDialogViewModel.y(c_5);
                    _this.ac();
                }
                break;
        }
        return _this;
    }
    FilterDialogViewModel.prototype.ac = function () {
        this.m = Nullable$1.toNullable(ExcelComparisonOperator_$type, 0);
        this.o = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        this.r = null;
        this.t = null;
        this.c = 0;
        var a;
        var b;
        var c;
        var d;
        var e;
        var f = this.ad(a, c, b, d, e);
        a = f.p0;
        c = f.p1;
        b = f.p2;
        d = f.p3;
        e = f.p4;
        var g;
        var h;
        var i = this.ab(g, h);
        g = i.p0;
        h = i.p1;
        if (g.hasValue) {
            if (nullableNotEquals(g, a)) {
                this.m = g;
                this.o = h;
                return;
            }
            if (h.hasValue && nullableNotEquals(h, b)) {
                this.m = g;
                this.o = h;
                return;
            }
        }
        if (a.hasValue) {
            this.m = a;
            this.o = b;
            this.r = c;
            this.t = d;
            this.c = e;
        }
    };
    FilterDialogViewModel.prototype.ad = function (a, b, c, d, e) {
        b = null;
        d = null;
        a = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        c = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        e = 0;
        if (null == this.f) {
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        if (typeCast(DatePeriodFilter.$, this.f) !== null || typeCast(FillFilter.$, this.f) !== null || typeCast(IconFilter.$, this.f) !== null || typeCast(FontColorFilter.$, this.f) !== null) {
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var f = typeCast(CustomFilter.$, this.f);
        if (null != f) {
            var g = f.condition1;
            if (null != g) {
                a = Nullable$1.toNullable(ExcelComparisonOperator_$type, g.comparisonOperator);
                b = g.value;
            }
            var h = f.condition2;
            if (null != h) {
                c = Nullable$1.toNullable(ExcelComparisonOperator_$type, h.comparisonOperator);
                d = h.value;
            }
            e = f.conditionalOperator;
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var i = typeCast(AverageFilter.$, this.f);
        if (null != i) {
            b = i.average;
            switch (i.type) {
                case 0:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 2);
                    break;
                case 1:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 4);
                    break;
                default: break;
            }
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var j = typeCast(FixedValuesFilter.$, this.f);
        if (null != j) {
            e = 1;
            a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 0);
            var k = j._displayValues$i.count;
            if (k == 0 || k > 2) {
                return {
                    p0: a,
                    p1: b,
                    p2: c,
                    p3: d,
                    p4: e
                };
            }
            b = j._displayValues$i.item(0);
            if (k > 1) {
                c = Nullable$1.toNullable(ExcelComparisonOperator_$type, 0);
                d = j._displayValues$i.item(1);
            }
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var l = typeCast(DateRangeFilter.$, this.f);
        if (null != l) {
            this.c = 0;
            a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 3);
            c = Nullable$1.toNullable(ExcelComparisonOperator_$type, 4);
            b = l.start;
            d = l.end;
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        var m = typeCast(TopOrBottomFilter.$, this.f);
        if (null != m) {
            switch (m._v) {
                case 2:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 0);
                    break;
                case 4:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 2);
                    break;
                case 6:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 3);
                    break;
                case 1:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 4);
                    break;
                case 3:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 5);
                    break;
                case 5:
                    a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 1);
                    break;
            }
            b = m._z;
            return {
                p0: a,
                p1: b,
                p2: c,
                p3: d,
                p4: e
            };
        }
        return {
            p0: a,
            p1: b,
            p2: c,
            p3: d,
            p4: e
        };
    };
    FilterDialogViewModel.prototype.ab = function (a, b) {
        a = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        b = Nullable$1.toNullable(ExcelComparisonOperator_$type, null);
        switch (this.b) {
            case 0:
            case 1:
            case 2:
            case 3:
            case 4:
            case 5:
            case 6:
            case 7:
            case 8:
            case 9:
            case 10:
            case 11:
                a = Nullable$1.toNullable(ExcelComparisonOperator_$type, FilterDialogViewModel.e(this.b));
                break;
            case 12:
                a = Nullable$1.toNullable(ExcelComparisonOperator_$type, 3);
                b = Nullable$1.toNullable(ExcelComparisonOperator_$type, 4);
                break;
            case 13: break;
            default: break;
        }
        return {
            p0: a,
            p1: b
        };
    };
    FilterDialogViewModel.x = function (a, b) {
        var c = a.filterSettings;
        var d = c != null ? c.region : null;
        if (null == c || null == d) {
            return null;
        }
        var e = d.firstRow;
        var f = d.firstColumn + b;
        var g = a._rows$i.item(e);
        var h = SpreadsheetUtilities.dg(g, f);
        return h;
    };
    FilterDialogViewModel.y = function (a) {
        var b = a._worksheet;
        var c = a.wholeColumnRegion.firstRow;
        var d = a._at;
        var e = new HashSet$1(Base.$, 0);
        var f = b._rows$i.item(c);
        return SpreadsheetUtilities.dg(f, d);
    };
    FilterDialogViewModel.e = function (a) {
        switch (a) {
            case 0: return 0;
            case 1: return 1;
            case 2: return 2;
            case 3: return 3;
            case 4: return 4;
            case 5: return 5;
            case 6: return 6;
            case 7: return 7;
            case 8: return 8;
            case 9: return 9;
            case 10: return 10;
            case 11: return 11;
            case 12:
            case 13: return 0;
            default: return 0;
        }
    };
    FilterDialogViewModel.prototype.q = function (a, b) {
        if (a.hasValue && CustomFilterCondition._h(a.value)) {
            return b;
        }
        switch (this.a) {
            case 3:
                {
                    var c_6;
                    if (((function () { var d = tryParseNumber(b, c_6); c_6 = d.p1; return d.ret; })())) {
                        return c_6;
                    }
                }
                break;
            case 2:
                {
                    var d_9;
                    if (((function () { var e = dateTryParse(b, d_9); d_9 = e.p1; return e.ret; })())) {
                        return d_9;
                    }
                }
                break;
        }
        return b;
    };
    FilterDialogViewModel.prototype.aa = function (a, b, c, d, e) {
        var f = this.q(a, b);
        var g = new CustomFilterCondition(a.value, f);
        var h = null;
        if (nullableNotEquals(null, c) && false == stringIsNullOrEmpty(c.toString())) {
            if (c.hasValue) {
                var i = this.q(a, d);
                h = new CustomFilterCondition(c.value, i);
            }
            else {
                return;
            }
        }
        if (null != this.h) {
            this.h._applyCustomFilter1(g, h, e);
        }
        else {
            this.g.filterSettings._applyCustomFilter1(this.l, g, h, e);
        }
    };
    FilterDialogViewModel.i = function (a) {
        var b;
        var c = new List$1(ComboBoxListItem.$, 0);
        b = new ComboBoxListItem(stringEmpty(), stringEmpty());
        c.add(b);
        var d = EnumUtil.getValues(ExcelComparisonOperator_$type);
        var e = "ExcelComparisonOperator_{0}_DisplayText";
        for (var g = 0; g < d.length; g++) {
            var f = d[g];
            var h = stringFormat(e, EnumUtil.getName(ExcelComparisonOperator_$type, f));
            var i = a._fs(h);
            b = new ComboBoxListItem(enumGetBox(ExcelComparisonOperator_$type, f), i);
            c.add(b);
        }
        return c;
    };
    FilterDialogViewModel.prototype.z = function (a) {
        var b = null;
        switch (a) {
            case 1:
                b = this.s;
                break;
            case 2:
                b = this.u;
                break;
            default: throw new ArgumentOutOfRangeException(1, "index must be 1 or 2.");
        }
        if (null == b) {
            return null;
        }
        if (typeCast(Date_$type, b) !== null) {
            var c = b;
            var d = +c != +(dateGetDate(c));
            var e_320 = this.g.workbook;
            var f = e_320._e6;
            var g = void 0;
            if (d) {
                g = e_320._b2.a(22);
            }
            else {
                g = e_320._b2.a(14);
            }
            var h_14;
            var i = ((function () { var j = ExcelUtils.b0(e_320, b, h_14); h_14 = j.p2; return j.ret; })());
            var j = g.h(h_14, b.toString(), b, 0, null, null, false, false);
            return j.g;
        }
        return b.toString();
    };
    Object.defineProperty(FilterDialogViewModel.prototype, "k", {
        get: function () {
            return this.j;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "w", {
        get: function () {
            return this.v;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "s", {
        get: function () {
            return this.r;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "u", {
        get: function () {
            return this.t;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "n", {
        get: function () {
            return this.m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "p", {
        get: function () {
            return this.o;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FilterDialogViewModel.prototype, "d", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    FilterDialogViewModel.$t = markType(FilterDialogViewModel, 'FilterDialogViewModel');
    return FilterDialogViewModel;
}(Base));
export { FilterDialogViewModel };
/**
 * @hidden
 */
var FormatCellsDialogViewModel = /** @class */ (function (_super) {
    tslib_1.__extends(FormatCellsDialogViewModel, _super);
    function FormatCellsDialogViewModel(a, b, c, d, e) {
        var _this = _super.call(this) || this;
        _this._e = null;
        _this._f = null;
        _this._i = null;
        _this._a8 = null;
        _this._m = null;
        _this._j = null;
        _this._aw = false;
        _this._a9 = null;
        _this._ax = false;
        _this._a = null;
        _this._r = null;
        _this._ac = 0;
        _this._ae = 0;
        _this._aa = 0;
        _this._w = null;
        _this._x = null;
        _this._t = 0;
        _this._aj = null;
        _this._ah = null;
        _this._ai = WorkbookColorInfo.automatic;
        _this._bc = -1;
        _this._bk = Nullable$1.toNullable(Boolean_$type, null);
        _this._bj = Nullable$1.toNullable(Boolean_$type, null);
        _this._bi = Nullable$1.toNullable(Boolean_$type, null);
        _this._bh = Nullable$1.toNullable(Boolean_$type, null);
        _this._c = null;
        _this._o = null;
        _this._bb = -1;
        _this._ay = false;
        _this._bt = null;
        _this._l = null;
        _this._ap = null;
        _this._bd = 0;
        _this._aq = null;
        _this._ar = null;
        _this._ao = null;
        _this._q = null;
        _this._h = 0;
        _this._bs = null;
        _this._a4 = false;
        _this.propertyChanged = null;
        CoreUtilities.z(a, "dialogOptions");
        CoreUtilities.z(b, "dialogData");
        CoreUtilities.z(c, "dialogServicesManager");
        _this._f = a;
        _this._e = b;
        _this._i = c;
        _this._bs = d;
        _this._a4 = _this._f.f;
        _this._a9 = new List$1(String_$type, 0);
        var f = (false == a.i.hasValue) ? a.i : (a.i.value & a.a) != 0 ? a.i : Nullable$1.toNullable(FormatCellsDialogTab_$type, null);
        _this._cm(e, f);
        return _this;
    }
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a0", {
        get: function () {
            return (this._f.a & 2) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a1", {
        get: function () {
            return (this._f.a & 8) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a2", {
        get: function () {
            return (this._f.a & 16) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a3", {
        get: function () {
            return (this._f.a & 4) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a5", {
        get: function () {
            return (this._f.a & 1) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a6", {
        get: function () {
            return (this._f.a & 32) != 0;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ak", {
        get: function () {
            return this._ah;
        },
        set: function (a) {
            if (WorkbookColorInfo.l_op_Inequality(a, this._ah)) {
                this._ah = a;
                this._cq("BackgroundColorInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_d", {
        get: function () {
            return this._c;
        },
        set: function (a) {
            if (a != this._c) {
                this._c = a;
                this._cq("CellBorderInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_cx", {
        get: function () {
            if (WorkbookColorInfo.l_op_Inequality(null, this._ai) && null != this._ag) {
                return this._ai._getResolvedColor1(this._ag);
            }
            if (null != this._ag) {
                return WorkbookColorInfo.automatic._getResolvedColor1(this._ag);
            }
            return WorkbookColorInfo.automatic._getResolvedColor();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_al", {
        get: function () {
            return this._ai;
        },
        set: function (a) {
            if (WorkbookColorInfo.l_op_Inequality(a, this._ai)) {
                this._ai = a;
                this._cq("CellBorderLineColorInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_as", {
        get: function () {
            var e_321, _0;
            if (null == this._ao) {
                var a = new List$1(EnumWrapper$1.$.specialize(CellBorderLineStyle_$type), 0);
                try {
                    for (var _1 = tslib_1.__values(fromEnum(EnumUtil.getValues(CellBorderLineStyle_$type))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var b = _2.value;
                        a.add(new EnumWrapper$1(CellBorderLineStyle_$type, b, "CellBorderLineStyle"));
                    }
                }
                catch (e_321_1) { e_321 = { error: e_321_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_321) throw e_321.error; }
                }
                this._ao = a.toArray();
            }
            return this._ao;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bx", {
        get: function () {
            return this._bt;
        },
        set: function (a) {
            if (a != this._bt) {
                this._bt = a;
                this._cq("CustomizedFormatMask");
                this._cq("SelectedFormatResolved");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_be", {
        get: function () {
            return this._bb;
        },
        set: function (a) {
            if (a != this._bb) {
                this._bb = a;
                this._cq("DecimalPlacesInSelectedNumberFormat");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_am", {
        get: function () {
            return this._aj;
        },
        set: function (a) {
            if (WorkbookColorInfo.l_op_Inequality(a, this._aj)) {
                this._aj = a;
                this._cq("FillPatternColorInfo");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_at", {
        get: function () {
            var e_322, _0;
            if (null == this._ap) {
                var a = new List$1(FillPatternStyle_$type, 1, EnumUtil.getValues(FillPatternStyle_$type));
                a.remove(-1);
                var b = new List$1(EnumWrapper$1.$.specialize(FillPatternStyle_$type), 0);
                try {
                    for (var _1 = tslib_1.__values(fromEnum(a)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var c = _2.value;
                        b.add(new EnumWrapper$1(FillPatternStyle_$type, c, "FillPatternStyle"));
                    }
                }
                catch (e_322_1) { e_322 = { error: e_322_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_322) throw e_322.error; }
                }
                this._ap = b.toArray();
            }
            return this._ap;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_b", {
        get: function () {
            if (null == this._a) {
                this._a = new FontControlViewModel(this._e.ah, this._e.x, this._e.z, this._e.aa, this._e.ab, this._e.k, this._e.l, this._e.r, this._i, this._f.b, this._f.c, this._f.g, this._f.h, this._ag, this._s);
            }
            return this._a;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ba", {
        get: function () {
            if (null == this._a8) {
                this._a8 = this._p.getFormatCategories(this._ag);
            }
            return this._a8;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_au", {
        get: function () {
            var e_323, _0;
            if (null == this._aq) {
                var a = new List$1(EnumWrapper$1.$.specialize(HorizontalCellAlignment_$type), 0);
                try {
                    for (var _1 = tslib_1.__values(fromEnum(EnumUtil.getValues(HorizontalCellAlignment_$type))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var b = _2.value;
                        a.add(new EnumWrapper$1(HorizontalCellAlignment_$type, b, "HorizontalCellAlignment"));
                    }
                }
                catch (e_323_1) { e_323 = { error: e_323_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_323) throw e_323.error; }
                }
                this._aq = a.toArray();
            }
            return this._aq;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bf", {
        get: function () {
            return this._bc;
        },
        set: function (a) {
            if (a != this._bc) {
                this._bc = a;
                this._cq("Indent");
                if (this._bc > 0) {
                    switch (this._ad) {
                        case 7:
                        case 1:
                        case 3: break;
                        default:
                            this._ad = 1;
                            break;
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_a7", {
        get: function () {
            return this._ay;
        },
        set: function (a) {
            if (a != this._ay) {
                this._ay = a;
                this._cq("IsShrinkToFitSelectionEnabled");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bn", {
        get: function () {
            return this._bh;
        },
        set: function (a) {
            var b = this._bp(a);
            if (nullableNotEquals(b, this._bh)) {
                this._bh = b;
                this._cq("Locked");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bo", {
        get: function () {
            return this._bi;
        },
        set: function (a) {
            var b = this._bp(a);
            if (nullableNotEquals(b, this._bi)) {
                this._bi = b;
                this._cq("MergeCells");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bg", {
        get: function () {
            return this._bd;
        },
        set: function (a) {
            if (a != this._bd) {
                this._bd = a;
                this._cq("NoColorVersion");
                this._cs();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_v", {
        get: function () {
            return this._t;
        },
        set: function (a) {
            if (a != this._t) {
                this._t = a;
                this._cq("SelectedCellBorderLineStyle");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_y", {
        get: function () {
            return this._w;
        },
        set: function (a) {
            if (a != this._w) {
                this._w = a;
                this._cq("SelectedFill");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_z", {
        get: function () {
            return this._x;
        },
        set: function (a) {
            if (a != this._x) {
                this._x = a;
                this._cq("SelectedFillForPreview");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ab", {
        get: function () {
            return this._aa;
        },
        set: function (a) {
            if (a != this._aa) {
                this._aa = a;
                this._cq("SelectedFillPatternStyle");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_k", {
        get: function () {
            return this._j;
        },
        set: function (a) {
            var b = a;
            var c = null != b ? Enumerable.ag(SpreadsheetDialogFormat.$, this._n._w, function (d) { return d._e == b._e; }) : null;
            if (c != this._j) {
                this._j = c;
                this._cq("SelectedFormat");
                if (null != this._j) {
                    this._bx = this._j._e;
                }
                this._cq("SelectedFormatResolved");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ce", {
        get: function () {
            if (null != this._n && this._n._l && null != this._bx) {
                var a = new ValueFormatter(0, this._ag, this._bx, this._ag._e6);
                if (a.o) {
                    return this._bx;
                }
            }
            if (null != this._k) {
                return this._k._e;
            }
            else {
                return stringEmpty();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_n", {
        get: function () {
            if (null == this._m) {
                if (null != this._ba && this._ba.count > 0) {
                    this._m = this._ba._inner[0];
                }
            }
            return this._m;
        },
        set: function (a) {
            this._l = this._m;
            if (null != this._l) {
                this._l._d = this._k;
            }
            if (a != this._m) {
                if (null != this._l) {
                    var b = this._l;
                    b.propertyChanged = delegateRemove(b.propertyChanged, runOn(this, this._co));
                }
                this._m = a;
                this._cq("SelectedFormatCategory");
                a.propertyChanged = delegateCombine(a.propertyChanged, runOn(this, this._co));
                var c = SpreadsheetUtilities.di(null, "FormatInfo_General");
                if (a._aa != c) {
                    this._cq("SelectedFormat");
                }
                if (a._l && this._a9.contains("CustomizedFormatMask")) {
                    this._a9.remove("CustomizedFormatMask");
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ad", {
        get: function () {
            return this._ac;
        },
        set: function (a) {
            if (a != this._ac) {
                this._ac = a;
                this._cq("SelectedHorizontalCellAlignment");
                this._cw();
                if (this._bf > 0) {
                    switch (this._ad) {
                        case 7:
                        case 1:
                        case 3: break;
                        default:
                            this._bf = 0;
                            break;
                    }
                }
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_af", {
        get: function () {
            return this._ae;
        },
        set: function (a) {
            if (a != this._ae) {
                this._ae = a;
                this._cq("SelectedVerticalCellAlignment");
                this._cw();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_bq", {
        get: function () {
            return this._bj;
        },
        set: function (a) {
            var b = this._bp(a);
            if (nullableNotEquals(b, this._bj)) {
                this._bj = b;
                this._cq("ShrinkToFit");
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_s", {
        get: function () {
            if (null == this._r) {
                var a = SpreadsheetUtilities.di(null, "SpreadsheetFontControl_Text_Automatic");
                this._r = new ThemeColorPickerControlViewModel(this._ag, a);
            }
            return this._r;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_av", {
        get: function () {
            var e_324, _0;
            if (null == this._ar) {
                var a = new List$1(EnumWrapper$1.$.specialize(VerticalCellAlignment_$type), 0);
                try {
                    for (var _1 = tslib_1.__values(fromEnum(EnumUtil.getValues(VerticalCellAlignment_$type))), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                        var b = _2.value;
                        a.add(new EnumWrapper$1(VerticalCellAlignment_$type, b, "VerticalCellAlignment"));
                    }
                }
                catch (e_324_1) { e_324 = { error: e_324_1 }; }
                finally {
                    try {
                        if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                    }
                    finally { if (e_324) throw e_324.error; }
                }
                this._ar = a.toArray();
            }
            return this._ar;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_ag", {
        get: function () {
            return this._e.o;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_br", {
        get: function () {
            return this._bk;
        },
        set: function (a) {
            var b = this._bp(a);
            if (nullableNotEquals(b, this._bk)) {
                this._bk = b;
                this._cq("WrapText");
                this._cw();
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(FormatCellsDialogViewModel.prototype, "_p", {
        get: function () {
            if (null == this._o) {
                this._o = new SpreadsheetDialogFormatsService();
            }
            return this._o;
        },
        enumerable: true,
        configurable: true
    });
    FormatCellsDialogViewModel.prototype._ck = function (a) {
        switch (a) {
            case 0:
                this._d._i = 0;
                this._d._l = 0;
                this._d._m = 0;
                this._d._n = 0;
                this._d._o = 0;
                this._d._p = 0;
                this._d._j = 0;
                this._d._k = 0;
                this._d._r = 1;
                break;
            case 2:
                if (FormatCellsDialogBorderInfo._aq(this._d._l) || WorkbookColorInfo.l_op_Inequality(this._d._ad, this._al) || this._d._l != this._v) {
                    this._d._l = this._v;
                    this._d._ad = this._al;
                }
                if (FormatCellsDialogBorderInfo._aq(this._d._m) || WorkbookColorInfo.l_op_Inequality(this._d._ae, this._al) || this._d._m != this._v) {
                    this._d._m = this._v;
                    this._d._ae = this._al;
                }
                break;
            case 1:
                if (FormatCellsDialogBorderInfo._aq(this._d._i) || WorkbookColorInfo.l_op_Inequality(this._d._aa, this._al) || this._d._i != this._v) {
                    this._d._i = this._v;
                    this._d._aa = this._al;
                }
                if (FormatCellsDialogBorderInfo._aq(this._d._n) || WorkbookColorInfo.l_op_Inequality(this._d._af, this._al) || this._d._n != this._v) {
                    this._d._n = this._v;
                    this._d._af = this._al;
                }
                if (FormatCellsDialogBorderInfo._aq(this._d._o) || WorkbookColorInfo.l_op_Inequality(this._d._ag, this._al) || this._d._o != this._v) {
                    this._d._o = this._v;
                    this._d._ag = this._al;
                }
                if (FormatCellsDialogBorderInfo._aq(this._d._p) || WorkbookColorInfo.l_op_Inequality(this._d._ah, this._al) || this._d._p != this._v) {
                    this._d._p = this._v;
                    this._d._ah = this._al;
                }
                break;
        }
    };
    FormatCellsDialogViewModel.prototype._cl = function () {
        var _this = this;
        var e_325, _0, e_326, _1;
        try {
            for (var _2 = tslib_1.__values(fromEnum(this._a9)), _3 = _2.next(); !_3.done; _3 = _2.next()) {
                var a = _3.value;
                switch (a) {
                    case "SelectedFormat":
                    case "CustomizedFormatMask":
                        var b = stringEmpty();
                        var c = true;
                        if (this._n._l) {
                            try {
                                var d = new ValueFormatter(0, this._ag, this._bx, this._ag._e6);
                                c = d.o;
                            }
                            catch (e) {
                                c = false;
                            }
                            if (c) {
                                b = this._bx;
                            }
                        }
                        else {
                            b = this._k._e;
                        }
                        if (false == c) {
                            var f = SpreadsheetUtilities.di(null, "FormatCellsDialog_NumberTabInvalidMaskError");
                            f = stringFormat(f, this._bx);
                            this._q = new SpreadsheetDialogResult(true, ((function () {
                                var $ret = new FormatCellsDialogViewModel_FormatCellsDialogState();
                                $ret.a = _this._h;
                                return $ret;
                            })()), f);
                            return;
                        }
                        else {
                            this._e.ai = b;
                        }
                        break;
                    case "SelectedHorizontalCellAlignment":
                        this._e.m = this._ad;
                        break;
                    case "SelectedVerticalCellAlignment":
                        this._e.n = this._af;
                        break;
                    case "Indent":
                        this._e.y = this._bf;
                        break;
                    case "WrapText":
                        if (false == this._br.hasValue) {
                            this._e.ag = Nullable$1.toNullable(Boolean_$type, null);
                        }
                        else if (true == this._br.value) {
                            this._e.ag = Nullable$1.toNullable(Boolean_$type, true);
                        }
                        else {
                            this._e.ag = Nullable$1.toNullable(Boolean_$type, false);
                        }
                        break;
                    case "ShrinkToFit":
                        if (false == this._bq.hasValue) {
                            this._e.af = Nullable$1.toNullable(Boolean_$type, null);
                        }
                        else if (true == this._bq.value) {
                            this._e.af = Nullable$1.toNullable(Boolean_$type, true);
                        }
                        else {
                            this._e.af = Nullable$1.toNullable(Boolean_$type, false);
                        }
                        break;
                    case "MergeCells":
                        if (false == this._bo.hasValue) {
                            this._e.ad = Nullable$1.toNullable(Boolean_$type, null);
                        }
                        else if (true == this._bo.value) {
                            this._e.ad = Nullable$1.toNullable(Boolean_$type, true);
                        }
                        else {
                            this._e.ad = Nullable$1.toNullable(Boolean_$type, false);
                        }
                        break;
                    case "Locked":
                        if (false == this._bn.hasValue) {
                            this._e.ac = Nullable$1.toNullable(Boolean_$type, null);
                        }
                        else if (true == this._bn.value) {
                            this._e.ac = Nullable$1.toNullable(Boolean_$type, true);
                        }
                        else {
                            this._e.ac = Nullable$1.toNullable(Boolean_$type, false);
                        }
                        break;
                    case "SelectedFillPatternStyle":
                    case "BackgroundColorInfo":
                    case "FillPatternColorInfo":
                        this._e.i = this._y;
                        break;
                    default: break;
                }
            }
        }
        catch (e_325_1) { e_325 = { error: e_325_1 }; }
        finally {
            try {
                if (_3 && !_3.done && (_0 = _2.return)) _0.call(_2);
            }
            finally { if (e_325) throw e_325.error; }
        }
        this._e.p = this._c._aa;
        this._e.b = this._c._i;
        this._e.s = this._c._ad;
        this._e.d = this._c._l;
        this._e.t = this._c._ae;
        this._e.e = this._c._m;
        this._e.u = this._c._af;
        this._e.f = this._c._n;
        this._e.v = this._c._ag;
        this._e.g = this._c._o;
        this._e.w = this._c._ah;
        this._e.h = this._c._p;
        this._e.j = this._c._r;
        this._e.q = this._c._ab;
        if (false == FormatCellsDialogBorderInfo._aq(this._c._k)) {
            this._e.c = this._c._k;
        }
        else if (false == FormatCellsDialogBorderInfo._aq(this._c._j)) {
            this._e.c = this._c._j;
        }
        else {
            this._e.c = 0;
        }
        try {
            for (var _4 = tslib_1.__values(fromEnum(this._b._ah)), _5 = _4.next(); !_5.done; _5 = _4.next()) {
                var g = _5.value;
                switch (g) {
                    case "SelectedFontName":
                        this._e.ah = this._b._ax;
                        break;
                    case "SelectedFontSize":
                        if (this._b._aj > -1) {
                            this._e.x = this._b._aj * 20;
                        }
                        break;
                    case "SelectedFontStyle":
                        {
                            var h = this._b._d.a;
                            if (this._b._d.a != 0) {
                                this._e.z = Nullable$1.toNullable(Boolean_$type, (h == 2 || h == 4) ? true : false);
                                this._e.aa = Nullable$1.toNullable(Boolean_$type, (h == 3 || h == 4) ? true : false);
                            }
                            else {
                                this._e.z = Nullable$1.toNullable(Boolean_$type, null);
                                this._e.aa = Nullable$1.toNullable(Boolean_$type, null);
                            }
                            break;
                        }
                    case "Subscript":
                    case "Superscript":
                        if (nullableEquals(true, this._b._ar)) {
                            this._e.k = 2;
                        }
                        else if (nullableEquals(true, this._b._as)) {
                            this._e.k = 1;
                        }
                        else {
                            this._e.k = 0;
                        }
                        break;
                    case "Strikeout":
                        if (false == this._b._aq.hasValue) {
                            this._e.ab = Nullable$1.toNullable(Boolean_$type, null);
                        }
                        else if (true == this._b._aq.value) {
                            this._e.ab = Nullable$1.toNullable(Boolean_$type, true);
                        }
                        else {
                            this._e.ab = Nullable$1.toNullable(Boolean_$type, false);
                        }
                        break;
                    case "SelectedFontColorInfo":
                        this._e.r = this._b._m;
                        break;
                    case "SelectedFontUnderlineStyle":
                        this._e.l = this._b._h;
                        break;
                    default: break;
                }
            }
        }
        catch (e_326_1) { e_326 = { error: e_326_1 }; }
        finally {
            try {
                if (_5 && !_5.done && (_1 = _4.return)) _1.call(_4);
            }
            finally { if (e_326) throw e_326.error; }
        }
        this._q = new SpreadsheetDialogResult(false, ((function () {
            var $ret = new FormatCellsDialogViewModel_FormatCellsDialogState();
            $ret.a = _this._h;
            return $ret;
        })()), "");
    };
    FormatCellsDialogViewModel.prototype._cv = function (a) {
        switch (a) {
            case 3:
                this._d._i = this._u(this._d._i, this._d._aa);
                if (this._d._i != 0) {
                    this._d._aa = this._al;
                }
                break;
            case 5:
                this._d._l = this._u(this._d._l, this._d._ad);
                if (this._d._l != 0) {
                    this._d._ad = this._al;
                }
                break;
            case 4:
                this._d._m = this._u(this._d._m, this._d._ae);
                if (this._d._m != 0) {
                    this._d._ae = this._al;
                }
                break;
            case 0:
                this._d._n = this._u(this._d._n, this._d._af);
                if (this._d._n != 0) {
                    this._d._af = this._al;
                }
                break;
            case 2:
                this._d._o = this._u(this._d._o, this._d._ag);
                if (this._d._o != 0) {
                    this._d._ag = this._al;
                }
                break;
            case 1:
                this._d._p = this._u(this._d._p, this._d._ah);
                if (this._d._p != 0) {
                    this._d._ah = this._al;
                }
                break;
            case 6:
                this._d._j = this._u(this._d._j, this._d._ab);
                if (this._d._j != 0) {
                    this._d._ab = this._al;
                }
                break;
            case 7:
                this._d._k = this._u(this._d._k, this._d._ac);
                if (this._d._k != 0) {
                    this._d._ac = this._al;
                }
                break;
        }
    };
    FormatCellsDialogViewModel.prototype._az = function (a) {
        return nullableEquals(a, true);
    };
    FormatCellsDialogViewModel.prototype._bl = function (a) {
        if (nullableEquals(a, null)) {
            return Nullable$1.toNullable(Boolean_$type, null);
        }
        else {
            return Nullable$1.toNullable(Boolean_$type, nullableEquals(a, true));
        }
    };
    FormatCellsDialogViewModel.prototype._bm = function (a) {
        if (WorkbookColorInfo.l_op_Equality(null, a)) {
            return Nullable$1.toNullable(Color.$, null);
        }
        return Nullable$1.toNullable(Color.$, a._getResolvedColor1(this._ag));
    };
    FormatCellsDialogViewModel.prototype._g = function () {
        if (this._a5) {
            return 1;
        }
        if (this._a0) {
            return 2;
        }
        if (this._a3) {
            return 4;
        }
        if (this._a1) {
            return 8;
        }
        if (this._a2) {
            return 16;
        }
        if (this._a6) {
            return 32;
        }
        return 0;
    };
    FormatCellsDialogViewModel.prototype._b1 = function (a) {
        var e_327, _0;
        try {
            for (var _1 = tslib_1.__values(fromEnum(a._w)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                var b = _2.value;
                var c = this._b2(b._e);
                if (false == stringIsNullOrEmpty(c)) {
                    return c;
                }
            }
        }
        catch (e_327_1) { e_327 = { error: e_327_1 }; }
        finally {
            try {
                if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
            }
            finally { if (e_327) throw e_327.error; }
        }
        return null;
    };
    FormatCellsDialogViewModel.prototype._b2 = function (a) {
        var b = ["black", "green", "white", "blue", "magenta", "yellow", "cyan", "red"];
        var c = [0, 0, 0, 0, 0, 0, 0, 0];
        var d = a.toLowerCase();
        for (var e = 0; e < b.length; e++) {
            if (stringContains(d, b[e])) {
                c[e]++;
            }
        }
        var f = null;
        for (var g = 0; g < c.length; g++) {
            if (c[g] > 0) {
                if (stringIsNullOrEmpty(f)) {
                    f = b[g];
                }
                else {
                    return stringEmpty();
                }
            }
        }
        return f;
    };
    FormatCellsDialogViewModel.prototype._an = function (a, b) {
        if (WorkbookColorInfo.l_op_Equality(null, a) || Color.c(Nullable$1.toNullable(Color.$, null), a._color$i)) {
            if (Color.e(Nullable$1.toNullable(Color.$, null), b)) {
                return new WorkbookColorInfo(b.value);
            }
        }
        else if (Color.e(Nullable$1.toNullable(Color.$, null), b)) {
            if (b.value.l == 0) {
                return new WorkbookColorInfo(b, Nullable$1.toNullable(WorkbookThemeColorType_$type, null), Nullable$1.toNullable(Number_$type, null), false, false);
            }
            else {
                return new WorkbookColorInfo(b, Nullable$1.toNullable(WorkbookThemeColorType_$type, null), Nullable$1.toNullable(Number_$type, null), false, true);
            }
        }
        return null;
    };
    FormatCellsDialogViewModel.prototype._u = function (a, b) {
        if (a == this._v && WorkbookColorInfo.l_op_Equality(b, this._al)) {
            return 0;
        }
        return this._v;
    };
    FormatCellsDialogViewModel.prototype._cn = function (a) {
        var e_328, _0;
        if (stringIsNullOrEmpty(a)) {
            this._k = null;
            this._n = null;
        }
        else {
            while (stringContains(a, "\"$\"")) {
                a = stringReplace(a, "\"$\"", "$");
            }
            while (stringContains(a, "\\")) {
                a = stringReplace(a, "\\", "");
            }
            var b = false;
            var c = null;
            var d = null;
            try {
                for (var _1 = tslib_1.__values(fromEnum(this._ba)), _2 = _1.next(); !_2.done; _2 = _1.next()) {
                    var e = _2.value;
                    c = e._c(a);
                    if (c != null) {
                        d = e;
                        b = e._l;
                        break;
                    }
                }
            }
            catch (e_328_1) { e_328 = { error: e_328_1 }; }
            finally {
                try {
                    if (_2 && !_2.done && (_0 = _1.return)) _0.call(_1);
                }
                finally { if (e_328) throw e_328.error; }
            }
            var f = null;
            var g = null;
            if (null == c || b) {
                var h = new ValueFormatter(0, this._ag, a, this._ag._e6);
                if (h.o) {
                    var i = true;
                    var j = true;
                    var k = true;
                    var l = true;
                    var m = true;
                    var n = -1;
                    var o = 0;
                    var p = a.split(';');
                    for (var q = 0; q < 4; q++) {
                        var r = h.c(q);
                        if (null == r) {
                            break;
                        }
                        o++;
                        if (false == r.isNumberSection) {
                            i = false;
                            break;
                        }
                        if (r.percentCount < 1) {
                            k = false;
                        }
                        for (var t = 0; t < p.length; t++) {
                            var s = p[t];
                            if (false == stringContains(s, "$")) {
                                j = false;
                            }
                            if (false == stringContains(s, "E+")) {
                                l = false;
                            }
                            if (false == stringContains(s, "_(")) {
                                m = false;
                            }
                        }
                        if (n == -1) {
                            n = r.fractionDigitCount;
                        }
                        else if (n != r.fractionDigitCount) {
                            n = -1;
                            break;
                        }
                    }
                    if (i && n != -1) {
                        var u = this._b2(a);
                        if (l) {
                            f = Enumerable.ag(SpreadsheetDialogFormatCategory.$, this._ba, function (v) { return v._r; });
                        }
                        else if (j) {
                            var v = Enumerable.ag(SpreadsheetDialogFormatCategory.$, this._ba, function (w) { return w._j; });
                            if (null == u || u == this._b1(v)) {
                                f = v;
                            }
                        }
                        else if (k) {
                            f = Enumerable.ag(SpreadsheetDialogFormatCategory.$, this._ba, function (w) { return w._q; });
                        }
                        else if (m) {
                            f = Enumerable.ag(SpreadsheetDialogFormatCategory.$, this._ba, function (w) { return w._i; });
                        }
                        else {
                            var w = Enumerable.ag(SpreadsheetDialogFormatCategory.$, this._ba, function (x) { return x._p; });
                            if (null == u || u == this._b1(w)) {
                                f = w;
                            }
                        }
                        if (null != f) {
                            f._y = n;
                            if (b && null != c) {
                                g = c;
                            }
                            else {
                                var x = f._c(a);
                                if (null != x) {
                                    g = x;
                                }
                                else {
                                    g = Enumerable.ad(SpreadsheetDialogFormat.$, f._w);
                                }
                            }
                        }
                    }
                }
            }
            if (null != f) {
                this._n = f;
                this._k = g;
                if (null == this._k) {
                    this._n = d;
                    this._k = c;
                }
            }
            else if (null == c) {
                var y = Enumerable.ae(SpreadsheetDialogFormatCategory.$, this._ba, function (z) { return z._l; });
                this._n = y;
                this._k = y._b(a);
            }
            else {
                this._n = d;
                this._k = c;
            }
        }
    };
    FormatCellsDialogViewModel.prototype._cm = function (a, b) {
        this._ax = true;
        this._cn(this._e.ai);
        this._ad = this._e.m;
        this._af = this._e.n;
        this._bf = this._e.y;
        this._br = this._bl(this._e.ag);
        this._bq = this._bl(this._e.af);
        this._bo = this._bl(this._e.ad);
        this._cw();
        this._c = new FormatCellsDialogBorderInfo(this._f.d, this._f.e);
        this._c._aa = this._e.p;
        this._c._i = this._e.b;
        this._c._ad = this._e.s;
        this._c._l = this._e.d;
        this._c._ae = this._e.t;
        this._c._m = this._e.e;
        this._c._af = this._e.u;
        this._c._n = this._e.f;
        this._c._ag = this._e.v;
        this._c._o = this._e.g;
        this._c._ah = this._e.w;
        this._c._p = this._e.h;
        this._c._r = this._e.j;
        this._c._ab = this._e.q;
        if (this._e.j == 7 || this._e.j == 3) {
            this._c._j = this._e.c;
        }
        this._c._ac = this._e.q;
        if (this._e.j == 7 || this._e.j == 5) {
            this._c._k = this._e.c;
        }
        this._v = 1;
        if (typeCast(CellFillPattern.$, this._e.i) !== null) {
            var c = this._e.i;
            this._ak = c.backgroundColorInfo;
            this._ab = c.patternStyle;
            this._am = c.patternColorInfo;
            this._cr();
        }
        else {
            this._ak = WorkbookColorInfo.automatic;
            this._ab = 0;
            this._am = WorkbookColorInfo.automatic;
            this._y = null;
            this._z = null;
        }
        this._bn = this._bl(this._e.ac);
        this._q = new SpreadsheetDialogResult(true, null, "");
        var d = typeCast(FormatCellsDialogViewModel_FormatCellsDialogState.$, a);
        if (null != d) {
            if (b.hasValue && (b.value == 2 || b.value == 8 || b.value == 16 || b.value == 4 || b.value == 1 || b.value == 32)) {
                this._h = b.value;
            }
            else {
                this._h = d.a;
            }
        }
        else {
            this._h = this._g();
        }
        this._ax = false;
    };
    FormatCellsDialogViewModel.prototype._bp = function (a) {
        if (a.hasValue) {
            return Nullable$1.toNullable(Boolean_$type, a.value);
        }
        if (this._ax) {
            return Nullable$1.toNullable(Boolean_$type, null);
        }
        else {
            return Nullable$1.toNullable(Boolean_$type, false);
        }
    };
    FormatCellsDialogViewModel.prototype._co = function (a, b) {
        if (b.propertyName == "DecimalPlaces") {
            if (false == this._a9.contains("SelectedFormat")) {
                this._a9.add("SelectedFormat");
            }
            this._cq("SelectedFormatResolved");
            this._cu();
        }
    };
    FormatCellsDialogViewModel.prototype._cp = function (a) {
        var _this = this;
        if (this._ax) {
            return;
        }
        if (this._aw) {
            return;
        }
        this._aw = true;
        try {
            if (false == this._a9.contains(a)) {
                this._a9.add(a);
            }
            switch (a) {
                case "SelectedFormat": break;
                case "SelectedFormatCategory":
                    if (this._n != null) {
                        if (true == this._n._l && null != this._l && null != this._l._d && false == this._l._l) {
                            var b = Enumerable.ag(SpreadsheetDialogFormat.$, this._n._w, function (c) { return c._e == _this._l._d._e; });
                            this._k = b;
                            if (null == b) {
                                this._bx = this._l._d._e;
                                this._cq("SelectedFormatResolved");
                            }
                        }
                        else if (null == this._n._d) {
                            this._k = Enumerable.af(SpreadsheetDialogFormat.$, this._n._w);
                        }
                        else {
                            this._k = Enumerable.ag(SpreadsheetDialogFormat.$, this._n._w, function (c) { return c._e == _this._n._d._e; });
                        }
                        this._cu();
                    }
                    break;
                case "BackgroundColorInfo":
                    this._cs();
                    break;
                case "SelectedFillPatternStyle":
                case "FillPatternColorInfo":
                    this._cr();
                    break;
            }
        }
        finally {
            this._aw = false;
        }
    };
    FormatCellsDialogViewModel.prototype._cr = function () {
        this._y = new CellFillPattern(this._ak, this._am, this._ab);
        this._z = new CellFillPattern(WorkbookColorInfo.l_op_Equality(null, this._ak) ? null : new WorkbookColorInfo(this._ak._getResolvedColor1(this._e.o)), WorkbookColorInfo.l_op_Equality(null, this._am) ? null : new WorkbookColorInfo(this._am._getResolvedColor1(this._e.o)), this._ab);
    };
    FormatCellsDialogViewModel.prototype._cs = function () {
        if (WorkbookColorInfo.l_op_Inequality(this._ak, null)) {
            if (this._ab == 0) {
                this._ab = 1;
            }
        }
        else {
            this._ab = 0;
        }
        this._cr();
    };
    FormatCellsDialogViewModel.prototype._ct = function (a, b) {
        switch (b.propertyName) {
            case "DecimalPlaces":
                {
                    this._cu();
                    break;
                }
            default: break;
        }
    };
    FormatCellsDialogViewModel.prototype._cu = function () {
        this._bb = -999999;
        this._be = this._m._y;
    };
    FormatCellsDialogViewModel.prototype._cw = function () {
        if (this._ad == 4 || this._ad == 5 || this._ad == 7 || this._af == 3 || this._af == 4 || nullableEquals(this._br, true)) {
            this._a7 = false;
        }
        else {
            this._a7 = true;
        }
    };
    FormatCellsDialogViewModel.prototype._cq = function (a) {
        this._cp(a);
        var b = this.propertyChanged;
        if (null != b) {
            b(this, new PropertyChangedEventArgs(a));
        }
    };
    FormatCellsDialogViewModel.$t = markType(FormatCellsDialogViewModel, 'FormatCellsDialogViewModel', Base.$, [INotifyPropertyChanged_$type]);
    return FormatCellsDialogViewModel;
}(Base));
export { FormatCellsDialogViewModel };
/**
 * For Internal Use only.
 * @typedef TEnum
 */
var EnumWrapper$1 = /** @class */ (function (_super) {
    tslib_1.__extends(EnumWrapper$1, _super);
    function EnumWrapper$1($tEnum, a, b) {
        var _this = _super.call(this) || this;
        _this.$tEnum = null;
        _this._d = null;
        _this._f = null;
        _this._g = null;
        _this.$tEnum = $tEnum;
        _this.$type = _this.$type.specialize(_this.$tEnum);
        _this._d = a;
        _this._f = b;
        return _this;
    }
    /**
     * Returns a string representation of the object.
     * @return
     */
    EnumWrapper$1.prototype.toString = function () {
        return this.enumValueNameLocalized;
    };
    Object.defineProperty(EnumWrapper$1.prototype, "enumValue", {
        /**
         * For Internal Use only.
         */
        get: function () {
            return this._enumValue$i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EnumWrapper$1.prototype, "_enumValue$i", {
        /**
         * @hidden
         */
        get: function () {
            return this._d;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EnumWrapper$1.prototype, "enumValueNameLocalized", {
        /**
         * For Internal Use only.
         */
        get: function () {
            if (stringIsNullOrEmpty(this._g)) {
                var a = this._f + "_" + this._h;
                this._g = SpreadsheetUtilities.di(null, a);
            }
            return this._g;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(EnumWrapper$1.prototype, "_h", {
        /**
         * @hidden
         */
        get: function () {
            return stringToString$1(this.$tEnum, this._d);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @hidden
     */
    EnumWrapper$1._a = function ($tEnum, a, b) {
        var e_329, _0;
        try {
            for (var a_2 = tslib_1.__values(a), a_2_1 = a_2.next(); !a_2_1.done; a_2_1 = a_2.next()) {
                var c = a_2_1.value;
                var d = typeCast(EnumWrapper$1.$.specialize($tEnum), c);
                if (null != d && d._h == b) {
                    return d;
                }
            }
        }
        catch (e_329_1) { e_329 = { error: e_329_1 }; }
        finally {
            try {
                if (a_2_1 && !a_2_1.done && (_0 = a_2.return)) _0.call(a_2);
            }
            finally { if (e_329) throw e_329.error; }
        }
        return null;
    };
    /**
     * @hidden
     */
    EnumWrapper$1._b = function ($tEnum, a, b) {
        var e_330, _0;
        try {
            for (var a_3 = tslib_1.__values(a), a_3_1 = a_3.next(); !a_3_1.done; a_3_1 = a_3.next()) {
                var c = a_3_1.value;
                var d = typeCast(EnumWrapper$1.$.specialize($tEnum), c);
                if (null != d && d.enumValueNameLocalized == b) {
                    return d;
                }
            }
        }
        catch (e_330_1) { e_330 = { error: e_330_1 }; }
        finally {
            try {
                if (a_3_1 && !a_3_1.done && (_0 = a_3.return)) _0.call(a_3);
            }
            finally { if (e_330) throw e_330.error; }
        }
        return null;
    };
    /**
     * @hidden
     */
    EnumWrapper$1._c = function ($tEnum, a, b) {
        var e_331, _0;
        try {
            for (var a_4 = tslib_1.__values(a), a_4_1 = a_4.next(); !a_4_1.done; a_4_1 = a_4.next()) {
                var c = a_4_1.value;
                var d = typeCast(EnumWrapper$1.$.specialize($tEnum), c);
                if (null != d && Base.equalsStatic(d._enumValue$i, getBoxIfEnum($tEnum, b))) {
                    return d;
                }
            }
        }
        catch (e_331_1) { e_331 = { error: e_331_1 }; }
        finally {
            try {
                if (a_4_1 && !a_4_1.done && (_0 = a_4.return)) _0.call(a_4);
            }
            finally { if (e_331) throw e_331.error; }
        }
        return null;
    };
    EnumWrapper$1.$t = markType(EnumWrapper$1, 'EnumWrapper$1');
    return EnumWrapper$1;
}(Base));
export { EnumWrapper$1 };
/**
 * @hidden
 */
var TopOrBottomDialogViewModel = /** @class */ (function (_super) {
    tslib_1.__extends(TopOrBottomDialogViewModel, _super);
    function TopOrBottomDialogViewModel(a) {
        var _rest = [];
        for (var _0 = 1; _0 < arguments.length; _0++) {
            _rest[_0 - 1] = arguments[_0];
        }
        var _this = _super.call(this) || this;
        _this.a = null;
        _this.c = 0;
        _this.i = false;
        _this.g = false;
        _this.m = 0;
        _this.e = null;
        _this.o = 0;
        _this.f = null;
        a = (a == void 0) ? 0 : a;
        switch (a) {
            case 0:
                {
                    var c = _rest[0];
                    var d = _rest[1];
                    _this.e = c;
                    _this.o = d;
                    _this.a = c.filterSettings.getFilter(d);
                    _this.r();
                }
                break;
            case 1:
                {
                    var c = _rest[0];
                    _this.f = c;
                    _this.e = _this.f.table.worksheet;
                    _this.a = c.filter;
                    _this.r();
                }
                break;
        }
        return _this;
    }
    TopOrBottomDialogViewModel.prototype.r = function () {
        var a = typeCast(TopOrBottomFilter.$, this.a);
        if (null != a) {
            this.c = a.type;
            this.m = a.value;
        }
        else {
            this.c = 0;
            this.m = 10;
        }
        switch (this.c) {
            case 3:
            case 1:
                this.i = false;
                break;
            case 2:
            case 0:
                this.i = true;
                break;
        }
        switch (this.c) {
            case 3:
            case 2:
                this.g = true;
                break;
            case 0:
            case 1:
                this.g = false;
                break;
        }
    };
    TopOrBottomDialogViewModel.b = function (a, b) {
        if (a) {
            if (b) {
                return 2;
            }
            else {
                return 0;
            }
        }
        else {
            if (b) {
                return 3;
            }
            else {
                return 1;
            }
        }
    };
    TopOrBottomDialogViewModel.prototype.q = function (a, b, c) {
        var d = TopOrBottomDialogViewModel.b(a, b);
        this.p(d, c);
    };
    TopOrBottomDialogViewModel.prototype.p = function (a, b) {
        if (null != this.f) {
            this.f._applyTopOrBottomFilter1(a, b);
        }
        else {
            this.e.filterSettings._applyTopOrBottomFilter1(this.o, a, b);
        }
    };
    TopOrBottomDialogViewModel.k = function (a) {
        var b;
        var c = new List$1(ComboBoxListItem.$, 0);
        var d = true;
        var e = "ExcelTopOrBottomFilterDirection_Top_DisplayText";
        var f = a._fs(e);
        b = new ComboBoxListItem(d, f);
        c.add(b);
        d = false;
        e = "ExcelTopOrBottomFilterDirection_Bottom_DisplayText";
        f = a._fs(e);
        b = new ComboBoxListItem(d, f);
        c.add(b);
        return c;
    };
    TopOrBottomDialogViewModel.l = function (a) {
        var b;
        var c = new List$1(ComboBoxListItem.$, 0);
        var d = false;
        var e = "ExcelTopOrBottomFilterTypes_Items_DisplayText";
        var f = a._fs(e);
        b = new ComboBoxListItem(d, f);
        c.add(b);
        d = true;
        e = "ExcelTopOrBottomFilterTypes_Percent_DisplayText";
        f = a._fs(e);
        b = new ComboBoxListItem(d, f);
        c.add(b);
        return c;
    };
    Object.defineProperty(TopOrBottomDialogViewModel.prototype, "d", {
        get: function () {
            return this.c;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TopOrBottomDialogViewModel.prototype, "n", {
        get: function () {
            return this.m;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TopOrBottomDialogViewModel.prototype, "j", {
        get: function () {
            return this.i;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TopOrBottomDialogViewModel.prototype, "h", {
        get: function () {
            return this.g;
        },
        enumerable: true,
        configurable: true
    });
    TopOrBottomDialogViewModel.$t = markType(TopOrBottomDialogViewModel, 'TopOrBottomDialogViewModel');
    return TopOrBottomDialogViewModel;
}(Base));
export { TopOrBottomDialogViewModel };
//# sourceMappingURL=SpreadsheetChartAdapterBase_combined.js.map
